{"errors": [], "interfile_languages_used": [], "paths": {"scanned": ["dbeaver-common/.gitignore", "dbeaver-common/LICENSE.md", "dbeaver-common/README.md", "dbeaver-common/SECURITY.md", "dbeaver-common/modules/com.dbeaver.rpc/META-INF/MANIFEST.MF", "dbeaver-common/modules/com.dbeaver.rpc/build.properties", "dbeaver-common/modules/com.dbeaver.rpc/pom.xml", "dbeaver-common/modules/com.dbeaver.rpc/src/com/dbeaver/rpc/RpcException.java", "dbeaver-common/modules/com.dbeaver.rpc/src/com/dbeaver/rpc/base/RpcClient.java", "dbeaver-common/modules/com.dbeaver.rpc/src/com/dbeaver/rpc/base/RpcTransport.java", "dbeaver-common/modules/com.dbeaver.rpc/target/MANIFEST.MF", "dbeaver-common/modules/com.dbeaver.rpc/target/classes/com/dbeaver/rpc/RpcException.class", "dbeaver-common/modules/com.dbeaver.rpc/target/classes/com/dbeaver/rpc/base/RpcClient.class", "dbeaver-common/modules/com.dbeaver.rpc/target/classes/com/dbeaver/rpc/base/RpcTransport.class", "dbeaver-common/modules/com.dbeaver.rpc/target/com.dbeaver.rpc-1.0.0-SNAPSHOT.jar", "dbeaver-common/modules/com.dbeaver.rpc/target/local-artifacts.properties", "dbeaver-common/modules/com.dbeaver.rpc/target/maven-archiver/pom.properties", "dbeaver-common/modules/com.dbeaver.rpc/target/p2artifacts.xml", "dbeaver-common/modules/com.dbeaver.rpc/target/p2content.xml", "dbeaver-common/modules/org.jkiss.utils/.gitignore", "dbeaver-common/modules/org.jkiss.utils/META-INF/MANIFEST.MF", "dbeaver-common/modules/org.jkiss.utils/build.properties", "dbeaver-common/modules/org.jkiss.utils/pom.xml", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/code/NotNull.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/code/Nullable.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/AlphanumericComparator.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/ArgumentTokenizer.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/ArrayUtils.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/Base64.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/BeanUtils.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/ByteNumberFormat.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/CommonUtils.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/GsonUtils.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/IOUtils.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/IntKeyMap.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/LongKeyMap.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/MimeType.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/Pair.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/ReaderWriterLock.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/SecurityUtils.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/StandardConstants.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/csv/CSVParser.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/csv/CSVParserBuilder.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/csv/CSVReader.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/csv/CSVReaderBuilder.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/csv/CSVReaderNullFieldIndicator.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/csv/CSVWriter.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/csv/LineReader.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/io/BOMInputStream.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/io/ByteOrderMark.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/rest/HttpTransportInvocationHandler.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/rest/JsonRpcClient.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/rest/RequestMapping.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/rest/RequestParameter.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/rest/RestClient.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/rest/RestEndpointResolver.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/rest/RestEndpointResolverAdvanced.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/rest/RestProxy.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/rest/RestServer.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/rest/RpcClient.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/rest/RpcConstants.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/rest/RpcException.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/rest/RpcInvocationHandler.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/time/ExtendedDateFormat.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/xml/SAXListener.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/xml/SAXReader.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/xml/XMLBuilder.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/xml/XMLConstants.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/xml/XMLException.java", "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/xml/XMLUtils.java", "dbeaver-common/modules/pom.xml", "dbeaver-common/pom.xml", "dbeaver-common/root/pom.xml"]}, "results": [{"check_id": "java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "end": {"col": 41, "line": 385, "offset": 11739}, "extra": {"engine_kind": "OSS", "fingerprint": "c0340343aa7331746191d81cde9d7d11b1619277171e35d7feb98a8077d58331837621ca4ba8923ecbeb708ffcf860e2afa064e2bea9dfad731f4d6a8b44cb97_0", "is_ignored": false, "lines": "                    e1.printStackTrace();", "message": "Possible active debug code detected. Deploying an application with debug code can create unintended entry points or expose sensitive information.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-489: Active Debug Code"], "functional-categories": ["debug::search::active-debug-code::java.lang"], "impact": "LOW", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "LOW", "owasp": ["A10:2004 - Insecure Configuration Management", "A06:2017 - Security Misconfiguration", "A05:2021 - Security Misconfiguration"], "references": ["https://cwe.mitre.org/data/definitions/489.html", "https://www.acunetix.com/vulnerabilities/web/stack-trace-disclosure-java/", "https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/02-Testing_for_Stack_Traces", "https://www.securecodewarrior.com/blog/coders-conquer-security-share-learn-series-information-exposure"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 27144, "rule_id": "v8U0rZ", "rv_id": 850441, "url": "https://semgrep.dev/playground/r/9lTJDWJ/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "version_id": "9lTJDWJ"}}, "shortlink": "https://sg.run/4K8z", "source": "https://semgrep.dev/r/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "subcategory": ["audit"], "technology": ["java"], "vulnerability_class": ["Active Debug Code"]}, "metavars": {"$EXCEPTION": {"abstract_content": "e1", "end": {"col": 23, "line": 385, "offset": 11721}, "start": {"col": 21, "line": 385, "offset": 11719}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/CommonUtils.java", "start": {"col": 21, "line": 385, "offset": 11719}}, {"check_id": "java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "end": {"col": 32, "line": 678, "offset": 20922}, "extra": {"engine_kind": "OSS", "fingerprint": "98d720d172a3e12fefcd6df2eb331cd2837f84fcf09947bcfa5e881dfe4ec3a62683e2bf2d9b27eeca8b11c30f1f0b2dd3cf75cc410e05663d1c296afe344dbf_0", "is_ignored": false, "lines": "            e.printStackTrace();", "message": "Possible active debug code detected. Deploying an application with debug code can create unintended entry points or expose sensitive information.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-489: Active Debug Code"], "functional-categories": ["debug::search::active-debug-code::java.lang"], "impact": "LOW", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "LOW", "owasp": ["A10:2004 - Insecure Configuration Management", "A06:2017 - Security Misconfiguration", "A05:2021 - Security Misconfiguration"], "references": ["https://cwe.mitre.org/data/definitions/489.html", "https://www.acunetix.com/vulnerabilities/web/stack-trace-disclosure-java/", "https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/02-Testing_for_Stack_Traces", "https://www.securecodewarrior.com/blog/coders-conquer-security-share-learn-series-information-exposure"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 27144, "rule_id": "v8U0rZ", "rv_id": 850441, "url": "https://semgrep.dev/playground/r/9lTJDWJ/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "version_id": "9lTJDWJ"}}, "shortlink": "https://sg.run/4K8z", "source": "https://semgrep.dev/r/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "subcategory": ["audit"], "technology": ["java"], "vulnerability_class": ["Active Debug Code"]}, "metavars": {"$EXCEPTION": {"abstract_content": "e", "end": {"col": 14, "line": 678, "offset": 20904}, "start": {"col": 13, "line": 678, "offset": 20903}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/CommonUtils.java", "start": {"col": 13, "line": 678, "offset": 20903}}, {"check_id": "java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "end": {"col": 32, "line": 690, "offset": 21255}, "extra": {"engine_kind": "OSS", "fingerprint": "98d720d172a3e12fefcd6df2eb331cd2837f84fcf09947bcfa5e881dfe4ec3a62683e2bf2d9b27eeca8b11c30f1f0b2dd3cf75cc410e05663d1c296afe344dbf_1", "is_ignored": false, "lines": "            e.printStackTrace();", "message": "Possible active debug code detected. Deploying an application with debug code can create unintended entry points or expose sensitive information.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-489: Active Debug Code"], "functional-categories": ["debug::search::active-debug-code::java.lang"], "impact": "LOW", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "LOW", "owasp": ["A10:2004 - Insecure Configuration Management", "A06:2017 - Security Misconfiguration", "A05:2021 - Security Misconfiguration"], "references": ["https://cwe.mitre.org/data/definitions/489.html", "https://www.acunetix.com/vulnerabilities/web/stack-trace-disclosure-java/", "https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/02-Testing_for_Stack_Traces", "https://www.securecodewarrior.com/blog/coders-conquer-security-share-learn-series-information-exposure"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 27144, "rule_id": "v8U0rZ", "rv_id": 850441, "url": "https://semgrep.dev/playground/r/9lTJDWJ/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "version_id": "9lTJDWJ"}}, "shortlink": "https://sg.run/4K8z", "source": "https://semgrep.dev/r/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "subcategory": ["audit"], "technology": ["java"], "vulnerability_class": ["Active Debug Code"]}, "metavars": {"$EXCEPTION": {"abstract_content": "e", "end": {"col": 14, "line": 690, "offset": 21237}, "start": {"col": 13, "line": 690, "offset": 21236}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/CommonUtils.java", "start": {"col": 13, "line": 690, "offset": 21236}}, {"check_id": "java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "end": {"col": 46, "line": 720, "offset": 22265}, "extra": {"engine_kind": "OSS", "fingerprint": "fd47819543a240a4366ee01e62c700a177bcae568fa0376811becbd7fd426bfbfb283f2771b8100223f93b077ff8cda0b18c40ba957267abb04bd903c635c90e_0", "is_ignored": false, "lines": "            error.printStackTrace(System.err);", "message": "Possible active debug code detected. Deploying an application with debug code can create unintended entry points or expose sensitive information.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-489: Active Debug Code"], "functional-categories": ["debug::search::active-debug-code::java.lang"], "impact": "LOW", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "LOW", "owasp": ["A10:2004 - Insecure Configuration Management", "A06:2017 - Security Misconfiguration", "A05:2021 - Security Misconfiguration"], "references": ["https://cwe.mitre.org/data/definitions/489.html", "https://www.acunetix.com/vulnerabilities/web/stack-trace-disclosure-java/", "https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/02-Testing_for_Stack_Traces", "https://www.securecodewarrior.com/blog/coders-conquer-security-share-learn-series-information-exposure"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 27144, "rule_id": "v8U0rZ", "rv_id": 850441, "url": "https://semgrep.dev/playground/r/9lTJDWJ/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "version_id": "9lTJDWJ"}}, "shortlink": "https://sg.run/4K8z", "source": "https://semgrep.dev/r/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "subcategory": ["audit"], "technology": ["java"], "vulnerability_class": ["Active Debug Code"]}, "metavars": {"$UTIL": {"abstract_content": "error", "end": {"col": 18, "line": 720, "offset": 22237}, "propagated_value": {"svalue_abstract_content": "new IllegalArgumentException(\"Invalid ordinal \"+ordinal+\" for type \"+enumClass.getName())", "svalue_end": {"col": 137, "line": 716, "offset": 22135}, "svalue_start": {"col": 42, "line": 716, "offset": 22040}}, "start": {"col": 13, "line": 720, "offset": 22232}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/CommonUtils.java", "start": {"col": 13, "line": 720, "offset": 22232}}, {"check_id": "java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "end": {"col": 32, "line": 54, "offset": 1654}, "extra": {"engine_kind": "OSS", "fingerprint": "0cd3e22babeb5d398aad7636cf9b43d6c64236a9d0fce50ef57ef55df11b5f1c9192a23083798ceb4479d33871e117b4e3a50854411835a257f0ecb5eda28ed0_0", "is_ignored": false, "lines": "            e.printStackTrace();", "message": "Possible active debug code detected. Deploying an application with debug code can create unintended entry points or expose sensitive information.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-489: Active Debug Code"], "functional-categories": ["debug::search::active-debug-code::java.lang"], "impact": "LOW", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "LOW", "owasp": ["A10:2004 - Insecure Configuration Management", "A06:2017 - Security Misconfiguration", "A05:2021 - Security Misconfiguration"], "references": ["https://cwe.mitre.org/data/definitions/489.html", "https://www.acunetix.com/vulnerabilities/web/stack-trace-disclosure-java/", "https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/02-Testing_for_Stack_Traces", "https://www.securecodewarrior.com/blog/coders-conquer-security-share-learn-series-information-exposure"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 27144, "rule_id": "v8U0rZ", "rv_id": 850441, "url": "https://semgrep.dev/playground/r/9lTJDWJ/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "version_id": "9lTJDWJ"}}, "shortlink": "https://sg.run/4K8z", "source": "https://semgrep.dev/r/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "subcategory": ["audit"], "technology": ["java"], "vulnerability_class": ["Active Debug Code"]}, "metavars": {"$EXCEPTION": {"abstract_content": "e", "end": {"col": 14, "line": 54, "offset": 1636}, "start": {"col": 13, "line": 54, "offset": 1635}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/IOUtils.java", "start": {"col": 13, "line": 54, "offset": 1635}}, {"check_id": "java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "end": {"col": 32, "line": 62, "offset": 1837}, "extra": {"engine_kind": "OSS", "fingerprint": "0cd3e22babeb5d398aad7636cf9b43d6c64236a9d0fce50ef57ef55df11b5f1c9192a23083798ceb4479d33871e117b4e3a50854411835a257f0ecb5eda28ed0_1", "is_ignored": false, "lines": "            e.printStackTrace();", "message": "Possible active debug code detected. Deploying an application with debug code can create unintended entry points or expose sensitive information.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-489: Active Debug Code"], "functional-categories": ["debug::search::active-debug-code::java.lang"], "impact": "LOW", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "LOW", "owasp": ["A10:2004 - Insecure Configuration Management", "A06:2017 - Security Misconfiguration", "A05:2021 - Security Misconfiguration"], "references": ["https://cwe.mitre.org/data/definitions/489.html", "https://www.acunetix.com/vulnerabilities/web/stack-trace-disclosure-java/", "https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/02-Testing_for_Stack_Traces", "https://www.securecodewarrior.com/blog/coders-conquer-security-share-learn-series-information-exposure"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 27144, "rule_id": "v8U0rZ", "rv_id": 850441, "url": "https://semgrep.dev/playground/r/9lTJDWJ/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "version_id": "9lTJDWJ"}}, "shortlink": "https://sg.run/4K8z", "source": "https://semgrep.dev/r/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "subcategory": ["audit"], "technology": ["java"], "vulnerability_class": ["Active Debug Code"]}, "metavars": {"$EXCEPTION": {"abstract_content": "e", "end": {"col": 14, "line": 62, "offset": 1819}, "start": {"col": 13, "line": 62, "offset": 1818}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/IOUtils.java", "start": {"col": 13, "line": 62, "offset": 1818}}, {"check_id": "java.lang.security.audit.crypto.unencrypted-socket.unencrypted-socket", "end": {"col": 64, "line": 266, "offset": 8399}, "extra": {"engine_kind": "OSS", "fingerprint": "91bb2c82c51dfdf75e6e3e90e021ce1e5b5df00f8bea9284109a0586338eedcdc93ff1f6687044ff14db4a483886f7b1a8eb4c36bac81e7c76decc1322fcfa06_0", "is_ignored": false, "lines": "                ServerSocket socket = new ServerSocket(portNum);", "message": "Detected use of a Java socket that is not encrypted. As a result, the traffic could be read by an attacker intercepting the network traffic. Use an SSLSocket created by 'SSLSocketFactory' or 'SSLServerSocketFactory' instead.", "metadata": {"asvs": {"control_id": "6.2.5 Insecure Algorithm", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x14-V6-Cryptography.md#v62-algorithms", "section": "V6 Stored Cryptography Verification Requirements", "version": "4"}, "category": "security", "confidence": "HIGH", "cwe": ["CWE-319: Cleartext Transmission of Sensitive Information"], "functional-categories": ["net::search::crypto-config::java.net"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9197, "rule_id": "BYUN3X", "rv_id": 833936, "url": "https://semgrep.dev/playground/r/7ZTx94Q/java.lang.security.audit.crypto.unencrypted-socket.unencrypted-socket", "version_id": "7ZTx94Q"}}, "shortlink": "https://sg.run/W8zA", "source": "https://semgrep.dev/r/java.lang.security.audit.crypto.unencrypted-socket.unencrypted-socket", "source-rule-url": "https://find-sec-bugs.github.io/bugs.htm#UNENCRYPTED_SOCKET", "subcategory": ["vuln"], "technology": ["java"], "vulnerability_class": ["Mishandled Sensitive Information"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/IOUtils.java", "start": {"col": 39, "line": 266, "offset": 8374}}, {"check_id": "java.lang.security.audit.bad-hexa-conversion.bad-hexa-conversion", "end": {"col": 6, "line": 113, "offset": 3599}, "extra": {"engine_kind": "OSS", "fingerprint": "567690e7753b59f14d1b6d5ae31311f5854eb2c1af9d001114a70558b7d44b97541210d4956ef4e22780eb0a75cb9bb93d1670ae5be6d01f8619b6ab019b5c23_0", "is_ignored": false, "lines": "    public static String generateGUID(boolean secure) {\n        String localHostAddr;\n        {\n            java.net.InetAddress id;\n            try {\n                id = java.net.InetAddress.getLocalHost();\n                localHostAddr = id.toString();\n            } catch (java.net.UnknownHostException e) {\n                localHostAddr = \"localhost\";\n            }\n        }\n\n        long time = System.currentTimeMillis();\n        long rand;\n\n        if (secure) {\n            rand = secureRand.nextLong();\n        } else {\n            rand = SecurityUtils.random.nextLong();\n        }\n\n        // This StringBuilder can be a long as you need; the MD5\n        // hash will always return 128 bits.  You can change\n        // the seed to include anything you want here.\n        // You could even stream a file through the MD5 making\n        // the odds of guessing it at least as great as that\n        // of guessing the contents of the file!\n        StringBuilder sb = new StringBuilder(32);\n        sb.append(localHostAddr)\n            .append(\":\")\n            .append(Long.toString(time))\n            .append(\":\")\n            .append(Long.toString(rand));\n\n\n        byte[] array;\n        try {\n            MessageDigest md5 = MessageDigest.getInstance(ECRYPTION_ALGORYTHM);\n            md5.update(sb.toString().getBytes(StandardCharsets.UTF_8));\n            array = md5.digest();\n        } catch (NoSuchAlgorithmException e) {\n            // Too bad. Lets get simple random numbers\n            array = new byte[16];\n            random.nextBytes(array);\n        }\n        sb.setLength(0);\n        for (int j = 0; j < array.length; ++j) {\n            int b = array[j] & 0xFF;\n            if (b < 0x10) {\n                sb.append('0');\n            }\n            sb.append(Integer.toHexString(b));\n        }\n\n        String raw = sb.toString().toUpperCase();\n        sb.setLength(0);\n        sb.append(raw.substring(0, 8));\n        sb.append(\"-\");\n        sb.append(raw.substring(8, 12));\n        sb.append(\"-\");\n        sb.append(raw.substring(12, 16));\n        sb.append(\"-\");\n        sb.append(raw.substring(16, 20));\n        sb.append(\"-\");\n        sb.append(raw.substring(20));\n\n        return sb.toString();\n    }", "message": "'Integer.toHexString()' strips leading zeroes from each byte if read byte-by-byte. This mistake weakens the hash value computed since it introduces more collisions. Use 'String.format(\"%02X\", ...)' instead.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-704: Incorrect Type Conversion or Cast"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": "A03:2017 - Sensitive Data Exposure", "references": ["https://cwe.mitre.org/data/definitions/704.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9166, "rule_id": "v8Uny0", "rv_id": 833916, "url": "https://semgrep.dev/playground/r/pZTXj58/java.lang.security.audit.bad-hexa-conversion.bad-hexa-conversion", "version_id": "pZTXj58"}}, "shortlink": "https://sg.run/1Z7D", "source": "https://semgrep.dev/r/java.lang.security.audit.bad-hexa-conversion.bad-hexa-conversion", "source-rule-url": "https://find-sec-bugs.github.io/bugs.htm#BAD_HEXA_CONVERSION", "subcategory": ["audit"], "technology": ["java"], "vulnerability_class": ["Improper Validation"]}, "metavars": {"$MD": {"abstract_content": "md5", "end": {"col": 30, "line": 83, "offset": 2606}, "start": {"col": 27, "line": 83, "offset": 2603}}, "$METHOD": {"abstract_content": "generateGUID", "end": {"col": 38, "line": 46, "offset": 1412}, "start": {"col": 26, "line": 46, "offset": 1400}}, "$X": {"abstract_content": "String", "end": {"col": 25, "line": 46, "offset": 1399}, "start": {"col": 19, "line": 46, "offset": 1393}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/SecurityUtils.java", "start": {"col": 5, "line": 46, "offset": 1379}}, {"check_id": "java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "end": {"col": 139, "line": 159, "offset": 5485}, "extra": {"engine_kind": "OSS", "fingerprint": "b9a84e3885a139b428e8b53ea5d56f34200a4ba15c6fd8d090edcbac39aae89d31a9a2ad9ab6d6ad6c612e8b0a6f4ca8fd5e70b068d1ed3fde5f99d6e3559088_0", "is_ignored": false, "lines": "                            new RpcException(\"JSON serialization error: \" + e.getMessage(), e).printStackTrace(new PrintWriter(buf, true));", "message": "Possible active debug code detected. Deploying an application with debug code can create unintended entry points or expose sensitive information.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-489: Active Debug Code"], "functional-categories": ["debug::search::active-debug-code::java.lang"], "impact": "LOW", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "LOW", "owasp": ["A10:2004 - Insecure Configuration Management", "A06:2017 - Security Misconfiguration", "A05:2021 - Security Misconfiguration"], "references": ["https://cwe.mitre.org/data/definitions/489.html", "https://www.acunetix.com/vulnerabilities/web/stack-trace-disclosure-java/", "https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/02-Testing_for_Stack_Traces", "https://www.securecodewarrior.com/blog/coders-conquer-security-share-learn-series-information-exposure"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 27144, "rule_id": "v8U0rZ", "rv_id": 850441, "url": "https://semgrep.dev/playground/r/9lTJDWJ/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "version_id": "9lTJDWJ"}}, "shortlink": "https://sg.run/4K8z", "source": "https://semgrep.dev/r/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "subcategory": ["audit"], "technology": ["java"], "vulnerability_class": ["Active Debug Code"]}, "metavars": {"$UTIL": {"abstract_content": "new RpcException(\"JSON serialization error: \"+e.getMessage()e)", "end": {"col": 95, "line": 159, "offset": 5441}, "start": {"col": 29, "line": 159, "offset": 5375}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/rest/RestServer.java", "start": {"col": 29, "line": 159, "offset": 5375}}, {"check_id": "java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "end": {"col": 54, "line": 275, "offset": 10350}, "extra": {"engine_kind": "OSS", "fingerprint": "d9bc58fc22ba043a94bef98f6867cc2b1336e17b409463df61c609ee85728d58e2727b4dbc88cc980fa476df28889bf51bfa7e33c57ca52a5b0e6a48c68cdcc6_0", "is_ignored": false, "lines": "        e.printStackTrace(new PrintWriter(buf, true));", "message": "Possible active debug code detected. Deploying an application with debug code can create unintended entry points or expose sensitive information.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-489: Active Debug Code"], "functional-categories": ["debug::search::active-debug-code::java.lang"], "impact": "LOW", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "LOW", "owasp": ["A10:2004 - Insecure Configuration Management", "A06:2017 - Security Misconfiguration", "A05:2021 - Security Misconfiguration"], "references": ["https://cwe.mitre.org/data/definitions/489.html", "https://www.acunetix.com/vulnerabilities/web/stack-trace-disclosure-java/", "https://owasp.org/www-project-web-security-testing-guide/v41/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/02-Testing_for_Stack_Traces", "https://www.securecodewarrior.com/blog/coders-conquer-security-share-learn-series-information-exposure"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 27144, "rule_id": "v8U0rZ", "rv_id": 850441, "url": "https://semgrep.dev/playground/r/9lTJDWJ/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "version_id": "9lTJDWJ"}}, "shortlink": "https://sg.run/4K8z", "source": "https://semgrep.dev/r/java.lang.security.audit.active-debug-code-printstacktrace.active-debug-code-printstacktrace", "subcategory": ["audit"], "technology": ["java"], "vulnerability_class": ["Active Debug Code"]}, "metavars": {"$UTIL": {"abstract_content": "e", "end": {"col": 10, "line": 275, "offset": 10306}, "start": {"col": 9, "line": 275, "offset": 10305}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/rest/RestServer.java", "start": {"col": 9, "line": 275, "offset": 10305}}, {"check_id": "java.lang.security.audit.xml-custom-entityresolver.xml-custom-entityresolver", "end": {"col": 47, "line": 105, "offset": 3227}, "extra": {"engine_kind": "OSS", "fingerprint": "9e6a88bf29cdd846214299a121e0307d850724f1e6951a3fe6c67e81087a1918b64dba23c3c762670bd483c9f9ae7443176cb527f4ec17f74a8f3e066a0c6f61_0", "is_ignored": false, "lines": "            saxReader.setEntityResolver(this);", "message": "The application is using an XML parser that has not been safely configured. This might lead to XML External Entity (XXE) vulnerabilities when parsing user-controlled input. An attacker can include document type definitions (DTDs) which can interact with internal or external hosts. XXE can lead to other vulnerabilities, such as Local File Inclusion (LFI), Remote Code Execution (RCE), and Server-side request forgery (SSRF), depending on the application configuration. An attacker can also use DTDs to expand recursively, leading to a Denial-of-Service (DoS) attack, also known as a Billion Laughs Attack. By setting a custom `EntityResolver` for all previous security configurations for are bypassed. It is your responsibility to handle security in the `EntityResolver` implementation instead. For more information, see: [Java XXE prevention](https://semgrep.dev/docs/cheat-sheets/java-xxe/)", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-611: Improper Restriction of XML External Entity Reference", "CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')"], "functional-categories": ["xml::sink::xml-parser::xml.sax"], "impact": "MEDIUM", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A04:2017 - XML External Entities (XXE)", "A05:2021 - Security Misconfiguration"], "references": ["https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-D97A1F1D-8DDF-4D19-A7E5-99099F27346E", "https://github.com/semgrep/java-xxe-research", "https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html", "https://rules.sonarsource.com/java/type/Vulnerability/RSPEC-2755", "https://blog.sonarsource.com/secure-xml-processor/", "https://blog.sonarsource.com/understanding-xxe-vulnerabilities/", "https://cwe.mitre.org/data/definitions/776.html", "https://cwe.mitre.org/data/definitions/776.html"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 27146, "rule_id": "ZqUK4E", "rv_id": 850444, "url": "https://semgrep.dev/playground/r/bZTB011/java.lang.security.audit.xml-custom-entityresolver.xml-custom-entityresolver", "version_id": "bZTB011"}}, "shortlink": "https://sg.run/JRXW", "source": "https://semgrep.dev/r/java.lang.security.audit.xml-custom-entityresolver.xml-custom-entityresolver", "subcategory": ["vuln"], "technology": ["java"], "vulnerability_class": ["XML Injection"]}, "metavars": {"$CONFIGURE": {"abstract_content": "setFeature", "end": {"col": 33, "line": 100, "offset": 2914}, "start": {"col": 23, "line": 100, "offset": 2904}}, "$PARSER": {"abstract_content": "saxReader", "end": {"col": 22, "line": 105, "offset": 3202}, "start": {"col": 13, "line": 105, "offset": 3193}}}, "severity": "INFO", "validation_state": "NO_VALIDATOR"}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/xml/SAXReader.java", "start": {"col": 13, "line": 105, "offset": 3193}}, {"check_id": "java.lang.security.xxe.documentbuilderfactory-xxe-parameter-entity.documentbuilderfactory-xxe-parameter-entity", "end": {"col": 78, "line": 78, "offset": 2707}, "extra": {"engine_kind": "OSS", "fingerprint": "f0f306c30f97ebe00f3a837cbdc9b8356ec8e4497acf5d2fb00d995bd1f0992d61fe6480c72e257e8d9aa71eb32b0898ec6c6e4d11bb4426102e3cf6ccc257a1_0", "is_ignored": false, "lines": "            DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();", "message": "The application is using an XML parser that has not been safely configured. This might lead to XML External Entity (XXE) vulnerabilities when parsing user-controlled input. An attacker can include document type definitions (DTDs) which can interact with internal or external hosts. XXE can lead to other vulnerabilities, such as Local File Inclusion (LFI), Remote Code Execution (RCE), and Server-side request forgery (SSRF), depending on the application configuration. An attacker can also use DTDs to expand recursively, leading to a Denial-of-Service (DoS) attack, also known as a Billion Laughs Attack. The current configuration allows for XXE attacks through parameter entities. It is our recommendation to secure this parser against XXE attacks by configuring dbf with `dbf.setFeature(http://apache.org/xml/features/disallow-doctype-decl, true)`. Alternatively, the following configurations also provide protection against XXE attacks with parameter entities. `dbf.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)` `dbf.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\")` `dbf.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", false)` Beware, using a custom EntityResolver will render these settings useless and you will be responsible for handeling security in the implementation of you EntityResolver. For more information, see: [Java XXE prevention](https://semgrep.dev/docs/cheat-sheets/java-xxe/)", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-611: Improper Restriction of XML External Entity Reference", "CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')"], "functional-categories": ["xml::sink::xml-parser::javax.xml"], "impact": "MEDIUM", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A04:2017 - XML External Entities (XXE)", "A05:2021 - Security Misconfiguration"], "references": ["https://semgrep.dev/blog/2022/xml-security-in-java", "https://semgrep.dev/docs/cheat-sheets/java-xxe/", "https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-D97A1F1D-8DDF-4D19-A7E5-99099F27346E", "https://github.com/semgrep/java-xxe-research", "https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html", "https://rules.sonarsource.com/java/type/Vulnerability/RSPEC-2755", "https://blog.sonarsource.com/secure-xml-processor/", "https://blog.sonarsource.com/understanding-xxe-vulnerabilities/", "https://cwe.mitre.org/data/definitions/776.html", "https://cwe.mitre.org/data/definitions/776.html"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 27147, "rule_id": "nJU2Wq", "rv_id": 899057, "url": "https://semgrep.dev/playground/r/YDTYGkr/java.lang.security.xxe.documentbuilderfactory-xxe-parameter-entity.documentbuilderfactory-xxe-parameter-entity", "version_id": "YDTYGkr"}}, "shortlink": "https://sg.run/5qYX", "source": "https://semgrep.dev/r/java.lang.security.xxe.documentbuilderfactory-xxe-parameter-entity.documentbuilderfactory-xxe-parameter-entity", "subcategory": ["vuln"], "technology": ["java"], "vulnerability_class": ["XML Injection"]}, "metavars": {"$FACTORY": {"abstract_content": "dbf", "end": {"col": 39, "line": 78, "offset": 2668}, "start": {"col": 36, "line": 78, "offset": 2665}}, "$PARSER": {"abstract_content": "xmlBuilder", "end": {"col": 39, "line": 79, "offset": 2747}, "start": {"col": 29, "line": 79, "offset": 2737}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/xml/XMLUtils.java", "start": {"col": 36, "line": 78, "offset": 2665}}, {"check_id": "java.lang.security.xxe.documentbuilderfactory-xxe.documentbuilderfactory-xxe", "end": {"col": 78, "line": 78, "offset": 2707}, "extra": {"engine_kind": "OSS", "fingerprint": "9d7c2d6c1207e7a01db02d14e366926dffffb37e081939e5b406fd1d7c717cd9b1fdd757298e8510aae76d043c317a688e6f8fc081c03fc916c4abfbaaad7c27_0", "is_ignored": false, "lines": "            DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();", "message": "The application is using an XML parser that has not been safely configured. This might lead to XML External Entity (XXE) vulnerabilities when parsing user-controlled input. An attacker can include document type definitions (DTDs) which can interact with internal or external hosts. XXE can lead to other vulnerabilities, such as Local File Inclusion (LFI), Remote Code Execution (RCE), and Server-side request forgery (SSRF), depending on the application configuration. An attacker can also use DTDs to expand recursively, leading to a Denial-of-Service (DoS) attack, also known as a Billion Laughs Attack. It is our recommendation to secure this parser against XXE attacks by configuring dbf with `dbf.setFeature(http://apache.org/xml/features/disallow-doctype-decl, true)`. Alternatively, the following configurations also provide protection against XXE attacks. `dbf.setExpandEntityReferences(false)` `dbf.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true)` `dbf.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\")` `dbf.setFeature(\"http://xml.org/sax/features/external-general-entities\", false)`. For more information, see: [Java XXE prevention](https://semgrep.dev/docs/cheat-sheets/java-xxe/)", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-611: Improper Restriction of XML External Entity Reference", "CWE-776: Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')"], "functional-categories": ["xml::sink::xml-parser::javax.xml"], "impact": "HIGH", "license": "Copyright 2023 Semgrep, Inc.", "likelihood": "MEDIUM", "owasp": ["A04:2017 - XML External Entities (XXE)", "A05:2021 - Security Misconfiguration"], "references": ["https://semgrep.dev/blog/2022/xml-security-in-java", "https://semgrep.dev/docs/cheat-sheets/java-xxe/", "https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-D97A1F1D-8DDF-4D19-A7E5-99099F27346E", "https://github.com/semgrep/java-xxe-research", "https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html", "https://rules.sonarsource.com/java/type/Vulnerability/RSPEC-2755", "https://blog.sonarsource.com/secure-xml-processor/", "https://blog.sonarsource.com/understanding-xxe-vulnerabilities/", "https://cwe.mitre.org/data/definitions/776.html", "https://cwe.mitre.org/data/definitions/776.html"], "semgrep.dev": {"rule": {"origin": "pro_rules", "r_id": 27148, "rule_id": "EwUEj8", "rv_id": 899058, "url": "https://semgrep.dev/playground/r/6xTy7G6/java.lang.security.xxe.documentbuilderfactory-xxe.documentbuilderfactory-xxe", "version_id": "6xTy7G6"}}, "shortlink": "https://sg.run/GJd2", "source": "https://semgrep.dev/r/java.lang.security.xxe.documentbuilderfactory-xxe.documentbuilderfactory-xxe", "subcategory": ["vuln"], "technology": ["java"], "vulnerability_class": ["XML Injection"]}, "metavars": {"$FACTORY": {"abstract_content": "dbf", "end": {"col": 39, "line": 78, "offset": 2668}, "start": {"col": 36, "line": 78, "offset": 2665}}, "$PARSER": {"abstract_content": "xmlBuilder", "end": {"col": 39, "line": 79, "offset": 2747}, "start": {"col": 29, "line": 79, "offset": 2737}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/xml/XMLUtils.java", "start": {"col": 36, "line": 78, "offset": 2665}}, {"check_id": "java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing", "end": {"col": 67, "line": 79, "offset": 2775}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "dbf", "location": {"end": {"col": 39, "line": 78, "offset": 2668}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/xml/XMLUtils.java", "start": {"col": 36, "line": 78, "offset": 2665}}}], "taint_sink": ["CliLoc", [{"end": {"col": 67, "line": 79, "offset": 2775}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/xml/XMLUtils.java", "start": {"col": 13, "line": 79, "offset": 2721}}, "DocumentBuilder xmlBuilder = dbf.newDocumentBuilder();"]], "taint_source": ["CliLoc", [{"end": {"col": 79, "line": 78, "offset": 2708}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/xml/XMLUtils.java", "start": {"col": 13, "line": 78, "offset": 2642}}, "DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();"]]}, "engine_kind": "OSS", "fingerprint": "1b60b72543643465258972b5226c19b64b208215c6f8535d88d907980e68037779a47c5e5506f88b41863ccb5c0cbe9609ba1ed4600d96ff321f8adf0e5bb30b_0", "fix": "dbf.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);\n            dbf.newDocumentBuilder();", "is_ignored": false, "lines": "            DocumentBuilder xmlBuilder = dbf.newDocumentBuilder();", "message": "DOCTYPE declarations are enabled for this DocumentBuilderFactory. This is vulnerable to XML external entity attacks. Disable this by setting the feature \"http://apache.org/xml/features/disallow-doctype-decl\" to true. Alternatively, allow DOCTYPE declarations and only prohibit external entities declarations. This can be done by setting the features \"http://xml.org/sax/features/external-general-entities\" and \"http://xml.org/sax/features/external-parameter-entities\" to false.", "metadata": {"asvs": {"control_id": "5.5.2 Insecue XML Deserialization", "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v55-deserialization-prevention", "section": "V5 Validation, Sanitization and Encoding", "version": "4"}, "category": "security", "confidence": "HIGH", "cwe": ["CWE-611: Improper Restriction of XML External Entity Reference"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A04:2017 - XML External Entities (XXE)", "A05:2021 - Security Misconfiguration"], "references": ["https://semgrep.dev/blog/2022/xml-security-in-java", "https://semgrep.dev/docs/cheat-sheets/java-xxe/", "https://blog.sonarsource.com/secure-xml-processor", "https://xerces.apache.org/xerces2-j/features.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 18245, "rule_id": "10UPQB", "rv_id": 833986, "url": "https://semgrep.dev/playground/r/O9TJWWv/java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing", "version_id": "O9TJWWv"}}, "shortlink": "https://sg.run/PYBz", "source": "https://semgrep.dev/r/java.lang.security.audit.xxe.documentbuilderfactory-disallow-doctype-decl-missing.documentbuilderfactory-disallow-doctype-decl-missing", "subcategory": ["vuln"], "technology": ["java", "xml"], "vulnerability_class": ["XML Injection"]}, "metavars": {"$FACTORY": {"abstract_content": "dbf", "end": {"col": 39, "line": 78, "offset": 2668}, "start": {"col": 36, "line": 78, "offset": 2665}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "dbeaver-common/modules/org.jkiss.utils/src/org/jkiss/utils/xml/XMLUtils.java", "start": {"col": 13, "line": 79, "offset": 2721}}], "skipped_rules": [], "version": "1.85.0"}
