{"errors": [{"code": 2, "level": "warn", "message": "Timeout when running go.lang.security.audit.crypto.math_random.math-random-used on pkg/session/session.go:\n ", "path": "pkg/session/session.go", "rule_id": "go.lang.security.audit.crypto.math_random.math-random-used", "type": "Timeout"}, {"code": 2, "level": "warn", "message": "Timeout when running go.lang.security.audit.crypto.math_random.math-random-used on pkg/server/internal/testserverclient/server_client.go:\n ", "path": "pkg/server/internal/testserverclient/server_client.go", "rule_id": "go.lang.security.audit.crypto.math_random.math-random-used", "type": "Timeout"}, {"code": 3, "level": "warn", "message": "Syntax error at line pkg/disttask/importinto/encode_and_sort_operator.go:51:\n `struct {\n\t*operator.AsyncOperator` was unexpected", "path": "pkg/disttask/importinto/encode_and_sort_operator.go", "spans": [{"end": {"col": 25, "line": 52, "offset": 33}, "file": "pkg/disttask/importinto/encode_and_sort_operator.go", "start": {"col": 28, "line": 51, "offset": 0}}, {"end": {"col": 4, "line": 53, "offset": 2}, "file": "pkg/disttask/importinto/encode_and_sort_operator.go", "start": {"col": 2, "line": 53, "offset": 0}}, {"end": {"col": 17, "line": 54, "offset": 6}, "file": "pkg/disttask/importinto/encode_and_sort_operator.go", "start": {"col": 11, "line": 54, "offset": 0}}, {"end": {"col": 16, "line": 56, "offset": 7}, "file": "pkg/disttask/importinto/encode_and_sort_operator.go", "start": {"col": 9, "line": 56, "offset": 0}}, {"end": {"col": 16, "line": 57, "offset": 7}, "file": "pkg/disttask/importinto/encode_and_sort_operator.go", "start": {"col": 9, "line": 57, "offset": 0}}, {"end": {"col": 25, "line": 59, "offset": 15}, "file": "pkg/disttask/importinto/encode_and_sort_operator.go", "start": {"col": 10, "line": 59, "offset": 0}}, {"end": {"col": 43, "line": 60, "offset": 22}, "file": "pkg/disttask/importinto/encode_and_sort_operator.go", "start": {"col": 21, "line": 60, "offset": 0}}, {"end": {"col": 24, "line": 66, "offset": 86}, "file": "pkg/disttask/importinto/encode_and_sort_operator.go", "start": {"col": 2, "line": 62, "offset": 0}}], "type": ["PartialParsing", [{"end": {"col": 25, "line": 52, "offset": 33}, "path": "pkg/disttask/importinto/encode_and_sort_operator.go", "start": {"col": 28, "line": 51, "offset": 0}}, {"end": {"col": 4, "line": 53, "offset": 2}, "path": "pkg/disttask/importinto/encode_and_sort_operator.go", "start": {"col": 2, "line": 53, "offset": 0}}, {"end": {"col": 17, "line": 54, "offset": 6}, "path": "pkg/disttask/importinto/encode_and_sort_operator.go", "start": {"col": 11, "line": 54, "offset": 0}}, {"end": {"col": 16, "line": 56, "offset": 7}, "path": "pkg/disttask/importinto/encode_and_sort_operator.go", "start": {"col": 9, "line": 56, "offset": 0}}, {"end": {"col": 16, "line": 57, "offset": 7}, "path": "pkg/disttask/importinto/encode_and_sort_operator.go", "start": {"col": 9, "line": 57, "offset": 0}}, {"end": {"col": 25, "line": 59, "offset": 15}, "path": "pkg/disttask/importinto/encode_and_sort_operator.go", "start": {"col": 10, "line": 59, "offset": 0}}, {"end": {"col": 43, "line": 60, "offset": 22}, "path": "pkg/disttask/importinto/encode_and_sort_operator.go", "start": {"col": 21, "line": 60, "offset": 0}}, {"end": {"col": 24, "line": 66, "offset": 86}, "path": "pkg/disttask/importinto/encode_and_sort_operator.go", "start": {"col": 2, "line": 62, "offset": 0}}]]}, {"code": 3, "level": "warn", "message": "Syntax error at line pkg/executor/join/row_table_builder.go:109:\n `int | uint64 |` was unexpected", "path": "pkg/executor/join/row_table_builder.go", "spans": [{"end": {"col": 34, "line": 109, "offset": 14}, "file": "pkg/executor/join/row_table_builder.go", "start": {"col": 20, "line": 109, "offset": 0}}], "type": ["PartialParsing", [{"end": {"col": 34, "line": 109, "offset": 14}, "path": "pkg/executor/join/row_table_builder.go", "start": {"col": 20, "line": 109, "offset": 0}}]]}, {"code": 3, "level": "warn", "message": "Syntax error at line pkg/ddl/backfilling_operators.go:467:\n `struct {\n\t*operator.AsyncOperator` was unexpected", "path": "pkg/ddl/backfilling_operators.go", "spans": [{"end": {"col": 25, "line": 468, "offset": 33}, "file": "pkg/ddl/backfilling_operators.go", "start": {"col": 24, "line": 467, "offset": 0}}, {"end": {"col": 2, "line": 469, "offset": 1}, "file": "pkg/ddl/backfilling_operators.go", "start": {"col": 1, "line": 469, "offset": 0}}, {"end": {"col": 26, "line": 472, "offset": 20}, "file": "pkg/ddl/backfilling_operators.go", "start": {"col": 6, "line": 472, "offset": 0}}, {"end": {"col": 25, "line": 589, "offset": 33}, "file": "pkg/ddl/backfilling_operators.go", "start": {"col": 33, "line": 588, "offset": 0}}, {"end": {"col": 2, "line": 590, "offset": 1}, "file": "pkg/ddl/backfilling_operators.go", "start": {"col": 1, "line": 590, "offset": 0}}, {"end": {"col": 35, "line": 593, "offset": 29}, "file": "pkg/ddl/backfilling_operators.go", "start": {"col": 6, "line": 593, "offset": 0}}, {"end": {"col": 25, "line": 665, "offset": 33}, "file": "pkg/ddl/backfilling_operators.go", "start": {"col": 26, "line": 664, "offset": 0}}, {"end": {"col": 2, "line": 666, "offset": 1}, "file": "pkg/ddl/backfilling_operators.go", "start": {"col": 1, "line": 666, "offset": 0}}, {"end": {"col": 28, "line": 669, "offset": 22}, "file": "pkg/ddl/backfilling_operators.go", "start": {"col": 6, "line": 669, "offset": 0}}], "type": ["PartialParsing", [{"end": {"col": 25, "line": 468, "offset": 33}, "path": "pkg/ddl/backfilling_operators.go", "start": {"col": 24, "line": 467, "offset": 0}}, {"end": {"col": 2, "line": 469, "offset": 1}, "path": "pkg/ddl/backfilling_operators.go", "start": {"col": 1, "line": 469, "offset": 0}}, {"end": {"col": 26, "line": 472, "offset": 20}, "path": "pkg/ddl/backfilling_operators.go", "start": {"col": 6, "line": 472, "offset": 0}}, {"end": {"col": 25, "line": 589, "offset": 33}, "path": "pkg/ddl/backfilling_operators.go", "start": {"col": 33, "line": 588, "offset": 0}}, {"end": {"col": 2, "line": 590, "offset": 1}, "path": "pkg/ddl/backfilling_operators.go", "start": {"col": 1, "line": 590, "offset": 0}}, {"end": {"col": 35, "line": 593, "offset": 29}, "path": "pkg/ddl/backfilling_operators.go", "start": {"col": 6, "line": 593, "offset": 0}}, {"end": {"col": 25, "line": 665, "offset": 33}, "path": "pkg/ddl/backfilling_operators.go", "start": {"col": 26, "line": 664, "offset": 0}}, {"end": {"col": 2, "line": 666, "offset": 1}, "path": "pkg/ddl/backfilling_operators.go", "start": {"col": 1, "line": 666, "offset": 0}}, {"end": {"col": 28, "line": 669, "offset": 22}, "path": "pkg/ddl/backfilling_operators.go", "start": {"col": 6, "line": 669, "offset": 0}}]]}, {"code": 3, "level": "warn", "message": "Syntax error at line pkg/statistics/handle/cache/statscache.go:40:\n `struct {\n\tatomic.Pointer` was unexpected", "path": "pkg/statistics/handle/cache/statscache.go", "spans": [{"end": {"col": 16, "line": 41, "offset": 24}, "file": "pkg/statistics/handle/cache/statscache.go", "start": {"col": 21, "line": 40, "offset": 0}}, {"end": {"col": 19, "line": 43, "offset": 5}, "file": "pkg/statistics/handle/cache/statscache.go", "start": {"col": 14, "line": 43, "offset": 0}}, {"end": {"col": 2, "line": 44, "offset": 1}, "file": "pkg/statistics/handle/cache/statscache.go", "start": {"col": 1, "line": 44, "offset": 0}}], "type": ["PartialParsing", [{"end": {"col": 16, "line": 41, "offset": 24}, "path": "pkg/statistics/handle/cache/statscache.go", "start": {"col": 21, "line": 40, "offset": 0}}, {"end": {"col": 19, "line": 43, "offset": 5}, "path": "pkg/statistics/handle/cache/statscache.go", "start": {"col": 14, "line": 43, "offset": 0}}, {"end": {"col": 2, "line": 44, "offset": 1}, "path": "pkg/statistics/handle/cache/statscache.go", "start": {"col": 1, "line": 44, "offset": 0}}]]}, {"code": 3, "level": "warn", "message": "Syntax error at line br/pkg/rtree/rtree.go:100:\n `struct {\n\t*btree.BTreeG` was unexpected", "path": "br/pkg/rtree/rtree.go", "spans": [{"end": {"col": 15, "line": 101, "offset": 23}, "file": "br/pkg/rtree/rtree.go", "start": {"col": 21, "line": 100, "offset": 0}}, {"end": {"col": 2, "line": 102, "offset": 1}, "file": "br/pkg/rtree/rtree.go", "start": {"col": 1, "line": 102, "offset": 0}}, {"end": {"col": 23, "line": 104, "offset": 17}, "file": "br/pkg/rtree/rtree.go", "start": {"col": 6, "line": 104, "offset": 0}}, {"end": {"col": 15, "line": 335, "offset": 23}, "file": "br/pkg/rtree/rtree.go", "start": {"col": 24, "line": 334, "offset": 0}}, {"end": {"col": 2, "line": 336, "offset": 1}, "file": "br/pkg/rtree/rtree.go", "start": {"col": 1, "line": 336, "offset": 0}}, {"end": {"col": 26, "line": 339, "offset": 20}, "file": "br/pkg/rtree/rtree.go", "start": {"col": 6, "line": 339, "offset": 0}}], "type": ["PartialParsing", [{"end": {"col": 15, "line": 101, "offset": 23}, "path": "br/pkg/rtree/rtree.go", "start": {"col": 21, "line": 100, "offset": 0}}, {"end": {"col": 2, "line": 102, "offset": 1}, "path": "br/pkg/rtree/rtree.go", "start": {"col": 1, "line": 102, "offset": 0}}, {"end": {"col": 23, "line": 104, "offset": 17}, "path": "br/pkg/rtree/rtree.go", "start": {"col": 6, "line": 104, "offset": 0}}, {"end": {"col": 15, "line": 335, "offset": 23}, "path": "br/pkg/rtree/rtree.go", "start": {"col": 24, "line": 334, "offset": 0}}, {"end": {"col": 2, "line": 336, "offset": 1}, "path": "br/pkg/rtree/rtree.go", "start": {"col": 1, "line": 336, "offset": 0}}, {"end": {"col": 26, "line": 339, "offset": 20}, "path": "br/pkg/rtree/rtree.go", "start": {"col": 6, "line": 339, "offset": 0}}]]}, {"code": 3, "level": "warn", "message": "Syntax error at line br/pkg/config/kv.go:10:\n `uint` was unexpected", "path": "br/pkg/config/kv.go", "spans": [{"end": {"col": 23, "line": 10, "offset": 4}, "file": "br/pkg/config/kv.go", "start": {"col": 19, "line": 10, "offset": 0}}], "type": ["PartialParsing", [{"end": {"col": 23, "line": 10, "offset": 4}, "path": "br/pkg/config/kv.go", "start": {"col": 19, "line": 10, "offset": 0}}]]}, {"code": 2, "level": "warn", "message": "Timeout when running go.lang.security.audit.crypto.math_random.math-random-used on pkg/domain/domain.go:\n ", "path": "pkg/domain/domain.go", "rule_id": "go.lang.security.audit.crypto.math_random.math-random-used", "type": "Timeout"}, {"code": 3, "level": "warn", "message": "Syntax error at line pkg/disttask/operator/wrapper.go:101:\n `[T, R]` was unexpected", "path": "pkg/disttask/operator/wrapper.go", "spans": [{"end": {"col": 22, "line": 101, "offset": 6}, "file": "pkg/disttask/operator/wrapper.go", "start": {"col": 16, "line": 101, "offset": 0}}], "type": ["PartialParsing", [{"end": {"col": 22, "line": 101, "offset": 6}, "path": "pkg/disttask/operator/wrapper.go", "start": {"col": 16, "line": 101, "offset": 0}}]]}, {"code": 3, "level": "warn", "message": "Syntax error at line pkg/lightning/backend/external/iter.go:345:\n `mergeIter[T, R]\n\treaderOpeners []readerOpenerFn[T, R]\n\tweights       []` was unexpected", "path": "pkg/lightning/backend/external/iter.go", "spans": [{"end": {"col": 18, "line": 347, "offset": 71}, "file": "pkg/lightning/backend/external/iter.go", "start": {"col": 3, "line": 345, "offset": 0}}], "type": ["PartialParsing", [{"end": {"col": 18, "line": 347, "offset": 71}, "path": "pkg/lightning/backend/external/iter.go", "start": {"col": 3, "line": 345, "offset": 0}}]]}, {"code": 3, "level": "warn", "message": "Syntax error at line lightning/pkg/web/res_vfsdata.go:21:\n `\u06f0FS` was unexpected", "path": "lightning/pkg/web/res_vfsdata.go", "spans": [{"end": {"col": 18, "line": 21, "offset": 4}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 14, "line": 21, "offset": 0}}, {"end": {"col": 17, "line": 22, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 9, "line": 22, "offset": 0}}, {"end": {"col": 27, "line": 26, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 19, "line": 26, "offset": 0}}, {"end": {"col": 25, "line": 33, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 17, "line": 33, "offset": 0}}, {"end": {"col": 37, "line": 40, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 29, "line": 40, "offset": 0}}, {"end": {"col": 20, "line": 48, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 12, "line": 48, "offset": 0}}, {"end": {"col": 16, "line": 57, "offset": 4}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 12, "line": 57, "offset": 0}}, {"end": {"col": 20, "line": 59, "offset": 4}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 16, "line": 59, "offset": 0}}, {"end": {"col": 16, "line": 67, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 8, "line": 67, "offset": 0}}, {"end": {"col": 19, "line": 73, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 11, "line": 73, "offset": 0}}, {"end": {"col": 12, "line": 74, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 4, "line": 74, "offset": 0}}, {"end": {"col": 16, "line": 77, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 8, "line": 77, "offset": 0}}, {"end": {"col": 22, "line": 78, "offset": 5}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 17, "line": 78, "offset": 0}}, {"end": {"col": 12, "line": 79, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 4, "line": 79, "offset": 0}}, {"end": {"col": 32, "line": 88, "offset": 20}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 12, "line": 88, "offset": 0}}, {"end": {"col": 18, "line": 95, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 95, "offset": 0}}, {"end": {"col": 18, "line": 98, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 98, "offset": 0}}, {"end": {"col": 18, "line": 100, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 100, "offset": 0}}, {"end": {"col": 18, "line": 104, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 104, "offset": 0}}, {"end": {"col": 18, "line": 105, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 105, "offset": 0}}, {"end": {"col": 18, "line": 106, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 106, "offset": 0}}, {"end": {"col": 18, "line": 107, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 107, "offset": 0}}, {"end": {"col": 18, "line": 108, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 108, "offset": 0}}, {"end": {"col": 18, "line": 109, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 109, "offset": 0}}, {"end": {"col": 28, "line": 112, "offset": 16}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 12, "line": 112, "offset": 0}}, {"end": {"col": 11, "line": 113, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 3, "line": 113, "offset": 0}}, {"end": {"col": 18, "line": 119, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 119, "offset": 0}}, {"end": {"col": 18, "line": 141, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 141, "offset": 0}}, {"end": {"col": 18, "line": 154, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 154, "offset": 0}}, {"end": {"col": 21, "line": 159, "offset": 9}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 12, "line": 159, "offset": 0}}, {"end": {"col": 18, "line": 165, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 165, "offset": 0}}, {"end": {"col": 18, "line": 168, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 168, "offset": 0}}, {"end": {"col": 18, "line": 169, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 169, "offset": 0}}, {"end": {"col": 18, "line": 171, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 171, "offset": 0}}, {"end": {"col": 18, "line": 172, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 172, "offset": 0}}, {"end": {"col": 18, "line": 173, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 173, "offset": 0}}, {"end": {"col": 18, "line": 174, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 174, "offset": 0}}, {"end": {"col": 18, "line": 175, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 175, "offset": 0}}, {"end": {"col": 18, "line": 176, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 176, "offset": 0}}, {"end": {"col": 17, "line": 179, "offset": 5}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 12, "line": 179, "offset": 0}}, {"end": {"col": 11, "line": 180, "offset": 8}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 3, "line": 180, "offset": 0}}, {"end": {"col": 21, "line": 184, "offset": 5}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 16, "line": 184, "offset": 0}}, {"end": {"col": 21, "line": 192, "offset": 5}, "file": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 16, "line": 192, "offset": 0}}], "type": ["PartialParsing", [{"end": {"col": 18, "line": 21, "offset": 4}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 14, "line": 21, "offset": 0}}, {"end": {"col": 17, "line": 22, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 9, "line": 22, "offset": 0}}, {"end": {"col": 27, "line": 26, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 19, "line": 26, "offset": 0}}, {"end": {"col": 25, "line": 33, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 17, "line": 33, "offset": 0}}, {"end": {"col": 37, "line": 40, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 29, "line": 40, "offset": 0}}, {"end": {"col": 20, "line": 48, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 12, "line": 48, "offset": 0}}, {"end": {"col": 16, "line": 57, "offset": 4}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 12, "line": 57, "offset": 0}}, {"end": {"col": 20, "line": 59, "offset": 4}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 16, "line": 59, "offset": 0}}, {"end": {"col": 16, "line": 67, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 8, "line": 67, "offset": 0}}, {"end": {"col": 19, "line": 73, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 11, "line": 73, "offset": 0}}, {"end": {"col": 12, "line": 74, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 4, "line": 74, "offset": 0}}, {"end": {"col": 16, "line": 77, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 8, "line": 77, "offset": 0}}, {"end": {"col": 22, "line": 78, "offset": 5}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 17, "line": 78, "offset": 0}}, {"end": {"col": 12, "line": 79, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 4, "line": 79, "offset": 0}}, {"end": {"col": 32, "line": 88, "offset": 20}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 12, "line": 88, "offset": 0}}, {"end": {"col": 18, "line": 95, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 95, "offset": 0}}, {"end": {"col": 18, "line": 98, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 98, "offset": 0}}, {"end": {"col": 18, "line": 100, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 100, "offset": 0}}, {"end": {"col": 18, "line": 104, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 104, "offset": 0}}, {"end": {"col": 18, "line": 105, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 105, "offset": 0}}, {"end": {"col": 18, "line": 106, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 106, "offset": 0}}, {"end": {"col": 18, "line": 107, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 107, "offset": 0}}, {"end": {"col": 18, "line": 108, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 108, "offset": 0}}, {"end": {"col": 18, "line": 109, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 109, "offset": 0}}, {"end": {"col": 28, "line": 112, "offset": 16}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 12, "line": 112, "offset": 0}}, {"end": {"col": 11, "line": 113, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 3, "line": 113, "offset": 0}}, {"end": {"col": 18, "line": 119, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 119, "offset": 0}}, {"end": {"col": 18, "line": 141, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 141, "offset": 0}}, {"end": {"col": 18, "line": 154, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 154, "offset": 0}}, {"end": {"col": 21, "line": 159, "offset": 9}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 12, "line": 159, "offset": 0}}, {"end": {"col": 18, "line": 165, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 165, "offset": 0}}, {"end": {"col": 18, "line": 168, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 168, "offset": 0}}, {"end": {"col": 18, "line": 169, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 169, "offset": 0}}, {"end": {"col": 18, "line": 171, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 171, "offset": 0}}, {"end": {"col": 18, "line": 172, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 172, "offset": 0}}, {"end": {"col": 18, "line": 173, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 173, "offset": 0}}, {"end": {"col": 18, "line": 174, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 174, "offset": 0}}, {"end": {"col": 18, "line": 175, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 175, "offset": 0}}, {"end": {"col": 18, "line": 176, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 10, "line": 176, "offset": 0}}, {"end": {"col": 17, "line": 179, "offset": 5}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 12, "line": 179, "offset": 0}}, {"end": {"col": 11, "line": 180, "offset": 8}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 3, "line": 180, "offset": 0}}, {"end": {"col": 21, "line": 184, "offset": 5}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 16, "line": 184, "offset": 0}}, {"end": {"col": 21, "line": 192, "offset": 5}, "path": "lightning/pkg/web/res_vfsdata.go", "start": {"col": 16, "line": 192, "offset": 0}}]]}], "interfile_languages_used": [], "paths": {"scanned": [".bazelrc", ".codecov.yml", ".dockerignore", ".editorconfig", ".gitattributes", ".github/CODEOWNERS", ".github/ISSUE_TEMPLATE/bug-report.md", ".github/ISSUE_TEMPLATE/config.yml", ".github/ISSUE_TEMPLATE/enhancement.md", ".github/ISSUE_TEMPLATE/feature-request.md", ".github/dependabot.yml", ".github/licenserc.yml", ".github/pull_request_template.md", ".github/workflows/integration-test-compile-br.yml", ".github/workflows/integration-test-dumpling.yml", ".gitignore", ".gitmodules", ".golangci.yml", ".pre-commit-config.yaml", "BUILD.bazel", "CODE_OF_CONDUCT.md", "CONTRIBUTING.md", "CONTRIBUTORS.md", "DEPS.bzl", "Dockerfile", "Dockerfile.enterprise", "Jenkinsfile", "LICENSE", "LICENSES/QL-LICENSE", "LICENSES/STRUTIL-LICENSE", "LICENSES/Unicode-DFS-2016-LICENSE", "MODULE.bazel", "Makefile", "Makefile.common", "OWNERS", "OWNERS_ALIASES", "README.md", "SECURITY.md", "WORKSPACE", "WORKSPACE.patchgo", "br/.editorconfig", "br/.gitattributes", "br/.gitignore", "br/.golangci.yml", "br/COMPATIBILITY_TEST.md", "br/CONTRIBUTING.md", "br/LICENSE.md", "br/OWNERS", "br/README.md", "br/SECURITY.md", "br/cmd/br/BUILD.bazel", "br/cmd/br/backup.go", "br/cmd/br/cmd.go", "br/cmd/br/debug.go", "br/cmd/br/fips.go", "br/cmd/br/main.go", "br/cmd/br/operator.go", "br/cmd/br/restore.go", "br/cmd/br/stream.go", "br/compatibility/backup_cluster.yaml", "br/compatibility/credentials/application_default_credentials.json", "br/compatibility/get_last_tags.sh", "br/compatibility/prepare_backup.sh", "br/compatibility/prepare_data/workload", "br/docker/Dockerfile", "br/docker/config/pd.toml", "br/docker/config/tidb.toml", "br/docker/config/tikv.toml", "br/docker/gcs.env", "br/docker/minio.env", "br/docker-compose.yaml", "br/docs/cn/2019-08-05-new-design-of-backup-restore.md", "br/docs/cn/2019-09-09-BR-key-rewrite-disscussion.md", "br/docs/cn/2019-09-17-design-of-reorganize-importSST-to-TiKV.md", "br/docs/resources/arch-of-reorganized-importer.svg", "br/docs/resources/download-sst-diagram.svg", "br/docs/resources/solution3-of-key-rewrite.svg", "br/errors.toml", "br/images/arch.svg", "br/metrics/alertmanager/lightning.rules.yml", "br/metrics/grafana/br.json", "br/metrics/grafana/lightning.json", "br/pkg/aws/BUILD.bazel", "br/pkg/aws/ebs.go", "br/pkg/backup/BUILD.bazel", "br/pkg/backup/check.go", "br/pkg/backup/client.go", "br/pkg/backup/metrics.go", "br/pkg/backup/prepare_snap/BUILD.bazel", "br/pkg/backup/prepare_snap/env.go", "br/pkg/backup/prepare_snap/errors.go", "br/pkg/backup/prepare_snap/prepare.go", "br/pkg/backup/prepare_snap/stream.go", "br/pkg/backup/schema.go", "br/pkg/backup/store.go", "br/pkg/checkpoint/BUILD.bazel", "br/pkg/checkpoint/backup.go", "br/pkg/checkpoint/checkpoint.go", "br/pkg/checkpoint/external_storage.go", "br/pkg/checkpoint/log_restore.go", "br/pkg/checkpoint/restore.go", "br/pkg/checkpoint/storage.go", "br/pkg/checkpoint/ticker.go", "br/pkg/checksum/BUILD.bazel", "br/pkg/checksum/executor.go", "br/pkg/checksum/validate.go", "br/pkg/common/BUILD.bazel", "br/pkg/common/consts.go", "br/pkg/config/BUILD.bazel", "br/pkg/config/ebs.go", "br/pkg/config/ebs_backup.json", "br/pkg/config/kv.go", "br/pkg/conn/BUILD.bazel", "br/pkg/conn/conn.go", "br/pkg/conn/util/BUILD.bazel", "br/pkg/conn/util/util.go", "br/pkg/encryption/BUILD.bazel", "br/pkg/encryption/manager.go", "br/pkg/encryption/master_key/BUILD.bazel", "br/pkg/encryption/master_key/common.go", "br/pkg/encryption/master_key/file_backend.go", "br/pkg/encryption/master_key/kms_backend.go", "br/pkg/encryption/master_key/master_key.go", "br/pkg/encryption/master_key/mem_backend.go", "br/pkg/encryption/master_key/multi_master_key_backend.go", "br/pkg/errors/BUILD.bazel", "br/pkg/errors/errors.go", "br/pkg/glue/BUILD.bazel", "br/pkg/glue/console_glue.go", "br/pkg/glue/glue.go", "br/pkg/glue/progressing.go", "br/pkg/gluetidb/BUILD.bazel", "br/pkg/gluetidb/glue.go", "br/pkg/gluetidb/mock/BUILD.bazel", "br/pkg/gluetidb/mock/mock.go", "br/pkg/gluetikv/BUILD.bazel", "br/pkg/gluetikv/glue.go", "br/pkg/httputil/BUILD.bazel", "br/pkg/httputil/http.go", "br/pkg/kms/BUILD.bazel", "br/pkg/kms/aws.go", "br/pkg/kms/common.go", "br/pkg/kms/gcp.go", "br/pkg/kms/kms.go", "br/pkg/logutil/BUILD.bazel", "br/pkg/logutil/context.go", "br/pkg/logutil/logging.go", "br/pkg/logutil/rate.go", "br/pkg/membuf/BUILD.bazel", "br/pkg/membuf/buffer.go", "br/pkg/membuf/limiter.go", "br/pkg/metautil/BUILD.bazel", "br/pkg/metautil/load.go", "br/pkg/metautil/metafile.go", "br/pkg/metautil/statsfile.go", "br/pkg/mock/BUILD.bazel", "br/pkg/mock/backend.go", "br/pkg/mock/encode.go", "br/pkg/mock/importer.go", "br/pkg/mock/mock_cluster.go", "br/pkg/mock/mockid/BUILD.bazel", "br/pkg/mock/mockid/mockid.go", "br/pkg/mock/mocklocal/BUILD.bazel", "br/pkg/mock/mocklocal/local.go", "br/pkg/mock/s3iface.go", "br/pkg/mock/storage/BUILD.bazel", "br/pkg/mock/storage/storage.go", "br/pkg/mock/task_register.go", "br/pkg/pdutil/BUILD.bazel", "br/pkg/pdutil/pd.go", "br/pkg/pdutil/utils.go", "br/pkg/restore/BUILD.bazel", "br/pkg/restore/data/BUILD.bazel", "br/pkg/restore/data/data.go", "br/pkg/restore/data/key.go", "br/pkg/restore/data/recover.go", "br/pkg/restore/import_mode_switcher.go", "br/pkg/restore/ingestrec/BUILD.bazel", "br/pkg/restore/ingestrec/ingest_recorder.go", "br/pkg/restore/internal/import_client/BUILD.bazel", "br/pkg/restore/internal/import_client/import_client.go", "br/pkg/restore/internal/log_split/BUILD.bazel", "br/pkg/restore/internal/log_split/split.go", "br/pkg/restore/internal/log_split/sum_sorted.go", "br/pkg/restore/internal/prealloc_db/BUILD.bazel", "br/pkg/restore/internal/prealloc_db/db.go", "br/pkg/restore/internal/prealloc_table_id/BUILD.bazel", "br/pkg/restore/internal/prealloc_table_id/alloc.go", "br/pkg/restore/internal/rawkv/BUILD.bazel", "br/pkg/restore/internal/rawkv/rawkv_client.go", "br/pkg/restore/internal/snap_split/BUILD.bazel", "br/pkg/restore/internal/snap_split/split.go", "br/pkg/restore/log_client/BUILD.bazel", "br/pkg/restore/log_client/client.go", "br/pkg/restore/log_client/import.go", "br/pkg/restore/log_client/import_retry.go", "br/pkg/restore/log_client/log_file_manager.go", "br/pkg/restore/log_client/log_file_map.go", "br/pkg/restore/misc.go", "br/pkg/restore/snap_client/BUILD.bazel", "br/pkg/restore/snap_client/client.go", "br/pkg/restore/snap_client/import.go", "br/pkg/restore/snap_client/pipeline_items.go", "br/pkg/restore/snap_client/placement_rule_manager.go", "br/pkg/restore/snap_client/systable_restore.go", "br/pkg/restore/snap_client/tikv_sender.go", "br/pkg/restore/split/BUILD.bazel", "br/pkg/restore/split/client.go", "br/pkg/restore/split/mock_pd_client.go", "br/pkg/restore/split/region.go", "br/pkg/restore/split/split.go", "br/pkg/restore/tiflashrec/BUILD.bazel", "br/pkg/restore/tiflashrec/tiflash_recorder.go", "br/pkg/restore/utils/BUILD.bazel", "br/pkg/restore/utils/merge.go", "br/pkg/restore/utils/misc.go", "br/pkg/restore/utils/rewrite_rule.go", "br/pkg/rtree/BUILD.bazel", "br/pkg/rtree/logging.go", "br/pkg/rtree/rtree.go", "br/pkg/storage/BUILD.bazel", "br/pkg/storage/OWNERS", "br/pkg/storage/azblob.go", "br/pkg/storage/compress.go", "br/pkg/storage/flags.go", "br/pkg/storage/gcs.go", "br/pkg/storage/gcs_extra.go", "br/pkg/storage/hdfs.go", "br/pkg/storage/helper.go", "br/pkg/storage/ks3.go", "br/pkg/storage/local.go", "br/pkg/storage/local_unix.go", "br/pkg/storage/local_windows.go", "br/pkg/storage/locking.go", "br/pkg/storage/memstore.go", "br/pkg/storage/noop.go", "br/pkg/storage/parse.go", "br/pkg/storage/s3.go", "br/pkg/storage/storage.go", "br/pkg/storage/writer.go", "br/pkg/stream/BUILD.bazel", "br/pkg/stream/decode_kv.go", "br/pkg/stream/meta_kv.go", "br/pkg/stream/rewrite_meta_rawkv.go", "br/pkg/stream/search.go", "br/pkg/stream/stream_metas.go", "br/pkg/stream/stream_mgr.go", "br/pkg/stream/stream_status.go", "br/pkg/stream/util.go", "br/pkg/streamhelper/BUILD.bazel", "br/pkg/streamhelper/advancer.go", "br/pkg/streamhelper/advancer_cliext.go", "br/pkg/streamhelper/advancer_daemon.go", "br/pkg/streamhelper/advancer_env.go", "br/pkg/streamhelper/client.go", "br/pkg/streamhelper/collector.go", "br/pkg/streamhelper/config/BUILD.bazel", "br/pkg/streamhelper/config/advancer_conf.go", "br/pkg/streamhelper/daemon/BUILD.bazel", "br/pkg/streamhelper/daemon/interface.go", "br/pkg/streamhelper/daemon/owner_daemon.go", "br/pkg/streamhelper/flush_subscriber.go", "br/pkg/streamhelper/models.go", "br/pkg/streamhelper/prefix_scanner.go", "br/pkg/streamhelper/regioniter.go", "br/pkg/streamhelper/spans/BUILD.bazel", "br/pkg/streamhelper/spans/sorted.go", "br/pkg/streamhelper/spans/utils.go", "br/pkg/streamhelper/spans/value_sorted.go", "br/pkg/summary/BUILD.bazel", "br/pkg/summary/collector.go", "br/pkg/summary/summary.go", "br/pkg/task/BUILD.bazel", "br/pkg/task/backup.go", "br/pkg/task/backup_ebs.go", "br/pkg/task/backup_raw.go", "br/pkg/task/backup_txn.go", "br/pkg/task/common.go", "br/pkg/task/encryption.go", "br/pkg/task/operator/BUILD.bazel", "br/pkg/task/operator/cmd.go", "br/pkg/task/operator/config.go", "br/pkg/task/restore.go", "br/pkg/task/restore_data.go", "br/pkg/task/restore_ebs_meta.go", "br/pkg/task/restore_raw.go", "br/pkg/task/restore_txn.go", "br/pkg/task/show/BUILD.bazel", "br/pkg/task/show/cmd.go", "br/pkg/task/show/testdata/full-schema.meta", "br/pkg/task/show/testdata/v2/backupmeta", "br/pkg/task/show/testdata/v2/backupmeta.schema.000000001", "br/pkg/task/show/testdata/v2-enc/backupmeta", "br/pkg/task/show/testdata/v2-enc/backupmeta.schema.000000001", "br/pkg/task/stream.go", "br/pkg/trace/BUILD.bazel", "br/pkg/trace/tracing.go", "br/pkg/utils/BUILD.bazel", "br/pkg/utils/backoff.go", "br/pkg/utils/db.go", "br/pkg/utils/dyn_pprof_other.go", "br/pkg/utils/dyn_pprof_unix.go", "br/pkg/utils/encryption.go", "br/pkg/utils/error_handling.go", "br/pkg/utils/iter/BUILD.bazel", "br/pkg/utils/iter/combinator_types.go", "br/pkg/utils/iter/combinators.go", "br/pkg/utils/iter/iter.go", "br/pkg/utils/iter/source.go", "br/pkg/utils/iter/source_types.go", "br/pkg/utils/json.go", "br/pkg/utils/key.go", "br/pkg/utils/misc.go", "br/pkg/utils/pointer.go", "br/pkg/utils/pprof.go", "br/pkg/utils/progress.go", "br/pkg/utils/register.go", "br/pkg/utils/retry.go", "br/pkg/utils/safe_point.go", "br/pkg/utils/schema.go", "br/pkg/utils/store_manager.go", "br/pkg/utils/storewatch/BUILD.bazel", "br/pkg/utils/storewatch/watching.go", "br/pkg/utils/worker.go", "br/pkg/utiltest/BUILD.bazel", "br/pkg/utiltest/fake.go", "br/pkg/utiltest/suite.go", "br/pkg/version/BUILD.bazel", "br/pkg/version/version.go", "br/revive.toml", "checklist.md", "ci.md", "cmd/benchdb/BUILD.bazel", "cmd/benchdb/README.md", "cmd/benchdb/main.go", "cmd/benchkv/BUILD.bazel", "cmd/benchkv/main.go", "cmd/benchraw/BUILD.bazel", "cmd/benchraw/main.go", "cmd/ddltest/BUILD.bazel", "cmd/importer/BUILD.bazel", "cmd/importer/README.md", "cmd/importer/config.go", "cmd/importer/config.toml", "cmd/importer/data.go", "cmd/importer/db.go", "cmd/importer/job.go", "cmd/importer/main.go", "cmd/importer/parser.go", "cmd/importer/rand.go", "cmd/importer/stats.go", "cmd/importer/stats.json", "cmd/mirror/BUILD.bazel", "cmd/mirror/mirror.go", "cmd/mirror/skylarkutil.go", "cmd/pluginpkg/BUILD.bazel", "cmd/pluginpkg/pluginpkg.go", "cmd/portgenerator/BUILD.bazel", "cmd/portgenerator/portgenerator.go", "cmd/tidb-server/BUILD.bazel", "cmd/tidb-server/fips.go", "cmd/tidb-server/main.go", "code_review_guide.md", "docs/architecture.png", "docs/contribution-map.png", "docs/design/2018-07-01-refactor-aggregate-framework.md", "docs/design/2018-07-19-row-format.md", "docs/design/2018-07-22-enhance-propagations.md", "docs/design/2018-08-10-restore-dropped-table.md", "docs/design/2018-08-29-new-planner.md", "docs/design/2018-09-04-histograms-in-plan.md", "docs/design/2018-09-10-adding-tz-env.md", "docs/design/2018-09-21-radix-hashjoin.md", "docs/design/2018-10-08-online-DDL.md", "docs/design/2018-10-19-table-partition.md", "docs/design/2018-10-20-join-reorder-dp-v1.md", "docs/design/2018-10-22-the-column-pool.md", "docs/design/2018-10-24-view-support.md", "docs/design/2018-10-31-window-functions.md", "docs/design/2018-11-29-ast-to-sql-text.md", "docs/design/2018-12-10-plugin-framework.md", "docs/design/2018-12-11-sql-plan-management.md", "docs/design/2019-01-25-skyline-pruning.md", "docs/design/2019-04-11-indexmerge.md", "docs/design/2019-11-05-index-advisor.md", "docs/design/2019-11-14-tidb-builtin-diagnostics-zh_CN.md", "docs/design/2019-11-14-tidb-builtin-diagnostics.md", "docs/design/2019-11-18-tidb-with-wasm.md", "docs/design/2020-01-24-collations.md", "docs/design/2020-03-12-invisible-index.md", "docs/design/2020-04-17-sql-sequence.md", "docs/design/2020-04-20-brie.md", "docs/design/2020-05-08-cluster-index.md", "docs/design/2020-05-08-standardize-error-codes-and-messages.md", "docs/design/2020-05-11-heap-profile-record.md", "docs/design/2020-06-01-global-kill.md", "docs/design/2020-06-24-placement-rules-in-sql.md", "docs/design/2020-07-07-change-column-types.md", "docs/design/2020-08-04-global-index.md", "docs/design/2020-09-12-utf8mb4-pinyin-order.md", "docs/design/2020-09-30-index-usage-information.md", "docs/design/2021-03-01-pipelined-window-functions.md", "docs/design/2021-03-09-dynamic-privileges.md", "docs/design/2021-03-09-security-enhanced-mode.md", "docs/design/2021-03-30-small-table-caching.md", "docs/design/2021-04-18-common-table-expression.md", "docs/design/2021-04-20-temporary-table.md", "docs/design/2021-04-21-unify-log-library.md", "docs/design/2021-04-26-lock-view.md", "docs/design/2021-06-23-restricted-read-only.md", "docs/design/2021-06-23-spilled-unparallel-hashagg.md", "docs/design/2021-06-27-restructure-tests.md", "docs/design/2021-07-07-rule-based-index-selection.md", "docs/design/2021-07-29-hidden-sysvars.md", "docs/design/2021-08-18-charsets.md", "docs/design/2021-09-13-parser-as-submodule-of-tidb.md", "docs/design/2021-09-22-data-consistency.md", "docs/design/2021-09-22-stale-read.md", "docs/design/2021-09-29-merge-dumpling-into-tidb.md", "docs/design/2021-09-29-secure-bootstrap.md", "docs/design/2021-10-09-select-for-update-of-tables.md", "docs/design/2021-10-20-table-attributes.md", "docs/design/2021-12-08-instance-scope.md", "docs/design/2021-12-09-TiDB-log-based-incremental-backup.md", "docs/design/2022-01-04-integer-shard-index.md", "docs/design/2022-03-03-rc-read-tso-optimization.md", "docs/design/2022-03-09-optimize-gc-for-internal-transaction.md", "docs/design/2022-03-10-backup-with-batch-create-table.md", "docs/design/2022-03-16-functional-dependency.md", "docs/design/2022-03-24-get-lock.md", "docs/design/2022-03-25-non-transactional-dml.md", "docs/design/2022-04-15-multi-schema-change.md", "docs/design/2022-06-07-adding-index-acceleration.md", "docs/design/2022-06-22-foreign-key.md", "docs/design/2022-07-03-block-storage-snapshot-based-backup-restore.md", "docs/design/2022-07-20-session-manager.md", "docs/design/2022-07-22-transaction-savepoint.md", "docs/design/2022-08-02-stats-lru-cache.md", "docs/design/2022-08-04-pessimistic-lazy-constraint-check.md", "docs/design/2022-09-19-distributed-ddl-reorg.md", "docs/design/2022-09-22-global-memory-control.md", "docs/design/2022-09-29-reorganize-partition.md", "docs/design/2022-10-13-mysql-compatible-auto-increment.md", "docs/design/2022-11-17-ttl-table.md", "docs/design/2022-11-22-view-hint.md", "docs/design/2022-11-23-batch-cop.md", "docs/design/2022-11-25-global-resource-control.md", "docs/design/2022-12-06-support-late-materialization.md", "docs/design/2023-03-14-multi-valued-index.md", "docs/design/2023-03-17-non-prepared-plan-cache.md", "docs/design/2023-04-11-dist-task.md", "docs/design/2023-04-11-pause-user-ddl-when-upgrading.md", "docs/design/2023-04-15-ddl-pause-resume.md", "docs/design/2023-06-16-runaway-queries-management.md", "docs/design/2023-06-30-configurable-kv-timeout.md", "docs/design/2023-08-24-background-tasks-control.md", "docs/design/2023-09-12-grouping-sets.md", "docs/design/2023-11-29-priority-queue-for-auto-analyze.md", "docs/design/2024-01-09-pipelined-DML.md", "docs/design/2024-05-10-extension-authentication-plugin.md", "docs/design/2024-05-11-hash-join-v2.md", "docs/design/2024-05-23-predicate-columns.md", "docs/design/2024-09-06-maintain-priority-queue-in-memory.md", "docs/design/README.md", "docs/design/TEMPLATE.md", "docs/design/imgs/add-index-flow-chart.png", "docs/design/imgs/addIndexLit-1.png", "docs/design/imgs/addIndexLit-2.png", "docs/design/imgs/analyze-dataflow.png", "docs/design/imgs/and.jpeg", "docs/design/imgs/ast-tree.png", "docs/design/imgs/auto-analyze-predicate-columns.png", "docs/design/imgs/background-control.png", "docs/design/imgs/build-overall-process.png", "docs/design/imgs/cached-table-read.png", "docs/design/imgs/cached-table-write.png", "docs/design/imgs/cnf200m2.png", "docs/design/imgs/concurrendl-ddl.png", "docs/design/imgs/create-user-stmt.png", "docs/design/imgs/cte_computation.png", "docs/design/imgs/ddl_job_state_machine.png", "docs/design/imgs/dist-reorg-flow-chart.png", "docs/design/imgs/dist-task-architect.jpg", "docs/design/imgs/dnf200.png", "docs/design/imgs/ebs-backup-detail.png", "docs/design/imgs/ebs-backup-overview.png", "docs/design/imgs/ebs-backup-worker.png", "docs/design/imgs/ebs-backup.png", "docs/design/imgs/ebs-data-consistency.jpeg", "docs/design/imgs/ebs-overview.png", "docs/design/imgs/ebs-restore-overview.png", "docs/design/imgs/ebs-restore-worker.png", "docs/design/imgs/ebs-restore.png", "docs/design/imgs/ebs-snapshot-restore.png", "docs/design/imgs/ebs-solution-overview.png", "docs/design/imgs/ebs-tidb-operator-backup.jpeg", "docs/design/imgs/ebs-tidb-operator-restore.jpeg", "docs/design/imgs/execution_model.png", "docs/design/imgs/executors.png", "docs/design/imgs/global-quota-control.png", "docs/design/imgs/group-and-expression.png", "docs/design/imgs/hash-table.png", "docs/design/imgs/histogram-1.jpeg", "docs/design/imgs/histogram-2.jpeg", "docs/design/imgs/histogram-3.png", "docs/design/imgs/histogram-formula-1.png", "docs/design/imgs/histogram-formula-2.png", "docs/design/imgs/histogram-formula-3.png", "docs/design/imgs/log-backup-architecture.jpg", "docs/design/imgs/log-backup-data-flow.jpg", "docs/design/imgs/logical_plan.png", "docs/design/imgs/non-prepared-plan-cache.png", "docs/design/imgs/owner-detail-flow-chart.png", "docs/design/imgs/pause-user-ddl-when-upgrading-step-2.png", "docs/design/imgs/pd-log-dependency.png", "docs/design/imgs/physical_plan.png", "docs/design/imgs/pipelined-dml/comparison.png", "docs/design/imgs/pipelined-dml/large_transaction_process.png", "docs/design/imgs/pipelined-dml/membuffer.png", "docs/design/imgs/pipelined-dml/scope.png", "docs/design/imgs/pipelined-dml/vanilla_process.png", "docs/design/imgs/predicate-columns-collect.png", "docs/design/imgs/probe-overall-process.png", "docs/design/imgs/queue-ddl.png", "docs/design/imgs/resource-control-overview.png", "docs/design/imgs/row-format.jpeg", "docs/design/imgs/scalability-formula.png", "docs/design/imgs/session-manager-component.png", "docs/design/imgs/session-manager-deployment.png", "docs/design/imgs/session-manager-health-check.png", "docs/design/imgs/session-manager-multi-tenancy.png", "docs/design/imgs/structure-flow-chart.png", "docs/design/imgs/the-column-pool.png", "docs/design/imgs/tidb-log-dependency.png", "docs/design/imgs/view.png", "docs/design/imgs/wasm-browser-support.png", "docs/design/imgs/wasm-mobile-exception.jpeg", "docs/design/imgs/wasm-run-error-in-browser.png", "docs/design/imgs/wasm-wasi-error.png", "docs/design/imgs/write-scheduling.png", "docs/logo.png", "docs/tidb-architecture.png", "docs/tidb-logo-with-text.png", "docs/tidb_http_api.md", "dumpling/OWNERS", "dumpling/README.md", "dumpling/cli/BUILD.bazel", "dumpling/cli/versions.go", "dumpling/cmd/dumpling/BUILD.bazel", "dumpling/cmd/dumpling/main.go", "dumpling/context/BUILD.bazel", "dumpling/context/context.go", "dumpling/docs/cn/user-guide.md", "dumpling/docs/en/user-guide.md", "dumpling/export/BUILD.bazel", "dumpling/export/block_allow_list.go", "dumpling/export/config.go", "dumpling/export/conn.go", "dumpling/export/consistency.go", "dumpling/export/dump.go", "dumpling/export/http_handler.go", "dumpling/export/ir.go", "dumpling/export/ir_impl.go", "dumpling/export/metadata.go", "dumpling/export/metrics.go", "dumpling/export/prepare.go", "dumpling/export/region_results.csv", "dumpling/export/retry.go", "dumpling/export/sql.go", "dumpling/export/sql_type.go", "dumpling/export/status.go", "dumpling/export/task.go", "dumpling/export/util.go", "dumpling/export/writer.go", "dumpling/export/writer_util.go", "dumpling/install.sh", "dumpling/log/BUILD.bazel", "dumpling/log/log.go", "dumpling/revive.toml", "errors.toml", "go.mod", "go.sum", "hooks/pre-commit", "lightning/.gitignore", "lightning/OWNERS", "lightning/README.md", "lightning/cmd/tidb-lightning/BUILD.bazel", "lightning/cmd/tidb-lightning/OWNERS", "lightning/cmd/tidb-lightning/fips.go", "lightning/cmd/tidb-lightning/main.go", "lightning/cmd/tidb-lightning-ctl/BUILD.bazel", "lightning/cmd/tidb-lightning-ctl/OWNERS", "lightning/cmd/tidb-lightning-ctl/fips.go", "lightning/cmd/tidb-lightning-ctl/main.go", "lightning/pkg/importer/BUILD.bazel", "lightning/pkg/importer/check_info.go", "lightning/pkg/importer/check_template.go", "lightning/pkg/importer/checksum_helper.go", "lightning/pkg/importer/chunk_process.go", "lightning/pkg/importer/dup_detect.go", "lightning/pkg/importer/get_pre_info.go", "lightning/pkg/importer/import.go", "lightning/pkg/importer/meta_manager.go", "lightning/pkg/importer/mock/BUILD.bazel", "lightning/pkg/importer/mock/mock.go", "lightning/pkg/importer/opts/BUILD.bazel", "lightning/pkg/importer/opts/get_pre_info_opts.go", "lightning/pkg/importer/opts/precheck_opts.go", "lightning/pkg/importer/precheck.go", "lightning/pkg/importer/precheck_impl.go", "lightning/pkg/importer/table_import.go", "lightning/pkg/importer/testdata/000000_0.parquet", "lightning/pkg/importer/tidb.go", "lightning/pkg/precheck/BUILD.bazel", "lightning/pkg/precheck/precheck.go", "lightning/pkg/server/BUILD.bazel", "lightning/pkg/server/lightning.go", "lightning/pkg/server/run_options.go", "lightning/pkg/server/sigusr1_other.go", "lightning/pkg/server/sigusr1_unix.go", "lightning/pkg/web/BUILD.bazel", "lightning/pkg/web/progress.go", "lightning/pkg/web/res.go", "lightning/pkg/web/res_vfsdata.go", "lightning/tidb-lightning.toml", "lightning/web/README.md", "lightning/web/docs/InfoPage.png", "lightning/web/docs/ProgressPage.png", "lightning/web/docs/TableProgressPage.png", "lightning/web/docs/api.yaml", "lightning/web/package-lock.json", "lightning/web/package.json", "lightning/web/public/index.html", "lightning/web/src/ChunksProgressPanel.tsx", "lightning/web/src/DottedProgress.tsx", "lightning/web/src/EnginesProgressPanel.tsx", "lightning/web/src/ErrorButton.tsx", "lightning/web/src/InfoButton.tsx", "lightning/web/src/InfoPage.tsx", "lightning/web/src/MoveTaskButton.tsx", "lightning/web/src/PauseButton.tsx", "lightning/web/src/ProgressPage.tsx", "lightning/web/src/RefreshButton.tsx", "lightning/web/src/TableProgressCard.tsx", "lightning/web/src/TableProgressPage.tsx", "lightning/web/src/TaskButton.tsx", "lightning/web/src/TitleBar.tsx", "lightning/web/src/TitleLink.tsx", "lightning/web/src/api.ts", "lightning/web/src/index.tsx", "lightning/web/src/json-bigint.d.ts", "lightning/web/tsconfig.json", "lightning/web/webpack.config.js", "pkg/autoid_service/BUILD.bazel", "pkg/autoid_service/OWNERS", "pkg/autoid_service/autoid.go", "pkg/bindinfo/BUILD.bazel", "pkg/bindinfo/OWNERS", "pkg/bindinfo/binding.go", "pkg/bindinfo/binding_cache.go", "pkg/bindinfo/binding_match.go", "pkg/bindinfo/capture.go", "pkg/bindinfo/global_handle.go", "pkg/bindinfo/internal/BUILD.bazel", "pkg/bindinfo/internal/logutil/BUILD.bazel", "pkg/bindinfo/internal/logutil/logutil.go", "pkg/bindinfo/internal/testutil.go", "pkg/bindinfo/norm/BUILD.bazel", "pkg/bindinfo/norm/normalize.go", "pkg/bindinfo/session_handle.go", "pkg/bindinfo/util.go", "pkg/config/BUILD.bazel", "pkg/config/OWNERS", "pkg/config/config.go", "pkg/config/config.toml.example", "pkg/config/config_util.go", "pkg/config/const.go", "pkg/ddl/BUILD.bazel", "pkg/ddl/OWNERS", "pkg/ddl/add_column.go", "pkg/ddl/backfilling.go", "pkg/ddl/backfilling_clean_s3.go", "pkg/ddl/backfilling_dist_executor.go", "pkg/ddl/backfilling_dist_scheduler.go", "pkg/ddl/backfilling_import_cloud.go", "pkg/ddl/backfilling_merge_sort.go", "pkg/ddl/backfilling_operators.go", "pkg/ddl/backfilling_read_index.go", "pkg/ddl/backfilling_scheduler.go", "pkg/ddl/bdr.go", "pkg/ddl/cluster.go", "pkg/ddl/column.go", "pkg/ddl/constant.go", "pkg/ddl/constraint.go", "pkg/ddl/copr/BUILD.bazel", "pkg/ddl/copr/copr_ctx.go", "pkg/ddl/create_table.go", "pkg/ddl/ddl.go", "pkg/ddl/ddl_algorithm.go", "pkg/ddl/ddl_history.go", "pkg/ddl/ddl_running_jobs.go", "pkg/ddl/ddl_tiflash_api.go", "pkg/ddl/ddl_workerpool.go", "pkg/ddl/delete_range.go", "pkg/ddl/delete_range_util.go", "pkg/ddl/dist_owner.go", "pkg/ddl/doc.go", "pkg/ddl/executor.go", "pkg/ddl/foreign_key.go", "pkg/ddl/generated_column.go", "pkg/ddl/index.go", "pkg/ddl/index_cop.go", "pkg/ddl/index_merge_tmp.go", "pkg/ddl/ingest/BUILD.bazel", "pkg/ddl/ingest/backend.go", "pkg/ddl/ingest/backend_mgr.go", "pkg/ddl/ingest/checkpoint.go", "pkg/ddl/ingest/config.go", "pkg/ddl/ingest/disk_root.go", "pkg/ddl/ingest/engine.go", "pkg/ddl/ingest/engine_mgr.go", "pkg/ddl/ingest/env.go", "pkg/ddl/ingest/mem_root.go", "pkg/ddl/ingest/message.go", "pkg/ddl/ingest/mock.go", "pkg/ddl/ingest/testutil/BUILD.bazel", "pkg/ddl/ingest/testutil/testutil.go", "pkg/ddl/ingest/util.go", "pkg/ddl/job_scheduler.go", "pkg/ddl/job_submitter.go", "pkg/ddl/job_worker.go", "pkg/ddl/label/BUILD.bazel", "pkg/ddl/label/attributes.go", "pkg/ddl/label/errors.go", "pkg/ddl/label/rule.go", "pkg/ddl/logutil/BUILD.bazel", "pkg/ddl/logutil/logutil.go", "pkg/ddl/metabuild.go", "pkg/ddl/mock/BUILD.bazel", "pkg/ddl/mock/schema_loader_mock.go", "pkg/ddl/mock/systable_manager_mock.go", "pkg/ddl/mock.go", "pkg/ddl/modify_column.go", "pkg/ddl/multi_schema_change.go", "pkg/ddl/notifier/BUILD.bazel", "pkg/ddl/notifier/events.go", "pkg/ddl/notifier/publish.go", "pkg/ddl/notifier/store.go", "pkg/ddl/notifier/subscribe.go", "pkg/ddl/options.go", "pkg/ddl/partition.go", "pkg/ddl/placement/BUILD.bazel", "pkg/ddl/placement/bundle.go", "pkg/ddl/placement/common.go", "pkg/ddl/placement/constraint.go", "pkg/ddl/placement/constraints.go", "pkg/ddl/placement/errors.go", "pkg/ddl/placement/rule.go", "pkg/ddl/placement_policy.go", "pkg/ddl/reorg.go", "pkg/ddl/resource_group.go", "pkg/ddl/resourcegroup/BUILD.bazel", "pkg/ddl/resourcegroup/errors.go", "pkg/ddl/resourcegroup/group.go", "pkg/ddl/rollingback.go", "pkg/ddl/sanity_check.go", "pkg/ddl/schema.go", "pkg/ddl/schema_version.go", "pkg/ddl/schematracker/BUILD.bazel", "pkg/ddl/schematracker/checker.go", "pkg/ddl/schematracker/dm_tracker.go", "pkg/ddl/schematracker/info_store.go", "pkg/ddl/schemaver/BUILD.bazel", "pkg/ddl/schemaver/mem_syncer.go", "pkg/ddl/schemaver/syncer.go", "pkg/ddl/sequence.go", "pkg/ddl/serverstate/BUILD.bazel", "pkg/ddl/serverstate/mem_syncer.go", "pkg/ddl/serverstate/syncer.go", "pkg/ddl/session/BUILD.bazel", "pkg/ddl/session/session.go", "pkg/ddl/session/session_pool.go", "pkg/ddl/split_region.go", "pkg/ddl/stat.go", "pkg/ddl/systable/BUILD.bazel", "pkg/ddl/systable/manager.go", "pkg/ddl/systable/min_job_id.go", "pkg/ddl/table.go", "pkg/ddl/table_lock.go", "pkg/ddl/testutil/BUILD.bazel", "pkg/ddl/testutil/operator.go", "pkg/ddl/testutil/testutil.go", "pkg/ddl/ttl.go", "pkg/ddl/util/BUILD.bazel", "pkg/ddl/util/dead_table_lock_checker.go", "pkg/ddl/util/mock.go", "pkg/ddl/util/util.go", "pkg/ddl/util/watcher.go", "pkg/distsql/BUILD.bazel", "pkg/distsql/OWNERS", "pkg/distsql/context/BUILD.bazel", "pkg/distsql/context/context.go", "pkg/distsql/distsql.go", "pkg/distsql/request_builder.go", "pkg/distsql/select_result.go", "pkg/disttask/OWNERS", "pkg/disttask/framework/handle/BUILD.bazel", "pkg/disttask/framework/handle/handle.go", "pkg/disttask/framework/integrationtests/BUILD.bazel", "pkg/disttask/framework/mock/BUILD.bazel", "pkg/disttask/framework/mock/execute/BUILD.bazel", "pkg/disttask/framework/mock/execute/execute_mock.go", "pkg/disttask/framework/mock/plan_mock.go", "pkg/disttask/framework/mock/scheduler_mock.go", "pkg/disttask/framework/mock/task_executor_mock.go", "pkg/disttask/framework/planner/BUILD.bazel", "pkg/disttask/framework/planner/plan.go", "pkg/disttask/framework/planner/planner.go", "pkg/disttask/framework/proto/BUILD.bazel", "pkg/disttask/framework/proto/node.go", "pkg/disttask/framework/proto/step.go", "pkg/disttask/framework/proto/subtask.go", "pkg/disttask/framework/proto/task.go", "pkg/disttask/framework/proto/type.go", "pkg/disttask/framework/scheduler/BUILD.bazel", "pkg/disttask/framework/scheduler/balancer.go", "pkg/disttask/framework/scheduler/collector.go", "pkg/disttask/framework/scheduler/interface.go", "pkg/disttask/framework/scheduler/mock/BUILD.bazel", "pkg/disttask/framework/scheduler/mock/scheduler_mock.go", "pkg/disttask/framework/scheduler/nodes.go", "pkg/disttask/framework/scheduler/scheduler.go", "pkg/disttask/framework/scheduler/scheduler_manager.go", "pkg/disttask/framework/scheduler/slots.go", "pkg/disttask/framework/scheduler/state_transform.go", "pkg/disttask/framework/scheduler/testutil.go", "pkg/disttask/framework/storage/BUILD.bazel", "pkg/disttask/framework/storage/converter.go", "pkg/disttask/framework/storage/history.go", "pkg/disttask/framework/storage/nodes.go", "pkg/disttask/framework/storage/subtask_state.go", "pkg/disttask/framework/storage/task_state.go", "pkg/disttask/framework/storage/task_table.go", "pkg/disttask/framework/taskexecutor/BUILD.bazel", "pkg/disttask/framework/taskexecutor/execute/BUILD.bazel", "pkg/disttask/framework/taskexecutor/execute/interface.go", "pkg/disttask/framework/taskexecutor/interface.go", "pkg/disttask/framework/taskexecutor/manager.go", "pkg/disttask/framework/taskexecutor/register.go", "pkg/disttask/framework/taskexecutor/slot.go", "pkg/disttask/framework/taskexecutor/task_executor.go", "pkg/disttask/framework/testutil/BUILD.bazel", "pkg/disttask/framework/testutil/context.go", "pkg/disttask/framework/testutil/disttest_util.go", "pkg/disttask/framework/testutil/executor_util.go", "pkg/disttask/framework/testutil/scheduler_util.go", "pkg/disttask/framework/testutil/table_util.go", "pkg/disttask/framework/testutil/task_util.go", "pkg/disttask/importinto/BUILD.bazel", "pkg/disttask/importinto/clean_s3.go", "pkg/disttask/importinto/encode_and_sort_operator.go", "pkg/disttask/importinto/job.go", "pkg/disttask/importinto/metrics.go", "pkg/disttask/importinto/mock/BUILD.bazel", "pkg/disttask/importinto/mock/import_mock.go", "pkg/disttask/importinto/planner.go", "pkg/disttask/importinto/proto.go", "pkg/disttask/importinto/scheduler.go", "pkg/disttask/importinto/subtask_executor.go", "pkg/disttask/importinto/task_executor.go", "pkg/disttask/importinto/wrapper.go", "pkg/disttask/operator/BUILD.bazel", "pkg/disttask/operator/compose.go", "pkg/disttask/operator/operator.go", "pkg/disttask/operator/pipeline.go", "pkg/disttask/operator/wrapper.go", "pkg/domain/BUILD.bazel", "pkg/domain/OWNERS", "pkg/domain/domain.go", "pkg/domain/domain_sysvars.go", "pkg/domain/domainctx.go", "pkg/domain/extract.go", "pkg/domain/globalconfigsync/BUILD.bazel", "pkg/domain/globalconfigsync/globalconfig.go", "pkg/domain/historical_stats.go", "pkg/domain/infosync/BUILD.bazel", "pkg/domain/infosync/error.go", "pkg/domain/infosync/info.go", "pkg/domain/infosync/label_manager.go", "pkg/domain/infosync/mock_info.go", "pkg/domain/infosync/placement_manager.go", "pkg/domain/infosync/region.go", "pkg/domain/infosync/resource_manager_client.go", "pkg/domain/infosync/schedule_manager.go", "pkg/domain/infosync/tiflash_manager.go", "pkg/domain/metrics/BUILD.bazel", "pkg/domain/metrics/metrics.go", "pkg/domain/optimize_trace.go", "pkg/domain/plan_replayer.go", "pkg/domain/plan_replayer_dump.go", "pkg/domain/ru_stats.go", "pkg/domain/runaway.go", "pkg/domain/schema_checker.go", "pkg/domain/schema_validator.go", "pkg/domain/sysvar_cache.go", "pkg/domain/test_helper.go", "pkg/domain/topn_slow_query.go", "pkg/errctx/BUILD.bazel", "pkg/errctx/context.go", "pkg/errno/BUILD.bazel", "pkg/errno/errcode.go", "pkg/errno/errname.go", "pkg/errno/infoschema.go", "pkg/errno/logredaction.md", "pkg/executor/BUILD.bazel", "pkg/executor/adapter.go", "pkg/executor/admin.go", "pkg/executor/admin_plugins.go", "pkg/executor/aggfuncs/BUILD.bazel", "pkg/executor/aggfuncs/aggfuncs.go", "pkg/executor/aggfuncs/builder.go", "pkg/executor/aggfuncs/func_avg.go", "pkg/executor/aggfuncs/func_bitfuncs.go", "pkg/executor/aggfuncs/func_count.go", "pkg/executor/aggfuncs/func_count_distinct.go", "pkg/executor/aggfuncs/func_cume_dist.go", "pkg/executor/aggfuncs/func_first_row.go", "pkg/executor/aggfuncs/func_group_concat.go", "pkg/executor/aggfuncs/func_json_arrayagg.go", "pkg/executor/aggfuncs/func_json_objectagg.go", "pkg/executor/aggfuncs/func_lead_lag.go", "pkg/executor/aggfuncs/func_max_min.go", "pkg/executor/aggfuncs/func_ntile.go", "pkg/executor/aggfuncs/func_percent_rank.go", "pkg/executor/aggfuncs/func_percentile.go", "pkg/executor/aggfuncs/func_rank.go", "pkg/executor/aggfuncs/func_stddevpop.go", "pkg/executor/aggfuncs/func_stddevsamp.go", "pkg/executor/aggfuncs/func_sum.go", "pkg/executor/aggfuncs/func_value.go", "pkg/executor/aggfuncs/func_varpop.go", "pkg/executor/aggfuncs/func_varsamp.go", "pkg/executor/aggfuncs/row_number.go", "pkg/executor/aggfuncs/spill_deserialize_helper.go", "pkg/executor/aggfuncs/spill_serialize_helper.go", "pkg/executor/aggregate/BUILD.bazel", "pkg/executor/aggregate/agg_hash_base_worker.go", "pkg/executor/aggregate/agg_hash_executor.go", "pkg/executor/aggregate/agg_hash_final_worker.go", "pkg/executor/aggregate/agg_hash_partial_worker.go", "pkg/executor/aggregate/agg_spill.go", "pkg/executor/aggregate/agg_stream_executor.go", "pkg/executor/aggregate/agg_util.go", "pkg/executor/analyze.go", "pkg/executor/analyze_col.go", "pkg/executor/analyze_col_v2.go", "pkg/executor/analyze_global_stats.go", "pkg/executor/analyze_idx.go", "pkg/executor/analyze_utils.go", "pkg/executor/analyze_worker.go", "pkg/executor/batch_checker.go", "pkg/executor/batch_point_get.go", "pkg/executor/bind.go", "pkg/executor/brie.go", "pkg/executor/brie_utils.go", "pkg/executor/builder.go", "pkg/executor/checksum.go", "pkg/executor/compact_table.go", "pkg/executor/compiler.go", "pkg/executor/coprocessor.go", "pkg/executor/cte.go", "pkg/executor/cte_table_reader.go", "pkg/executor/ddl.go", "pkg/executor/delete.go", "pkg/executor/detach.go", "pkg/executor/distsql.go", "pkg/executor/executor.go", "pkg/executor/expand.go", "pkg/executor/explain.go", "pkg/executor/foreign_key.go", "pkg/executor/grant.go", "pkg/executor/import_into.go", "pkg/executor/importer/BUILD.bazel", "pkg/executor/importer/OWNERS", "pkg/executor/importer/chunk_process.go", "pkg/executor/importer/engine_process.go", "pkg/executor/importer/import.go", "pkg/executor/importer/job.go", "pkg/executor/importer/kv_encode.go", "pkg/executor/importer/precheck.go", "pkg/executor/importer/progress.go", "pkg/executor/importer/table_import.go", "pkg/executor/index_merge_reader.go", "pkg/executor/infoschema_reader.go", "pkg/executor/insert.go", "pkg/executor/insert_common.go", "pkg/executor/inspection_common.go", "pkg/executor/inspection_profile.go", "pkg/executor/inspection_result.go", "pkg/executor/inspection_summary.go", "pkg/executor/internal/BUILD.bazel", "pkg/executor/internal/applycache/BUILD.bazel", "pkg/executor/internal/applycache/apply_cache.go", "pkg/executor/internal/builder/BUILD.bazel", "pkg/executor/internal/builder/builder_utils.go", "pkg/executor/internal/calibrateresource/BUILD.bazel", "pkg/executor/internal/calibrateresource/calibrate_resource.go", "pkg/executor/internal/exec/BUILD.bazel", "pkg/executor/internal/exec/executor.go", "pkg/executor/internal/exec/indexusage.go", "pkg/executor/internal/mpp/BUILD.bazel", "pkg/executor/internal/mpp/executor_with_retry.go", "pkg/executor/internal/mpp/local_mpp_coordinator.go", "pkg/executor/internal/mpp/recovery_handler.go", "pkg/executor/internal/pdhelper/BUILD.bazel", "pkg/executor/internal/pdhelper/pd.go", "pkg/executor/internal/querywatch/BUILD.bazel", "pkg/executor/internal/querywatch/query_watch.go", "pkg/executor/internal/testutil/BUILD.bazel", "pkg/executor/internal/testutil/agg.go", "pkg/executor/internal/testutil/limit.go", "pkg/executor/internal/testutil/sort.go", "pkg/executor/internal/testutil/testutil.go", "pkg/executor/internal/testutil/window.go", "pkg/executor/internal/util/BUILD.bazel", "pkg/executor/internal/util/partition_table.go", "pkg/executor/internal/util/util.go", "pkg/executor/internal/vecgroupchecker/BUILD.bazel", "pkg/executor/internal/vecgroupchecker/vec_group_checker.go", "pkg/executor/join/BUILD.bazel", "pkg/executor/join/base_join_probe.go", "pkg/executor/join/concurrent_map.go", "pkg/executor/join/hash_join_base.go", "pkg/executor/join/hash_join_v1.go", "pkg/executor/join/hash_join_v2.go", "pkg/executor/join/hash_table_v1.go", "pkg/executor/join/hash_table_v2.go", "pkg/executor/join/index_lookup_hash_join.go", "pkg/executor/join/index_lookup_join.go", "pkg/executor/join/index_lookup_merge_join.go", "pkg/executor/join/inner_join_probe.go", "pkg/executor/join/join_row_table.go", "pkg/executor/join/join_table_meta.go", "pkg/executor/join/joiner.go", "pkg/executor/join/joinversion/BUILD.bazel", "pkg/executor/join/joinversion/join_version.go", "pkg/executor/join/merge_join.go", "pkg/executor/join/outer_join_probe.go", "pkg/executor/join/row_table_builder.go", "pkg/executor/join/tagged_ptr.go", "pkg/executor/load_data.go", "pkg/executor/load_stats.go", "pkg/executor/lockstats/BUILD.bazel", "pkg/executor/lockstats/lock_stats_executor.go", "pkg/executor/lockstats/unlock_stats_executor.go", "pkg/executor/mem_reader.go", "pkg/executor/memtable_reader.go", "pkg/executor/metrics/BUILD.bazel", "pkg/executor/metrics/metrics.go", "pkg/executor/metrics_reader.go", "pkg/executor/mpp_gather.go", "pkg/executor/mppcoordmanager/BUILD.bazel", "pkg/executor/mppcoordmanager/mpp_coordinator_manager.go", "pkg/executor/opt_rule_blacklist.go", "pkg/executor/parallel_apply.go", "pkg/executor/pipelined_window.go", "pkg/executor/plan_replayer.go", "pkg/executor/point_get.go", "pkg/executor/prepared.go", "pkg/executor/projection.go", "pkg/executor/reload_expr_pushdown_blacklist.go", "pkg/executor/replace.go", "pkg/executor/revoke.go", "pkg/executor/sample.go", "pkg/executor/select_into.go", "pkg/executor/set.go", "pkg/executor/set_config.go", "pkg/executor/show.go", "pkg/executor/show_placement.go", "pkg/executor/show_stats.go", "pkg/executor/shuffle.go", "pkg/executor/simple.go", "pkg/executor/slow_query.go", "pkg/executor/sortexec/BUILD.bazel", "pkg/executor/sortexec/multi_way_merge.go", "pkg/executor/sortexec/parallel_sort_spill_helper.go", "pkg/executor/sortexec/parallel_sort_worker.go", "pkg/executor/sortexec/sort.go", "pkg/executor/sortexec/sort_partition.go", "pkg/executor/sortexec/sort_spill.go", "pkg/executor/sortexec/sort_util.go", "pkg/executor/sortexec/topn.go", "pkg/executor/sortexec/topn_chunk_heap.go", "pkg/executor/sortexec/topn_spill.go", "pkg/executor/sortexec/topn_worker.go", "pkg/executor/split.go", "pkg/executor/staticrecordset/BUILD.bazel", "pkg/executor/staticrecordset/cursorrecordset.go", "pkg/executor/staticrecordset/recordset.go", "pkg/executor/stmtsummary.go", "pkg/executor/table_reader.go", "pkg/executor/testdata/prepare_suite_in.json", "pkg/executor/testdata/prepare_suite_out.json", "pkg/executor/testdata/slow_query_suite_in.json", "pkg/executor/testdata/slow_query_suite_out.json", "pkg/executor/testdata/tiflash_v620_dt_segments.json", "pkg/executor/testdata/tiflash_v620_dt_tables.json", "pkg/executor/testdata/tiflash_v630_dt_segments.json", "pkg/executor/testdata/tiflash_v640_dt_tables.json", "pkg/executor/trace.go", "pkg/executor/union_scan.go", "pkg/executor/unionexec/BUILD.bazel", "pkg/executor/unionexec/union.go", "pkg/executor/update.go", "pkg/executor/utils.go", "pkg/executor/window.go", "pkg/executor/write.go", "pkg/expression/BUILD.bazel", "pkg/expression/OWNERS", "pkg/expression/aggregation/BUILD.bazel", "pkg/expression/aggregation/agg_to_pb.go", "pkg/expression/aggregation/aggregation.go", "pkg/expression/aggregation/avg.go", "pkg/expression/aggregation/base_func.go", "pkg/expression/aggregation/bit_and.go", "pkg/expression/aggregation/bit_or.go", "pkg/expression/aggregation/bit_xor.go", "pkg/expression/aggregation/concat.go", "pkg/expression/aggregation/count.go", "pkg/expression/aggregation/descriptor.go", "pkg/expression/aggregation/explain.go", "pkg/expression/aggregation/first_row.go", "pkg/expression/aggregation/max_min.go", "pkg/expression/aggregation/sum.go", "pkg/expression/aggregation/util.go", "pkg/expression/aggregation/window_func.go", "pkg/expression/builtin.go", "pkg/expression/builtin_arithmetic.go", "pkg/expression/builtin_arithmetic_vec.go", "pkg/expression/builtin_cast.go", "pkg/expression/builtin_cast_vec.go", "pkg/expression/builtin_compare.go", "pkg/expression/builtin_compare_vec.go", "pkg/expression/builtin_compare_vec_generated.go", "pkg/expression/builtin_control.go", "pkg/expression/builtin_control_vec_generated.go", "pkg/expression/builtin_convert_charset.go", "pkg/expression/builtin_encryption.go", "pkg/expression/builtin_encryption_vec.go", "pkg/expression/builtin_func_param.go", "pkg/expression/builtin_grouping.go", "pkg/expression/builtin_ilike.go", "pkg/expression/builtin_ilike_vec.go", "pkg/expression/builtin_info.go", "pkg/expression/builtin_info_vec.go", "pkg/expression/builtin_json.go", "pkg/expression/builtin_json_vec.go", "pkg/expression/builtin_like.go", "pkg/expression/builtin_like_vec.go", "pkg/expression/builtin_math.go", "pkg/expression/builtin_math_vec.go", "pkg/expression/builtin_miscellaneous.go", "pkg/expression/builtin_miscellaneous_vec.go", "pkg/expression/builtin_op.go", "pkg/expression/builtin_op_vec.go", "pkg/expression/builtin_other.go", "pkg/expression/builtin_other_vec.go", "pkg/expression/builtin_other_vec_generated.go", "pkg/expression/builtin_regexp.go", "pkg/expression/builtin_regexp_util.go", "pkg/expression/builtin_string.go", "pkg/expression/builtin_string_vec.go", "pkg/expression/builtin_string_vec_generated.go", "pkg/expression/builtin_time.go", "pkg/expression/builtin_time_vec.go", "pkg/expression/builtin_time_vec_generated.go", "pkg/expression/builtin_vec.go", "pkg/expression/builtin_vectorized.go", "pkg/expression/chunk_executor.go", "pkg/expression/collation.go", "pkg/expression/column.go", "pkg/expression/constant.go", "pkg/expression/constant_fold.go", "pkg/expression/constant_propagation.go", "pkg/expression/context.go", "pkg/expression/distsql_builtin.go", "pkg/expression/errors.go", "pkg/expression/evaluator.go", "pkg/expression/explain.go", "pkg/expression/expr_to_pb.go", "pkg/expression/exprctx/BUILD.bazel", "pkg/expression/exprctx/context.go", "pkg/expression/exprctx/optional.go", "pkg/expression/exprctx/param.go", "pkg/expression/expression.go", "pkg/expression/expropt/BUILD.bazel", "pkg/expression/expropt/advisory_lock.go", "pkg/expression/expropt/current_user.go", "pkg/expression/expropt/ddlowner.go", "pkg/expression/expropt/infoschema.go", "pkg/expression/expropt/kvstore.go", "pkg/expression/expropt/optional.go", "pkg/expression/expropt/sequence.go", "pkg/expression/expropt/sessionvars.go", "pkg/expression/expropt/sqlexec.go", "pkg/expression/exprstatic/BUILD.bazel", "pkg/expression/exprstatic/evalctx.go", "pkg/expression/exprstatic/exprctx.go", "pkg/expression/extension.go", "pkg/expression/function_traits.go", "pkg/expression/generator/compare_vec.go", "pkg/expression/generator/control_vec.go", "pkg/expression/generator/helper/BUILD.bazel", "pkg/expression/generator/helper/helper.go", "pkg/expression/generator/other_vec.go", "pkg/expression/generator/string_vec.go", "pkg/expression/generator/time_vec.go", "pkg/expression/grouping_sets.go", "pkg/expression/helper.go", "pkg/expression/infer_pushdown.go", "pkg/expression/integration_test/BUILD.bazel", "pkg/expression/integration_test/README.md", "pkg/expression/scalar_function.go", "pkg/expression/schema.go", "pkg/expression/sessionexpr/BUILD.bazel", "pkg/expression/sessionexpr/sessionctx.go", "pkg/expression/simple_rewriter.go", "pkg/expression/util.go", "pkg/expression/vectorized.go", "pkg/extension/.gitignore", "pkg/extension/BUILD.bazel", "pkg/extension/README.md", "pkg/extension/_import/BUILD.bazel", "pkg/extension/_import/import.go", "pkg/extension/auth.go", "pkg/extension/extensionimpl/BUILD.bazel", "pkg/extension/extensionimpl/bootstrap.go", "pkg/extension/extensions.go", "pkg/extension/function.go", "pkg/extension/manifest.go", "pkg/extension/registry.go", "pkg/extension/session.go", "pkg/extension/util.go", "pkg/infoschema/BUILD.bazel", "pkg/infoschema/OWNERS", "pkg/infoschema/builder.go", "pkg/infoschema/builder_misc.go", "pkg/infoschema/bundle_builder.go", "pkg/infoschema/cache.go", "pkg/infoschema/cluster.go", "pkg/infoschema/context/BUILD.bazel", "pkg/infoschema/context/infoschema.go", "pkg/infoschema/error.go", "pkg/infoschema/infoschema.go", "pkg/infoschema/infoschema_v2.go", "pkg/infoschema/interface.go", "pkg/infoschema/internal/BUILD.bazel", "pkg/infoschema/internal/sizer.go", "pkg/infoschema/internal/testkit.go", "pkg/infoschema/metric_table_def.go", "pkg/infoschema/metrics/BUILD.bazel", "pkg/infoschema/metrics/metrics.go", "pkg/infoschema/metrics.go", "pkg/infoschema/metrics_schema.go", "pkg/infoschema/perfschema/BUILD.bazel", "pkg/infoschema/perfschema/const.go", "pkg/infoschema/perfschema/init.go", "pkg/infoschema/perfschema/tables.go", "pkg/infoschema/perfschema/testdata/test.pprof", "pkg/infoschema/perfschema/testdata/tikv.cpu.profile", "pkg/infoschema/sieve.go", "pkg/infoschema/tables.go", "pkg/keyspace/BUILD.bazel", "pkg/keyspace/keyspace.go", "pkg/kv/BUILD.bazel", "pkg/kv/cachedb.go", "pkg/kv/checker.go", "pkg/kv/error.go", "pkg/kv/fault_injection.go", "pkg/kv/iter.go", "pkg/kv/key.go", "pkg/kv/keyflags.go", "pkg/kv/kv.go", "pkg/kv/mpp.go", "pkg/kv/option.go", "pkg/kv/txn.go", "pkg/kv/txn_scope_var.go", "pkg/kv/utils.go", "pkg/kv/variables.go", "pkg/kv/version.go", "pkg/lightning/OWNERS", "pkg/lightning/backend/BUILD.bazel", "pkg/lightning/backend/backend.go", "pkg/lightning/backend/encode/BUILD.bazel", "pkg/lightning/backend/encode/encode.go", "pkg/lightning/backend/external/BUILD.bazel", "pkg/lightning/backend/external/byte_reader.go", "pkg/lightning/backend/external/codec.go", "pkg/lightning/backend/external/concurrent_reader.go", "pkg/lightning/backend/external/engine.go", "pkg/lightning/backend/external/file.go", "pkg/lightning/backend/external/iter.go", "pkg/lightning/backend/external/kv_reader.go", "pkg/lightning/backend/external/merge.go", "pkg/lightning/backend/external/merge_v2.go", "pkg/lightning/backend/external/onefile_writer.go", "pkg/lightning/backend/external/reader.go", "pkg/lightning/backend/external/split.go", "pkg/lightning/backend/external/stat_reader.go", "pkg/lightning/backend/external/testutil.go", "pkg/lightning/backend/external/util.go", "pkg/lightning/backend/external/writer.go", "pkg/lightning/backend/kv/BUILD.bazel", "pkg/lightning/backend/kv/allocator.go", "pkg/lightning/backend/kv/base.go", "pkg/lightning/backend/kv/context.go", "pkg/lightning/backend/kv/kv2sql.go", "pkg/lightning/backend/kv/session.go", "pkg/lightning/backend/kv/sql2kv.go", "pkg/lightning/backend/local/BUILD.bazel", "pkg/lightning/backend/local/checksum.go", "pkg/lightning/backend/local/compress.go", "pkg/lightning/backend/local/disk_quota.go", "pkg/lightning/backend/local/duplicate.go", "pkg/lightning/backend/local/engine.go", "pkg/lightning/backend/local/engine_mgr.go", "pkg/lightning/backend/local/iterator.go", "pkg/lightning/backend/local/local.go", "pkg/lightning/backend/local/local_freebsd.go", "pkg/lightning/backend/local/local_unix.go", "pkg/lightning/backend/local/local_unix_generic.go", "pkg/lightning/backend/local/local_windows.go", "pkg/lightning/backend/local/localhelper.go", "pkg/lightning/backend/local/region_job.go", "pkg/lightning/backend/local/tikv_mode.go", "pkg/lightning/backend/tidb/BUILD.bazel", "pkg/lightning/backend/tidb/tidb.go", "pkg/lightning/checkpoints/BUILD.bazel", "pkg/lightning/checkpoints/checkpoints.go", "pkg/lightning/checkpoints/checkpointspb/BUILD.bazel", "pkg/lightning/checkpoints/checkpointspb/file_checkpoints.pb.go", "pkg/lightning/checkpoints/checkpointspb/file_checkpoints.proto", "pkg/lightning/checkpoints/tidb.go", "pkg/lightning/common/BUILD.bazel", "pkg/lightning/common/common.go", "pkg/lightning/common/conn.go", "pkg/lightning/common/dupdetect.go", "pkg/lightning/common/engine.go", "pkg/lightning/common/errors.go", "pkg/lightning/common/ingest_data.go", "pkg/lightning/common/key_adapter.go", "pkg/lightning/common/once_error.go", "pkg/lightning/common/pause.go", "pkg/lightning/common/retry.go", "pkg/lightning/common/security.go", "pkg/lightning/common/storage.go", "pkg/lightning/common/storage_unix.go", "pkg/lightning/common/storage_windows.go", "pkg/lightning/common/util.go", "pkg/lightning/config/BUILD.bazel", "pkg/lightning/config/bytesize.go", "pkg/lightning/config/config.go", "pkg/lightning/config/configlist.go", "pkg/lightning/config/const.go", "pkg/lightning/config/global.go", "pkg/lightning/duplicate/BUILD.bazel", "pkg/lightning/duplicate/detector.go", "pkg/lightning/duplicate/internal.go", "pkg/lightning/duplicate/worker.go", "pkg/lightning/errormanager/BUILD.bazel", "pkg/lightning/errormanager/errormanager.go", "pkg/lightning/log/BUILD.bazel", "pkg/lightning/log/filter.go", "pkg/lightning/log/log.go", "pkg/lightning/log/testlogger.go", "pkg/lightning/manual/BUILD.bazel", "pkg/lightning/manual/allocator.go", "pkg/lightning/manual/manual.go", "pkg/lightning/manual/manual_nocgo.go", "pkg/lightning/metric/BUILD.bazel", "pkg/lightning/metric/metric.go", "pkg/lightning/mydump/BUILD.bazel", "pkg/lightning/mydump/bytes.go", "pkg/lightning/mydump/charset_convertor.go", "pkg/lightning/mydump/csv/gb18030_test_file.csv", "pkg/lightning/mydump/csv/split_large_file.csv", "pkg/lightning/mydump/csv/split_large_file.csv.zst", "pkg/lightning/mydump/csv/utf8_test_file.csv", "pkg/lightning/mydump/csv_parser.go", "pkg/lightning/mydump/examples/metadata", "pkg/lightning/mydump/examples/mocker_test-schema-create.sql", "pkg/lightning/mydump/examples/mocker_test.i-schema.sql", "pkg/lightning/mydump/examples/mocker_test.i.sql", "pkg/lightning/mydump/examples/mocker_test.report_case_high_risk-schema.sql", "pkg/lightning/mydump/examples/mocker_test.report_case_high_risk.sql", "pkg/lightning/mydump/examples/mocker_test.tbl_autoid-schema.sql", "pkg/lightning/mydump/examples/mocker_test.tbl_autoid.sql", "pkg/lightning/mydump/examples/mocker_test.tbl_multi_index-schema.sql", "pkg/lightning/mydump/examples/mocker_test.tbl_multi_index.sql", "pkg/lightning/mydump/examples/test.parquet", "pkg/lightning/mydump/loader.go", "pkg/lightning/mydump/parquet/000000_0.parquet", "pkg/lightning/mydump/parquet_parser.go", "pkg/lightning/mydump/parser.go", "pkg/lightning/mydump/parser.rl", "pkg/lightning/mydump/parser_generated.go", "pkg/lightning/mydump/reader.go", "pkg/lightning/mydump/region.go", "pkg/lightning/mydump/router.go", "pkg/lightning/mydump/schema_import.go", "pkg/lightning/tikv/BUILD.bazel", "pkg/lightning/tikv/tikv.go", "pkg/lightning/verification/BUILD.bazel", "pkg/lightning/verification/checksum.go", "pkg/lightning/worker/BUILD.bazel", "pkg/lightning/worker/worker.go", "pkg/lock/BUILD.bazel", "pkg/lock/OWNERS", "pkg/lock/context/BUILD.bazel", "pkg/lock/context/lockcontext.go", "pkg/lock/lock.go", "pkg/meta/BUILD.bazel", "pkg/meta/OWNERS", "pkg/meta/autoid/BUILD.bazel", "pkg/meta/autoid/autoid.go", "pkg/meta/autoid/autoid_service.go", "pkg/meta/autoid/errors.go", "pkg/meta/autoid/memid.go", "pkg/meta/meta.go", "pkg/meta/meta_autoid.go", "pkg/meta/metabuild/BUILD.bazel", "pkg/meta/metabuild/context.go", "pkg/meta/model/BUILD.bazel", "pkg/meta/model/bdr.go", "pkg/meta/model/column.go", "pkg/meta/model/db.go", "pkg/meta/model/flags.go", "pkg/meta/model/index.go", "pkg/meta/model/job.go", "pkg/meta/model/job_args.go", "pkg/meta/model/placement.go", "pkg/meta/model/reorg.go", "pkg/meta/model/resource_group.go", "pkg/meta/model/table.go", "pkg/metrics/BUILD.bazel", "pkg/metrics/alertmanager/tidb.rules.yml", "pkg/metrics/bindinfo.go", "pkg/metrics/ddl.go", "pkg/metrics/distsql.go", "pkg/metrics/disttask.go", "pkg/metrics/domain.go", "pkg/metrics/executor.go", "pkg/metrics/gc_worker.go", "pkg/metrics/globalsort.go", "pkg/metrics/grafana/README.md", "pkg/metrics/grafana/generate_json.sh", "pkg/metrics/grafana/overview.json", "pkg/metrics/grafana/performance_overview.json", "pkg/metrics/grafana/tidb.json", "pkg/metrics/grafana/tidb_resource_control.json", "pkg/metrics/grafana/tidb_runtime.json", "pkg/metrics/grafana/tidb_summary.json", "pkg/metrics/grafana/tidb_summary.jsonnet", "pkg/metrics/import.go", "pkg/metrics/infoschema.go", "pkg/metrics/log_backup.go", "pkg/metrics/meta.go", "pkg/metrics/metrics.go", "pkg/metrics/owner.go", "pkg/metrics/resource_group.go", "pkg/metrics/resourcemanager.go", "pkg/metrics/server.go", "pkg/metrics/session.go", "pkg/metrics/sli.go", "pkg/metrics/stats.go", "pkg/metrics/topsql.go", "pkg/metrics/ttl.go", "pkg/metrics/wrapper.go", "pkg/owner/BUILD.bazel", "pkg/owner/OWNERS", "pkg/owner/manager.go", "pkg/owner/mock.go", "pkg/param/BUILD.bazel", "pkg/param/binary_params.go", "pkg/parser/.editorconfig", "pkg/parser/.gitignore", "pkg/parser/BUILD.bazel", "pkg/parser/LICENSE", "pkg/parser/Makefile", "pkg/parser/OWNERS", "pkg/parser/README.md", "pkg/parser/SECURITY.md", "pkg/parser/ast/BUILD.bazel", "pkg/parser/ast/ast.go", "pkg/parser/ast/base.go", "pkg/parser/ast/ddl.go", "pkg/parser/ast/dml.go", "pkg/parser/ast/expressions.go", "pkg/parser/ast/flag.go", "pkg/parser/ast/functions.go", "pkg/parser/ast/misc.go", "pkg/parser/ast/procedure.go", "pkg/parser/ast/stats.go", "pkg/parser/ast/util.go", "pkg/parser/auth/BUILD.bazel", "pkg/parser/auth/auth.go", "pkg/parser/auth/caching_sha2.go", "pkg/parser/auth/mysql_native_password.go", "pkg/parser/auth/tidb_sm3.go", "pkg/parser/charset/BUILD.bazel", "pkg/parser/charset/charset.go", "pkg/parser/charset/encoding.go", "pkg/parser/charset/encoding_ascii.go", "pkg/parser/charset/encoding_base.go", "pkg/parser/charset/encoding_bin.go", "pkg/parser/charset/encoding_gbk.go", "pkg/parser/charset/encoding_latin1.go", "pkg/parser/charset/encoding_table.go", "pkg/parser/charset/encoding_utf8.go", "pkg/parser/digester.go", "pkg/parser/docs/quickstart.md", "pkg/parser/duration/BUILD.bazel", "pkg/parser/duration/duration.go", "pkg/parser/format/BUILD.bazel", "pkg/parser/format/format.go", "pkg/parser/generate.go", "pkg/parser/generate_keyword/BUILD.bazel", "pkg/parser/generate_keyword/genkeyword.go", "pkg/parser/go.mod", "pkg/parser/go.sum", "pkg/parser/goyacc/BUILD.bazel", "pkg/parser/goyacc/format_yacc.go", "pkg/parser/goyacc/main.go", "pkg/parser/hintparser.go", "pkg/parser/hintparser.y", "pkg/parser/hintparserimpl.go", "pkg/parser/keywords.go", "pkg/parser/lexer.go", "pkg/parser/misc.go", "pkg/parser/model/BUILD.bazel", "pkg/parser/model/model.go", "pkg/parser/mysql/BUILD.bazel", "pkg/parser/mysql/charset.go", "pkg/parser/mysql/const.go", "pkg/parser/mysql/errcode.go", "pkg/parser/mysql/errname.go", "pkg/parser/mysql/error.go", "pkg/parser/mysql/locale_format.go", "pkg/parser/mysql/privs.go", "pkg/parser/mysql/state.go", "pkg/parser/mysql/type.go", "pkg/parser/mysql/util.go", "pkg/parser/opcode/BUILD.bazel", "pkg/parser/opcode/opcode.go", "pkg/parser/parser.y", "pkg/parser/terror/BUILD.bazel", "pkg/parser/terror/terror.go", "pkg/parser/test.sh", "pkg/parser/test_driver/BUILD.bazel", "pkg/parser/test_driver/test_driver.go", "pkg/parser/test_driver/test_driver_datum.go", "pkg/parser/test_driver/test_driver_helper.go", "pkg/parser/test_driver/test_driver_mydecimal.go", "pkg/parser/tidb/BUILD.bazel", "pkg/parser/tidb/features.go", "pkg/parser/types/BUILD.bazel", "pkg/parser/types/etc.go", "pkg/parser/types/eval_type.go", "pkg/parser/types/field_type.go", "pkg/parser/yy_parser.go", "pkg/planner/BUILD.bazel", "pkg/planner/OWNERS", "pkg/planner/cardinality/BUILD.bazel", "pkg/planner/cardinality/cross_estimation.go", "pkg/planner/cardinality/join.go", "pkg/planner/cardinality/ndv.go", "pkg/planner/cardinality/pseudo.go", "pkg/planner/cardinality/row_count_column.go", "pkg/planner/cardinality/row_count_index.go", "pkg/planner/cardinality/row_size.go", "pkg/planner/cardinality/selectivity.go", "pkg/planner/cardinality/testdata/cardinality_suite_in.json", "pkg/planner/cardinality/testdata/cardinality_suite_out.json", "pkg/planner/cardinality/trace.go", "pkg/planner/cascades/BUILD.bazel", "pkg/planner/cascades/base/BUILD.bazel", "pkg/planner/cascades/base/base.go", "pkg/planner/cascades/base/hash_equaler.go", "pkg/planner/cascades/enforcer_rules.go", "pkg/planner/cascades/implementation_rules.go", "pkg/planner/cascades/memo/BUILD.bazel", "pkg/planner/cascades/memo/group.go", "pkg/planner/cascades/memo/group_expr.go", "pkg/planner/cascades/memo/group_id_generator.go", "pkg/planner/cascades/memo/memo.go", "pkg/planner/cascades/optimize.go", "pkg/planner/cascades/stringer.go", "pkg/planner/cascades/testdata/stringer_suite_in.json", "pkg/planner/cascades/testdata/stringer_suite_out.json", "pkg/planner/cascades/testdata/transformation_rules_suite_in.json", "pkg/planner/cascades/testdata/transformation_rules_suite_out.json", "pkg/planner/cascades/transformation_rules.go", "pkg/planner/core/BUILD.bazel", "pkg/planner/core/access_object.go", "pkg/planner/core/base/BUILD.bazel", "pkg/planner/core/base/doc.go", "pkg/planner/core/base/misc_base.go", "pkg/planner/core/base/plan_base.go", "pkg/planner/core/base/rule_base.go", "pkg/planner/core/base/task_base.go", "pkg/planner/core/casetest/BUILD.bazel", "pkg/planner/core/casetest/binaryplan/BUILD.bazel", "pkg/planner/core/casetest/binaryplan/testdata/binary_plan_suite_in.json", "pkg/planner/core/casetest/binaryplan/testdata/binary_plan_suite_out.json", "pkg/planner/core/casetest/cbotest/BUILD.bazel", "pkg/planner/core/casetest/cbotest/testdata/analyzeSuiteTestLimitIndexEstimationT.json", "pkg/planner/core/casetest/cbotest/testdata/analyze_suite_in.json", "pkg/planner/core/casetest/cbotest/testdata/analyze_suite_out.json", "pkg/planner/core/casetest/cbotest/testdata/analyzesSuiteTestIndexReadT.json", "pkg/planner/core/casetest/correlated/BUILD.bazel", "pkg/planner/core/casetest/dag/BUILD.bazel", "pkg/planner/core/casetest/dag/testdata/plan_suite_in.json", "pkg/planner/core/casetest/dag/testdata/plan_suite_out.json", "pkg/planner/core/casetest/enforcempp/BUILD.bazel", "pkg/planner/core/casetest/enforcempp/testdata/enforce_mpp_suite_in.json", "pkg/planner/core/casetest/enforcempp/testdata/enforce_mpp_suite_out.json", "pkg/planner/core/casetest/flatplan/BUILD.bazel", "pkg/planner/core/casetest/flatplan/testdata/flat_plan_suite_in.json", "pkg/planner/core/casetest/flatplan/testdata/flat_plan_suite_out.json", "pkg/planner/core/casetest/hint/BUILD.bazel", "pkg/planner/core/casetest/hint/testdata/integration_suite_in.json", "pkg/planner/core/casetest/hint/testdata/integration_suite_out.json", "pkg/planner/core/casetest/index/BUILD.bazel", "pkg/planner/core/casetest/index/testdata/index_range_in.json", "pkg/planner/core/casetest/index/testdata/index_range_out.json", "pkg/planner/core/casetest/index/testdata/integration_suite_in.json", "pkg/planner/core/casetest/index/testdata/integration_suite_out.json", "pkg/planner/core/casetest/instanceplancache/BUILD.bazel", "pkg/planner/core/casetest/mpp/BUILD.bazel", "pkg/planner/core/casetest/mpp/testdata/integration_suite_in.json", "pkg/planner/core/casetest/mpp/testdata/integration_suite_out.json", "pkg/planner/core/casetest/parallelapply/BUILD.bazel", "pkg/planner/core/casetest/partition/BUILD.bazel", "pkg/planner/core/casetest/partition/testdata/integration_partition_suite_in.json", "pkg/planner/core/casetest/partition/testdata/integration_partition_suite_out.json", "pkg/planner/core/casetest/partition/testdata/partition_pruner_in.json", "pkg/planner/core/casetest/partition/testdata/partition_pruner_out.json", "pkg/planner/core/casetest/physicalplantest/BUILD.bazel", "pkg/planner/core/casetest/physicalplantest/testdata/plan_suite_in.json", "pkg/planner/core/casetest/physicalplantest/testdata/plan_suite_out.json", "pkg/planner/core/casetest/planstats/BUILD.bazel", "pkg/planner/core/casetest/planstats/testdata/plan_stats_suite_in.json", "pkg/planner/core/casetest/planstats/testdata/plan_stats_suite_out.json", "pkg/planner/core/casetest/pushdown/BUILD.bazel", "pkg/planner/core/casetest/pushdown/testdata/integration_suite_in.json", "pkg/planner/core/casetest/pushdown/testdata/integration_suite_out.json", "pkg/planner/core/casetest/rule/BUILD.bazel", "pkg/planner/core/casetest/rule/testdata/derive_topn_from_window_in.json", "pkg/planner/core/casetest/rule/testdata/derive_topn_from_window_out.json", "pkg/planner/core/casetest/rule/testdata/join_reorder_suite_in.json", "pkg/planner/core/casetest/rule/testdata/join_reorder_suite_out.json", "pkg/planner/core/casetest/rule/testdata/outer2inner_in.json", "pkg/planner/core/casetest/rule/testdata/outer2inner_out.json", "pkg/planner/core/casetest/rule/testdata/predicate_pushdown_suite_in.json", "pkg/planner/core/casetest/rule/testdata/predicate_pushdown_suite_out.json", "pkg/planner/core/casetest/scalarsubquery/BUILD.bazel", "pkg/planner/core/casetest/scalarsubquery/testdata/plan_suite_in.json", "pkg/planner/core/casetest/scalarsubquery/testdata/plan_suite_out.json", "pkg/planner/core/casetest/testdata/integration_suite_in.json", "pkg/planner/core/casetest/testdata/integration_suite_out.json", "pkg/planner/core/casetest/testdata/json_plan_suite_in.json", "pkg/planner/core/casetest/testdata/json_plan_suite_out.json", "pkg/planner/core/casetest/testdata/plan_normalized_suite_in.json", "pkg/planner/core/casetest/testdata/plan_normalized_suite_out.json", "pkg/planner/core/casetest/testdata/stats_suite_in.json", "pkg/planner/core/casetest/testdata/stats_suite_out.json", "pkg/planner/core/casetest/windows/BUILD.bazel", "pkg/planner/core/casetest/windows/testdata/window_push_down_suite_in.json", "pkg/planner/core/casetest/windows/testdata/window_push_down_suite_out.json", "pkg/planner/core/collect_column_stats_usage.go", "pkg/planner/core/common_plans.go", "pkg/planner/core/constraint/BUILD.bazel", "pkg/planner/core/constraint/exprs.go", "pkg/planner/core/core_init.go", "pkg/planner/core/cost/BUILD.bazel", "pkg/planner/core/cost/factors_thresholds.go", "pkg/planner/core/debugtrace.go", "pkg/planner/core/encode.go", "pkg/planner/core/exhaust_physical_plans.go", "pkg/planner/core/explain.go", "pkg/planner/core/expression_codec_fn.go", "pkg/planner/core/expression_rewriter.go", "pkg/planner/core/find_best_task.go", "pkg/planner/core/flat_plan.go", "pkg/planner/core/foreign_key.go", "pkg/planner/core/fragment.go", "pkg/planner/core/hashcode.go", "pkg/planner/core/hint_utils.go", "pkg/planner/core/index_join_path.go", "pkg/planner/core/indexmerge_path.go", "pkg/planner/core/indexmerge_unfinished_path.go", "pkg/planner/core/initialize.go", "pkg/planner/core/issuetest/BUILD.bazel", "pkg/planner/core/logical_datasource.go", "pkg/planner/core/logical_index_scan.go", "pkg/planner/core/logical_initialize.go", "pkg/planner/core/logical_plan_builder.go", "pkg/planner/core/logical_plans.go", "pkg/planner/core/logical_table_scan.go", "pkg/planner/core/logical_tikv_single_gather.go", "pkg/planner/core/memtable_infoschema_extractor.go", "pkg/planner/core/memtable_predicate_extractor.go", "pkg/planner/core/metrics/BUILD.bazel", "pkg/planner/core/metrics/metrics.go", "pkg/planner/core/mock.go", "pkg/planner/core/operator/baseimpl/BUILD.bazel", "pkg/planner/core/operator/baseimpl/plan.go", "pkg/planner/core/operator/logicalop/BUILD.bazel", "pkg/planner/core/operator/logicalop/base_logical_plan.go", "pkg/planner/core/operator/logicalop/logical_aggregation.go", "pkg/planner/core/operator/logicalop/logical_apply.go", "pkg/planner/core/operator/logicalop/logical_cte.go", "pkg/planner/core/operator/logicalop/logical_cte_table.go", "pkg/planner/core/operator/logicalop/logical_expand.go", "pkg/planner/core/operator/logicalop/logical_join.go", "pkg/planner/core/operator/logicalop/logical_limit.go", "pkg/planner/core/operator/logicalop/logical_lock.go", "pkg/planner/core/operator/logicalop/logical_max_one_row.go", "pkg/planner/core/operator/logicalop/logical_mem_table.go", "pkg/planner/core/operator/logicalop/logical_partition_union_all.go", "pkg/planner/core/operator/logicalop/logical_projection.go", "pkg/planner/core/operator/logicalop/logical_schema_producer.go", "pkg/planner/core/operator/logicalop/logical_selection.go", "pkg/planner/core/operator/logicalop/logical_sequence.go", "pkg/planner/core/operator/logicalop/logical_show.go", "pkg/planner/core/operator/logicalop/logical_show_ddl_jobs.go", "pkg/planner/core/operator/logicalop/logical_sort.go", "pkg/planner/core/operator/logicalop/logical_table_dual.go", "pkg/planner/core/operator/logicalop/logical_top_n.go", "pkg/planner/core/operator/logicalop/logical_union_all.go", "pkg/planner/core/operator/logicalop/logical_union_scan.go", "pkg/planner/core/operator/logicalop/logical_window.go", "pkg/planner/core/operator/logicalop/logicalop_test/BUILD.bazel", "pkg/planner/core/operator/physicalop/BUILD.bazel", "pkg/planner/core/operator/physicalop/base_physical_plan.go", "pkg/planner/core/optimizer.go", "pkg/planner/core/partition_prune.go", "pkg/planner/core/pb_to_plan.go", "pkg/planner/core/physical_plans.go", "pkg/planner/core/plan.go", "pkg/planner/core/plan_cache.go", "pkg/planner/core/plan_cache_instance.go", "pkg/planner/core/plan_cache_lru.go", "pkg/planner/core/plan_cache_param.go", "pkg/planner/core/plan_cache_rebuild.go", "pkg/planner/core/plan_cache_utils.go", "pkg/planner/core/plan_cacheable_checker.go", "pkg/planner/core/plan_clone_generated.go", "pkg/planner/core/plan_clone_generator.go", "pkg/planner/core/plan_cost_detail.go", "pkg/planner/core/plan_cost_ver1.go", "pkg/planner/core/plan_cost_ver2.go", "pkg/planner/core/plan_to_pb.go", "pkg/planner/core/planbuilder.go", "pkg/planner/core/point_get_plan.go", "pkg/planner/core/preprocess.go", "pkg/planner/core/property_cols_prune.go", "pkg/planner/core/recheck_cte.go", "pkg/planner/core/resolve/BUILD.bazel", "pkg/planner/core/resolve/resolve.go", "pkg/planner/core/resolve/result.go", "pkg/planner/core/resolve_indices.go", "pkg/planner/core/rule/BUILD.bazel", "pkg/planner/core/rule/logical_rules.go", "pkg/planner/core/rule/rule_build_key_info.go", "pkg/planner/core/rule/rule_constant_propagation.go", "pkg/planner/core/rule/rule_init.go", "pkg/planner/core/rule/util/BUILD.bazel", "pkg/planner/core/rule/util/build_key_info_misc.go", "pkg/planner/core/rule/util/misc.go", "pkg/planner/core/rule_aggregation_elimination.go", "pkg/planner/core/rule_aggregation_push_down.go", "pkg/planner/core/rule_aggregation_skew_rewrite.go", "pkg/planner/core/rule_collect_plan_stats.go", "pkg/planner/core/rule_column_pruning.go", "pkg/planner/core/rule_decorrelate.go", "pkg/planner/core/rule_derive_topn_from_window.go", "pkg/planner/core/rule_eliminate_projection.go", "pkg/planner/core/rule_generate_column_substitute.go", "pkg/planner/core/rule_inject_extra_projection.go", "pkg/planner/core/rule_join_elimination.go", "pkg/planner/core/rule_join_reorder.go", "pkg/planner/core/rule_join_reorder_dp.go", "pkg/planner/core/rule_join_reorder_greedy.go", "pkg/planner/core/rule_max_min_eliminate.go", "pkg/planner/core/rule_outer_to_inner_join.go", "pkg/planner/core/rule_partition_processor.go", "pkg/planner/core/rule_predicate_push_down.go", "pkg/planner/core/rule_predicate_simplification.go", "pkg/planner/core/rule_push_down_sequence.go", "pkg/planner/core/rule_resolve_grouping_expand.go", "pkg/planner/core/rule_result_reorder.go", "pkg/planner/core/rule_semi_join_rewrite.go", "pkg/planner/core/rule_topn_push_down.go", "pkg/planner/core/runtime_filter.go", "pkg/planner/core/runtime_filter_generator.go", "pkg/planner/core/scalar_subq_expression.go", "pkg/planner/core/show_predicate_extractor.go", "pkg/planner/core/stats.go", "pkg/planner/core/stringer.go", "pkg/planner/core/task.go", "pkg/planner/core/task_base.go", "pkg/planner/core/testdata/index_merge_suite_in.json", "pkg/planner/core/testdata/index_merge_suite_out.json", "pkg/planner/core/testdata/plan_cache_suite_in.json", "pkg/planner/core/testdata/plan_cache_suite_out.json", "pkg/planner/core/testdata/plan_suite_unexported_in.json", "pkg/planner/core/testdata/plan_suite_unexported_out.json", "pkg/planner/core/testdata/runtime_filter_generator_suite_in.json", "pkg/planner/core/testdata/runtime_filter_generator_suite_out.json", "pkg/planner/core/tiflash_selection_late_materialization.go", "pkg/planner/core/trace.go", "pkg/planner/core/util.go", "pkg/planner/funcdep/BUILD.bazel", "pkg/planner/funcdep/doc.go", "pkg/planner/funcdep/fd_graph.go", "pkg/planner/implementation/BUILD.bazel", "pkg/planner/implementation/base.go", "pkg/planner/implementation/datasource.go", "pkg/planner/implementation/join.go", "pkg/planner/implementation/simple_plans.go", "pkg/planner/implementation/sort.go", "pkg/planner/indexadvisor/BUILD.bazel", "pkg/planner/indexadvisor/algorithm.go", "pkg/planner/indexadvisor/indexadvisor.go", "pkg/planner/indexadvisor/model.go", "pkg/planner/indexadvisor/optimizer.go", "pkg/planner/indexadvisor/options.go", "pkg/planner/indexadvisor/utils.go", "pkg/planner/memo/BUILD.bazel", "pkg/planner/memo/expr_iterator.go", "pkg/planner/memo/group.go", "pkg/planner/memo/group_expr.go", "pkg/planner/memo/implementation.go", "pkg/planner/optimize.go", "pkg/planner/pattern/BUILD.bazel", "pkg/planner/pattern/engine.go", "pkg/planner/pattern/pattern.go", "pkg/planner/planctx/BUILD.bazel", "pkg/planner/planctx/context.go", "pkg/planner/plannersession/BUILD.bazel", "pkg/planner/plannersession/context.go", "pkg/planner/property/BUILD.bazel", "pkg/planner/property/logical_property.go", "pkg/planner/property/physical_property.go", "pkg/planner/property/stats_info.go", "pkg/planner/property/task_type.go", "pkg/planner/task/BUILD.bazel", "pkg/planner/task/task.go", "pkg/planner/task/task_scheduler.go", "pkg/planner/util/BUILD.bazel", "pkg/planner/util/byitem.go", "pkg/planner/util/coretestsdk/BUILD.bazel", "pkg/planner/util/coretestsdk/testkit.go", "pkg/planner/util/coreusage/BUILD.bazel", "pkg/planner/util/coreusage/cast_misc.go", "pkg/planner/util/coreusage/correlated_misc.go", "pkg/planner/util/costusage/BUILD.bazel", "pkg/planner/util/costusage/cost_misc.go", "pkg/planner/util/debugtrace/BUILD.bazel", "pkg/planner/util/debugtrace/base.go", "pkg/planner/util/explain_misc.go", "pkg/planner/util/expression.go", "pkg/planner/util/fixcontrol/BUILD.bazel", "pkg/planner/util/fixcontrol/get.go", "pkg/planner/util/fixcontrol/set.go", "pkg/planner/util/fixcontrol/testdata/fix_control_suite_in.json", "pkg/planner/util/fixcontrol/testdata/fix_control_suite_out.json", "pkg/planner/util/funcdep_misc.go", "pkg/planner/util/handle_cols.go", "pkg/planner/util/misc.go", "pkg/planner/util/null_misc.go", "pkg/planner/util/optimizetrace/BUILD.bazel", "pkg/planner/util/optimizetrace/logicaltrace/BUILD.bazel", "pkg/planner/util/optimizetrace/logicaltrace/logical_tracer.go", "pkg/planner/util/optimizetrace/opt_tracer.go", "pkg/planner/util/path.go", "pkg/planner/util/tablesampler/BUILD.bazel", "pkg/planner/util/tablesampler/sample.go", "pkg/planner/util/utilfuncp/BUILD.bazel", "pkg/planner/util/utilfuncp/func_pointer_misc.go", "pkg/plugin/BUILD.bazel", "pkg/plugin/README.md", "pkg/plugin/audit.go", "pkg/plugin/conn_ip_example/BUILD.bazel", "pkg/plugin/conn_ip_example/conn_ip_example.go", "pkg/plugin/conn_ip_example/manifest.toml", "pkg/plugin/const.go", "pkg/plugin/errors.go", "pkg/plugin/helper.go", "pkg/plugin/plugin.go", "pkg/plugin/spi.go", "pkg/privilege/BUILD.bazel", "pkg/privilege/conn/BUILD.bazel", "pkg/privilege/conn/conn.go", "pkg/privilege/privilege.go", "pkg/privilege/privileges/BUILD.bazel", "pkg/privilege/privileges/cache.go", "pkg/privilege/privileges/errors.go", "pkg/privilege/privileges/ldap/BUILD.bazel", "pkg/privilege/privileges/ldap/const.go", "pkg/privilege/privileges/ldap/ldap_common.go", "pkg/privilege/privileges/ldap/sasl.go", "pkg/privilege/privileges/ldap/simple.go", "pkg/privilege/privileges/privileges.go", "pkg/privilege/privileges/tidb_auth_token.go", "pkg/resourcegroup/BUILD.bazel", "pkg/resourcegroup/checker.go", "pkg/resourcegroup/runaway/BUILD.bazel", "pkg/resourcegroup/runaway/checker.go", "pkg/resourcegroup/runaway/manager.go", "pkg/resourcegroup/runaway/record.go", "pkg/resourcegroup/runaway/syncer.go", "pkg/resourcemanager/BUILD.bazel", "pkg/resourcemanager/OWNERS", "pkg/resourcemanager/pool/BUILD.bazel", "pkg/resourcemanager/pool/basepool.go", "pkg/resourcemanager/pool/spool/BUILD.bazel", "pkg/resourcemanager/pool/spool/option.go", "pkg/resourcemanager/pool/spool/spool.go", "pkg/resourcemanager/pool/workerpool/BUILD.bazel", "pkg/resourcemanager/pool/workerpool/workerpool.go", "pkg/resourcemanager/poolmanager/BUILD.bazel", "pkg/resourcemanager/poolmanager/task_manager.go", "pkg/resourcemanager/poolmanager/task_manager_iterator.go", "pkg/resourcemanager/poolmanager/task_manager_scheduler.go", "pkg/resourcemanager/rm.go", "pkg/resourcemanager/schedule.go", "pkg/resourcemanager/scheduler/BUILD.bazel", "pkg/resourcemanager/scheduler/cpu_scheduler.go", "pkg/resourcemanager/scheduler/scheduler.go", "pkg/resourcemanager/util/BUILD.bazel", "pkg/resourcemanager/util/mock_gpool.go", "pkg/resourcemanager/util/shard_pool_map.go", "pkg/resourcemanager/util/util.go", "pkg/server/BUILD.bazel", "pkg/server/conn.go", "pkg/server/conn_stmt.go", "pkg/server/conn_stmt_params.go", "pkg/server/driver.go", "pkg/server/driver_tidb.go", "pkg/server/err/BUILD.bazel", "pkg/server/err/error.go", "pkg/server/extension.go", "pkg/server/extract.go", "pkg/server/handler/BUILD.bazel", "pkg/server/handler/extractorhandler/BUILD.bazel", "pkg/server/handler/extractorhandler/extractor.go", "pkg/server/handler/optimizor/BUILD.bazel", "pkg/server/handler/optimizor/optimize_trace.go", "pkg/server/handler/optimizor/plan_replayer.go", "pkg/server/handler/optimizor/statistics_handler.go", "pkg/server/handler/tikv_handler.go", "pkg/server/handler/tikvhandler/BUILD.bazel", "pkg/server/handler/tikvhandler/tikv_handler.go", "pkg/server/handler/ttlhandler/BUILD.bazel", "pkg/server/handler/ttlhandler/ttl.go", "pkg/server/handler/upgrade_handler.go", "pkg/server/handler/util.go", "pkg/server/http_handler.go", "pkg/server/http_status.go", "pkg/server/internal/BUILD.bazel", "pkg/server/internal/column/BUILD.bazel", "pkg/server/internal/column/column.go", "pkg/server/internal/column/convert.go", "pkg/server/internal/column/result_encoder.go", "pkg/server/internal/dump/BUILD.bazel", "pkg/server/internal/dump/dump.go", "pkg/server/internal/handshake/BUILD.bazel", "pkg/server/internal/handshake/handshake.go", "pkg/server/internal/packetio.go", "pkg/server/internal/parse/BUILD.bazel", "pkg/server/internal/parse/parse.go", "pkg/server/internal/resultset/BUILD.bazel", "pkg/server/internal/resultset/cursor.go", "pkg/server/internal/resultset/resultset.go", "pkg/server/internal/testserverclient/BUILD.bazel", "pkg/server/internal/testserverclient/server_client.go", "pkg/server/internal/testutil/BUILD.bazel", "pkg/server/internal/testutil/testutil.go", "pkg/server/internal/util/BUILD.bazel", "pkg/server/internal/util/buffered_read_conn.go", "pkg/server/internal/util/util.go", "pkg/server/metrics/BUILD.bazel", "pkg/server/metrics/metrics.go", "pkg/server/mock_conn.go", "pkg/server/rpc_server.go", "pkg/server/server.go", "pkg/server/stat.go", "pkg/server/testdata/optimizer_suite_in.json", "pkg/server/testdata/optimizer_suite_out.json", "pkg/session/BUILD.bazel", "pkg/session/OWNERS", "pkg/session/advisory_locks.go", "pkg/session/bootstrap.go", "pkg/session/bootstraptest/BUILD.bazel", "pkg/session/clusteredindextest/BUILD.bazel", "pkg/session/contextimpl.go", "pkg/session/cursor/BUILD.bazel", "pkg/session/cursor/state.go", "pkg/session/cursor/tracker.go", "pkg/session/metrics/BUILD.bazel", "pkg/session/metrics/metrics.go", "pkg/session/mock_bootstrap.go", "pkg/session/nontransactional.go", "pkg/session/nontransactionaltest/BUILD.bazel", "pkg/session/resourcegrouptest/BUILD.bazel", "pkg/session/schematest/BUILD.bazel", "pkg/session/session.go", "pkg/session/sync_upgrade.go", "pkg/session/temporarytabletest/BUILD.bazel", "pkg/session/testutil.go", "pkg/session/tidb.go", "pkg/session/txn.go", "pkg/session/txninfo/BUILD.bazel", "pkg/session/txninfo/summary.go", "pkg/session/txninfo/txn_info.go", "pkg/session/txnmanager.go", "pkg/session/types/BUILD.bazel", "pkg/session/types/sesson_interface.go", "pkg/sessionctx/BUILD.bazel", "pkg/sessionctx/context.go", "pkg/sessionctx/sessionstates/BUILD.bazel", "pkg/sessionctx/sessionstates/session_states.go", "pkg/sessionctx/sessionstates/session_token.go", "pkg/sessionctx/stmtctx/BUILD.bazel", "pkg/sessionctx/stmtctx/stmtctx.go", "pkg/sessionctx/sysproctrack/BUILD.bazel", "pkg/sessionctx/sysproctrack/track.go", "pkg/sessionctx/variable/BUILD.bazel", "pkg/sessionctx/variable/OWNERS", "pkg/sessionctx/variable/error.go", "pkg/sessionctx/variable/mock_globalaccessor.go", "pkg/sessionctx/variable/noop.go", "pkg/sessionctx/variable/removed.go", "pkg/sessionctx/variable/sequence_state.go", "pkg/sessionctx/variable/session.go", "pkg/sessionctx/variable/setvar_affect.go", "pkg/sessionctx/variable/statusvar.go", "pkg/sessionctx/variable/sysvar.go", "pkg/sessionctx/variable/tidb_vars.go", "pkg/sessionctx/variable/variable.go", "pkg/sessionctx/variable/varsutil.go", "pkg/sessiontxn/BUILD.bazel", "pkg/sessiontxn/failpoint.go", "pkg/sessiontxn/future.go", "pkg/sessiontxn/interface.go", "pkg/sessiontxn/internal/BUILD.bazel", "pkg/sessiontxn/internal/txn.go", "pkg/sessiontxn/isolation/BUILD.bazel", "pkg/sessiontxn/isolation/base.go", "pkg/sessiontxn/isolation/metrics/BUILD.bazel", "pkg/sessiontxn/isolation/metrics/metrics.go", "pkg/sessiontxn/isolation/optimistic.go", "pkg/sessiontxn/isolation/readcommitted.go", "pkg/sessiontxn/isolation/repeatable_read.go", "pkg/sessiontxn/isolation/serializable.go", "pkg/sessiontxn/staleread/BUILD.bazel", "pkg/sessiontxn/staleread/errors.go", "pkg/sessiontxn/staleread/failpoint.go", "pkg/sessiontxn/staleread/processor.go", "pkg/sessiontxn/staleread/provider.go", "pkg/sessiontxn/staleread/util.go", "pkg/statistics/BUILD.bazel", "pkg/statistics/OWNERS", "pkg/statistics/analyze.go", "pkg/statistics/analyze_jobs.go", "pkg/statistics/asyncload/BUILD.bazel", "pkg/statistics/asyncload/async_load.go", "pkg/statistics/builder.go", "pkg/statistics/builder_ext_stats.go", "pkg/statistics/cmsketch.go", "pkg/statistics/cmsketch_util.go", "pkg/statistics/column.go", "pkg/statistics/debugtrace.go", "pkg/statistics/estimate.go", "pkg/statistics/fmsketch.go", "pkg/statistics/handle/BUILD.bazel", "pkg/statistics/handle/autoanalyze/BUILD.bazel", "pkg/statistics/handle/autoanalyze/autoanalyze.go", "pkg/statistics/handle/autoanalyze/exec/BUILD.bazel", "pkg/statistics/handle/autoanalyze/exec/exec.go", "pkg/statistics/handle/autoanalyze/internal/heap/BUILD.bazel", "pkg/statistics/handle/autoanalyze/internal/heap/heap.go", "pkg/statistics/handle/autoanalyze/priorityqueue/BUILD.bazel", "pkg/statistics/handle/autoanalyze/priorityqueue/analysis_job_factory.go", "pkg/statistics/handle/autoanalyze/priorityqueue/calculator.go", "pkg/statistics/handle/autoanalyze/priorityqueue/calculatoranalysis/BUILD.bazel", "pkg/statistics/handle/autoanalyze/priorityqueue/calculatoranalysis/README.md", "pkg/statistics/handle/autoanalyze/priorityqueue/calculatoranalysis/testdata/calculated_priorities.golden.csv", "pkg/statistics/handle/autoanalyze/priorityqueue/dynamic_partitioned_table_analysis_job.go", "pkg/statistics/handle/autoanalyze/priorityqueue/interval.go", "pkg/statistics/handle/autoanalyze/priorityqueue/job.go", "pkg/statistics/handle/autoanalyze/priorityqueue/non_partitioned_table_analysis_job.go", "pkg/statistics/handle/autoanalyze/priorityqueue/queue.go", "pkg/statistics/handle/autoanalyze/priorityqueue/static_partitioned_table_analysis_job.go", "pkg/statistics/handle/autoanalyze/refresher/BUILD.bazel", "pkg/statistics/handle/autoanalyze/refresher/refresher.go", "pkg/statistics/handle/autoanalyze/refresher/worker.go", "pkg/statistics/handle/bootstrap.go", "pkg/statistics/handle/cache/BUILD.bazel", "pkg/statistics/handle/cache/internal/BUILD.bazel", "pkg/statistics/handle/cache/internal/inner.go", "pkg/statistics/handle/cache/internal/lfu/BUILD.bazel", "pkg/statistics/handle/cache/internal/lfu/key_set.go", "pkg/statistics/handle/cache/internal/lfu/key_set_shard.go", "pkg/statistics/handle/cache/internal/lfu/lfu_cache.go", "pkg/statistics/handle/cache/internal/mapcache/BUILD.bazel", "pkg/statistics/handle/cache/internal/mapcache/map_cache.go", "pkg/statistics/handle/cache/internal/metrics/BUILD.bazel", "pkg/statistics/handle/cache/internal/metrics/metrics.go", "pkg/statistics/handle/cache/internal/testutil/BUILD.bazel", "pkg/statistics/handle/cache/internal/testutil/testutil.go", "pkg/statistics/handle/cache/stats_table_row_cache.go", "pkg/statistics/handle/cache/statscache.go", "pkg/statistics/handle/cache/statscacheinner.go", "pkg/statistics/handle/ddl/BUILD.bazel", "pkg/statistics/handle/ddl/ddl.go", "pkg/statistics/handle/ddl/drop_partition.go", "pkg/statistics/handle/ddl/exchange_partition.go", "pkg/statistics/handle/ddl/reorganize_partition.go", "pkg/statistics/handle/ddl/truncate_partition.go", "pkg/statistics/handle/globalstats/BUILD.bazel", "pkg/statistics/handle/globalstats/global_stats.go", "pkg/statistics/handle/globalstats/global_stats_async.go", "pkg/statistics/handle/globalstats/merge_worker.go", "pkg/statistics/handle/globalstats/topn.go", "pkg/statistics/handle/handle.go", "pkg/statistics/handle/handletest/BUILD.bazel", "pkg/statistics/handle/handletest/analyze/BUILD.bazel", "pkg/statistics/handle/handletest/lockstats/BUILD.bazel", "pkg/statistics/handle/handletest/statstest/BUILD.bazel", "pkg/statistics/handle/history/BUILD.bazel", "pkg/statistics/handle/history/history_stats.go", "pkg/statistics/handle/initstats/BUILD.bazel", "pkg/statistics/handle/initstats/load_stats.go", "pkg/statistics/handle/initstats/load_stats_page.go", "pkg/statistics/handle/internal/BUILD.bazel", "pkg/statistics/handle/internal/testutil.go", "pkg/statistics/handle/lockstats/BUILD.bazel", "pkg/statistics/handle/lockstats/lock_stats.go", "pkg/statistics/handle/lockstats/query_lock.go", "pkg/statistics/handle/lockstats/unlock_stats.go", "pkg/statistics/handle/logutil/BUILD.bazel", "pkg/statistics/handle/logutil/logutil.go", "pkg/statistics/handle/metrics/BUILD.bazel", "pkg/statistics/handle/metrics/metrics.go", "pkg/statistics/handle/storage/BUILD.bazel", "pkg/statistics/handle/storage/gc.go", "pkg/statistics/handle/storage/json.go", "pkg/statistics/handle/storage/read.go", "pkg/statistics/handle/storage/save.go", "pkg/statistics/handle/storage/stats_read_writer.go", "pkg/statistics/handle/storage/update.go", "pkg/statistics/handle/syncload/BUILD.bazel", "pkg/statistics/handle/syncload/stats_syncload.go", "pkg/statistics/handle/types/BUILD.bazel", "pkg/statistics/handle/types/interfaces.go", "pkg/statistics/handle/updatetest/BUILD.bazel", "pkg/statistics/handle/usage/BUILD.bazel", "pkg/statistics/handle/usage/collector/BUILD.bazel", "pkg/statistics/handle/usage/collector/collector.go", "pkg/statistics/handle/usage/index_usage.go", "pkg/statistics/handle/usage/indexusage/BUILD.bazel", "pkg/statistics/handle/usage/indexusage/collector.go", "pkg/statistics/handle/usage/predicate_column.go", "pkg/statistics/handle/usage/predicatecolumn/BUILD.bazel", "pkg/statistics/handle/usage/predicatecolumn/predicate_column.go", "pkg/statistics/handle/usage/session_stats_collect.go", "pkg/statistics/handle/util/BUILD.bazel", "pkg/statistics/handle/util/auto_analyze_proc_id_generator.go", "pkg/statistics/handle/util/lease_getter.go", "pkg/statistics/handle/util/pool.go", "pkg/statistics/handle/util/table_info.go", "pkg/statistics/handle/util/util.go", "pkg/statistics/histogram.go", "pkg/statistics/index.go", "pkg/statistics/row_sampler.go", "pkg/statistics/sample.go", "pkg/statistics/scalar.go", "pkg/statistics/table.go", "pkg/statistics/testdata/integration_suite_in.json", "pkg/statistics/testdata/integration_suite_out.json", "pkg/store/BUILD.bazel", "pkg/store/copr/BUILD.bazel", "pkg/store/copr/batch_coprocessor.go", "pkg/store/copr/batch_request_sender.go", "pkg/store/copr/copr_test/BUILD.bazel", "pkg/store/copr/coprocessor.go", "pkg/store/copr/coprocessor_cache.go", "pkg/store/copr/key_ranges.go", "pkg/store/copr/metrics/BUILD.bazel", "pkg/store/copr/metrics/metrics.go", "pkg/store/copr/mpp.go", "pkg/store/copr/mpp_probe.go", "pkg/store/copr/region_cache.go", "pkg/store/copr/store.go", "pkg/store/driver/BUILD.bazel", "pkg/store/driver/backoff/BUILD.bazel", "pkg/store/driver/backoff/backoff.go", "pkg/store/driver/error/BUILD.bazel", "pkg/store/driver/error/error.go", "pkg/store/driver/options/BUILD.bazel", "pkg/store/driver/options/options.go", "pkg/store/driver/tikv_driver.go", "pkg/store/driver/txn/BUILD.bazel", "pkg/store/driver/txn/batch_getter.go", "pkg/store/driver/txn/error.go", "pkg/store/driver/txn/scanner.go", "pkg/store/driver/txn/snapshot.go", "pkg/store/driver/txn/txn_driver.go", "pkg/store/driver/txn/union_iter.go", "pkg/store/driver/txn/unionstore_driver.go", "pkg/store/gcworker/BUILD.bazel", "pkg/store/gcworker/gc_worker.go", "pkg/store/helper/BUILD.bazel", "pkg/store/helper/helper.go", "pkg/store/mockstore/BUILD.bazel", "pkg/store/mockstore/mockcopr/BUILD.bazel", "pkg/store/mockstore/mockcopr/aggregate.go", "pkg/store/mockstore/mockcopr/analyze.go", "pkg/store/mockstore/mockcopr/checksum.go", "pkg/store/mockstore/mockcopr/cop_handler_dag.go", "pkg/store/mockstore/mockcopr/copr_handler.go", "pkg/store/mockstore/mockcopr/executor.go", "pkg/store/mockstore/mockcopr/rpc_copr.go", "pkg/store/mockstore/mockcopr/topn.go", "pkg/store/mockstore/mockstorage/BUILD.bazel", "pkg/store/mockstore/mockstorage/storage.go", "pkg/store/mockstore/mockstore.go", "pkg/store/mockstore/redirector.go", "pkg/store/mockstore/tikv.go", "pkg/store/mockstore/unistore/BUILD.bazel", "pkg/store/mockstore/unistore/client/BUILD.bazel", "pkg/store/mockstore/unistore/client/client.go", "pkg/store/mockstore/unistore/cluster.go", "pkg/store/mockstore/unistore/config/BUILD.bazel", "pkg/store/mockstore/unistore/config/config-template.toml", "pkg/store/mockstore/unistore/config/config.go", "pkg/store/mockstore/unistore/cophandler/BUILD.bazel", "pkg/store/mockstore/unistore/cophandler/analyze.go", "pkg/store/mockstore/unistore/cophandler/closure_exec.go", "pkg/store/mockstore/unistore/cophandler/cop_handler.go", "pkg/store/mockstore/unistore/cophandler/mpp.go", "pkg/store/mockstore/unistore/cophandler/mpp_exec.go", "pkg/store/mockstore/unistore/cophandler/topn.go", "pkg/store/mockstore/unistore/lockstore/BUILD.bazel", "pkg/store/mockstore/unistore/lockstore/arena.go", "pkg/store/mockstore/unistore/lockstore/iterator.go", "pkg/store/mockstore/unistore/lockstore/load_dump.go", "pkg/store/mockstore/unistore/lockstore/lockstore.go", "pkg/store/mockstore/unistore/metrics/BUILD.bazel", "pkg/store/mockstore/unistore/metrics/metrics.go", "pkg/store/mockstore/unistore/mock.go", "pkg/store/mockstore/unistore/pd/BUILD.bazel", "pkg/store/mockstore/unistore/pd/client.go", "pkg/store/mockstore/unistore/pd.go", "pkg/store/mockstore/unistore/raw_handler.go", "pkg/store/mockstore/unistore/rpc.go", "pkg/store/mockstore/unistore/server/BUILD.bazel", "pkg/store/mockstore/unistore/server/server.go", "pkg/store/mockstore/unistore/testutil.go", "pkg/store/mockstore/unistore/tikv/BUILD.bazel", "pkg/store/mockstore/unistore/tikv/dbreader/BUILD.bazel", "pkg/store/mockstore/unistore/tikv/dbreader/db_reader.go", "pkg/store/mockstore/unistore/tikv/deadlock.go", "pkg/store/mockstore/unistore/tikv/detector.go", "pkg/store/mockstore/unistore/tikv/inner_server.go", "pkg/store/mockstore/unistore/tikv/kverrors/BUILD.bazel", "pkg/store/mockstore/unistore/tikv/kverrors/errors.go", "pkg/store/mockstore/unistore/tikv/mock_region.go", "pkg/store/mockstore/unistore/tikv/mvcc/BUILD.bazel", "pkg/store/mockstore/unistore/tikv/mvcc/db_writer.go", "pkg/store/mockstore/unistore/tikv/mvcc/mvcc.go", "pkg/store/mockstore/unistore/tikv/mvcc/tikv.go", "pkg/store/mockstore/unistore/tikv/mvcc.go", "pkg/store/mockstore/unistore/tikv/pberror/BUILD.bazel", "pkg/store/mockstore/unistore/tikv/pberror/pberror.go", "pkg/store/mockstore/unistore/tikv/region.go", "pkg/store/mockstore/unistore/tikv/server.go", "pkg/store/mockstore/unistore/tikv/server_batch.go", "pkg/store/mockstore/unistore/tikv/util.go", "pkg/store/mockstore/unistore/tikv/write.go", "pkg/store/mockstore/unistore/util/lockwaiter/BUILD.bazel", "pkg/store/mockstore/unistore/util/lockwaiter/lockwaiter.go", "pkg/store/mockstore/unistore.go", "pkg/store/pdtypes/BUILD.bazel", "pkg/store/pdtypes/api.go", "pkg/store/pdtypes/config.go", "pkg/store/pdtypes/placement.go", "pkg/store/pdtypes/region_tree.go", "pkg/store/pdtypes/statistics.go", "pkg/store/pdtypes/typeutil.go", "pkg/store/store.go", "pkg/structure/BUILD.bazel", "pkg/structure/hash.go", "pkg/structure/list.go", "pkg/structure/string.go", "pkg/structure/structure.go", "pkg/structure/type.go", "pkg/table/BUILD.bazel", "pkg/table/OWNERS", "pkg/table/column.go", "pkg/table/constraint.go", "pkg/table/index.go", "pkg/table/table.go", "pkg/table/tables/BUILD.bazel", "pkg/table/tables/cache.go", "pkg/table/tables/index.go", "pkg/table/tables/mutation_checker.go", "pkg/table/tables/partition.go", "pkg/table/tables/state_remote.go", "pkg/table/tables/tables.go", "pkg/table/tables/testutil.go", "pkg/table/tblctx/BUILD.bazel", "pkg/table/tblctx/buffers.go", "pkg/table/tblctx/table.go", "pkg/table/tblsession/BUILD.bazel", "pkg/table/tblsession/table.go", "pkg/table/temptable/BUILD.bazel", "pkg/table/temptable/ddl.go", "pkg/table/temptable/infoschema.go", "pkg/table/temptable/interceptor.go", "pkg/tablecodec/BUILD.bazel", "pkg/tablecodec/OWNERS", "pkg/tablecodec/rowindexcodec/BUILD.bazel", "pkg/tablecodec/rowindexcodec/rowindexcodec.go", "pkg/tablecodec/tablecodec.go", "pkg/testkit/BUILD.bazel", "pkg/testkit/analyzehelper/BUILD.bazel", "pkg/testkit/analyzehelper/helper.go", "pkg/testkit/asynctestkit.go", "pkg/testkit/dbtestkit.go", "pkg/testkit/ddlhelper/BUILD.bazel", "pkg/testkit/ddlhelper/helper.go", "pkg/testkit/external/BUILD.bazel", "pkg/testkit/external/util.go", "pkg/testkit/mocksessionmanager.go", "pkg/testkit/mockstore.go", "pkg/testkit/result.go", "pkg/testkit/stepped.go", "pkg/testkit/testdata/BUILD.bazel", "pkg/testkit/testdata/testdata.go", "pkg/testkit/testenv/BUILD.bazel", "pkg/testkit/testenv/testenv.go", "pkg/testkit/testfailpoint/BUILD.bazel", "pkg/testkit/testfailpoint/failpoint.go", "pkg/testkit/testfork/BUILD.bazel", "pkg/testkit/testfork/fork.go", "pkg/testkit/testkit.go", "pkg/testkit/testmain/BUILD.bazel", "pkg/testkit/testmain/bench.go", "pkg/testkit/testmain/wrapper.go", "pkg/testkit/testsetup/BUILD.bazel", "pkg/testkit/testsetup/bridge.go", "pkg/testkit/testutil/BUILD.bazel", "pkg/testkit/testutil/handle.go", "pkg/testkit/testutil/loghook.go", "pkg/testkit/testutil/require.go", "pkg/timer/BUILD.bazel", "pkg/timer/README.md", "pkg/timer/api/BUILD.bazel", "pkg/timer/api/client.go", "pkg/timer/api/error.go", "pkg/timer/api/hook.go", "pkg/timer/api/mem_store.go", "pkg/timer/api/store.go", "pkg/timer/api/timer.go", "pkg/timer/metrics/BUILD.bazel", "pkg/timer/metrics/metrics.go", "pkg/timer/runtime/BUILD.bazel", "pkg/timer/runtime/cache.go", "pkg/timer/runtime/runtime.go", "pkg/timer/runtime/worker.go", "pkg/timer/tablestore/BUILD.bazel", "pkg/timer/tablestore/notifier.go", "pkg/timer/tablestore/sql.go", "pkg/timer/tablestore/store.go", "pkg/ttl/cache/BUILD.bazel", "pkg/ttl/cache/base.go", "pkg/ttl/cache/infoschema.go", "pkg/ttl/cache/table.go", "pkg/ttl/cache/task.go", "pkg/ttl/cache/ttlstatus.go", "pkg/ttl/client/BUILD.bazel", "pkg/ttl/client/command.go", "pkg/ttl/client/notification.go", "pkg/ttl/metrics/BUILD.bazel", "pkg/ttl/metrics/metrics.go", "pkg/ttl/session/BUILD.bazel", "pkg/ttl/session/session.go", "pkg/ttl/sqlbuilder/BUILD.bazel", "pkg/ttl/sqlbuilder/sql.go", "pkg/ttl/ttlworker/BUILD.bazel", "pkg/ttl/ttlworker/config.go", "pkg/ttl/ttlworker/del.go", "pkg/ttl/ttlworker/job.go", "pkg/ttl/ttlworker/job_manager.go", "pkg/ttl/ttlworker/scan.go", "pkg/ttl/ttlworker/session.go", "pkg/ttl/ttlworker/task_manager.go", "pkg/ttl/ttlworker/timer.go", "pkg/ttl/ttlworker/timer_sync.go", "pkg/ttl/ttlworker/worker.go", "pkg/types/BUILD.bazel", "pkg/types/binary_literal.go", "pkg/types/compare.go", "pkg/types/context.go", "pkg/types/convert.go", "pkg/types/core_time.go", "pkg/types/datum.go", "pkg/types/datum_eval.go", "pkg/types/enum.go", "pkg/types/errors.go", "pkg/types/etc.go", "pkg/types/eval_type.go", "pkg/types/explain_format.go", "pkg/types/field_name.go", "pkg/types/field_type.go", "pkg/types/field_type_builder.go", "pkg/types/fsp.go", "pkg/types/helper.go", "pkg/types/json_binary.go", "pkg/types/json_binary_functions.go", "pkg/types/json_constants.go", "pkg/types/json_path_expr.go", "pkg/types/mydecimal.go", "pkg/types/overflow.go", "pkg/types/parser_driver/BUILD.bazel", "pkg/types/parser_driver/value_expr.go", "pkg/types/set.go", "pkg/types/time.go", "pkg/types/truncate.go", "pkg/types/vector.go", "pkg/types/vector_functions.go", "pkg/util/BUILD.bazel", "pkg/util/admin/BUILD.bazel", "pkg/util/admin/admin.go", "pkg/util/arena/BUILD.bazel", "pkg/util/arena/arena.go", "pkg/util/backoff/BUILD.bazel", "pkg/util/backoff/backoff.go", "pkg/util/benchdaily/BUILD.bazel", "pkg/util/benchdaily/bench_daily.go", "pkg/util/bitmap/BUILD.bazel", "pkg/util/bitmap/concurrent.go", "pkg/util/breakpoint/BUILD.bazel", "pkg/util/breakpoint/breakpoint.go", "pkg/util/cdcutil/BUILD.bazel", "pkg/util/cdcutil/cdc.go", "pkg/util/cgmon/BUILD.bazel", "pkg/util/cgmon/cgmon.go", "pkg/util/cgroup/BUILD.bazel", "pkg/util/cgroup/cgroup.go", "pkg/util/cgroup/cgroup_cpu.go", "pkg/util/cgroup/cgroup_cpu_linux.go", "pkg/util/cgroup/cgroup_cpu_unsupport.go", "pkg/util/cgroup/cgroup_memory.go", "pkg/util/channel/BUILD.bazel", "pkg/util/channel/channel.go", "pkg/util/checksum/BUILD.bazel", "pkg/util/checksum/checksum.go", "pkg/util/chunk/BUILD.bazel", "pkg/util/chunk/alloc.go", "pkg/util/chunk/chunk.go", "pkg/util/chunk/chunk_in_disk.go", "pkg/util/chunk/chunk_util.go", "pkg/util/chunk/codec.go", "pkg/util/chunk/column.go", "pkg/util/chunk/compare.go", "pkg/util/chunk/iterator.go", "pkg/util/chunk/list.go", "pkg/util/chunk/mutrow.go", "pkg/util/chunk/pool.go", "pkg/util/chunk/row.go", "pkg/util/chunk/row_container.go", "pkg/util/chunk/row_container_reader.go", "pkg/util/chunk/row_in_disk.go", "pkg/util/codec/BUILD.bazel", "pkg/util/codec/bytes.go", "pkg/util/codec/codec.go", "pkg/util/codec/decimal.go", "pkg/util/codec/float.go", "pkg/util/codec/number.go", "pkg/util/collate/BUILD.bazel", "pkg/util/collate/bin.go", "pkg/util/collate/charset.go", "pkg/util/collate/collate.go", "pkg/util/collate/gbk_bin.go", "pkg/util/collate/gbk_chinese_ci.go", "pkg/util/collate/gbk_chinese_ci_data.go", "pkg/util/collate/general_ci.go", "pkg/util/collate/pinyin_tidb_as_cs.go", "pkg/util/collate/ucadata/BUILD.bazel", "pkg/util/collate/ucadata/data.go", "pkg/util/collate/ucadata/generator/BUILD.bazel", "pkg/util/collate/ucadata/generator/data.go.tpl", "pkg/util/collate/ucadata/generator/magic.go", "pkg/util/collate/ucadata/generator/main.go", "pkg/util/collate/ucadata/unicode_ci_data_generated.go", "pkg/util/collate/ucaimpl/BUILD.bazel", "pkg/util/collate/ucaimpl/main.go", "pkg/util/collate/ucaimpl/unicode_ci.go.tpl", "pkg/util/collate/unicode_0400_ci_generated.go", "pkg/util/collate/unicode_0400_ci_impl.go", "pkg/util/collate/unicode_0900_ai_ci_generated.go", "pkg/util/collate/unicode_0900_ai_ci_impl.go", "pkg/util/column-mapping/BUILD.bazel", "pkg/util/column-mapping/README.md", "pkg/util/column-mapping/column.go", "pkg/util/compress/BUILD.bazel", "pkg/util/compress/gzip.go", "pkg/util/context/BUILD.bazel", "pkg/util/context/context.go", "pkg/util/context/plancache.go", "pkg/util/context/warn.go", "pkg/util/cpu/BUILD.bazel", "pkg/util/cpu/cpu.go", "pkg/util/cpu_posix.go", "pkg/util/cpu_windows.go", "pkg/util/cpuprofile/BUILD.bazel", "pkg/util/cpuprofile/cpuprofile.go", "pkg/util/cpuprofile/pprof_api.go", "pkg/util/cpuprofile/testutil/BUILD.bazel", "pkg/util/cpuprofile/testutil/util.go", "pkg/util/cteutil/BUILD.bazel", "pkg/util/cteutil/storage.go", "pkg/util/dbterror/BUILD.bazel", "pkg/util/dbterror/ddl_terror.go", "pkg/util/dbterror/exeerrors/BUILD.bazel", "pkg/util/dbterror/exeerrors/errors.go", "pkg/util/dbterror/plannererrors/BUILD.bazel", "pkg/util/dbterror/plannererrors/planner_terror.go", "pkg/util/dbterror/terror.go", "pkg/util/dbutil/BUILD.bazel", "pkg/util/dbutil/README.md", "pkg/util/dbutil/common.go", "pkg/util/dbutil/dbutiltest/BUILD.bazel", "pkg/util/dbutil/dbutiltest/utils.go", "pkg/util/dbutil/index.go", "pkg/util/dbutil/interface.go", "pkg/util/dbutil/query.go", "pkg/util/dbutil/retry.go", "pkg/util/dbutil/table.go", "pkg/util/dbutil/types.go", "pkg/util/dbutil/variable.go", "pkg/util/ddl-checker/BUILD.bazel", "pkg/util/ddl-checker/ddl_syncer.go", "pkg/util/ddl-checker/executable_checker.go", "pkg/util/deadlockhistory/BUILD.bazel", "pkg/util/deadlockhistory/deadlock_history.go", "pkg/util/deeptest/BUILD.bazel", "pkg/util/deeptest/statictesthelper.go", "pkg/util/disjointset/BUILD.bazel", "pkg/util/disjointset/int_set.go", "pkg/util/disjointset/set.go", "pkg/util/disk/BUILD.bazel", "pkg/util/disk/tempDir.go", "pkg/util/disk/tracker.go", "pkg/util/disttask/BUILD.bazel", "pkg/util/disttask/idservice.go", "pkg/util/domainutil/BUILD.bazel", "pkg/util/domainutil/repair_vars.go", "pkg/util/encrypt/BUILD.bazel", "pkg/util/encrypt/aes.go", "pkg/util/encrypt/aes_layer.go", "pkg/util/encrypt/crypt.go", "pkg/util/engine/BUILD.bazel", "pkg/util/engine/engine.go", "pkg/util/errors.go", "pkg/util/etcd/BUILD.bazel", "pkg/util/etcd/etcd.go", "pkg/util/etcd.go", "pkg/util/execdetails/BUILD.bazel", "pkg/util/execdetails/execdetails.go", "pkg/util/expensivequery/BUILD.bazel", "pkg/util/expensivequery/expensivequery.go", "pkg/util/extsort/BUILD.bazel", "pkg/util/extsort/disk_sorter.go", "pkg/util/extsort/external_sorter.go", "pkg/util/fastrand/BUILD.bazel", "pkg/util/fastrand/random.go", "pkg/util/fastrand/runtime.go", "pkg/util/fastrand/runtime_1.22.go", "pkg/util/filter/BUILD.bazel", "pkg/util/filter/README.md", "pkg/util/filter/filter.go", "pkg/util/filter/schema.go", "pkg/util/format/BUILD.bazel", "pkg/util/format/format.go", "pkg/util/gctuner/BUILD.bazel", "pkg/util/gctuner/finalizer.go", "pkg/util/gctuner/mem.go", "pkg/util/gctuner/memory_limit_tuner.go", "pkg/util/gctuner/tuner.go", "pkg/util/gcutil/BUILD.bazel", "pkg/util/gcutil/gcutil.go", "pkg/util/generatedexpr/BUILD.bazel", "pkg/util/generatedexpr/generated_expr.go", "pkg/util/generic/BUILD.bazel", "pkg/util/generic/sync_map.go", "pkg/util/globalconn/BUILD.bazel", "pkg/util/globalconn/globalconn.go", "pkg/util/globalconn/pool.go", "pkg/util/gogc.go", "pkg/util/hack/BUILD.bazel", "pkg/util/hack/hack.go", "pkg/util/hint/BUILD.bazel", "pkg/util/hint/hint.go", "pkg/util/hint/hint_processor.go", "pkg/util/hint/hint_query_block.go", "pkg/util/id_generator.go", "pkg/util/importer/BUILD.bazel", "pkg/util/importer/config.go", "pkg/util/importer/data.go", "pkg/util/importer/db.go", "pkg/util/importer/importer.go", "pkg/util/importer/job.go", "pkg/util/importer/parser.go", "pkg/util/importer/rand.go", "pkg/util/intest/BUILD.bazel", "pkg/util/intest/assert.go", "pkg/util/intest/common.go", "pkg/util/intest/intest.go", "pkg/util/intset/BUILD.bazel", "pkg/util/intset/fast_int_set.go", "pkg/util/israce/BUILD.bazel", "pkg/util/israce/israce.go", "pkg/util/israce/norace.go", "pkg/util/keydecoder/BUILD.bazel", "pkg/util/keydecoder/keydecoder.go", "pkg/util/kvcache/BUILD.bazel", "pkg/util/kvcache/simple_lru.go", "pkg/util/linter/constructor/BUILD.bazel", "pkg/util/linter/constructor/constructorflag.go", "pkg/util/logutil/BUILD.bazel", "pkg/util/logutil/consistency/BUILD.bazel", "pkg/util/logutil/consistency/reporter.go", "pkg/util/logutil/general_logger.go", "pkg/util/logutil/hex.go", "pkg/util/logutil/log.go", "pkg/util/logutil/slow_query_logger.go", "pkg/util/mathutil/BUILD.bazel", "pkg/util/mathutil/exponential_average.go", "pkg/util/mathutil/math.go", "pkg/util/mathutil/rand.go", "pkg/util/memory/BUILD.bazel", "pkg/util/memory/action.go", "pkg/util/memory/meminfo.go", "pkg/util/memory/memstats.go", "pkg/util/memory/tracker.go", "pkg/util/memoryusagealarm/BUILD.bazel", "pkg/util/memoryusagealarm/memoryusagealarm.go", "pkg/util/metricsutil/BUILD.bazel", "pkg/util/metricsutil/common.go", "pkg/util/misc.go", "pkg/util/mock/BUILD.bazel", "pkg/util/mock/client.go", "pkg/util/mock/context.go", "pkg/util/mock/iter.go", "pkg/util/mock/metrics.go", "pkg/util/mock/store.go", "pkg/util/mvmap/BUILD.bazel", "pkg/util/mvmap/fnv.go", "pkg/util/mvmap/mvmap.go", "pkg/util/nocopy/BUILD.bazel", "pkg/util/nocopy/nocopy.go", "pkg/util/paging/BUILD.bazel", "pkg/util/paging/paging.go", "pkg/util/parser/BUILD.bazel", "pkg/util/parser/ast.go", "pkg/util/parser/parser.go", "pkg/util/partialjson/BUILD.bazel", "pkg/util/partialjson/extract.go", "pkg/util/password-validation/BUILD.bazel", "pkg/util/password-validation/password_validation.go", "pkg/util/plancodec/BUILD.bazel", "pkg/util/plancodec/binary_plan_decode.go", "pkg/util/plancodec/codec.go", "pkg/util/plancodec/id.go", "pkg/util/ppcpuusage/BUILD.bazel", "pkg/util/ppcpuusage/cpuusages.go", "pkg/util/prefetch/BUILD.bazel", "pkg/util/prefetch/reader.go", "pkg/util/prefix_helper.go", "pkg/util/printer/BUILD.bazel", "pkg/util/printer/printer.go", "pkg/util/printer.go", "pkg/util/processinfo.go", "pkg/util/profile/BUILD.bazel", "pkg/util/profile/flamegraph.go", "pkg/util/profile/profile.go", "pkg/util/profile/testdata/test.pprof", "pkg/util/promutil/BUILD.bazel", "pkg/util/promutil/factory.go", "pkg/util/promutil/registry.go", "pkg/util/ranger/BUILD.bazel", "pkg/util/ranger/checker.go", "pkg/util/ranger/context/BUILD.bazel", "pkg/util/ranger/context/context.go", "pkg/util/ranger/detacher.go", "pkg/util/ranger/points.go", "pkg/util/ranger/ranger.go", "pkg/util/ranger/types.go", "pkg/util/redact/BUILD.bazel", "pkg/util/redact/redact.go", "pkg/util/regexpr-router/BUILD.bazel", "pkg/util/regexpr-router/regexpr_router.go", "pkg/util/replayer/BUILD.bazel", "pkg/util/replayer/replayer.go", "pkg/util/resourcegrouptag/BUILD.bazel", "pkg/util/resourcegrouptag/resource_group_tag.go", "pkg/util/rlimit_other.go", "pkg/util/rlimit_windows.go", "pkg/util/rowDecoder/BUILD.bazel", "pkg/util/rowDecoder/decoder.go", "pkg/util/rowcodec/BUILD.bazel", "pkg/util/rowcodec/common.go", "pkg/util/rowcodec/decoder.go", "pkg/util/rowcodec/encoder.go", "pkg/util/rowcodec/row.go", "pkg/util/schemacmp/BUILD.bazel", "pkg/util/schemacmp/lattice.go", "pkg/util/schemacmp/table.go", "pkg/util/schemacmp/type.go", "pkg/util/schemacmp/util.go", "pkg/util/security.go", "pkg/util/selection/BUILD.bazel", "pkg/util/selection/selection.go", "pkg/util/sem/BUILD.bazel", "pkg/util/sem/sem.go", "pkg/util/serialization/BUILD.bazel", "pkg/util/serialization/common_util.go", "pkg/util/serialization/deserialization_util.go", "pkg/util/serialization/serialization_util.go", "pkg/util/servermemorylimit/BUILD.bazel", "pkg/util/servermemorylimit/servermemorylimit.go", "pkg/util/servicescope/BUILD.bazel", "pkg/util/servicescope/scope.go", "pkg/util/session_pool.go", "pkg/util/set/BUILD.bazel", "pkg/util/set/float64_set.go", "pkg/util/set/int_set.go", "pkg/util/set/mem_aware_map.go", "pkg/util/set/set.go", "pkg/util/set/set_with_memory_usage.go", "pkg/util/set/string_set.go", "pkg/util/signal/BUILD.bazel", "pkg/util/signal/signal_posix.go", "pkg/util/signal/signal_wasm.go", "pkg/util/signal/signal_windows.go", "pkg/util/size/BUILD.bazel", "pkg/util/size/size.go", "pkg/util/skip/BUILD.bazel", "pkg/util/skip/skip.go", "pkg/util/sli/BUILD.bazel", "pkg/util/sli/sli.go", "pkg/util/slice/BUILD.bazel", "pkg/util/slice/slice.go", "pkg/util/sqlescape/BUILD.bazel", "pkg/util/sqlescape/utils.go", "pkg/util/sqlexec/BUILD.bazel", "pkg/util/sqlexec/mock/BUILD.bazel", "pkg/util/sqlexec/mock/mock.go", "pkg/util/sqlexec/mock/restricted_sql_executor_mock.go", "pkg/util/sqlexec/restricted_sql_executor.go", "pkg/util/sqlexec/simple_record_set.go", "pkg/util/sqlkiller/BUILD.bazel", "pkg/util/sqlkiller/sqlkiller.go", "pkg/util/stmtsummary/BUILD.bazel", "pkg/util/stmtsummary/evicted.go", "pkg/util/stmtsummary/reader.go", "pkg/util/stmtsummary/statement_summary.go", "pkg/util/stmtsummary/v2/BUILD.bazel", "pkg/util/stmtsummary/v2/column.go", "pkg/util/stmtsummary/v2/logger.go", "pkg/util/stmtsummary/v2/reader.go", "pkg/util/stmtsummary/v2/record.go", "pkg/util/stmtsummary/v2/stmtsummary.go", "pkg/util/stringutil/BUILD.bazel", "pkg/util/stringutil/string_util.go", "pkg/util/syncutil/BUILD.bazel", "pkg/util/syncutil/mutex_deadlock.go", "pkg/util/syncutil/mutex_sync.go", "pkg/util/sys/linux/BUILD.bazel", "pkg/util/sys/linux/sys_linux.go", "pkg/util/sys/linux/sys_other.go", "pkg/util/sys/linux/sys_windows.go", "pkg/util/sys/storage/BUILD.bazel", "pkg/util/sys/storage/sys_other.go", "pkg/util/sys/storage/sys_posix.go", "pkg/util/sys/storage/sys_windows.go", "pkg/util/systimemon/BUILD.bazel", "pkg/util/systimemon/systime_mon.go", "pkg/util/table-filter/BUILD.bazel", "pkg/util/table-filter/README.md", "pkg/util/table-filter/column_filter.go", "pkg/util/table-filter/compat.go", "pkg/util/table-filter/matchers.go", "pkg/util/table-filter/parser.go", "pkg/util/table-filter/table_filter.go", "pkg/util/table-router/BUILD.bazel", "pkg/util/table-router/router.go", "pkg/util/table-rule-selector/BUILD.bazel", "pkg/util/table-rule-selector/trie_selector.go", "pkg/util/tableutil/BUILD.bazel", "pkg/util/tableutil/tableutil.go", "pkg/util/texttree/BUILD.bazel", "pkg/util/texttree/texttree.go", "pkg/util/tiflash/BUILD.bazel", "pkg/util/tiflash/tiflash_replica_read.go", "pkg/util/tiflashcompute/BUILD.bazel", "pkg/util/tiflashcompute/dispatch_policy.go", "pkg/util/tiflashcompute/topo_fetcher.go", "pkg/util/tikvutil/BUILD.bazel", "pkg/util/tikvutil/tikvutil.go", "pkg/util/timeutil/BUILD.bazel", "pkg/util/timeutil/errors.go", "pkg/util/timeutil/time.go", "pkg/util/timeutil/time_zone.go", "pkg/util/tls/BUILD.bazel", "pkg/util/tls/tls.go", "pkg/util/tokenlimiter.go", "pkg/util/topsql/BUILD.bazel", "pkg/util/topsql/collector/BUILD.bazel", "pkg/util/topsql/collector/cpu.go", "pkg/util/topsql/collector/mock/BUILD.bazel", "pkg/util/topsql/collector/mock/mock.go", "pkg/util/topsql/reporter/BUILD.bazel", "pkg/util/topsql/reporter/datamodel.go", "pkg/util/topsql/reporter/datasink.go", "pkg/util/topsql/reporter/metrics/BUILD.bazel", "pkg/util/topsql/reporter/metrics/metrics.go", "pkg/util/topsql/reporter/mock/BUILD.bazel", "pkg/util/topsql/reporter/mock/pubsub.go", "pkg/util/topsql/reporter/mock/server.go", "pkg/util/topsql/reporter/pubsub.go", "pkg/util/topsql/reporter/reporter.go", "pkg/util/topsql/reporter/single_target.go", "pkg/util/topsql/state/BUILD.bazel", "pkg/util/topsql/state/state.go", "pkg/util/topsql/stmtstats/BUILD.bazel", "pkg/util/topsql/stmtstats/aggregator.go", "pkg/util/topsql/stmtstats/kv_exec_count.go", "pkg/util/topsql/stmtstats/stmtstats.go", "pkg/util/topsql/topsql.go", "pkg/util/tracing/BUILD.bazel", "pkg/util/tracing/opt_trace.go", "pkg/util/tracing/util.go", "pkg/util/trxevents/BUILD.bazel", "pkg/util/trxevents/trx_events.go", "pkg/util/urls.go", "pkg/util/util.go", "pkg/util/versioninfo/BUILD.bazel", "pkg/util/versioninfo/versioninfo.go", "pkg/util/vitess/BUILD.bazel", "pkg/util/vitess/vitess_hash.go", "pkg/util/wait_group_wrapper.go", "pkg/util/watcher/BUILD.bazel", "pkg/util/watcher/event.go", "pkg/util/watcher/watcher.go", "pkg/util/worker_pool.go", "pkg/util/zeropool/BUILD.bazel", "pkg/util/zeropool/pool.go", "roadmap.md", "tools/check/check-bazel-prepare-rbe.sh", "tools/check/check-bazel-prepare.sh", "tools/check/check-errdoc.sh", "tools/check/check-file-perm.sh", "tools/check/check-gogenerate.sh", "tools/check/check-tidy.sh", "tools/check/check_testSuite.sh", "tools/check/go-compile-without-link.sh", "tools/check/revive.toml", "tools/check/ut.go", "tools/check/xprog.go", "tools/dashboard-linter/BUILD.bazel", "tools/dashboard-linter/main.go", "tools/fake-oauth/BUILD.bazel", "tools/fake-oauth/main.go", "tools/gen-parquet/BUILD.bazel", "tools/gen-parquet/main.go", "tools/patch-go/Dockerfile", "tools/patch-go/build.sh", "tools/patch-go/check.go", "tools/patch-go/go1.20.1.patch", "tools/patch-go/go1.20.2.patch", "tools/patch-go/go1.20.5.patch", "tools/patch-go/patch-go.sh", "tools/tazel/BUILD.bazel", "tools/tazel/ast.go", "tools/tazel/main.go", "tools/tazel/util.go"]}, "results": [{"check_id": "go.lang.security.audit.unsafe-reflect-by-name.unsafe-reflect-by-name", "end": {"col": 66, "line": 309, "offset": 9473}, "extra": {"engine_kind": "OSS", "fingerprint": "1376982eb75f8072b80a058e8b8da671de2092b4d4368c8fc22c438b750ad9de47ac70175f97ebae28d3dc26b5f47e7bb512b7dfffe0bcfd9fd43ae8253d3870_0", "is_ignored": false, "lines": "\t\t\t_, found := reflect.TypeOf(*backupMeta).FieldByName(fieldName)", "message": "If an attacker can supply values that the application then uses to determine which method or field to invoke, the potential exists for the attacker to create control flow paths through the application that were not intended by the application developers. This attack vector may allow the attacker to bypass authentication or access control checks or otherwise cause the application to behave in an unexpected manner.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-470: Use of Externally-Controlled Input to Select Classes or Code ('Unsafe Reflection')"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10005, "rule_id": "BYUBdJ", "rv_id": 833866, "url": "https://semgrep.dev/playground/r/qkTQnDr/go.lang.security.audit.unsafe-reflect-by-name.unsafe-reflect-by-name", "version_id": "qkTQnDr"}}, "shortlink": "https://sg.run/R8Xv", "source": "https://semgrep.dev/r/go.lang.security.audit.unsafe-reflect-by-name.unsafe-reflect-by-name", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$NAME": {"abstract_content": "fieldName", "end": {"col": 65, "line": 309, "offset": 9472}, "start": {"col": 56, "line": 309, "offset": 9463}}, "$SMTH": {"abstract_content": "reflect.TypeOf(*backupMeta)", "end": {"col": 43, "line": 309, "offset": 9450}, "start": {"col": 16, "line": 309, "offset": 9423}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/cmd/br/debug.go", "start": {"col": 16, "line": 309, "offset": 9423}}, {"check_id": "go.lang.security.audit.unsafe-reflect-by-name.unsafe-reflect-by-name", "end": {"col": 64, "line": 314, "offset": 9624}, "extra": {"engine_kind": "OSS", "fingerprint": "3c7764ea3c268428e35a1fa6fe1d9fa9887888413afc8b3f6d315e741e6390496b680aea59ece174878cfe663f2bc2d3cab2f9fc61b8f40c8bf7207874adfe26_0", "is_ignored": false, "lines": "\t\t\tfield := reflect.ValueOf(*backupMeta).FieldByName(fieldName)", "message": "If an attacker can supply values that the application then uses to determine which method or field to invoke, the potential exists for the attacker to create control flow paths through the application that were not intended by the application developers. This attack vector may allow the attacker to bypass authentication or access control checks or otherwise cause the application to behave in an unexpected manner.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-470: Use of Externally-Controlled Input to Select Classes or Code ('Unsafe Reflection')"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10005, "rule_id": "BYUBdJ", "rv_id": 833866, "url": "https://semgrep.dev/playground/r/qkTQnDr/go.lang.security.audit.unsafe-reflect-by-name.unsafe-reflect-by-name", "version_id": "qkTQnDr"}}, "shortlink": "https://sg.run/R8Xv", "source": "https://semgrep.dev/r/go.lang.security.audit.unsafe-reflect-by-name.unsafe-reflect-by-name", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$NAME": {"abstract_content": "fieldName", "end": {"col": 63, "line": 314, "offset": 9623}, "start": {"col": 54, "line": 314, "offset": 9614}}, "$SMTH": {"abstract_content": "reflect.ValueOf(*backupMeta)", "end": {"col": 41, "line": 314, "offset": 9601}, "start": {"col": 13, "line": 314, "offset": 9573}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/cmd/br/debug.go", "start": {"col": 13, "line": 314, "offset": 9573}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 10, "line": 6, "offset": 98}, "extra": {"engine_kind": "OSS", "fingerprint": "02eb3af2d733d60169306f43cd11f1f6137ec56ef87afe0c6b134bcefe3a44e9d50dd17eb14bf602abc7969cdf72368fa64c4aab459d8b4d7c5bc771ff1c41af_0", "is_ignored": false, "lines": "  control:", "message": "Service 'control' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "control", "end": {"col": 10, "line": 6, "offset": 98}, "start": {"col": 3, "line": 6, "offset": 91}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/compatibility/backup_cluster.yaml", "start": {"col": 3, "line": 6, "offset": 91}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 10, "line": 6, "offset": 98}, "extra": {"engine_kind": "OSS", "fingerprint": "ef463e02ff3b0eaf3ff7bebb8adccdd49a8655512a5459788e1408c05a7286a93efd9a7fed4a0abf7b9d7ca8448d8f7eda6130e44556f45f68ab315bf9eb9af7_0", "is_ignored": false, "lines": "  control:", "message": "Service 'control' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "control", "end": {"col": 10, "line": 6, "offset": 98}, "start": {"col": 3, "line": 6, "offset": 91}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/compatibility/backup_cluster.yaml", "start": {"col": 3, "line": 6, "offset": 91}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 6, "line": 26, "offset": 629}, "extra": {"engine_kind": "OSS", "fingerprint": "507a3fa80104880967f29f5f9e764bfde1c38763e81479ce7227efb25053271ef5cbdad74933ce816e6fd7a06f8eab5ac7ed64ad704359821ec9fd30dfffbb82_0", "is_ignored": false, "lines": "  pd0:", "message": "Service 'pd0' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "pd0", "end": {"col": 6, "line": 26, "offset": 629}, "start": {"col": 3, "line": 26, "offset": 626}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/compatibility/backup_cluster.yaml", "start": {"col": 3, "line": 26, "offset": 626}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 6, "line": 26, "offset": 629}, "extra": {"engine_kind": "OSS", "fingerprint": "9248565f5d88abc5864a548cb142be2c7554742e09a777033fc1cc29f76b3b4b6005a646c419c97bd7d88dc870e44cc117e64492265cb06d7158336212ed98cf_0", "is_ignored": false, "lines": "  pd0:", "message": "Service 'pd0' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "pd0", "end": {"col": 6, "line": 26, "offset": 629}, "start": {"col": 3, "line": 26, "offset": 626}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/compatibility/backup_cluster.yaml", "start": {"col": 3, "line": 26, "offset": 626}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 8, "line": 52, "offset": 1358}, "extra": {"engine_kind": "OSS", "fingerprint": "ff5037d7341ed85f7538f4dc951c262db3e0905924d88dd603496effcd1c8bc14b3e98cb8dfc902cd3dcda768b96e88fcda3d3923f485a2fae126bca6a40766d_0", "is_ignored": false, "lines": "  tikv0:", "message": "Service 'tikv0' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "tikv0", "end": {"col": 8, "line": 52, "offset": 1358}, "start": {"col": 3, "line": 52, "offset": 1353}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/compatibility/backup_cluster.yaml", "start": {"col": 3, "line": 52, "offset": 1353}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 8, "line": 52, "offset": 1358}, "extra": {"engine_kind": "OSS", "fingerprint": "4c0875ae5e14a0e09e8783699640e2ddc3e689b07c61ea8061ade4148961ae97b675002f9b21e0c00acafbed0571234c9367a55b3c4d14a46fb66825f8371d19_0", "is_ignored": false, "lines": "  tikv0:", "message": "Service 'tikv0' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "tikv0", "end": {"col": 8, "line": 52, "offset": 1358}, "start": {"col": 3, "line": 52, "offset": 1353}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/compatibility/backup_cluster.yaml", "start": {"col": 3, "line": 52, "offset": 1353}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 7, "line": 77, "offset": 1975}, "extra": {"engine_kind": "OSS", "fingerprint": "d5cdba4507633a56d8ef491c69edd003e34c93c929dcc72547d6c717fa37cda3ae993a3a6a1bcc2d5d71f137aef76fa76b9ed4866936ec52c3f82245000829e6_0", "is_ignored": false, "lines": "  tidb:", "message": "Service 'tidb' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "tidb", "end": {"col": 7, "line": 77, "offset": 1975}, "start": {"col": 3, "line": 77, "offset": 1971}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/compatibility/backup_cluster.yaml", "start": {"col": 3, "line": 77, "offset": 1971}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 7, "line": 77, "offset": 1975}, "extra": {"engine_kind": "OSS", "fingerprint": "02a5d4cccb6c506a9621f19dca1e360f1f2dcd5c2b37091512384fda6b207f284ebeb6797103fefd9747c265b68e94e1613bb422127d8bf39f16dc76e56c028a_0", "is_ignored": false, "lines": "  tidb:", "message": "Service 'tidb' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "tidb", "end": {"col": 7, "line": 77, "offset": 1975}, "start": {"col": 3, "line": 77, "offset": 1971}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/compatibility/backup_cluster.yaml", "start": {"col": 3, "line": 77, "offset": 1971}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 8, "line": 98, "offset": 2485}, "extra": {"engine_kind": "OSS", "fingerprint": "9b8520e1f9478314b08452d2512f025f0696abb8248f43bc17460e518a23e169ff849a96bfb46a1ab1c4bef36771abcd4d20fbfeacd75d9123ab8a236975a277_0", "is_ignored": false, "lines": "  minio:", "message": "Service 'minio' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "minio", "end": {"col": 8, "line": 98, "offset": 2485}, "start": {"col": 3, "line": 98, "offset": 2480}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/compatibility/backup_cluster.yaml", "start": {"col": 3, "line": 98, "offset": 2480}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 8, "line": 98, "offset": 2485}, "extra": {"engine_kind": "OSS", "fingerprint": "dbdf4d047502a2dad8875332ce978fefa50f9b03b60fedf8b80ee84320b9646e515be210e8f6b309845f30ec6b5ce122f7673aa145eef07a1a03911e4503324d_0", "is_ignored": false, "lines": "  minio:", "message": "Service 'minio' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "minio", "end": {"col": 8, "line": 98, "offset": 2485}, "start": {"col": 3, "line": 98, "offset": 2480}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/compatibility/backup_cluster.yaml", "start": {"col": 3, "line": 98, "offset": 2480}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 6, "line": 111, "offset": 2725}, "extra": {"engine_kind": "OSS", "fingerprint": "ab01fb22af241c2018ce8e30af81e025477157136042ba6916349c618360a89afdf480dec9c014d554bad91a462fa753220ce9c2edcb03c0271ee8e6f7197166_0", "is_ignored": false, "lines": "  gcs:", "message": "Service 'gcs' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "gcs", "end": {"col": 6, "line": 111, "offset": 2725}, "start": {"col": 3, "line": 111, "offset": 2722}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/compatibility/backup_cluster.yaml", "start": {"col": 3, "line": 111, "offset": 2722}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 6, "line": 111, "offset": 2725}, "extra": {"engine_kind": "OSS", "fingerprint": "768e77503ed894ee998d01c2a09334efd89728717d64581071e0d3475b1b0160cb90b03ea9104f0b2600842accfe1e23528bb9c692f8eb8f0a2695e6788c17c7_0", "is_ignored": false, "lines": "  gcs:", "message": "Service 'gcs' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "gcs", "end": {"col": 6, "line": 111, "offset": 2725}, "start": {"col": 3, "line": 111, "offset": 2722}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/compatibility/backup_cluster.yaml", "start": {"col": 3, "line": 111, "offset": 2722}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 8, "line": 125, "offset": 3053}, "extra": {"engine_kind": "OSS", "fingerprint": "ddd900419f456abfac83eb3df2c2b4a0ce6cded69cce128c350b6ce544e0c30d72890d7ca71ff389eea6da2af2f20c669e2c468656b7b1d7b1445cc970e6d1e2_0", "is_ignored": false, "lines": "  oauth:", "message": "Service 'oauth' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "oauth", "end": {"col": 8, "line": 125, "offset": 3053}, "start": {"col": 3, "line": 125, "offset": 3048}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/compatibility/backup_cluster.yaml", "start": {"col": 3, "line": 125, "offset": 3048}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 8, "line": 125, "offset": 3053}, "extra": {"engine_kind": "OSS", "fingerprint": "05fd4a8c535f33c9a1271977d4274aaacdb5ee3bf45cdf28504dc2226045b049ad86a89881231e392f48b4ac49cf2c84b4b6e54ead94ace6c1ede75bec77fbef_0", "is_ignored": false, "lines": "  oauth:", "message": "Service 'oauth' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "oauth", "end": {"col": 8, "line": 125, "offset": 3053}, "start": {"col": 3, "line": 125, "offset": 3048}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/compatibility/backup_cluster.yaml", "start": {"col": 3, "line": 125, "offset": 3048}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 10, "line": 6, "offset": 98}, "extra": {"engine_kind": "OSS", "fingerprint": "a153b61da04840a7983966974ffeef704b2796e295687d22e6ef0cf430a0f25b8ce7ef37dad777e1b07fd7ebc3f1241068399b15104ef7eef0507ec15b0ebbe1_0", "is_ignored": false, "lines": "  control:", "message": "Service 'control' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "control", "end": {"col": 10, "line": 6, "offset": 98}, "start": {"col": 3, "line": 6, "offset": 91}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 6, "offset": 91}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 10, "line": 6, "offset": 98}, "extra": {"engine_kind": "OSS", "fingerprint": "3f7acb7ddfb3f98dbff6fe7e2c9eb23e6da8b65478d1fce49e52726bb383a786bbba433a09b1fcedc8a2ce3f3c6398e788f237d8be0a14c1f635f322f22b4e4b_0", "is_ignored": false, "lines": "  control:", "message": "Service 'control' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "control", "end": {"col": 10, "line": 6, "offset": 98}, "start": {"col": 3, "line": 6, "offset": 91}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 6, "offset": 91}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 6, "line": 23, "offset": 502}, "extra": {"engine_kind": "OSS", "fingerprint": "d133ffe283da9301cbdf57636f30b9e1679564fa3ee2a7611aab3bf2b5bb2dea4bf914a97f47c7a6c453221fb8799e4c717aacbdd4aa036d96177193f206b6b6_0", "is_ignored": false, "lines": "  pd0:", "message": "Service 'pd0' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "pd0", "end": {"col": 6, "line": 23, "offset": 502}, "start": {"col": 3, "line": 23, "offset": 499}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 23, "offset": 499}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 6, "line": 23, "offset": 502}, "extra": {"engine_kind": "OSS", "fingerprint": "db55eb4579bab419f52516359a074930b7986eec8f9fdde99c50893d2f01b1cefa9d082cb9f6c032fa7a8c5170018f879cd79b242c637c60f0c47bd1d86979e0_0", "is_ignored": false, "lines": "  pd0:", "message": "Service 'pd0' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "pd0", "end": {"col": 6, "line": 23, "offset": 502}, "start": {"col": 3, "line": 23, "offset": 499}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 23, "offset": 499}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 8, "line": 49, "offset": 1187}, "extra": {"engine_kind": "OSS", "fingerprint": "f748a6037c48f07554e62baedf46ae57231bc595254759a4f79f57d3f8e21d7ad64717dc2508093b1d556a56fa9b7056bbf31665e3fd3eaddf153a8f7b754d76_0", "is_ignored": false, "lines": "  tikv0:", "message": "Service 'tikv0' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "tikv0", "end": {"col": 8, "line": 49, "offset": 1187}, "start": {"col": 3, "line": 49, "offset": 1182}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 49, "offset": 1182}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 8, "line": 49, "offset": 1187}, "extra": {"engine_kind": "OSS", "fingerprint": "ae77c6096602b9022a934d28632719cfb1ce5ff9a086ffb73e5f42825f8350091dd90c7a76b25fb50d4e437ce7d982e0f75052a3437d1f4ca793a55494a8f632_0", "is_ignored": false, "lines": "  tikv0:", "message": "Service 'tikv0' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "tikv0", "end": {"col": 8, "line": 49, "offset": 1187}, "start": {"col": 3, "line": 49, "offset": 1182}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 49, "offset": 1182}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 8, "line": 74, "offset": 1776}, "extra": {"engine_kind": "OSS", "fingerprint": "620c1508c37192ef4ebcc04b0b58abd83e4a694fd652f1360fb4566dc6fdebafa314d6a9d7b9eedf7e947bd965a78b5ffb499ebc674643cb89fbd659b2d88ab2_0", "is_ignored": false, "lines": "  tikv1:", "message": "Service 'tikv1' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "tikv1", "end": {"col": 8, "line": 74, "offset": 1776}, "start": {"col": 3, "line": 74, "offset": 1771}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 74, "offset": 1771}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 8, "line": 74, "offset": 1776}, "extra": {"engine_kind": "OSS", "fingerprint": "8c458ef55e2d8b0561afc7af9e94920b31881b1c981cbe623345eaab03d3c8499b033551772418604eedf1177664d56e0bb7a775cc8e238e25e426f0feb49757_0", "is_ignored": false, "lines": "  tikv1:", "message": "Service 'tikv1' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "tikv1", "end": {"col": 8, "line": 74, "offset": 1776}, "start": {"col": 3, "line": 74, "offset": 1771}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 74, "offset": 1771}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 8, "line": 99, "offset": 2365}, "extra": {"engine_kind": "OSS", "fingerprint": "30803836c70546a254a81870432e11ec76a54fd4fe39a4f95371a746ff735e72496ffb5ed760063c58d470b708c199d23671a3eef5776a34458e78ada50dad2e_0", "is_ignored": false, "lines": "  tikv2:", "message": "Service 'tikv2' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "tikv2", "end": {"col": 8, "line": 99, "offset": 2365}, "start": {"col": 3, "line": 99, "offset": 2360}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 99, "offset": 2360}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 8, "line": 99, "offset": 2365}, "extra": {"engine_kind": "OSS", "fingerprint": "6baa050b1f51356311a9e86d35c6e96b1a1d6883eeabb46e2b7e94dade4e0a8df0a328902e128aa24dece9877c73b4c4ebe092277e36afacddeb03c209d1b36c_0", "is_ignored": false, "lines": "  tikv2:", "message": "Service 'tikv2' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "tikv2", "end": {"col": 8, "line": 99, "offset": 2365}, "start": {"col": 3, "line": 99, "offset": 2360}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 99, "offset": 2360}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 8, "line": 124, "offset": 2954}, "extra": {"engine_kind": "OSS", "fingerprint": "d7765b76ebc76cef1959639917a93b7b390c8cd325fd8156d12482fe5b6ece370f8fa5935f4f33d30808c8c35cd298eb45934271bfcad516ca4f67a1438d4433_0", "is_ignored": false, "lines": "  tikv3:", "message": "Service 'tikv3' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "tikv3", "end": {"col": 8, "line": 124, "offset": 2954}, "start": {"col": 3, "line": 124, "offset": 2949}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 124, "offset": 2949}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 8, "line": 124, "offset": 2954}, "extra": {"engine_kind": "OSS", "fingerprint": "428ef9d6787f77c39be5d8f1c23b38ad7a3f8344bf14487e70103be3233394c3dc4bbbb15b641be0860d12fa0ebcfa0bdc2d1b4c9f0d1e1af3aaeebcd7753ed5_0", "is_ignored": false, "lines": "  tikv3:", "message": "Service 'tikv3' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "tikv3", "end": {"col": 8, "line": 124, "offset": 2954}, "start": {"col": 3, "line": 124, "offset": 2949}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 124, "offset": 2949}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 8, "line": 149, "offset": 3543}, "extra": {"engine_kind": "OSS", "fingerprint": "d615904d2d07945ff91037a6dc0680447ae482d3b0578a700a2ff2332c1aaad143423a33e0caaf60a783fda02a314f213881bdd36e6fcd26e2f39c87cb003ef4_0", "is_ignored": false, "lines": "  tikv4:", "message": "Service 'tikv4' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "tikv4", "end": {"col": 8, "line": 149, "offset": 3543}, "start": {"col": 3, "line": 149, "offset": 3538}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 149, "offset": 3538}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 8, "line": 149, "offset": 3543}, "extra": {"engine_kind": "OSS", "fingerprint": "49fb74658f94109441b779a91e75b13146c9d7651c7db60c31f637d823d3b39b13fab79b0a72d45dfde9bd6419c69720e960eb392fb1a213c3adfcf95c36f83f_0", "is_ignored": false, "lines": "  tikv4:", "message": "Service 'tikv4' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "tikv4", "end": {"col": 8, "line": 149, "offset": 3543}, "start": {"col": 3, "line": 149, "offset": 3538}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 149, "offset": 3538}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 7, "line": 174, "offset": 4131}, "extra": {"engine_kind": "OSS", "fingerprint": "44f3ac28608240fa99ad4073a2831d5090412dfc3a459e04b44ef92b377622dc91c9211695d2fbacd1b5d8ac9e65db63195657d3bceb3db7fd24601169051ae4_0", "is_ignored": false, "lines": "  tidb:", "message": "Service 'tidb' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "tidb", "end": {"col": 7, "line": 174, "offset": 4131}, "start": {"col": 3, "line": 174, "offset": 4127}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 174, "offset": 4127}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 7, "line": 174, "offset": 4131}, "extra": {"engine_kind": "OSS", "fingerprint": "644af619faffbafaeb9c9b6b5440ff0d8ba4ab31db0c12b7c0526efd68be52678d05a72aa2afc424945f93550aecb501962200241b1f0e06a191106ddd7411d7_0", "is_ignored": false, "lines": "  tidb:", "message": "Service 'tidb' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "tidb", "end": {"col": 7, "line": 174, "offset": 4131}, "start": {"col": 3, "line": 174, "offset": 4127}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 174, "offset": 4127}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 8, "line": 202, "offset": 4711}, "extra": {"engine_kind": "OSS", "fingerprint": "76a936c9d66c4ebec523c2c2d6bc93ea4e27a5f27078ad49faf18867299ca848b42c19ebbd34625f944dee95db9264102734b90865f5f676534ee700c94bd2c9_0", "is_ignored": false, "lines": "  minio:", "message": "Service 'minio' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "minio", "end": {"col": 8, "line": 202, "offset": 4711}, "start": {"col": 3, "line": 202, "offset": 4706}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 202, "offset": 4706}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 8, "line": 202, "offset": 4711}, "extra": {"engine_kind": "OSS", "fingerprint": "cd9ae957a3849ac6c33c94c2f19b5071301a646409cf181cac8f18679dee76fd1b026f50dd2e727dace237d736a9d19537514c70a3347eb750c363c9b2991cdd_0", "is_ignored": false, "lines": "  minio:", "message": "Service 'minio' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "minio", "end": {"col": 8, "line": 202, "offset": 4711}, "start": {"col": 3, "line": 202, "offset": 4706}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 202, "offset": 4706}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 6, "line": 212, "offset": 4913}, "extra": {"engine_kind": "OSS", "fingerprint": "0aaa97f84137e536d53cf819ed903e97d4440e73f54575597b97c0f11cb6b193695cd08f12ab3b02e49d5c93264f7585340fcbec23637e14f11848cdbec85b72_0", "is_ignored": false, "lines": "  gcs:", "message": "Service 'gcs' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "gcs", "end": {"col": 6, "line": 212, "offset": 4913}, "start": {"col": 3, "line": 212, "offset": 4910}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 212, "offset": 4910}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 6, "line": 212, "offset": 4913}, "extra": {"engine_kind": "OSS", "fingerprint": "56442f5b10617fa0c9ed7a838e55d81fd1d8253e83a10af4ee3f6a73043c2885c851140db21524dd83a71abd2fbebfa4bb2f1e65f55cb893d2e55fa722f822d7_0", "is_ignored": false, "lines": "  gcs:", "message": "Service 'gcs' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "gcs", "end": {"col": 6, "line": 212, "offset": 4913}, "start": {"col": 3, "line": 212, "offset": 4910}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 212, "offset": 4910}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 8, "line": 221, "offset": 5181}, "extra": {"engine_kind": "OSS", "fingerprint": "720e72ec6ae3ea1c56e7a49f3a890fab19cb51166aa08d7ef8b81a1bbc7289b79b071ceeab3387858f5bdc4e34da24da83a475c3efdd3c80de5412e405d7f1f8_0", "is_ignored": false, "lines": "  oauth:", "message": "Service 'oauth' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "oauth", "end": {"col": 8, "line": 221, "offset": 5181}, "start": {"col": 3, "line": 221, "offset": 5176}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 221, "offset": 5176}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 8, "line": 221, "offset": 5181}, "extra": {"engine_kind": "OSS", "fingerprint": "b065822bc09094ac497a2c5baaeea6047d5a0278ca1faa6a831f816fd56f46a7ad1ef8e45aeacc245f56f8678bc18aac029eeef6a6d3126b0e5433cdb6f3e36e_0", "is_ignored": false, "lines": "  oauth:", "message": "Service 'oauth' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "oauth", "end": {"col": 8, "line": 221, "offset": 5181}, "start": {"col": 3, "line": 221, "offset": 5176}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/docker-compose.yaml", "start": {"col": 3, "line": 221, "offset": 5176}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 21, "offset": 657}, "extra": {"engine_kind": "OSS", "fingerprint": "5c50f027876891ebe87d0a5008275c9e8e40a036e3e71e709f4aa11bd17719c1419f95c682e3d9eee187dc13bedf2440dae14144a8b7cdb28d76ad47b09fcb4a_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "Sprintf", "end": {"col": 28, "line": 65, "offset": 2051}, "start": {"col": 21, "line": 65, "offset": 2044}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 21, "offset": 657}, "start": {"col": 3, "line": 21, "offset": 648}}, "$RAND": {"abstract_content": "fmt", "end": {"col": 20, "line": 65, "offset": 2043}, "start": {"col": 17, "line": 65, "offset": 2040}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/pkg/restore/log_client/import.go", "start": {"col": 3, "line": 21, "offset": 648}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 21, "offset": 658}, "extra": {"engine_kind": "OSS", "fingerprint": "9a5c1149bc5b075c16ec059db209d8145ee287aec8853c01fce71fbf66999f8574852d75b454e9b3160ef28453abb38836d28a27e9797dc8acc895fa61d32608_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "RLock", "end": {"col": 9, "line": 82, "offset": 2243}, "start": {"col": 4, "line": 82, "offset": 2238}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 21, "offset": 658}, "start": {"col": 3, "line": 21, "offset": 649}}, "$RAND": {"abstract_content": "s", "end": {"col": 3, "line": 82, "offset": 2237}, "start": {"col": 2, "line": 82, "offset": 2236}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/pkg/restore/snap_client/import.go", "start": {"col": 3, "line": 21, "offset": 649}}, {"check_id": "go.lang.security.audit.dangerous-exec-command.dangerous-exec-command", "end": {"col": 41, "line": 54, "offset": 1127}, "extra": {"engine_kind": "OSS", "fingerprint": "5effa5597a44f0f7766287e0f09a4dc10925ce9073270651955dde8ea510ea05d8b0d82e3600c42ba3a1e73add0eed72db45e803f5fa3f9de3c2ca2d9f7100be_0", "is_ignored": false, "lines": "\treturn exec.Command(cmd[0], cmd[1:]...), nil", "message": "Detected non-static command inside Command. Audit the input to 'exec.Command'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9109, "rule_id": "X5U8RQ", "rv_id": 833845, "url": "https://semgrep.dev/playground/r/GxTDE1v/go.lang.security.audit.dangerous-exec-command.dangerous-exec-command", "version_id": "GxTDE1v"}}, "shortlink": "https://sg.run/W8lA", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-command.dangerous-exec-command", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "cmd[0]", "end": {"col": 28, "line": 54, "offset": 1114}, "start": {"col": 22, "line": 54, "offset": 1108}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "br/pkg/storage/hdfs.go", "start": {"col": 9, "line": 54, "offset": 1095}}, {"check_id": "trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "end": {"col": 4, "line": 133, "offset": 3127}, "extra": {"engine_kind": "OSS", "fingerprint": "386ca1e8a6fdc74ea0c8c90b72505b90d0fd7f8c26b1519fc46b0d0df838b359e99bdfb1fa5e4d73663f893bb499d06d4ca829d0d79a2c8ac16f6c55a84e7104_0", "is_ignored": false, "lines": "\t\tte, err := t.toTaskEvent(ctx, event)\n\t\tif err != nil {\n\t\t\tte.Type = EventErr\n\t\t\tte.Err = err\n\t\t}", "message": "Variable `te` is likely modified and later used on error. In some cases this could result  in panics due to a nil dereference", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-665: Improper Initialization", "description": "Possible unintentional assignment when an error occurs", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "MEDIUM", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17197, "rule_id": "kxU6Xb", "rv_id": 833265, "url": "https://semgrep.dev/playground/r/zyTWJNZ/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "version_id": "zyTWJNZ"}}, "shortlink": "https://sg.run/WWQ2", "source": "https://semgrep.dev/r/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$ERR": {"abstract_content": "err", "end": {"col": 10, "line": 129, "offset": 3038}, "start": {"col": 7, "line": 129, "offset": 3035}}, "$X": {"abstract_content": "te", "end": {"col": 5, "line": 129, "offset": 3033}, "start": {"col": 3, "line": 129, "offset": 3031}}, "$Y": {"abstract_content": "Type", "end": {"col": 11, "line": 131, "offset": 3096}, "start": {"col": 7, "line": 131, "offset": 3092}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "br/pkg/streamhelper/advancer_cliext.go", "start": {"col": 3, "line": 129, "offset": 3031}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 21, "offset": 651}, "extra": {"engine_kind": "OSS", "fingerprint": "3ee13a37dd1eb3c8c169008cb974e7c9022b655c7924088ba94c3da256e9f8a51fac544b0c449cb4c140ce08a0af919d768dce9e7e74ee54ab683492eb808197_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "String", "end": {"col": 25, "line": 38, "offset": 1066}, "start": {"col": 19, "line": 38, "offset": 1060}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 21, "offset": 651}, "start": {"col": 3, "line": 21, "offset": 642}}, "$RAND": {"abstract_content": "flag", "end": {"col": 18, "line": 38, "offset": 1059}, "start": {"col": 14, "line": 38, "offset": 1055}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "cmd/benchdb/main.go", "start": {"col": 3, "line": 21, "offset": 642}}, {"check_id": "go.lang.security.audit.net.pprof.pprof-debug-exposure", "end": {"col": 44, "line": 84, "offset": 2407}, "extra": {"engine_kind": "OSS", "fingerprint": "6da9f35c9de1c6567bd61bb998700de23ead685a14892c5bdf24ba7db3a86905256c7466f7535f5614df91536af9d90ee50a0975ec4b17e8057999a9e09d6a3d_0", "is_ignored": false, "lines": "\t\terr1 := http.ListenAndServe(\":9191\", nil)", "message": "The profiling 'pprof' endpoint is automatically exposed on /debug/pprof. This could leak information about the server. Instead, use `import \"net/http/pprof\"`. See https://www.farsightsecurity.com/blog/txt-record/go-remote-profiling-20161028/ for more information and mitigation.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-489: Active Debug Code"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": "A06:2017 - Security Misconfiguration", "references": ["https://www.farsightsecurity.com/blog/txt-record/go-remote-profiling-20161028/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9130, "rule_id": "gxU1Kp", "rv_id": 833855, "url": "https://semgrep.dev/playground/r/YDTl0Lv/go.lang.security.audit.net.pprof.pprof-debug-exposure", "version_id": "YDTl0Lv"}}, "shortlink": "https://sg.run/x1Ep", "source": "https://semgrep.dev/r/go.lang.security.audit.net.pprof.pprof-debug-exposure", "source-rule-url": "https://github.com/securego/gosec#available-rules", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Active Debug Code"]}, "metavars": {"$ANY": {"abstract_content": "Init", "end": {"col": 10, "line": 72, "offset": 2038}, "start": {"col": 6, "line": 72, "offset": 2034}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "cmd/benchkv/main.go", "start": {"col": 11, "line": 84, "offset": 2374}}, {"check_id": "go.lang.security.audit.net.use-tls.use-tls", "end": {"col": 44, "line": 84, "offset": 2407}, "extra": {"engine_kind": "OSS", "fingerprint": "f17f15506d603ed1eebbcb4321befe7f804890e5f2639cbc508944d144e0bdfd4b36d6fa2a53c899adb56d0e5a4e90d9b8ce536a4148415be2b7301dfc301a89_0", "fix": "http.ListenAndServeTLS(\":9191\", certFile, keyFile, nil)", "is_ignored": false, "lines": "\t\terr1 := http.ListenAndServe(\":9191\", nil)", "message": "Found an HTTP server without TLS. Use 'http.ListenAndServeTLS' instead. See https://golang.org/pkg/net/http/#ListenAndServeTLS for more information.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-319: Cleartext Transmission of Sensitive Information"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://golang.org/pkg/net/http/#ListenAndServeTLS"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9134, "rule_id": "PeUZ8X", "rv_id": 833859, "url": "https://semgrep.dev/playground/r/RGTKGyp/go.lang.security.audit.net.use-tls.use-tls", "version_id": "RGTKGyp"}}, "shortlink": "https://sg.run/dKbY", "source": "https://semgrep.dev/r/go.lang.security.audit.net.use-tls.use-tls", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Mishandled Sensitive Information"]}, "metavars": {"$ADDR": {"abstract_content": "\":9191\"", "end": {"col": 38, "line": 84, "offset": 2401}, "start": {"col": 31, "line": 84, "offset": 2394}}, "$HANDLER": {"abstract_content": "nil", "end": {"col": 43, "line": 84, "offset": 2406}, "start": {"col": 40, "line": 84, "offset": 2403}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "cmd/benchkv/main.go", "start": {"col": 11, "line": 84, "offset": 2374}}, {"check_id": "go.lang.security.audit.net.pprof.pprof-debug-exposure", "end": {"col": 43, "line": 81, "offset": 2216}, "extra": {"engine_kind": "OSS", "fingerprint": "0ebdf857b38f78b4947aaf3df28c0d420eb3318db5fc42302da673f3e69b853b2294d8e60df4a4c81d2e4241e9b1512f00281872ca45c5486795a2e57f4e7450_0", "is_ignored": false, "lines": "\t\terr := http.ListenAndServe(\":9191\", nil)", "message": "The profiling 'pprof' endpoint is automatically exposed on /debug/pprof. This could leak information about the server. Instead, use `import \"net/http/pprof\"`. See https://www.farsightsecurity.com/blog/txt-record/go-remote-profiling-20161028/ for more information and mitigation.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-489: Active Debug Code"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": "A06:2017 - Security Misconfiguration", "references": ["https://www.farsightsecurity.com/blog/txt-record/go-remote-profiling-20161028/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9130, "rule_id": "gxU1Kp", "rv_id": 833855, "url": "https://semgrep.dev/playground/r/YDTl0Lv/go.lang.security.audit.net.pprof.pprof-debug-exposure", "version_id": "YDTl0Lv"}}, "shortlink": "https://sg.run/x1Ep", "source": "https://semgrep.dev/r/go.lang.security.audit.net.pprof.pprof-debug-exposure", "source-rule-url": "https://github.com/securego/gosec#available-rules", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Active Debug Code"]}, "metavars": {"$ANY": {"abstract_content": "main", "end": {"col": 10, "line": 77, "offset": 2113}, "start": {"col": 6, "line": 77, "offset": 2109}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "cmd/benchraw/main.go", "start": {"col": 10, "line": 81, "offset": 2183}}, {"check_id": "go.lang.security.audit.net.use-tls.use-tls", "end": {"col": 43, "line": 81, "offset": 2216}, "extra": {"engine_kind": "OSS", "fingerprint": "492469cc04429d7f91656cff89b25e380eb7b1034223ad9248c806183008a77fba3e4b21d2372bd6989ee10a72346cb4419bce346c49214e319ac494732f463c_0", "fix": "http.ListenAndServeTLS(\":9191\", certFile, keyFile, nil)", "is_ignored": false, "lines": "\t\terr := http.ListenAndServe(\":9191\", nil)", "message": "Found an HTTP server without TLS. Use 'http.ListenAndServeTLS' instead. See https://golang.org/pkg/net/http/#ListenAndServeTLS for more information.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-319: Cleartext Transmission of Sensitive Information"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://golang.org/pkg/net/http/#ListenAndServeTLS"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9134, "rule_id": "PeUZ8X", "rv_id": 833859, "url": "https://semgrep.dev/playground/r/RGTKGyp/go.lang.security.audit.net.use-tls.use-tls", "version_id": "RGTKGyp"}}, "shortlink": "https://sg.run/dKbY", "source": "https://semgrep.dev/r/go.lang.security.audit.net.use-tls.use-tls", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Mishandled Sensitive Information"]}, "metavars": {"$ADDR": {"abstract_content": "\":9191\"", "end": {"col": 37, "line": 81, "offset": 2210}, "start": {"col": 30, "line": 81, "offset": 2203}}, "$HANDLER": {"abstract_content": "nil", "end": {"col": 42, "line": 81, "offset": 2215}, "start": {"col": 39, "line": 81, "offset": 2212}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "cmd/benchraw/main.go", "start": {"col": 10, "line": 81, "offset": 2183}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 19, "offset": 632}, "extra": {"engine_kind": "OSS", "fingerprint": "48e2bb85fd95d194f889cb64de3e12c7ae38139424651ece998c851e6725042969decef6e4026ed1be9961dd37fd5182450fbca789673588224018374fae080a_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "Lock", "end": {"col": 8, "line": 47, "offset": 1084}, "start": {"col": 4, "line": 47, "offset": 1080}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 19, "offset": 632}, "start": {"col": 3, "line": 19, "offset": 623}}, "$RAND": {"abstract_content": "d", "end": {"col": 3, "line": 47, "offset": 1079}, "start": {"col": 2, "line": 47, "offset": 1078}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "cmd/importer/data.go", "start": {"col": 3, "line": 19, "offset": 623}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 21, "offset": 656}, "extra": {"engine_kind": "OSS", "fingerprint": "3af851cfe2c4428edbbc930ca63c25002fd39bcda08c7566b1058f2461a744f40a0e868eeb43516852fd1cf61d70be5ab09ebe43eb94ffbc2027aadafd8229e8_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "ParseInt", "end": {"col": 30, "line": 35, "offset": 987}, "start": {"col": 22, "line": 35, "offset": 979}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 21, "offset": 656}, "start": {"col": 3, "line": 21, "offset": 647}}, "$RAND": {"abstract_content": "strconv", "end": {"col": 21, "line": 35, "offset": 978}, "start": {"col": 14, "line": 35, "offset": 971}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "cmd/importer/db.go", "start": {"col": 3, "line": 21, "offset": 647}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 21, "offset": 648}, "extra": {"engine_kind": "OSS", "fingerprint": "2848ed4b12cb468de06b3a61e54eed641792e83031df5a1ce4e0db34747b98828ce56efefcf49db658bd29e819d0de690ee17c7532166bbf4df30f588bf40957_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "Intn", "end": {"col": 24, "line": 42, "offset": 1240}, "start": {"col": 20, "line": 42, "offset": 1236}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 21, "offset": 648}, "start": {"col": 3, "line": 21, "offset": 639}}, "$RAND": {"abstract_content": "rand", "end": {"col": 19, "line": 42, "offset": 1235}, "start": {"col": 15, "line": 42, "offset": 1231}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "cmd/importer/rand.go", "start": {"col": 3, "line": 21, "offset": 639}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 19, "offset": 642}, "extra": {"engine_kind": "OSS", "fingerprint": "08fccc8ae706da6c2e454eed09f24942acc8b808c74f6ac922b87dfef03bc7af14f54ba2d0dcf51a5694a207645cf001aefef802317f84a27949f16b8445be38_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "ReadFile", "end": {"col": 26, "line": 34, "offset": 1077}, "start": {"col": 18, "line": 34, "offset": 1069}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 19, "offset": 642}, "start": {"col": 3, "line": 19, "offset": 633}}, "$RAND": {"abstract_content": "os", "end": {"col": 17, "line": 34, "offset": 1068}, "start": {"col": 15, "line": 34, "offset": 1066}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "cmd/importer/stats.go", "start": {"col": 3, "line": 19, "offset": 633}}, {"check_id": "go.lang.security.audit.dangerous-exec-command.dangerous-exec-command", "end": {"col": 45, "line": 197, "offset": 5091}, "extra": {"engine_kind": "OSS", "fingerprint": "87f8a260901f501cf0f398da9978e57bdbbd3a8a9193befb5fcbb4e5dd1cabdfc9b6dd7e85720a62b868f1514fba4e1ca99129e3d35795fb6b84778d2af9d43c_0", "is_ignored": false, "lines": "\tcmd := exec.Command(gobin, downloadArgs...)", "message": "Detected non-static command inside Command. Audit the input to 'exec.Command'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9109, "rule_id": "X5U8RQ", "rv_id": 833845, "url": "https://semgrep.dev/playground/r/GxTDE1v/go.lang.security.audit.dangerous-exec-command.dangerous-exec-command", "version_id": "GxTDE1v"}}, "shortlink": "https://sg.run/W8lA", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-command.dangerous-exec-command", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "gobin", "end": {"col": 27, "line": 197, "offset": 5073}, "start": {"col": 22, "line": 197, "offset": 5068}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "cmd/mirror/mirror.go", "start": {"col": 9, "line": 197, "offset": 5055}}, {"check_id": "go.lang.security.audit.dangerous-exec-command.dangerous-exec-command", "end": {"col": 75, "line": 227, "offset": 5911}, "extra": {"engine_kind": "OSS", "fingerprint": "87f8a260901f501cf0f398da9978e57bdbbd3a8a9193befb5fcbb4e5dd1cabdfc9b6dd7e85720a62b868f1514fba4e1ca99129e3d35795fb6b84778d2af9d43c_1", "is_ignored": false, "lines": "\tcmd := exec.Command(gobin, \"list\", \"-mod=readonly\", \"-m\", \"-json\", \"all\")", "message": "Detected non-static command inside Command. Audit the input to 'exec.Command'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9109, "rule_id": "X5U8RQ", "rv_id": 833845, "url": "https://semgrep.dev/playground/r/GxTDE1v/go.lang.security.audit.dangerous-exec-command.dangerous-exec-command", "version_id": "GxTDE1v"}}, "shortlink": "https://sg.run/W8lA", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-command.dangerous-exec-command", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "gobin", "end": {"col": 27, "line": 227, "offset": 5863}, "start": {"col": 22, "line": 227, "offset": 5858}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "cmd/mirror/mirror.go", "start": {"col": 9, "line": 227, "offset": 5845}}, {"check_id": "go.lang.security.audit.xss.import-text-template.import-text-template", "end": {"col": 16, "line": 26, "offset": 713}, "extra": {"engine_kind": "OSS", "fingerprint": "dc59abd4740e588a7053adabcfa2e069fa032ae69cf3a0eb0346cdffe84a661f9c81dbf0447a4aab180d883dad5936ae045d942252ffe996603d3be6ae839de9_0", "fix": "html/template", "is_ignored": false, "lines": "\t\"text/template\"", "message": "When working with web applications that involve rendering user-generated  content, it's important to properly escape any HTML content to prevent  Cross-Site Scripting (XSS) attacks. In Go, the `text/template` package does  not automatically escape HTML content, which can leave your application  vulnerable to these types of attacks. To mitigate this risk, it's  recommended to use the `html/template` package instead, which provides  built-in functionality for HTML escaping. By using `html/template` to render  your HTML content, you can help to ensure that your web application is more  secure and less susceptible to XSS vulnerabilities.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www.veracode.com/blog/secure-development/use-golang-these-mistakes-could-compromise-your-apps-security"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9136, "rule_id": "5rUOZQ", "rv_id": 833868, "url": "https://semgrep.dev/playground/r/YDTl0LG/go.lang.security.audit.xss.import-text-template.import-text-template", "version_id": "YDTl0LG"}}, "shortlink": "https://sg.run/ndEO", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.import-text-template.import-text-template", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$1": {"abstract_content": "text/template", "end": {"col": 14, "line": 1, "offset": 13}, "start": {"col": 1, "line": 1, "offset": 0}}, "$IMPORT": {"abstract_content": "text/template", "end": {"col": 16, "line": 26, "offset": 713}, "start": {"col": 3, "line": 26, "offset": 700}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "cmd/pluginpkg/pluginpkg.go", "start": {"col": 3, "line": 26, "offset": 700}}, {"check_id": "go.lang.security.audit.xss.import-text-template.import-text-template", "end": {"col": 16, "line": 13, "offset": 178}, "extra": {"engine_kind": "OSS", "fingerprint": "4d01ada92fd284fd84172fcafb1ba0c82fafcaf101db733acc579c1f0990f2b6cbd3c5c2ea97d35b1fec597cac9a89b8a4d7fd747d092a64d287f990bd000e4e_0", "fix": "html/template", "is_ignored": false, "lines": "\t\"text/template\"", "message": "When working with web applications that involve rendering user-generated  content, it's important to properly escape any HTML content to prevent  Cross-Site Scripting (XSS) attacks. In Go, the `text/template` package does  not automatically escape HTML content, which can leave your application  vulnerable to these types of attacks. To mitigate this risk, it's  recommended to use the `html/template` package instead, which provides  built-in functionality for HTML escaping. By using `html/template` to render  your HTML content, you can help to ensure that your web application is more  secure and less susceptible to XSS vulnerabilities.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www.veracode.com/blog/secure-development/use-golang-these-mistakes-could-compromise-your-apps-security"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9136, "rule_id": "5rUOZQ", "rv_id": 833868, "url": "https://semgrep.dev/playground/r/YDTl0LG/go.lang.security.audit.xss.import-text-template.import-text-template", "version_id": "YDTl0LG"}}, "shortlink": "https://sg.run/ndEO", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.import-text-template.import-text-template", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$1": {"abstract_content": "text/template", "end": {"col": 14, "line": 1, "offset": 13}, "start": {"col": 1, "line": 1, "offset": 0}}, "$IMPORT": {"abstract_content": "text/template", "end": {"col": 16, "line": 13, "offset": 178}, "start": {"col": 3, "line": 13, "offset": 165}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dumpling/export/config.go", "start": {"col": 3, "line": 13, "offset": 165}}, {"check_id": "problem-based-packs.insecure-transport.go-stdlib.bypass-tls-verification.bypass-tls-verification", "end": {"col": 4, "line": 289, "offset": 9501}, "extra": {"engine_kind": "OSS", "fingerprint": "11552d5fa8e7f1ce65e9414180b8d45114163f704044776f9e9d2b366f2decc9cc349550b6983bd5cf50506614039e5cd9f3d62d64c53995958b21363772d9dd_0", "is_ignored": false, "lines": "\t\tdriverCfg.TLS = &tls.Config{\n\t\t\tInsecureSkipVerify: true,\n\t\t\tMinVersion:         minTLSVersion,\n\t\t\tNextProtos:         []string{\"h2\", \"http/1.1\"}, // specify `h2` to let Go use HTTP/2.\n\t\t}", "message": "Checks for disabling of TLS/SSL certificate verification. This should only be used for debugging purposes because it leads to vulnerability to MTM attacks.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": "CWE-319: Cleartext Transmission of Sensitive Information", "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "HIGH", "owasp": "A03:2017 - Sensitive Data Exposure", "references": ["https://stackoverflow.com/questions/12122159/how-to-do-a-https-request-with-bad-certificate"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9400, "rule_id": "DbUpjg", "rv_id": 834309, "url": "https://semgrep.dev/playground/r/BjTe0EO/problem-based-packs.insecure-transport.go-stdlib.bypass-tls-verification.bypass-tls-verification", "version_id": "BjTe0EO"}}, "shortlink": "https://sg.run/4xj5", "source": "https://semgrep.dev/r/problem-based-packs.insecure-transport.go-stdlib.bypass-tls-verification.bypass-tls-verification", "subcategory": ["vuln"], "technology": ["go"], "vulnerability": "Insecure Transport", "vulnerability_class": ["Mishandled Sensitive Information"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dumpling/export/config.go", "start": {"col": 20, "line": 285, "offset": 9330}}, {"check_id": "go.lang.security.audit.xss.import-text-template.import-text-template", "end": {"col": 16, "line": 10, "offset": 144}, "extra": {"engine_kind": "OSS", "fingerprint": "8eb811102a5b5b99c633419b7afae2c45872365ab698e227f1cfb58ba583e8d1530f461bba88ebe94b55e57022fce2656e60d3bddfd39130e38d83f73587e3fe_0", "fix": "html/template", "is_ignored": false, "lines": "\t\"text/template\"", "message": "When working with web applications that involve rendering user-generated  content, it's important to properly escape any HTML content to prevent  Cross-Site Scripting (XSS) attacks. In Go, the `text/template` package does  not automatically escape HTML content, which can leave your application  vulnerable to these types of attacks. To mitigate this risk, it's  recommended to use the `html/template` package instead, which provides  built-in functionality for HTML escaping. By using `html/template` to render  your HTML content, you can help to ensure that your web application is more  secure and less susceptible to XSS vulnerabilities.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www.veracode.com/blog/secure-development/use-golang-these-mistakes-could-compromise-your-apps-security"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9136, "rule_id": "5rUOZQ", "rv_id": 833868, "url": "https://semgrep.dev/playground/r/YDTl0LG/go.lang.security.audit.xss.import-text-template.import-text-template", "version_id": "YDTl0LG"}}, "shortlink": "https://sg.run/ndEO", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.import-text-template.import-text-template", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$1": {"abstract_content": "text/template", "end": {"col": 14, "line": 1, "offset": 13}, "start": {"col": 1, "line": 1, "offset": 0}}, "$IMPORT": {"abstract_content": "text/template", "end": {"col": 16, "line": 10, "offset": 144}, "start": {"col": 3, "line": 10, "offset": 131}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dumpling/export/prepare.go", "start": {"col": 3, "line": 10, "offset": 131}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 61, "line": 325, "offset": 11849}, "extra": {"engine_kind": "OSS", "fingerprint": "204ccb471ff33b771cfe1f1d4724fbc37ee12d9e3033b1ddc4db715e0ff0f8040d533591c0506a62210af2a8ae6a48c86c2558a6ebe411f8f6d670dd0b958aa8_0", "is_ignored": false, "lines": "\t\t\tquery := fmt.Sprintf(queryTemplate, escapeString(schema))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CTX": {"abstract_content": "tctx", "end": {"col": 37, "line": 326, "offset": 11886}, "start": {"col": 33, "line": 326, "offset": 11882}}, "$FUNC": {"abstract_content": "updateSpecifiedTablesMeta", "end": {"col": 31, "line": 251, "offset": 9598}, "start": {"col": 6, "line": 251, "offset": 9573}}, "$OBJ": {"abstract_content": "db", "end": {"col": 19, "line": 326, "offset": 11868}, "start": {"col": 17, "line": 326, "offset": 11866}}, "$QUERY": {"abstract_content": "query", "end": {"col": 9, "line": 325, "offset": 11797}, "start": {"col": 4, "line": 325, "offset": 11792}}, "$SQLSTR": {"abstract_content": "SHOW TABLE STATUS FROM `%s`", "end": {"col": 53, "line": 323, "offset": 11748}, "start": {"col": 26, "line": 323, "offset": 11721}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dumpling/export/sql.go", "start": {"col": 4, "line": 325, "offset": 11792}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 61, "line": 442, "offset": 16209}, "extra": {"engine_kind": "OSS", "fingerprint": "430cf43f8fbd26331acf2a8a5b1c96950bf54cd3bd9754e2ef6a14a03ad8ece4f192bd8cf91d8ca857fe6c5ebaccb7fdd95531625b6e5025a2fb6449cd4a0fa9_0", "is_ignored": false, "lines": "\t\t\tquery := fmt.Sprintf(queryTemplate, escapeString(schema))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CTX": {"abstract_content": "tctx", "end": {"col": 37, "line": 443, "offset": 16246}, "start": {"col": 33, "line": 443, "offset": 16242}}, "$FUNC": {"abstract_content": "ListAllDatabasesTables", "end": {"col": 28, "line": 367, "offset": 13393}, "start": {"col": 6, "line": 367, "offset": 13371}}, "$OBJ": {"abstract_content": "db", "end": {"col": 19, "line": 443, "offset": 16228}, "start": {"col": 17, "line": 443, "offset": 16226}}, "$QUERY": {"abstract_content": "query", "end": {"col": 9, "line": 442, "offset": 16157}, "start": {"col": 4, "line": 442, "offset": 16152}}, "$SQLSTR": {"abstract_content": "SHOW TABLE STATUS FROM `%s`", "end": {"col": 53, "line": 435, "offset": 15922}, "start": {"col": 26, "line": 435, "offset": 15895}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dumpling/export/sql.go", "start": {"col": 4, "line": 442, "offset": 16152}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 106, "line": 738, "offset": 26094}, "extra": {"engine_kind": "OSS", "fingerprint": "b5a6db4a21c87f7f963ab0ff2e64365bf6afab69e342b5c681eafb61631bf37be102e7ab9ae67afea3790417b8bde9754b91caf12147d3e5d7fd02c4e4aacb12_0", "is_ignored": false, "lines": "\tlockTableQuery := fmt.Sprintf(\"LOCK TABLES `%s`.`%s` READ\", escapeString(database), escapeString(table))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CTX": {"abstract_content": "ctx", "end": {"col": 30, "line": 739, "offset": 26124}, "start": {"col": 27, "line": 739, "offset": 26121}}, "$FUNC": {"abstract_content": "LockTables", "end": {"col": 16, "line": 737, "offset": 25921}, "start": {"col": 6, "line": 737, "offset": 25911}}, "$OBJ": {"abstract_content": "db", "end": {"col": 14, "line": 739, "offset": 26108}, "start": {"col": 12, "line": 739, "offset": 26106}}, "$QUERY": {"abstract_content": "lockTableQuery", "end": {"col": 16, "line": 738, "offset": 26004}, "start": {"col": 2, "line": 738, "offset": 25990}}, "$SQLSTR": {"abstract_content": "LOCK TABLES `%s`.`%s` READ", "end": {"col": 59, "line": 738, "offset": 26047}, "start": {"col": 33, "line": 738, "offset": 26021}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dumpling/export/sql.go", "start": {"col": 2, "line": 738, "offset": 25990}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 44, "line": 966, "offset": 32977}, "extra": {"engine_kind": "OSS", "fingerprint": "c3d8b7128838b993b11240fc336ea05695473047c2dd7af1a4cae5f48839fc90fb8d670e962aee427ba343296804abd6fd88f89a95456daed4d9933922e917a5_0", "is_ignored": false, "lines": "\t\ts := fmt.Sprintf(\"SET SESSION %s = ?\", k)", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CTX": {"abstract_content": "tctx", "end": {"col": 32, "line": 967, "offset": 33009}, "start": {"col": 28, "line": 967, "offset": 33005}}, "$FUNC": {"abstract_content": "resetDBWithSessionParams", "end": {"col": 30, "line": 951, "offset": 32519}, "start": {"col": 6, "line": 951, "offset": 32495}}, "$OBJ": {"abstract_content": "db", "end": {"col": 15, "line": 967, "offset": 32992}, "start": {"col": 13, "line": 967, "offset": 32990}}, "$QUERY": {"abstract_content": "s", "end": {"col": 4, "line": 966, "offset": 32937}, "start": {"col": 3, "line": 966, "offset": 32936}}, "$SQLSTR": {"abstract_content": "SET SESSION %s = ?", "end": {"col": 39, "line": 966, "offset": 32972}, "start": {"col": 21, "line": 966, "offset": 32954}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dumpling/export/sql.go", "start": {"col": 3, "line": 966, "offset": 32936}}, {"check_id": "go.lang.security.audit.xss.import-text-template.import-text-template", "end": {"col": 16, "line": 10, "offset": 143}, "extra": {"engine_kind": "OSS", "fingerprint": "fa3a604fb08480af7bddd8b0c1ed3b4eb8fa21721d673436525a5aa8f95221f3b09d9eb13173215f98c5b760c453b15717cde939c73a53e119a123d0a571b3a3_0", "fix": "html/template", "is_ignored": false, "lines": "\t\"text/template\"", "message": "When working with web applications that involve rendering user-generated  content, it's important to properly escape any HTML content to prevent  Cross-Site Scripting (XSS) attacks. In Go, the `text/template` package does  not automatically escape HTML content, which can leave your application  vulnerable to these types of attacks. To mitigate this risk, it's  recommended to use the `html/template` package instead, which provides  built-in functionality for HTML escaping. By using `html/template` to render  your HTML content, you can help to ensure that your web application is more  secure and less susceptible to XSS vulnerabilities.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www.veracode.com/blog/secure-development/use-golang-these-mistakes-could-compromise-your-apps-security"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9136, "rule_id": "5rUOZQ", "rv_id": 833868, "url": "https://semgrep.dev/playground/r/YDTl0LG/go.lang.security.audit.xss.import-text-template.import-text-template", "version_id": "YDTl0LG"}}, "shortlink": "https://sg.run/ndEO", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.import-text-template.import-text-template", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$1": {"abstract_content": "text/template", "end": {"col": 14, "line": 1, "offset": 13}, "start": {"col": 1, "line": 1, "offset": 0}}, "$IMPORT": {"abstract_content": "text/template", "end": {"col": 16, "line": 10, "offset": 143}, "start": {"col": 3, "line": 10, "offset": 130}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "dumpling/export/writer.go", "start": {"col": 3, "line": 10, "offset": 130}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 120, "line": 1633, "offset": 54223}, "extra": {"engine_kind": "OSS", "fingerprint": "efa03e34c5e8866b94d6b31d3594fd2f029d75ed1c5a946b4bf135d7b7da73c3988a0d6b8bc2aab67daabc84f8cf428e0d1c635702440f7a4154fb250df8898d_0", "is_ignored": false, "lines": "\trows, err := db.QueryContext(ctx, fmt.Sprintf(\"ADMIN SHOW DDL JOBS %d WHERE job_id = %d\", getDDLStatusMaxJobs, jobID))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CTX": {"abstract_content": "ctx", "end": {"col": 34, "line": 1633, "offset": 54137}, "start": {"col": 31, "line": 1633, "offset": 54134}}, "$OBJ": {"abstract_content": "db", "end": {"col": 17, "line": 1633, "offset": 54120}, "start": {"col": 15, "line": 1633, "offset": 54118}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 47, "line": 1633, "offset": 54150}, "start": {"col": 40, "line": 1633, "offset": 54143}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "lightning/pkg/importer/table_import.go", "start": {"col": 15, "line": 1633, "offset": 54118}}, {"check_id": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "end": {"col": 120, "line": 1633, "offset": 54223}, "extra": {"engine_kind": "OSS", "fingerprint": "9df1d839e87386912f1f194825005e875e9a1c8c26e273efad7e8e5561086cee5d66388607a719015a54784067bc26011d410f52d1830f7a16092b64f6d2f4fc_0", "is_ignored": false, "lines": "\trows, err := db.QueryContext(ctx, fmt.Sprintf(\"ADMIN SHOW DDL JOBS %d WHERE job_id = %d\", getDDLStatusMaxJobs, jobID))", "message": "Detected string concatenation with a non-literal variable in a \"database/sql\" Go SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use prepared statements with the 'Prepare' and 'PrepareContext' calls.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10258, "rule_id": "YGUrnQ", "rv_id": 833862, "url": "https://semgrep.dev/playground/r/DkTG0E7/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "version_id": "DkTG0E7"}}, "shortlink": "https://sg.run/YgOX", "source": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "QueryContext", "end": {"col": 13, "line": 1, "offset": 12}, "start": {"col": 1, "line": 1, "offset": 0}}, "$DB": {"abstract_content": "db", "end": {"col": 17, "line": 1633, "offset": 54120}, "start": {"col": 15, "line": 1633, "offset": 54118}}, "$FUNCNAME": {"abstract_content": "getDDLStatus", "end": {"col": 18, "line": 1623, "offset": 53900}, "start": {"col": 6, "line": 1623, "offset": 53888}}, "$METHOD": {"abstract_content": "QueryContext", "end": {"col": 30, "line": 1633, "offset": 54133}, "start": {"col": 18, "line": 1633, "offset": 54121}}, "$PARAM1": {"abstract_content": "getDDLStatusMaxJobs", "end": {"col": 111, "line": 1633, "offset": 54214}, "propagated_value": {"svalue_abstract_content": "30", "svalue_end": {"col": 26, "line": 1615, "offset": 53811}, "svalue_start": {"col": 24, "line": 1615, "offset": 53809}}, "start": {"col": 92, "line": 1633, "offset": 54195}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "lightning/pkg/importer/table_import.go", "start": {"col": 15, "line": 1633, "offset": 54118}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 108, "line": 1688, "offset": 55570}, "extra": {"engine_kind": "OSS", "fingerprint": "efa03e34c5e8866b94d6b31d3594fd2f029d75ed1c5a946b4bf135d7b7da73c3988a0d6b8bc2aab67daabc84f8cf428e0d1c635702440f7a4154fb250df8898d_1", "is_ignored": false, "lines": "\trows, err := db.QueryContext(ctx, fmt.Sprintf(\"ADMIN SHOW DDL JOB QUERIES LIMIT %d\", getDDLStatusMaxJobs))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CTX": {"abstract_content": "ctx", "end": {"col": 34, "line": 1688, "offset": 55496}, "start": {"col": 31, "line": 1688, "offset": 55493}}, "$OBJ": {"abstract_content": "db", "end": {"col": 17, "line": 1688, "offset": 55479}, "start": {"col": 15, "line": 1688, "offset": 55477}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 47, "line": 1688, "offset": 55509}, "start": {"col": 40, "line": 1688, "offset": 55502}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "lightning/pkg/importer/table_import.go", "start": {"col": 15, "line": 1688, "offset": 55477}}, {"check_id": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "end": {"col": 108, "line": 1688, "offset": 55570}, "extra": {"engine_kind": "OSS", "fingerprint": "91a944a5b3ba62254393fd3733d9120b42e0fd226acb30222ccb7ae8f1f8cbdde92293d992b79d24f2c327418a2d8cbcefae84ed5d7ba77def66adbdf2d490e1_0", "is_ignored": false, "lines": "\trows, err := db.QueryContext(ctx, fmt.Sprintf(\"ADMIN SHOW DDL JOB QUERIES LIMIT %d\", getDDLStatusMaxJobs))", "message": "Detected string concatenation with a non-literal variable in a \"database/sql\" Go SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use prepared statements with the 'Prepare' and 'PrepareContext' calls.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10258, "rule_id": "YGUrnQ", "rv_id": 833862, "url": "https://semgrep.dev/playground/r/DkTG0E7/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "version_id": "DkTG0E7"}}, "shortlink": "https://sg.run/YgOX", "source": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "QueryContext", "end": {"col": 13, "line": 1, "offset": 12}, "start": {"col": 1, "line": 1, "offset": 0}}, "$DB": {"abstract_content": "db", "end": {"col": 17, "line": 1688, "offset": 55479}, "start": {"col": 15, "line": 1688, "offset": 55477}}, "$FUNCNAME": {"abstract_content": "getDDLJobIDByQuery", "end": {"col": 24, "line": 1687, "offset": 55394}, "start": {"col": 6, "line": 1687, "offset": 55376}}, "$METHOD": {"abstract_content": "QueryContext", "end": {"col": 30, "line": 1688, "offset": 55492}, "start": {"col": 18, "line": 1688, "offset": 55480}}, "$PARAM1": {"abstract_content": "getDDLStatusMaxJobs", "end": {"col": 106, "line": 1688, "offset": 55568}, "propagated_value": {"svalue_abstract_content": "30", "svalue_end": {"col": 26, "line": 1615, "offset": 53811}, "svalue_start": {"col": 24, "line": 1615, "offset": 53809}}, "start": {"col": 87, "line": 1688, "offset": 55549}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "lightning/pkg/importer/table_import.go", "start": {"col": 15, "line": 1688, "offset": 55477}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 51, "line": 91, "offset": 3125}, "extra": {"engine_kind": "OSS", "fingerprint": "1898f9af647b58dc8560b8dbc58c9f679025f5e6e3ded55932765e713fc788305209329c65a04a6e9b891cac430486f439e4242b3f2e78165809aaf277922274_0", "is_ignored": false, "lines": "\t\tq := fmt.Sprintf(\"SET SESSION %s = '%s';\", k, v)", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CTX": {"abstract_content": "ctx", "end": {"col": 35, "line": 92, "offset": 3160}, "start": {"col": 32, "line": 92, "offset": 3157}}, "$FUNC": {"abstract_content": "DBFromConfig", "end": {"col": 18, "line": 48, "offset": 1470}, "start": {"col": 6, "line": 48, "offset": 1458}}, "$OBJ": {"abstract_content": "db", "end": {"col": 19, "line": 92, "offset": 3144}, "start": {"col": 17, "line": 92, "offset": 3142}}, "$QUERY": {"abstract_content": "q", "end": {"col": 4, "line": 91, "offset": 3078}, "start": {"col": 3, "line": 91, "offset": 3077}}, "$SQLSTR": {"abstract_content": "SET SESSION %s = '%s';", "end": {"col": 43, "line": 91, "offset": 3117}, "start": {"col": 21, "line": 91, "offset": 3095}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "lightning/pkg/importer/tidb.go", "start": {"col": 3, "line": 91, "offset": 3077}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 20, "line": 875, "offset": 25956}, "extra": {"engine_kind": "OSS", "fingerprint": "5feda9f59563db272edd15ae0cab262d6730cc509d9e14e1a37915b39e65517ca325082a242b2ad3cef4d20a7ef0b70980677a247386bcde138f3e6e6758438d_0", "is_ignored": false, "lines": "\t\t_, _ = w.Write(b)", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "writeBytesCompressed", "end": {"col": 26, "line": 873, "offset": 25815}, "start": {"col": 6, "line": 873, "offset": 25795}}, "$WRITER": {"abstract_content": "w", "end": {"col": 11, "line": 875, "offset": 25947}, "start": {"col": 10, "line": 875, "offset": 25946}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "lightning/pkg/server/lightning.go", "start": {"col": 10, "line": 875, "offset": 25946}}, {"check_id": "go.lang.security.audit.xss.no-fprintf-to-responsewriter.no-fprintf-to-responsewriter", "end": {"col": 69, "line": 919, "offset": 27167}, "extra": {"engine_kind": "OSS", "fingerprint": "507040049cf012a8f8e18a8db7a6be175901bcd37ff030f9a9711c3e528914fd7b155fed2e7c255416df630cbee703a7d87091b83ef8ba79aaa4acbed307b8be_0", "is_ignored": false, "lines": "\t\tfmt.Fprintf(w, `{\"paused\":%v}`, importer.DeliverPauser.IsPaused())", "message": "Detected 'Fprintf' or similar writing to 'http.ResponseWriter'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package to render data to users.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9138, "rule_id": "ReUgyJ", "rv_id": 833870, "url": "https://semgrep.dev/playground/r/o5TBEAp/go.lang.security.audit.xss.no-fprintf-to-responsewriter.no-fprintf-to-responsewriter", "version_id": "o5TBEAp"}}, "shortlink": "https://sg.run/7oqR", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-fprintf-to-responsewriter.no-fprintf-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "handlePause", "end": {"col": 17, "line": 913, "offset": 26927}, "start": {"col": 6, "line": 913, "offset": 26916}}, "$PRINTF": {"abstract_content": "Fprintf", "end": {"col": 14, "line": 919, "offset": 27112}, "start": {"col": 7, "line": 919, "offset": 27105}}, "$WRITER": {"abstract_content": "w", "end": {"col": 16, "line": 919, "offset": 27114}, "start": {"col": 15, "line": 919, "offset": 27113}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "lightning/pkg/server/lightning.go", "start": {"col": 3, "line": 919, "offset": 27101}}, {"check_id": "trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "end": {"col": 2, "line": 1255, "offset": 59268}, "extra": {"engine_kind": "OSS", "fingerprint": "448276276bf6d7592b66068d4b3b66431d8ae4746d53cdfd3cbc0710d9be4ab091fdf9dd8bdb521a2debee28f2f571f63968f26991615ba97812bc54d21f799b_0", "is_ignored": false, "lines": "var removedConfig = map[string]struct{}{\n\t\"pessimistic-txn.ttl\":                {},\n\t\"pessimistic-txn.enable\":             {},\n\t\"log.file.log-rotate\":                {},\n\t\"log.log-slow-query\":                 {},\n\t\"txn-local-latches\":                  {},\n\t\"txn-local-latches.enabled\":          {},\n\t\"txn-local-latches.capacity\":         {},\n\t\"performance.max-memory\":             {},\n\t\"max-txn-time-use\":                   {},\n\t\"experimental.allow-auto-random\":     {},\n\t\"enable-redact-log\":                  {}, // use variable tidb_redact_log instead\n\t\"enable-streaming\":                   {},\n\t\"performance.mem-profile-interval\":   {},\n\t\"security.require-secure-transport\":  {},\n\t\"lower-case-table-names\":             {},\n\t\"stmt-summary\":                       {},\n\t\"stmt-summary.enable\":                {},\n\t\"stmt-summary.enable-internal-query\": {},\n\t\"stmt-summary.max-stmt-count\":        {},\n\t\"stmt-summary.max-sql-length\":        {},\n\t\"stmt-summary.refresh-interval\":      {},\n\t\"stmt-summary.history-size\":          {},\n\t\"enable-batch-dml\":                   {}, // use tidb_enable_batch_dml\n\t\"mem-quota-query\":                    {},\n\t\"log.query-log-max-len\":              {},\n\t\"performance.committer-concurrency\":  {},\n\t\"experimental.enable-global-kill\":    {},\n\t\"performance.run-auto-analyze\":       {}, // use tidb_enable_auto_analyze\n\t// use tidb_enable_prepared_plan_cache, tidb_prepared_plan_cache_size and tidb_prepared_plan_cache_memory_guard_ratio\n\t\"prepared-plan-cache.enabled\":            {},\n\t\"prepared-plan-cache.capacity\":           {},\n\t\"prepared-plan-cache.memory-guard-ratio\": {},\n\t\"oom-action\":                             {},\n\t\"check-mb4-value-in-utf8\":                {}, // use tidb_check_mb4_value_in_utf8\n\t\"enable-collect-execution-info\":          {}, // use tidb_enable_collect_execution_info\n\t\"log.enable-slow-log\":                    {}, // use tidb_enable_slow_log\n\t\"log.slow-threshold\":                     {}, // use tidb_slow_log_threshold\n\t\"log.record-plan-in-slow-log\":            {}, // use tidb_record_plan_in_slow_log\n\t\"log.expensive-threshold\":                {},\n\t\"performance.force-priority\":             {}, // use tidb_force_priority\n\t\"performance.memory-usage-alarm-ratio\":   {}, // use tidb_memory_usage_alarm_ratio\n\t\"plugin.load\":                            {}, // use plugin_load\n\t\"plugin.dir\":                             {}, // use plugin_dir\n\t\"performance.feedback-probability\":       {}, // This feature is deprecated\n\t\"performance.query-feedback-limit\":       {},\n\t\"oom-use-tmp-storage\":                    {}, // use tidb_enable_tmp_storage_on_oom\n\t\"max-server-connections\":                 {}, // use sysvar max_connections\n\t\"run-ddl\":                                {}, // use sysvar tidb_enable_ddl\n\t\"instance.tidb_memory_usage_alarm_ratio\": {}, // use sysvar tidb_memory_usage_alarm_ratio\n\t\"enable-global-index\":                    {}, // use sysvar tidb_enable_global_index\n}\n\n// isAllRemovedConfigItems returns true if all the items that couldn't validate\n// belong to the list of removedConfig items.\nfunc isAllRemovedConfigItems(items []string) bool {\n\tfor _, item := range items {\n\t\tif _, ok := removedConfig[item]; !ok {\n\t\t\treturn false\n\t\t}\n\t}\n\treturn true\n}\n\n// InitializeConfig initialize the global config handler.\n// The function enforceCmdArgs is used to merge the config file with command arguments:\n// For example, if you start TiDB by the command \"./tidb-server --port=3000\", the port number should be\n// overwritten to 3000 and ignore the port number in the config file.\nfunc InitializeConfig(confPath string, configCheck, configStrict bool, enforceCmdArgs func(*Config, *flag.FlagSet), fset *flag.FlagSet) {\n\tcfg := GetGlobalConfig()\n\tvar err error\n\tif confPath != \"\" {\n\t\tif err = cfg.Load(confPath); err != nil {\n\t\t\t// Unused config item error turns to warnings.\n\t\t\tif tmp, ok := err.(*ErrConfigValidationFailed); ok {\n\t\t\t\t// This block is to accommodate an interim situation where strict config checking\n\t\t\t\t// is not the default behavior of TiDB. The warning message must be deferred until\n\t\t\t\t// logging has been set up. After strict config checking is the default behavior,\n\t\t\t\t// This should all be removed.\n\t\t\t\tif (!configCheck && !configStrict) || isAllRemovedConfigItems(tmp.UndecodedItems) {\n\t\t\t\t\tfmt.Fprintln(os.Stderr, err.Error())\n\t\t\t\t\terr = nil\n\t\t\t\t}\n\t\t\t} else if tmp, ok := err.(*ErrConfigInstanceSection); ok {\n\t\t\t\tlogutil.BgLogger().Warn(tmp.Error())\n\t\t\t\terr = nil\n\t\t\t}\n\t\t}\n\t\t// In configCheck we always print out which options in the config file\n\t\t// have been removed. This helps users upgrade better.\n\t\tif configCheck {\n\t\t\terr = cfg.RemovedVariableCheck(confPath)\n\t\t\tif err != nil {\n\t\t\t\tlogutil.BgLogger().Warn(err.Error())\n\t\t\t\terr = nil // treat as warning\n\t\t\t}\n\t\t}\n\n\t\tterror.MustNil(err)\n\t} else {\n\t\t// configCheck should have the config file specified.\n\t\tif configCheck {\n\t\t\tfmt.Fprintln(os.Stderr, \"config check failed\", errors.New(\"no config file specified for config-check\"))\n\t\t\tos.Exit(1)\n\t\t}\n\t}\n\tenforceCmdArgs(cfg, fset)\n\n\tif err := cfg.Valid(); err != nil {\n\t\tif !filepath.IsAbs(confPath) {\n\t\t\tif tmp, err := filepath.Abs(confPath); err == nil {\n\t\t\t\tconfPath = tmp\n\t\t\t}\n\t\t}\n\t\tfmt.Fprintln(os.Stderr, \"load config file:\", confPath)\n\t\tfmt.Fprintln(os.Stderr, \"invalid config\", err)\n\t\tos.Exit(1)\n\t}\n\tif configCheck {\n\t\tfmt.Println(\"config check successful\")\n\t\tos.Exit(0)\n\t}\n\tStoreGlobalConfig(cfg)\n}\n\n// RemovedVariableCheck checks if the config file contains any items\n// which have been removed. These will not take effect any more.\nfunc (c *Config) RemovedVariableCheck(confFile string) error {\n\tmetaData, err := toml.DecodeFile(confFile, c)\n\tif err != nil {\n\t\treturn err\n\t}\n\tvar removed []string\n\tfor item := range removedConfig {\n\t\t// We need to split the string to account for the top level\n\t\t// and the section hierarchy of config.\n\t\ttmp := strings.Split(item, \".\")\n\t\tif len(tmp) == 2 && metaData.IsDefined(tmp[0], tmp[1]) {\n\t\t\tremoved = append(removed, item)\n\t\t} else if len(tmp) == 1 && metaData.IsDefined(tmp[0]) {\n\t\t\tremoved = append(removed, item)\n\t\t}\n\t}\n\tif len(removed) > 0 {\n\t\tsort.Strings(removed) // deterministic for tests\n\t\treturn fmt.Errorf(\"The following configuration options are no longer supported in this version of TiDB. Check the release notes for more information: %s\", strings.Join(removed, \", \"))\n\t}\n\treturn nil\n}", "message": "Iteration over a possibly empty map `removedConfig`. This is likely a bug or redundant code", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": "CWE-665: Improper Initialization", "description": "Probably redundant iteration over an empty map", "impact": "LOW", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17198, "rule_id": "wdUlww", "rv_id": 833266, "url": "https://semgrep.dev/playground/r/pZTXjeW/trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "version_id": "pZTXjeW"}}, "shortlink": "https://sg.run/08jj", "source": "https://semgrep.dev/r/trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$C": {"abstract_content": "removedConfig", "end": {"col": 18, "line": 1107, "offset": 52937}, "start": {"col": 5, "line": 1107, "offset": 52924}}, "$K": {"abstract_content": "item", "end": {"col": 10, "line": 1240, "offset": 58634}, "start": {"col": 6, "line": 1240, "offset": 58630}}, "$T1": {"abstract_content": "string", "end": {"col": 31, "line": 1107, "offset": 52950}, "start": {"col": 25, "line": 1107, "offset": 52944}}, "$T2": {"abstract_content": "struct{}", "end": {"col": 40, "line": 1107, "offset": 52959}, "start": {"col": 32, "line": 1107, "offset": 52951}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/config/config.go", "start": {"col": 5, "line": 1107, "offset": 52924}}, {"check_id": "trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "end": {"col": 2, "line": 1535, "offset": 69517}, "extra": {"engine_kind": "OSS", "fingerprint": "6231d44325c7f04ebdd0236789706e8618abc38a0328ad7002c78b1972885322c8fec806387d250fb0e81dbdff05e6e6999e5d92975a54c93c4520caf53b5403_0", "is_ignored": false, "lines": "var removedConfig = map[string]struct{}{\n\t\"pessimistic-txn.ttl\":                {},\n\t\"pessimistic-txn.enable\":             {},\n\t\"log.file.log-rotate\":                {},\n\t\"log.log-slow-query\":                 {},\n\t\"txn-local-latches\":                  {},\n\t\"txn-local-latches.enabled\":          {},\n\t\"txn-local-latches.capacity\":         {},\n\t\"performance.max-memory\":             {},\n\t\"max-txn-time-use\":                   {},\n\t\"experimental.allow-auto-random\":     {},\n\t\"enable-redact-log\":                  {}, // use variable tidb_redact_log instead\n\t\"enable-streaming\":                   {},\n\t\"performance.mem-profile-interval\":   {},\n\t\"security.require-secure-transport\":  {},\n\t\"lower-case-table-names\":             {},\n\t\"stmt-summary\":                       {},\n\t\"stmt-summary.enable\":                {},\n\t\"stmt-summary.enable-internal-query\": {},\n\t\"stmt-summary.max-stmt-count\":        {},\n\t\"stmt-summary.max-sql-length\":        {},\n\t\"stmt-summary.refresh-interval\":      {},\n\t\"stmt-summary.history-size\":          {},\n\t\"enable-batch-dml\":                   {}, // use tidb_enable_batch_dml\n\t\"mem-quota-query\":                    {},\n\t\"log.query-log-max-len\":              {},\n\t\"performance.committer-concurrency\":  {},\n\t\"experimental.enable-global-kill\":    {},\n\t\"performance.run-auto-analyze\":       {}, // use tidb_enable_auto_analyze\n\t// use tidb_enable_prepared_plan_cache, tidb_prepared_plan_cache_size and tidb_prepared_plan_cache_memory_guard_ratio\n\t\"prepared-plan-cache.enabled\":            {},\n\t\"prepared-plan-cache.capacity\":           {},\n\t\"prepared-plan-cache.memory-guard-ratio\": {},\n\t\"oom-action\":                             {},\n\t\"check-mb4-value-in-utf8\":                {}, // use tidb_check_mb4_value_in_utf8\n\t\"enable-collect-execution-info\":          {}, // use tidb_enable_collect_execution_info\n\t\"log.enable-slow-log\":                    {}, // use tidb_enable_slow_log\n\t\"log.slow-threshold\":                     {}, // use tidb_slow_log_threshold\n\t\"log.record-plan-in-slow-log\":            {}, // use tidb_record_plan_in_slow_log\n\t\"log.expensive-threshold\":                {},\n\t\"performance.force-priority\":             {}, // use tidb_force_priority\n\t\"performance.memory-usage-alarm-ratio\":   {}, // use tidb_memory_usage_alarm_ratio\n\t\"plugin.load\":                            {}, // use plugin_load\n\t\"plugin.dir\":                             {}, // use plugin_dir\n\t\"performance.feedback-probability\":       {}, // This feature is deprecated\n\t\"performance.query-feedback-limit\":       {},\n\t\"oom-use-tmp-storage\":                    {}, // use tidb_enable_tmp_storage_on_oom\n\t\"max-server-connections\":                 {}, // use sysvar max_connections\n\t\"run-ddl\":                                {}, // use sysvar tidb_enable_ddl\n\t\"instance.tidb_memory_usage_alarm_ratio\": {}, // use sysvar tidb_memory_usage_alarm_ratio\n\t\"enable-global-index\":                    {}, // use sysvar tidb_enable_global_index\n}\n\n// isAllRemovedConfigItems returns true if all the items that couldn't validate\n// belong to the list of removedConfig items.\nfunc isAllRemovedConfigItems(items []string) bool {\n\tfor _, item := range items {\n\t\tif _, ok := removedConfig[item]; !ok {\n\t\t\treturn false\n\t\t}\n\t}\n\treturn true\n}\n\n// InitializeConfig initialize the global config handler.\n// The function enforceCmdArgs is used to merge the config file with command arguments:\n// For example, if you start TiDB by the command \"./tidb-server --port=3000\", the port number should be\n// overwritten to 3000 and ignore the port number in the config file.\nfunc InitializeConfig(confPath string, configCheck, configStrict bool, enforceCmdArgs func(*Config, *flag.FlagSet), fset *flag.FlagSet) {\n\tcfg := GetGlobalConfig()\n\tvar err error\n\tif confPath != \"\" {\n\t\tif err = cfg.Load(confPath); err != nil {\n\t\t\t// Unused config item error turns to warnings.\n\t\t\tif tmp, ok := err.(*ErrConfigValidationFailed); ok {\n\t\t\t\t// This block is to accommodate an interim situation where strict config checking\n\t\t\t\t// is not the default behavior of TiDB. The warning message must be deferred until\n\t\t\t\t// logging has been set up. After strict config checking is the default behavior,\n\t\t\t\t// This should all be removed.\n\t\t\t\tif (!configCheck && !configStrict) || isAllRemovedConfigItems(tmp.UndecodedItems) {\n\t\t\t\t\tfmt.Fprintln(os.Stderr, err.Error())\n\t\t\t\t\terr = nil\n\t\t\t\t}\n\t\t\t} else if tmp, ok := err.(*ErrConfigInstanceSection); ok {\n\t\t\t\tlogutil.BgLogger().Warn(tmp.Error())\n\t\t\t\terr = nil\n\t\t\t}\n\t\t}\n\t\t// In configCheck we always print out which options in the config file\n\t\t// have been removed. This helps users upgrade better.\n\t\tif configCheck {\n\t\t\terr = cfg.RemovedVariableCheck(confPath)\n\t\t\tif err != nil {\n\t\t\t\tlogutil.BgLogger().Warn(err.Error())\n\t\t\t\terr = nil // treat as warning\n\t\t\t}\n\t\t}\n\n\t\tterror.MustNil(err)\n\t} else {\n\t\t// configCheck should have the config file specified.\n\t\tif configCheck {\n\t\t\tfmt.Fprintln(os.Stderr, \"config check failed\", errors.New(\"no config file specified for config-check\"))\n\t\t\tos.Exit(1)\n\t\t}\n\t}\n\tenforceCmdArgs(cfg, fset)\n\n\tif err := cfg.Valid(); err != nil {\n\t\tif !filepath.IsAbs(confPath) {\n\t\t\tif tmp, err := filepath.Abs(confPath); err == nil {\n\t\t\t\tconfPath = tmp\n\t\t\t}\n\t\t}\n\t\tfmt.Fprintln(os.Stderr, \"load config file:\", confPath)\n\t\tfmt.Fprintln(os.Stderr, \"invalid config\", err)\n\t\tos.Exit(1)\n\t}\n\tif configCheck {\n\t\tfmt.Println(\"config check successful\")\n\t\tos.Exit(0)\n\t}\n\tStoreGlobalConfig(cfg)\n}\n\n// RemovedVariableCheck checks if the config file contains any items\n// which have been removed. These will not take effect any more.\nfunc (c *Config) RemovedVariableCheck(confFile string) error {\n\tmetaData, err := toml.DecodeFile(confFile, c)\n\tif err != nil {\n\t\treturn err\n\t}\n\tvar removed []string\n\tfor item := range removedConfig {\n\t\t// We need to split the string to account for the top level\n\t\t// and the section hierarchy of config.\n\t\ttmp := strings.Split(item, \".\")\n\t\tif len(tmp) == 2 && metaData.IsDefined(tmp[0], tmp[1]) {\n\t\t\tremoved = append(removed, item)\n\t\t} else if len(tmp) == 1 && metaData.IsDefined(tmp[0]) {\n\t\t\tremoved = append(removed, item)\n\t\t}\n\t}\n\tif len(removed) > 0 {\n\t\tsort.Strings(removed) // deterministic for tests\n\t\treturn fmt.Errorf(\"The following configuration options are no longer supported in this version of TiDB. Check the release notes for more information: %s\", strings.Join(removed, \", \"))\n\t}\n\treturn nil\n}\n\n// Load loads config options from a toml file.\nfunc (c *Config) Load(confFile string) error {\n\tmetaData, err := toml.DecodeFile(confFile, c)\n\tif err != nil {\n\t\treturn err\n\t}\n\tif c.TokenLimit == 0 {\n\t\tc.TokenLimit = 1000\n\t} else if c.TokenLimit > MaxTokenLimit {\n\t\tc.TokenLimit = MaxTokenLimit\n\t}\n\t// If any items in confFile file are not mapped into the Config struct, issue\n\t// an error and stop the server from starting.\n\tundecoded := metaData.Undecoded()\n\tif len(undecoded) > 0 {\n\t\tvar undecodedItems []string\n\t\tfor _, item := range undecoded {\n\t\t\tundecodedItems = append(undecodedItems, item.String())\n\t\t}\n\t\terr = &ErrConfigValidationFailed{confFile, undecodedItems}\n\t}\n\n\tfor _, section := range sectionMovedToInstance {\n\t\tnewConflictSection := InstanceConfigSection{SectionName: section.SectionName, NameMappings: map[string]string{}}\n\t\tnewDeprecatedSection := InstanceConfigSection{SectionName: section.SectionName, NameMappings: map[string]string{}}\n\t\tfor oldName, newName := range section.NameMappings {\n\t\t\tif section.SectionName == \"\" && metaData.IsDefined(oldName) ||\n\t\t\t\tsection.SectionName != \"\" && metaData.IsDefined(section.SectionName, oldName) {\n\t\t\t\tif metaData.IsDefined(\"instance\", newName) {\n\t\t\t\t\tnewConflictSection.NameMappings[oldName] = newName\n\t\t\t\t} else {\n\t\t\t\t\tnewDeprecatedSection.NameMappings[oldName] = newName\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif len(newConflictSection.NameMappings) > 0 {\n\t\t\tConflictOptions = append(ConflictOptions, newConflictSection)\n\t\t}\n\t\tif len(newDeprecatedSection.NameMappings) > 0 {\n\t\t\tDeprecatedOptions = append(DeprecatedOptions, newDeprecatedSection)\n\t\t}\n\t}\n\tif len(ConflictOptions) > 0 || len(DeprecatedOptions) > 0 {\n\t\t// Give a warning that the 'instance' section should be used.\n\t\terr = &ErrConfigInstanceSection{confFile, &ConflictOptions, &DeprecatedOptions}\n\t}\n\n\treturn err\n}\n\n// Valid checks if this config is valid.\nfunc (c *Config) Valid() error {\n\tif c.Log.EnableErrorStack == c.Log.DisableErrorStack && c.Log.EnableErrorStack != nbUnset {\n\t\tlogutil.BgLogger().Warn(fmt.Sprintf(\"\\\"enable-error-stack\\\" (%v) conflicts \\\"disable-error-stack\\\" (%v). \\\"disable-error-stack\\\" is deprecated, please use \\\"enable-error-stack\\\" instead. disable-error-stack is ignored.\", c.Log.EnableErrorStack, c.Log.DisableErrorStack))\n\t\t// if two options conflict, we will use the value of EnableErrorStack\n\t\tc.Log.DisableErrorStack = nbUnset\n\t}\n\tif c.Log.EnableTimestamp == c.Log.DisableTimestamp && c.Log.EnableTimestamp != nbUnset {\n\t\tlogutil.BgLogger().Warn(fmt.Sprintf(\"\\\"enable-timestamp\\\" (%v) conflicts \\\"disable-timestamp\\\" (%v). \\\"disable-timestamp\\\" is deprecated, please use \\\"enable-timestamp\\\" instead\", c.Log.EnableTimestamp, c.Log.DisableTimestamp))\n\t\t// if two options conflict, we will use the value of EnableTimestamp\n\t\tc.Log.DisableTimestamp = nbUnset\n\t}\n\tif c.Security.SkipGrantTable && !hasRootPrivilege() {\n\t\treturn fmt.Errorf(\"TiDB run with skip-grant-table need root privilege\")\n\t}\n\tif !ValidStorage[c.Store] {\n\t\tnameList := make([]string, 0, len(ValidStorage))\n\t\tfor k, v := range ValidStorage {\n\t\t\tif v {\n\t\t\t\tnameList = append(nameList, k)\n\t\t\t}\n\t\t}\n\t\treturn fmt.Errorf(\"invalid store=%s, valid storages=%v\", c.Store, nameList)\n\t}\n\tif c.Store == \"mocktikv\" && !c.Instance.TiDBEnableDDL.Load() {\n\t\treturn fmt.Errorf(\"can't disable DDL on mocktikv\")\n\t}\n\tif c.MaxIndexLength < DefMaxIndexLength || c.MaxIndexLength > DefMaxOfMaxIndexLength {\n\t\treturn fmt.Errorf(\"max-index-length should be [%d, %d]\", DefMaxIndexLength, DefMaxOfMaxIndexLength)\n\t}\n\tif c.IndexLimit < DefIndexLimit || c.IndexLimit > DefMaxOfIndexLimit {\n\t\treturn fmt.Errorf(\"index-limit should be [%d, %d]\", DefIndexLimit, DefMaxOfIndexLimit)\n\t}\n\tif c.Log.File.MaxSize > MaxLogFileSize {\n\t\treturn fmt.Errorf(\"invalid max log file size=%v which is larger than max=%v\", c.Log.File.MaxSize, MaxLogFileSize)\n\t}\n\tif c.TableColumnCountLimit < DefTableColumnCountLimit || c.TableColumnCountLimit > DefMaxOfTableColumnCountLimit {\n\t\treturn fmt.Errorf(\"table-column-limit should be [%d, %d]\", DefIndexLimit, DefMaxOfTableColumnCountLimit)\n\t}\n\n\t// txn-local-latches\n\tif err := c.TxnLocalLatches.Valid(); err != nil {\n\t\treturn err\n\t}\n\n\t// For tikvclient.\n\tif err := c.TiKVClient.Valid(); err != nil {\n\t\treturn err\n\t}\n\tif err := c.TrxSummary.Valid(); err != nil {\n\t\treturn err\n\t}\n\n\tif c.Performance.TxnTotalSizeLimit > 1<<40 {\n\t\treturn fmt.Errorf(\"txn-total-size-limit should be less than %d\", 1<<40)\n\t}\n\n\tif c.Instance.MemoryUsageAlarmRatio > 1 || c.Instance.MemoryUsageAlarmRatio < 0 {\n\t\treturn fmt.Errorf(\"tidb_memory_usage_alarm_ratio in [Instance] must be greater than or equal to 0 and less than or equal to 1\")\n\t}\n\n\tif len(c.IsolationRead.Engines) < 1 {\n\t\treturn fmt.Errorf(\"the number of [isolation-read]engines for isolation read should be at least 1\")\n\t}\n\tfor _, engine := range c.IsolationRead.Engines {\n\t\tif engine != \"tidb\" && engine != \"tikv\" && engine != \"tiflash\" {\n\t\t\treturn fmt.Errorf(\"type of [isolation-read]engines can't be %v should be one of tidb or tikv or tiflash\", engine)\n\t\t}\n\t}\n\n\t// test security\n\tc.Security.SpilledFileEncryptionMethod = strings.ToLower(c.Security.SpilledFileEncryptionMethod)\n\tswitch c.Security.SpilledFileEncryptionMethod {\n\tcase SpilledFileEncryptionMethodPlaintext, SpilledFileEncryptionMethodAES128CTR:\n\tdefault:\n\t\treturn fmt.Errorf(\"unsupported [security]spilled-file-encryption-method %v, TiDB only supports [%v, %v]\",\n\t\t\tc.Security.SpilledFileEncryptionMethod, SpilledFileEncryptionMethodPlaintext, SpilledFileEncryptionMethodAES128CTR)\n\t}\n\n\t// check stats load config\n\tif c.Performance.StatsLoadConcurrency < DefStatsLoadConcurrencyLimit || c.Performance.StatsLoadConcurrency > DefMaxOfStatsLoadConcurrencyLimit {\n\t\treturn fmt.Errorf(\"stats-load-concurrency should be [%d, %d]\", DefStatsLoadConcurrencyLimit, DefMaxOfStatsLoadConcurrencyLimit)\n\t}\n\tif c.Performance.StatsLoadQueueSize < DefStatsLoadQueueSizeLimit || c.Performance.StatsLoadQueueSize > DefMaxOfStatsLoadQueueSizeLimit {\n\t\treturn fmt.Errorf(\"stats-load-queue-size should be [%d, %d]\", DefStatsLoadQueueSizeLimit, DefMaxOfStatsLoadQueueSizeLimit)\n\t}\n\n\t// Check tiflash_compute topo fetch is valid.\n\tif c.DisaggregatedTiFlash && c.UseAutoScaler {\n\t\tif !tiflashcompute.IsValidAutoScalerConfig(c.TiFlashComputeAutoScalerType) {\n\t\t\treturn fmt.Errorf(\"invalid AutoScaler type, expect %s, %s or %s, got %s\",\n\t\t\t\ttiflashcompute.MockASStr, tiflashcompute.AWSASStr, tiflashcompute.GCPASStr, c.TiFlashComputeAutoScalerType)\n\t\t}\n\t\tif c.TiFlashComputeAutoScalerAddr == \"\" {\n\t\t\treturn fmt.Errorf(\"autoscaler-addr cannot be empty when disaggregated-tiflash mode is true\")\n\t\t}\n\t}\n\n\t// test log level\n\tl := zap.NewAtomicLevel()\n\treturn l.UnmarshalText([]byte(c.Log.Level))\n}\n\n// UpdateGlobal updates the global config, and provide a restore function that can be used to restore to the original.\nfunc UpdateGlobal(f func(conf *Config)) {\n\tg := GetGlobalConfig()\n\tnewConf := *g\n\tf(&newConf)\n\tStoreGlobalConfig(&newConf)\n}\n\n// RestoreFunc gets a function that restore the config to the current value.\nfunc RestoreFunc() (restore func()) {\n\tg := GetGlobalConfig()\n\treturn func() {\n\t\tStoreGlobalConfig(g)\n\t}\n}\n\nfunc hasRootPrivilege() bool {\n\treturn os.Geteuid() == 0\n}\n\n// TableLockEnabled uses to check whether enabled the table lock feature.\nfunc TableLockEnabled() bool {\n\treturn GetGlobalConfig().EnableTableLock\n}\n\n// TableLockDelayClean uses to get the time of delay clean table lock.\nvar TableLockDelayClean = func() uint64 {\n\treturn GetGlobalConfig().DelayCleanTableLock\n}\n\n// ToLogConfig converts *Log to *logutil.LogConfig.\nfunc (l *Log) ToLogConfig() *logutil.LogConfig {\n\treturn logutil.NewLogConfig(l.Level, l.Format, l.SlowQueryFile, l.GeneralLogFile, l.File, l.getDisableTimestamp(),\n\t\tfunc(config *zaplog.Config) { config.DisableErrorVerbose = l.getDisableErrorStack() },\n\t\tfunc(config *zaplog.Config) { config.Timeout = l.Timeout },\n\t)\n}\n\n// ToTracingConfig converts *OpenTracing to *tracing.Configuration.\nfunc (t *OpenTracing) ToTracingConfig() *tracing.Configuration {\n\tret := &tracing.Configuration{\n\t\tDisabled:   !t.Enable,\n\t\tRPCMetrics: t.RPCMetrics,\n\t\tReporter:   &tracing.ReporterConfig{},\n\t\tSampler:    &tracing.SamplerConfig{},\n\t}\n\tret.Reporter.QueueSize = t.Reporter.QueueSize\n\tret.Reporter.BufferFlushInterval = t.Reporter.BufferFlushInterval\n\tret.Reporter.LogSpans = t.Reporter.LogSpans\n\tret.Reporter.LocalAgentHostPort = t.Reporter.LocalAgentHostPort\n\n\tret.Sampler.Type = t.Sampler.Type\n\tret.Sampler.Param = t.Sampler.Param\n\tret.Sampler.SamplingServerURL = t.Sampler.SamplingServerURL\n\tret.Sampler.MaxOperations = t.Sampler.MaxOperations\n\tret.Sampler.SamplingRefreshInterval = t.Sampler.SamplingRefreshInterval\n\treturn ret\n}\n\nfunc init() {\n\tinitByLDFlags(versioninfo.TiDBEdition, checkBeforeDropLDFlag)\n}\n\nfunc initByLDFlags(edition, checkBeforeDropLDFlag string) {\n\tconf := defaultConf\n\tStoreGlobalConfig(&conf)\n\tif checkBeforeDropLDFlag == \"1\" {\n\t\tCheckTableBeforeDrop = true\n\t}\n}\n\n// hideConfig is used to filter a single line of config for hiding.\nvar hideConfig = []string{\n\t\"performance.index-usage-sync-lease\",\n}\n\n// GetJSONConfig returns the config as JSON with hidden items removed\n// It replaces the earlier HideConfig() which used strings.Split() in\n// an way that didn't work for similarly named items (like enable).\nfunc GetJSONConfig() (string, error) {\n\tj, err := json.Marshal(GetGlobalConfig())\n\tif err != nil {\n\t\treturn \"\", err\n\t}\n\n\tjsonValue := make(map[string]any)\n\terr = json.Unmarshal(j, &jsonValue)\n\tif err != nil {\n\t\treturn \"\", err\n\t}\n\n\tremovedPaths := make([]string, 0, len(removedConfig)+len(hideConfig))\n\tfor removedItem := range removedConfig {\n\t\tremovedPaths = append(removedPaths, removedItem)\n\t}\n\tremovedPaths = append(removedPaths, hideConfig...)\n\n\tfor _, path := range removedPaths {\n\t\ts := strings.Split(path, \".\")\n\t\tcurValue := jsonValue\n\t\tfor i, key := range s {\n\t\t\tif i == len(s)-1 {\n\t\t\t\tdelete(curValue, key)\n\t\t\t}\n\t\t\tif curValue[key] == nil {\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tmapValue, ok := curValue[key].(map[string]any)\n\t\t\tif !ok {\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcurValue = mapValue\n\t\t}\n\t}\n\n\tbuf, err := json.Marshal(jsonValue)\n\tif err != nil {\n\t\treturn \"\", err\n\t}\n\n\tvar resBuf bytes.Buffer\n\tif err = json.Indent(&resBuf, buf, \"\", \"\\t\"); err != nil {\n\t\treturn \"\", err\n\t}\n\treturn resBuf.String(), nil\n}", "message": "Iteration over a possibly empty map `removedConfig`. This is likely a bug or redundant code", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": "CWE-665: Improper Initialization", "description": "Probably redundant iteration over an empty map", "impact": "LOW", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17198, "rule_id": "wdUlww", "rv_id": 833266, "url": "https://semgrep.dev/playground/r/pZTXjeW/trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "version_id": "pZTXjeW"}}, "shortlink": "https://sg.run/08jj", "source": "https://semgrep.dev/r/trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$C": {"abstract_content": "removedConfig", "end": {"col": 18, "line": 1107, "offset": 52937}, "start": {"col": 5, "line": 1107, "offset": 52924}}, "$K": {"abstract_content": "removedItem", "end": {"col": 17, "line": 1502, "offset": 68850}, "start": {"col": 6, "line": 1502, "offset": 68839}}, "$T1": {"abstract_content": "string", "end": {"col": 31, "line": 1107, "offset": 52950}, "start": {"col": 25, "line": 1107, "offset": 52944}}, "$T2": {"abstract_content": "struct{}", "end": {"col": 40, "line": 1107, "offset": 52959}, "start": {"col": 32, "line": 1107, "offset": 52951}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/config/config.go", "start": {"col": 5, "line": 1107, "offset": 52924}}, {"check_id": "trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "end": {"col": 2, "line": 1551, "offset": 69865}, "extra": {"engine_kind": "OSS", "fingerprint": "eeb3ae4cdffba77f4cdaca3b89fa2643be6e3c6726033297846f21f9cff643a95155e89b09772d0c3347c9a11ade9f29789e8c697da4481de2085098e4914b02_0", "is_ignored": false, "lines": "var removedConfig = map[string]struct{}{\n\t\"pessimistic-txn.ttl\":                {},\n\t\"pessimistic-txn.enable\":             {},\n\t\"log.file.log-rotate\":                {},\n\t\"log.log-slow-query\":                 {},\n\t\"txn-local-latches\":                  {},\n\t\"txn-local-latches.enabled\":          {},\n\t\"txn-local-latches.capacity\":         {},\n\t\"performance.max-memory\":             {},\n\t\"max-txn-time-use\":                   {},\n\t\"experimental.allow-auto-random\":     {},\n\t\"enable-redact-log\":                  {}, // use variable tidb_redact_log instead\n\t\"enable-streaming\":                   {},\n\t\"performance.mem-profile-interval\":   {},\n\t\"security.require-secure-transport\":  {},\n\t\"lower-case-table-names\":             {},\n\t\"stmt-summary\":                       {},\n\t\"stmt-summary.enable\":                {},\n\t\"stmt-summary.enable-internal-query\": {},\n\t\"stmt-summary.max-stmt-count\":        {},\n\t\"stmt-summary.max-sql-length\":        {},\n\t\"stmt-summary.refresh-interval\":      {},\n\t\"stmt-summary.history-size\":          {},\n\t\"enable-batch-dml\":                   {}, // use tidb_enable_batch_dml\n\t\"mem-quota-query\":                    {},\n\t\"log.query-log-max-len\":              {},\n\t\"performance.committer-concurrency\":  {},\n\t\"experimental.enable-global-kill\":    {},\n\t\"performance.run-auto-analyze\":       {}, // use tidb_enable_auto_analyze\n\t// use tidb_enable_prepared_plan_cache, tidb_prepared_plan_cache_size and tidb_prepared_plan_cache_memory_guard_ratio\n\t\"prepared-plan-cache.enabled\":            {},\n\t\"prepared-plan-cache.capacity\":           {},\n\t\"prepared-plan-cache.memory-guard-ratio\": {},\n\t\"oom-action\":                             {},\n\t\"check-mb4-value-in-utf8\":                {}, // use tidb_check_mb4_value_in_utf8\n\t\"enable-collect-execution-info\":          {}, // use tidb_enable_collect_execution_info\n\t\"log.enable-slow-log\":                    {}, // use tidb_enable_slow_log\n\t\"log.slow-threshold\":                     {}, // use tidb_slow_log_threshold\n\t\"log.record-plan-in-slow-log\":            {}, // use tidb_record_plan_in_slow_log\n\t\"log.expensive-threshold\":                {},\n\t\"performance.force-priority\":             {}, // use tidb_force_priority\n\t\"performance.memory-usage-alarm-ratio\":   {}, // use tidb_memory_usage_alarm_ratio\n\t\"plugin.load\":                            {}, // use plugin_load\n\t\"plugin.dir\":                             {}, // use plugin_dir\n\t\"performance.feedback-probability\":       {}, // This feature is deprecated\n\t\"performance.query-feedback-limit\":       {},\n\t\"oom-use-tmp-storage\":                    {}, // use tidb_enable_tmp_storage_on_oom\n\t\"max-server-connections\":                 {}, // use sysvar max_connections\n\t\"run-ddl\":                                {}, // use sysvar tidb_enable_ddl\n\t\"instance.tidb_memory_usage_alarm_ratio\": {}, // use sysvar tidb_memory_usage_alarm_ratio\n\t\"enable-global-index\":                    {}, // use sysvar tidb_enable_global_index\n}\n\n// isAllRemovedConfigItems returns true if all the items that couldn't validate\n// belong to the list of removedConfig items.\nfunc isAllRemovedConfigItems(items []string) bool {\n\tfor _, item := range items {\n\t\tif _, ok := removedConfig[item]; !ok {\n\t\t\treturn false\n\t\t}\n\t}\n\treturn true\n}\n\n// InitializeConfig initialize the global config handler.\n// The function enforceCmdArgs is used to merge the config file with command arguments:\n// For example, if you start TiDB by the command \"./tidb-server --port=3000\", the port number should be\n// overwritten to 3000 and ignore the port number in the config file.\nfunc InitializeConfig(confPath string, configCheck, configStrict bool, enforceCmdArgs func(*Config, *flag.FlagSet), fset *flag.FlagSet) {\n\tcfg := GetGlobalConfig()\n\tvar err error\n\tif confPath != \"\" {\n\t\tif err = cfg.Load(confPath); err != nil {\n\t\t\t// Unused config item error turns to warnings.\n\t\t\tif tmp, ok := err.(*ErrConfigValidationFailed); ok {\n\t\t\t\t// This block is to accommodate an interim situation where strict config checking\n\t\t\t\t// is not the default behavior of TiDB. The warning message must be deferred until\n\t\t\t\t// logging has been set up. After strict config checking is the default behavior,\n\t\t\t\t// This should all be removed.\n\t\t\t\tif (!configCheck && !configStrict) || isAllRemovedConfigItems(tmp.UndecodedItems) {\n\t\t\t\t\tfmt.Fprintln(os.Stderr, err.Error())\n\t\t\t\t\terr = nil\n\t\t\t\t}\n\t\t\t} else if tmp, ok := err.(*ErrConfigInstanceSection); ok {\n\t\t\t\tlogutil.BgLogger().Warn(tmp.Error())\n\t\t\t\terr = nil\n\t\t\t}\n\t\t}\n\t\t// In configCheck we always print out which options in the config file\n\t\t// have been removed. This helps users upgrade better.\n\t\tif configCheck {\n\t\t\terr = cfg.RemovedVariableCheck(confPath)\n\t\t\tif err != nil {\n\t\t\t\tlogutil.BgLogger().Warn(err.Error())\n\t\t\t\terr = nil // treat as warning\n\t\t\t}\n\t\t}\n\n\t\tterror.MustNil(err)\n\t} else {\n\t\t// configCheck should have the config file specified.\n\t\tif configCheck {\n\t\t\tfmt.Fprintln(os.Stderr, \"config check failed\", errors.New(\"no config file specified for config-check\"))\n\t\t\tos.Exit(1)\n\t\t}\n\t}\n\tenforceCmdArgs(cfg, fset)\n\n\tif err := cfg.Valid(); err != nil {\n\t\tif !filepath.IsAbs(confPath) {\n\t\t\tif tmp, err := filepath.Abs(confPath); err == nil {\n\t\t\t\tconfPath = tmp\n\t\t\t}\n\t\t}\n\t\tfmt.Fprintln(os.Stderr, \"load config file:\", confPath)\n\t\tfmt.Fprintln(os.Stderr, \"invalid config\", err)\n\t\tos.Exit(1)\n\t}\n\tif configCheck {\n\t\tfmt.Println(\"config check successful\")\n\t\tos.Exit(0)\n\t}\n\tStoreGlobalConfig(cfg)\n}\n\n// RemovedVariableCheck checks if the config file contains any items\n// which have been removed. These will not take effect any more.\nfunc (c *Config) RemovedVariableCheck(confFile string) error {\n\tmetaData, err := toml.DecodeFile(confFile, c)\n\tif err != nil {\n\t\treturn err\n\t}\n\tvar removed []string\n\tfor item := range removedConfig {\n\t\t// We need to split the string to account for the top level\n\t\t// and the section hierarchy of config.\n\t\ttmp := strings.Split(item, \".\")\n\t\tif len(tmp) == 2 && metaData.IsDefined(tmp[0], tmp[1]) {\n\t\t\tremoved = append(removed, item)\n\t\t} else if len(tmp) == 1 && metaData.IsDefined(tmp[0]) {\n\t\t\tremoved = append(removed, item)\n\t\t}\n\t}\n\tif len(removed) > 0 {\n\t\tsort.Strings(removed) // deterministic for tests\n\t\treturn fmt.Errorf(\"The following configuration options are no longer supported in this version of TiDB. Check the release notes for more information: %s\", strings.Join(removed, \", \"))\n\t}\n\treturn nil\n}\n\n// Load loads config options from a toml file.\nfunc (c *Config) Load(confFile string) error {\n\tmetaData, err := toml.DecodeFile(confFile, c)\n\tif err != nil {\n\t\treturn err\n\t}\n\tif c.TokenLimit == 0 {\n\t\tc.TokenLimit = 1000\n\t} else if c.TokenLimit > MaxTokenLimit {\n\t\tc.TokenLimit = MaxTokenLimit\n\t}\n\t// If any items in confFile file are not mapped into the Config struct, issue\n\t// an error and stop the server from starting.\n\tundecoded := metaData.Undecoded()\n\tif len(undecoded) > 0 {\n\t\tvar undecodedItems []string\n\t\tfor _, item := range undecoded {\n\t\t\tundecodedItems = append(undecodedItems, item.String())\n\t\t}\n\t\terr = &ErrConfigValidationFailed{confFile, undecodedItems}\n\t}\n\n\tfor _, section := range sectionMovedToInstance {\n\t\tnewConflictSection := InstanceConfigSection{SectionName: section.SectionName, NameMappings: map[string]string{}}\n\t\tnewDeprecatedSection := InstanceConfigSection{SectionName: section.SectionName, NameMappings: map[string]string{}}\n\t\tfor oldName, newName := range section.NameMappings {\n\t\t\tif section.SectionName == \"\" && metaData.IsDefined(oldName) ||\n\t\t\t\tsection.SectionName != \"\" && metaData.IsDefined(section.SectionName, oldName) {\n\t\t\t\tif metaData.IsDefined(\"instance\", newName) {\n\t\t\t\t\tnewConflictSection.NameMappings[oldName] = newName\n\t\t\t\t} else {\n\t\t\t\t\tnewDeprecatedSection.NameMappings[oldName] = newName\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif len(newConflictSection.NameMappings) > 0 {\n\t\t\tConflictOptions = append(ConflictOptions, newConflictSection)\n\t\t}\n\t\tif len(newDeprecatedSection.NameMappings) > 0 {\n\t\t\tDeprecatedOptions = append(DeprecatedOptions, newDeprecatedSection)\n\t\t}\n\t}\n\tif len(ConflictOptions) > 0 || len(DeprecatedOptions) > 0 {\n\t\t// Give a warning that the 'instance' section should be used.\n\t\terr = &ErrConfigInstanceSection{confFile, &ConflictOptions, &DeprecatedOptions}\n\t}\n\n\treturn err\n}\n\n// Valid checks if this config is valid.\nfunc (c *Config) Valid() error {\n\tif c.Log.EnableErrorStack == c.Log.DisableErrorStack && c.Log.EnableErrorStack != nbUnset {\n\t\tlogutil.BgLogger().Warn(fmt.Sprintf(\"\\\"enable-error-stack\\\" (%v) conflicts \\\"disable-error-stack\\\" (%v). \\\"disable-error-stack\\\" is deprecated, please use \\\"enable-error-stack\\\" instead. disable-error-stack is ignored.\", c.Log.EnableErrorStack, c.Log.DisableErrorStack))\n\t\t// if two options conflict, we will use the value of EnableErrorStack\n\t\tc.Log.DisableErrorStack = nbUnset\n\t}\n\tif c.Log.EnableTimestamp == c.Log.DisableTimestamp && c.Log.EnableTimestamp != nbUnset {\n\t\tlogutil.BgLogger().Warn(fmt.Sprintf(\"\\\"enable-timestamp\\\" (%v) conflicts \\\"disable-timestamp\\\" (%v). \\\"disable-timestamp\\\" is deprecated, please use \\\"enable-timestamp\\\" instead\", c.Log.EnableTimestamp, c.Log.DisableTimestamp))\n\t\t// if two options conflict, we will use the value of EnableTimestamp\n\t\tc.Log.DisableTimestamp = nbUnset\n\t}\n\tif c.Security.SkipGrantTable && !hasRootPrivilege() {\n\t\treturn fmt.Errorf(\"TiDB run with skip-grant-table need root privilege\")\n\t}\n\tif !ValidStorage[c.Store] {\n\t\tnameList := make([]string, 0, len(ValidStorage))\n\t\tfor k, v := range ValidStorage {\n\t\t\tif v {\n\t\t\t\tnameList = append(nameList, k)\n\t\t\t}\n\t\t}\n\t\treturn fmt.Errorf(\"invalid store=%s, valid storages=%v\", c.Store, nameList)\n\t}\n\tif c.Store == \"mocktikv\" && !c.Instance.TiDBEnableDDL.Load() {\n\t\treturn fmt.Errorf(\"can't disable DDL on mocktikv\")\n\t}\n\tif c.MaxIndexLength < DefMaxIndexLength || c.MaxIndexLength > DefMaxOfMaxIndexLength {\n\t\treturn fmt.Errorf(\"max-index-length should be [%d, %d]\", DefMaxIndexLength, DefMaxOfMaxIndexLength)\n\t}\n\tif c.IndexLimit < DefIndexLimit || c.IndexLimit > DefMaxOfIndexLimit {\n\t\treturn fmt.Errorf(\"index-limit should be [%d, %d]\", DefIndexLimit, DefMaxOfIndexLimit)\n\t}\n\tif c.Log.File.MaxSize > MaxLogFileSize {\n\t\treturn fmt.Errorf(\"invalid max log file size=%v which is larger than max=%v\", c.Log.File.MaxSize, MaxLogFileSize)\n\t}\n\tif c.TableColumnCountLimit < DefTableColumnCountLimit || c.TableColumnCountLimit > DefMaxOfTableColumnCountLimit {\n\t\treturn fmt.Errorf(\"table-column-limit should be [%d, %d]\", DefIndexLimit, DefMaxOfTableColumnCountLimit)\n\t}\n\n\t// txn-local-latches\n\tif err := c.TxnLocalLatches.Valid(); err != nil {\n\t\treturn err\n\t}\n\n\t// For tikvclient.\n\tif err := c.TiKVClient.Valid(); err != nil {\n\t\treturn err\n\t}\n\tif err := c.TrxSummary.Valid(); err != nil {\n\t\treturn err\n\t}\n\n\tif c.Performance.TxnTotalSizeLimit > 1<<40 {\n\t\treturn fmt.Errorf(\"txn-total-size-limit should be less than %d\", 1<<40)\n\t}\n\n\tif c.Instance.MemoryUsageAlarmRatio > 1 || c.Instance.MemoryUsageAlarmRatio < 0 {\n\t\treturn fmt.Errorf(\"tidb_memory_usage_alarm_ratio in [Instance] must be greater than or equal to 0 and less than or equal to 1\")\n\t}\n\n\tif len(c.IsolationRead.Engines) < 1 {\n\t\treturn fmt.Errorf(\"the number of [isolation-read]engines for isolation read should be at least 1\")\n\t}\n\tfor _, engine := range c.IsolationRead.Engines {\n\t\tif engine != \"tidb\" && engine != \"tikv\" && engine != \"tiflash\" {\n\t\t\treturn fmt.Errorf(\"type of [isolation-read]engines can't be %v should be one of tidb or tikv or tiflash\", engine)\n\t\t}\n\t}\n\n\t// test security\n\tc.Security.SpilledFileEncryptionMethod = strings.ToLower(c.Security.SpilledFileEncryptionMethod)\n\tswitch c.Security.SpilledFileEncryptionMethod {\n\tcase SpilledFileEncryptionMethodPlaintext, SpilledFileEncryptionMethodAES128CTR:\n\tdefault:\n\t\treturn fmt.Errorf(\"unsupported [security]spilled-file-encryption-method %v, TiDB only supports [%v, %v]\",\n\t\t\tc.Security.SpilledFileEncryptionMethod, SpilledFileEncryptionMethodPlaintext, SpilledFileEncryptionMethodAES128CTR)\n\t}\n\n\t// check stats load config\n\tif c.Performance.StatsLoadConcurrency < DefStatsLoadConcurrencyLimit || c.Performance.StatsLoadConcurrency > DefMaxOfStatsLoadConcurrencyLimit {\n\t\treturn fmt.Errorf(\"stats-load-concurrency should be [%d, %d]\", DefStatsLoadConcurrencyLimit, DefMaxOfStatsLoadConcurrencyLimit)\n\t}\n\tif c.Performance.StatsLoadQueueSize < DefStatsLoadQueueSizeLimit || c.Performance.StatsLoadQueueSize > DefMaxOfStatsLoadQueueSizeLimit {\n\t\treturn fmt.Errorf(\"stats-load-queue-size should be [%d, %d]\", DefStatsLoadQueueSizeLimit, DefMaxOfStatsLoadQueueSizeLimit)\n\t}\n\n\t// Check tiflash_compute topo fetch is valid.\n\tif c.DisaggregatedTiFlash && c.UseAutoScaler {\n\t\tif !tiflashcompute.IsValidAutoScalerConfig(c.TiFlashComputeAutoScalerType) {\n\t\t\treturn fmt.Errorf(\"invalid AutoScaler type, expect %s, %s or %s, got %s\",\n\t\t\t\ttiflashcompute.MockASStr, tiflashcompute.AWSASStr, tiflashcompute.GCPASStr, c.TiFlashComputeAutoScalerType)\n\t\t}\n\t\tif c.TiFlashComputeAutoScalerAddr == \"\" {\n\t\t\treturn fmt.Errorf(\"autoscaler-addr cannot be empty when disaggregated-tiflash mode is true\")\n\t\t}\n\t}\n\n\t// test log level\n\tl := zap.NewAtomicLevel()\n\treturn l.UnmarshalText([]byte(c.Log.Level))\n}\n\n// UpdateGlobal updates the global config, and provide a restore function that can be used to restore to the original.\nfunc UpdateGlobal(f func(conf *Config)) {\n\tg := GetGlobalConfig()\n\tnewConf := *g\n\tf(&newConf)\n\tStoreGlobalConfig(&newConf)\n}\n\n// RestoreFunc gets a function that restore the config to the current value.\nfunc RestoreFunc() (restore func()) {\n\tg := GetGlobalConfig()\n\treturn func() {\n\t\tStoreGlobalConfig(g)\n\t}\n}\n\nfunc hasRootPrivilege() bool {\n\treturn os.Geteuid() == 0\n}\n\n// TableLockEnabled uses to check whether enabled the table lock feature.\nfunc TableLockEnabled() bool {\n\treturn GetGlobalConfig().EnableTableLock\n}\n\n// TableLockDelayClean uses to get the time of delay clean table lock.\nvar TableLockDelayClean = func() uint64 {\n\treturn GetGlobalConfig().DelayCleanTableLock\n}\n\n// ToLogConfig converts *Log to *logutil.LogConfig.\nfunc (l *Log) ToLogConfig() *logutil.LogConfig {\n\treturn logutil.NewLogConfig(l.Level, l.Format, l.SlowQueryFile, l.GeneralLogFile, l.File, l.getDisableTimestamp(),\n\t\tfunc(config *zaplog.Config) { config.DisableErrorVerbose = l.getDisableErrorStack() },\n\t\tfunc(config *zaplog.Config) { config.Timeout = l.Timeout },\n\t)\n}\n\n// ToTracingConfig converts *OpenTracing to *tracing.Configuration.\nfunc (t *OpenTracing) ToTracingConfig() *tracing.Configuration {\n\tret := &tracing.Configuration{\n\t\tDisabled:   !t.Enable,\n\t\tRPCMetrics: t.RPCMetrics,\n\t\tReporter:   &tracing.ReporterConfig{},\n\t\tSampler:    &tracing.SamplerConfig{},\n\t}\n\tret.Reporter.QueueSize = t.Reporter.QueueSize\n\tret.Reporter.BufferFlushInterval = t.Reporter.BufferFlushInterval\n\tret.Reporter.LogSpans = t.Reporter.LogSpans\n\tret.Reporter.LocalAgentHostPort = t.Reporter.LocalAgentHostPort\n\n\tret.Sampler.Type = t.Sampler.Type\n\tret.Sampler.Param = t.Sampler.Param\n\tret.Sampler.SamplingServerURL = t.Sampler.SamplingServerURL\n\tret.Sampler.MaxOperations = t.Sampler.MaxOperations\n\tret.Sampler.SamplingRefreshInterval = t.Sampler.SamplingRefreshInterval\n\treturn ret\n}\n\nfunc init() {\n\tinitByLDFlags(versioninfo.TiDBEdition, checkBeforeDropLDFlag)\n}\n\nfunc initByLDFlags(edition, checkBeforeDropLDFlag string) {\n\tconf := defaultConf\n\tStoreGlobalConfig(&conf)\n\tif checkBeforeDropLDFlag == \"1\" {\n\t\tCheckTableBeforeDrop = true\n\t}\n}\n\n// hideConfig is used to filter a single line of config for hiding.\nvar hideConfig = []string{\n\t\"performance.index-usage-sync-lease\",\n}\n\n// GetJSONConfig returns the config as JSON with hidden items removed\n// It replaces the earlier HideConfig() which used strings.Split() in\n// an way that didn't work for similarly named items (like enable).\nfunc GetJSONConfig() (string, error) {\n\tj, err := json.Marshal(GetGlobalConfig())\n\tif err != nil {\n\t\treturn \"\", err\n\t}\n\n\tjsonValue := make(map[string]any)\n\terr = json.Unmarshal(j, &jsonValue)\n\tif err != nil {\n\t\treturn \"\", err\n\t}\n\n\tremovedPaths := make([]string, 0, len(removedConfig)+len(hideConfig))\n\tfor removedItem := range removedConfig {\n\t\tremovedPaths = append(removedPaths, removedItem)\n\t}\n\tremovedPaths = append(removedPaths, hideConfig...)\n\n\tfor _, path := range removedPaths {\n\t\ts := strings.Split(path, \".\")\n\t\tcurValue := jsonValue\n\t\tfor i, key := range s {\n\t\t\tif i == len(s)-1 {\n\t\t\t\tdelete(curValue, key)\n\t\t\t}\n\t\t\tif curValue[key] == nil {\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tmapValue, ok := curValue[key].(map[string]any)\n\t\t\tif !ok {\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcurValue = mapValue\n\t\t}\n\t}\n\n\tbuf, err := json.Marshal(jsonValue)\n\tif err != nil {\n\t\treturn \"\", err\n\t}\n\n\tvar resBuf bytes.Buffer\n\tif err = json.Indent(&resBuf, buf, \"\", \"\\t\"); err != nil {\n\t\treturn \"\", err\n\t}\n\treturn resBuf.String(), nil\n}\n\n// ContainHiddenConfig checks whether it contains the configuration that needs to be hidden.\nfunc ContainHiddenConfig(s string) bool {\n\ts = strings.ToLower(s)\n\tfor _, hc := range hideConfig {\n\t\tif strings.Contains(s, hc) {\n\t\t\treturn true\n\t\t}\n\t}\n\tfor dc := range removedConfig {\n\t\tif strings.Contains(s, dc) {\n\t\t\treturn true\n\t\t}\n\t}\n\treturn false\n}", "message": "Iteration over a possibly empty map `removedConfig`. This is likely a bug or redundant code", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": "CWE-665: Improper Initialization", "description": "Probably redundant iteration over an empty map", "impact": "LOW", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17198, "rule_id": "wdUlww", "rv_id": 833266, "url": "https://semgrep.dev/playground/r/pZTXjeW/trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "version_id": "pZTXjeW"}}, "shortlink": "https://sg.run/08jj", "source": "https://semgrep.dev/r/trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$C": {"abstract_content": "removedConfig", "end": {"col": 18, "line": 1107, "offset": 52937}, "start": {"col": 5, "line": 1107, "offset": 52924}}, "$K": {"abstract_content": "dc", "end": {"col": 8, "line": 1545, "offset": 69771}, "start": {"col": 6, "line": 1545, "offset": 69769}}, "$T1": {"abstract_content": "string", "end": {"col": 31, "line": 1107, "offset": 52950}, "start": {"col": 25, "line": 1107, "offset": 52944}}, "$T2": {"abstract_content": "struct{}", "end": {"col": 40, "line": 1107, "offset": 52959}, "start": {"col": 32, "line": 1107, "offset": 52951}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/config/config.go", "start": {"col": 5, "line": 1107, "offset": 52924}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 20, "offset": 642}, "extra": {"engine_kind": "OSS", "fingerprint": "3b3cfacf291b75eb0c2f1c86a1054cb179aebf62465d78df5093d937ecda5b7889be5bf0824767b0423ec4809fa5b700ce0aa0da41846239a0eedcaee1d91a4b_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "NewInt32", "end": {"col": 35, "line": 56, "offset": 1836}, "start": {"col": 27, "line": 56, "offset": 1828}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 20, "offset": 642}, "start": {"col": 3, "line": 20, "offset": 633}}, "$RAND": {"abstract_content": "atomicutil", "end": {"col": 26, "line": 56, "offset": 1827}, "start": {"col": 16, "line": 56, "offset": 1817}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/ddl/job_worker.go", "start": {"col": 3, "line": 20, "offset": 633}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 21, "offset": 658}, "extra": {"engine_kind": "OSS", "fingerprint": "597279be3648e5a508b42cfde6fd57ee183ee79541acff94050386a1e51691e3ebbdb24bc6b13bd6a10c43906e583404c573b5affb8f68ded6b402cfda81017f_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "NewEvalContext", "end": {"col": 38, "line": 97, "offset": 3293}, "start": {"col": 24, "line": 97, "offset": 3279}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 21, "offset": 658}, "start": {"col": 3, "line": 21, "offset": 649}}, "$RAND": {"abstract_content": "exprstatic", "end": {"col": 23, "line": 97, "offset": 3278}, "start": {"col": 13, "line": 97, "offset": 3268}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/ddl/reorg.go", "start": {"col": 3, "line": 21, "offset": 649}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 19, "offset": 641}, "extra": {"engine_kind": "OSS", "fingerprint": "5330bb1c0045579ff1fac40d823d267ede2f1fb00f367a1589daf9496bc2c5d383759eee9114ff0789ad053f2bc25b90783412a75e8afca05d20c75cfc0aee24_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "L", "end": {"col": 17, "line": 95, "offset": 3305}, "start": {"col": 16, "line": 95, "offset": 3304}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 19, "offset": 641}, "start": {"col": 3, "line": 19, "offset": 632}}, "$RAND": {"abstract_content": "log", "end": {"col": 15, "line": 95, "offset": 3303}, "start": {"col": 12, "line": 95, "offset": 3300}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/disttask/framework/scheduler/scheduler.go", "start": {"col": 3, "line": 19, "offset": 632}}, {"check_id": "go.lang.security.audit.unsafe-reflect-by-name.unsafe-reflect-by-name", "end": {"col": 50, "line": 94, "offset": 3121}, "extra": {"engine_kind": "OSS", "fingerprint": "41f010ba659257d049d32d03de6bbee0018d90432b1f621bd37f71b38f31bf14cd4854151f5f9999b7bfef6dcbbf6d03abd8a9c84f9590c48b24e6d01d1d7d16_0", "is_ignored": false, "lines": "\tinfo := e.FieldByName(stepExecFrameworkInfoName)", "message": "If an attacker can supply values that the application then uses to determine which method or field to invoke, the potential exists for the attacker to create control flow paths through the application that were not intended by the application developers. This attack vector may allow the attacker to bypass authentication or access control checks or otherwise cause the application to behave in an unexpected manner.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-470: Use of Externally-Controlled Input to Select Classes or Code ('Unsafe Reflection')"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10005, "rule_id": "BYUBdJ", "rv_id": 833866, "url": "https://semgrep.dev/playground/r/qkTQnDr/go.lang.security.audit.unsafe-reflect-by-name.unsafe-reflect-by-name", "version_id": "qkTQnDr"}}, "shortlink": "https://sg.run/R8Xv", "source": "https://semgrep.dev/r/go.lang.security.audit.unsafe-reflect-by-name.unsafe-reflect-by-name", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$NAME": {"abstract_content": "stepExecFrameworkInfoName", "end": {"col": 49, "line": 94, "offset": 3120}, "start": {"col": 24, "line": 94, "offset": 3095}}, "$SMTH": {"abstract_content": "e", "end": {"col": 11, "line": 94, "offset": 3082}, "start": {"col": 10, "line": 94, "offset": 3081}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/disttask/framework/taskexecutor/execute/interface.go", "start": {"col": 10, "line": 94, "offset": 3081}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 20, "offset": 647}, "extra": {"engine_kind": "OSS", "fingerprint": "937271c64bcc886c380f8b303d262a08a3624753887eb42ddc7ce35b09704eb46b7d97421e0ff123589a79c08ad6816af52c29bf00a7dd7250ab96ec2c4ddaad_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "Intn", "end": {"col": 24, "line": 75, "offset": 2292}, "start": {"col": 20, "line": 75, "offset": 2288}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 20, "offset": 647}, "start": {"col": 3, "line": 20, "offset": 638}}, "$RAND": {"abstract_content": "c.Rand", "end": {"col": 19, "line": 75, "offset": 2287}, "start": {"col": 13, "line": 75, "offset": 2281}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/disttask/framework/testutil/context.go", "start": {"col": 3, "line": 20, "offset": 638}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 23, "offset": 696}, "extra": {"engine_kind": "OSS", "fingerprint": "77a1d070bc990b1f1050b71b5693d58c18dd3f3cfbf62badc24008cdf897fefdd8e742f30150cbb07c393323678f86b974a53faf8019c5054dcd35435bedadef_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "extractTask", "end": {"col": 29, "line": 91, "offset": 2560}, "start": {"col": 18, "line": 91, "offset": 2549}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 23, "offset": 696}, "start": {"col": 3, "line": 23, "offset": 687}}, "$RAND": {"abstract_content": "h.worker", "end": {"col": 17, "line": 91, "offset": 2548}, "start": {"col": 9, "line": 91, "offset": 2540}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/domain/extract.go", "start": {"col": 3, "line": 23, "offset": 687}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 41, "line": 425, "offset": 15488}, "extra": {"engine_kind": "OSS", "fingerprint": "e38ec9af0796cb5b5277b5833c32ad2b2f697f8b7dd31c5344fca3de4b5265c79d6e5a7158a0c82a68121ceb7577252e3d5d321414bc2df6a3617eeea51e7073_0", "is_ignored": false, "lines": "\t\t_, _ = w.Write([]byte(table.String()))", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$WRITER": {"abstract_content": "w", "end": {"col": 11, "line": 425, "offset": 15458}, "start": {"col": 10, "line": 425, "offset": 15457}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/domain/infosync/tiflash_manager.go", "start": {"col": 10, "line": 425, "offset": 15457}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 28, "line": 432, "offset": 15768}, "extra": {"engine_kind": "OSS", "fingerprint": "e38ec9af0796cb5b5277b5833c32ad2b2f697f8b7dd31c5344fca3de4b5265c79d6e5a7158a0c82a68121ceb7577252e3d5d321414bc2df6a3617eeea51e7073_1", "is_ignored": false, "lines": "\t\t_, _ = w.Write([]byte(s))", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$WRITER": {"abstract_content": "w", "end": {"col": 11, "line": 432, "offset": 15751}, "start": {"col": 10, "line": 432, "offset": 15750}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/domain/infosync/tiflash_manager.go", "start": {"col": 10, "line": 432, "offset": 15750}}, {"check_id": "trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "end": {"col": 3, "line": 215, "offset": 7602}, "extra": {"engine_kind": "OSS", "fingerprint": "27b1b136cd290a725f23a8017101a54f30357745a4a811f752752481e20b4b7c802abc98172b712d41e4f711831aa6eeb8766480141644893e35308f000816ed_0", "is_ignored": false, "lines": "\tchangedTblMap := make(map[int64]uint64)\n\tchangedSchemaVers := make([]int64, 0)\n\tfor _, item := range newerDeltas {\n\t\taffected := false\n\t\tfor i, tblID := range item.relatedIDs {\n\t\t\tfor _, relatedTblID := range tableIDs {\n\t\t\t\tif tblID == relatedTblID || relatedTblID == -1 {\n\t\t\t\t\t// if actionType >= 64, the value of left shift equals 0, and it will not impact amend txn\n\t\t\t\t\tchangedTblMap[tblID] |= 1 << item.relatedActions[i]\n\t\t\t\t\taffected = true\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif affected {\n\t\t\tchangedSchemaVers = append(changedSchemaVers, item.schemaVersion)\n\t\t}\n\t}\n\tif len(changedTblMap) > 0 {\n\t\ttblIDs := make([]int64, 0, len(changedTblMap))\n\t\tfor id := range changedTblMap {\n\t\t\ttblIDs = append(tblIDs, id)\n\t\t}\n\t\tslices.Sort(tblIDs)\n\t\tlogutil.BgLogger().Info(\"schema of tables in the transaction are changed\", zap.Int64s(\"conflicted table IDs\", tblIDs),\n\t\t\tzap.Int64(\"transaction schema\", currVer), zap.Int64s(\"schema versions that changed the tables\", changedSchemaVers))\n\t\treturn true\n\t}", "message": "Iteration over a possibly empty map `changedTblMap`. This is likely a bug or redundant code", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": "CWE-665: Improper Initialization", "description": "Probably redundant iteration over an empty map", "impact": "LOW", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17198, "rule_id": "wdUlww", "rv_id": 833266, "url": "https://semgrep.dev/playground/r/pZTXjeW/trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "version_id": "pZTXjeW"}}, "shortlink": "https://sg.run/08jj", "source": "https://semgrep.dev/r/trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$C": {"abstract_content": "changedTblMap", "end": {"col": 15, "line": 189, "offset": 6636}, "start": {"col": 2, "line": 189, "offset": 6623}}, "$K": {"abstract_content": "id", "end": {"col": 9, "line": 208, "offset": 7263}, "start": {"col": 7, "line": 208, "offset": 7261}}, "$T1": {"abstract_content": "int64", "end": {"col": 33, "line": 189, "offset": 6654}, "start": {"col": 28, "line": 189, "offset": 6649}}, "$T2": {"abstract_content": "uint64", "end": {"col": 40, "line": 189, "offset": 6661}, "start": {"col": 34, "line": 189, "offset": 6655}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/domain/schema_validator.go", "start": {"col": 2, "line": 189, "offset": 6623}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 18, "offset": 630}, "extra": {"engine_kind": "OSS", "fingerprint": "969ca8bb477acf7a089b209e29a16f42f4aad6a083507acfe1ad0b2b2aad638a7b203b0764351dfe77a6358d3b394022c963f54d6812ff67f5e1f493c9bf6114_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "restoreOnePartition", "end": {"col": 59, "line": 57, "offset": 1858}, "start": {"col": 40, "line": 57, "offset": 1839}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 18, "offset": 630}, "start": {"col": 3, "line": 18, "offset": 621}}, "$RAND": {"abstract_content": "w.spillHelper", "end": {"col": 39, "line": 57, "offset": 1838}, "start": {"col": 26, "line": 57, "offset": 1825}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/executor/aggregate/agg_hash_final_worker.go", "start": {"col": 3, "line": 18, "offset": 621}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 18, "offset": 630}, "extra": {"engine_kind": "OSS", "fingerprint": "aea7184cb580b70a353d5a4e2a7c2430304d5ede243b84905716cb06b55062d11bea82675cf13b1be50a254bbae0a1f95e2304a04a13f0327ef4401d00b21dd2_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "SwapColumns", "end": {"col": 20, "line": 82, "offset": 2651}, "start": {"col": 9, "line": 82, "offset": 2640}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 18, "offset": 630}, "start": {"col": 3, "line": 18, "offset": 621}}, "$RAND": {"abstract_content": "w.chk", "end": {"col": 8, "line": 82, "offset": 2639}, "start": {"col": 3, "line": 82, "offset": 2634}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/executor/aggregate/agg_hash_partial_worker.go", "start": {"col": 3, "line": 18, "offset": 621}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 21, "offset": 653}, "extra": {"engine_kind": "OSS", "fingerprint": "10f6134ba5d6bac9e1b1eec7804e18831b5f62e6620621987d6dad6b85b31ce6dcda89c5efac7b1b20432a7e0d0e0f84f54a7e8e71698bee38ed8d591a355d31_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "Get", "end": {"col": 54, "line": 62, "offset": 1766}, "start": {"col": 51, "line": 62, "offset": 1763}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 21, "offset": 653}, "start": {"col": 3, "line": 21, "offset": 644}}, "$RAND": {"abstract_content": "partialResultsBufferPool", "end": {"col": 50, "line": 62, "offset": 1762}, "start": {"col": 26, "line": 62, "offset": 1738}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/executor/aggregate/agg_util.go", "start": {"col": 3, "line": 21, "offset": 644}}, {"check_id": "trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "end": {"col": 33, "line": 451, "offset": 14525}, "extra": {"engine_kind": "OSS", "fingerprint": "3d956c1aa0a8a196cacc9e561ff64dbe90fac3c6ad64567c0d742ffcda46e0fd1fdcb0d92b4f8f18a098bb149fd0e11b557f3b0db87edbae7f1d31bd98d2e27e_0", "is_ignored": false, "lines": "\tsize, err := strconv.Atoi(sizeStr)\n\tif err != nil {\n\t\treturn 0, errors.Trace(err)\n\t}\n\treturn uint64(size) * rate, nil", "message": "Downcasting or changing sign of an integer with `$CAST_METHOD` method", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-681: Incorrect Conversion between Numeric Types", "description": "Integer underflows", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://github.com/golang/go/issues/30209"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 11759, "rule_id": "4bU2AZ", "rv_id": 833273, "url": "https://semgrep.dev/playground/r/rxTDzNy/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "version_id": "rxTDzNy"}}, "shortlink": "https://sg.run/65WB", "source": "https://semgrep.dev/r/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$X": {"abstract_content": "size", "end": {"col": 6, "line": 447, "offset": 14412}, "start": {"col": 2, "line": 447, "offset": 14408}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/executor/inspection_result.go", "start": {"col": 2, "line": 447, "offset": 14408}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 21, "line": 24, "offset": 710}, "extra": {"engine_kind": "OSS", "fingerprint": "2e1d23241b2a4f06fb643ce42f597cbd7e37ce8bdaa7a29ba8d00daf3877cd774e326dca6cf39b366c2e91d323b23b650fbc82f90afe30bc9510d0d9781fcc89_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\tmathrand \"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "Int", "end": {"col": 24, "line": 100, "offset": 2629}, "start": {"col": 21, "line": 100, "offset": 2626}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 21, "line": 24, "offset": 710}, "start": {"col": 12, "line": 24, "offset": 701}}, "$RAND": {"abstract_content": "mathrand", "end": {"col": 10, "line": 24, "offset": 699}, "start": {"col": 2, "line": 24, "offset": 691}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/executor/internal/testutil/testutil.go", "start": {"col": 12, "line": 24, "offset": 701}}, {"check_id": "trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "end": {"col": 4, "line": 401, "offset": 12074}, "extra": {"engine_kind": "OSS", "fingerprint": "7d8f53734a029c7edc79b4184d76bb88512bf662e8df4dc19f9713a15281e5bdb2dfddb2e5f01ea48fcca7eb906aaf71d26008d726c173bd1955ecbaea2c4840_0", "is_ignored": false, "lines": "\t\ttask, err := ow.buildTask(ctx)\n\t\tif err != nil {\n\t\t\ttask.doneCh <- err\n\t\t\tow.pushToChan(ctx, task, ow.resultCh)\n\t\t\treturn\n\t\t}", "message": "Variable `task` is likely modified and later used on error. In some cases this could result  in panics due to a nil dereference", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-665: Improper Initialization", "description": "Possible unintentional assignment when an error occurs", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "MEDIUM", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17197, "rule_id": "kxU6Xb", "rv_id": 833265, "url": "https://semgrep.dev/playground/r/zyTWJNZ/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "version_id": "zyTWJNZ"}}, "shortlink": "https://sg.run/WWQ2", "source": "https://semgrep.dev/r/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$ERR": {"abstract_content": "err", "end": {"col": 12, "line": 396, "offset": 11958}, "start": {"col": 9, "line": 396, "offset": 11955}}, "$X": {"abstract_content": "task", "end": {"col": 7, "line": 396, "offset": 11953}, "start": {"col": 3, "line": 396, "offset": 11949}}, "$Y": {"abstract_content": "doneCh", "end": {"col": 15, "line": 398, "offset": 12012}, "start": {"col": 9, "line": 398, "offset": 12006}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/executor/join/index_lookup_join.go", "start": {"col": 3, "line": 396, "offset": 11949}}, {"check_id": "trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "end": {"col": 4, "line": 318, "offset": 9609}, "extra": {"engine_kind": "OSS", "fingerprint": "fb06d53de5067021b6b0d1d7d6e1bf4ff980b075e9ed0758d44bcc6ca65633a44d18e29b1c371e24d414f3e243e3bcad667f7dad6c344e9ecd13fc1a50d6b96a_0", "is_ignored": false, "lines": "\t\ttask, err := omw.buildTask(ctx)\n\t\tif err != nil {\n\t\t\ttask.doneErr = err\n\t\t\tclose(task.results)\n\t\t\tomw.pushToChan(ctx, task, omw.resultCh)\n\t\t\treturn\n\t\t}", "message": "Variable `task` is likely modified and later used on error. In some cases this could result  in panics due to a nil dereference", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-665: Improper Initialization", "description": "Possible unintentional assignment when an error occurs", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "MEDIUM", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17197, "rule_id": "kxU6Xb", "rv_id": 833265, "url": "https://semgrep.dev/playground/r/zyTWJNZ/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "version_id": "zyTWJNZ"}}, "shortlink": "https://sg.run/WWQ2", "source": "https://semgrep.dev/r/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$ERR": {"abstract_content": "err", "end": {"col": 12, "line": 312, "offset": 9467}, "start": {"col": 9, "line": 312, "offset": 9464}}, "$X": {"abstract_content": "task", "end": {"col": 7, "line": 312, "offset": 9462}, "start": {"col": 3, "line": 312, "offset": 9458}}, "$Y": {"abstract_content": "doneErr", "end": {"col": 16, "line": 314, "offset": 9523}, "start": {"col": 9, "line": 314, "offset": 9516}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/executor/join/index_lookup_merge_join.go", "start": {"col": 3, "line": 312, "offset": 9458}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 18, "offset": 629}, "extra": {"engine_kind": "OSS", "fingerprint": "ebf4a6968c67fa2e303ebe3ceca4b632aa8a37de0011f1d8265dbc8714106f4af96e57e1e20c4cb944dd109ee6d6b3bb7c8b14f968c95c3cc87ccb4b7d26877b_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "ReplaceBytesUsed", "end": {"col": 31, "line": 85, "offset": 2544}, "start": {"col": 15, "line": 85, "offset": 2528}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 18, "offset": 629}, "start": {"col": 3, "line": 18, "offset": 620}}, "$RAND": {"abstract_content": "p.memTracker", "end": {"col": 14, "line": 85, "offset": 2527}, "start": {"col": 2, "line": 85, "offset": 2515}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/executor/sortexec/parallel_sort_worker.go", "start": {"col": 3, "line": 18, "offset": 620}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 19, "offset": 640}, "extra": {"engine_kind": "OSS", "fingerprint": "1a3f3e862c9918054ecd84b20513f9a6c9d3db2ddb76c830fa12144a79ce184d1704a58c65e8ecc312e1415159001ba510f7248cb63f276d7a83587948c4c9ca_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "SetFinished", "end": {"col": 39, "line": 114, "offset": 3366}, "start": {"col": 28, "line": 114, "offset": 3355}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 19, "offset": 640}, "start": {"col": 3, "line": 19, "offset": 631}}, "$RAND": {"abstract_content": "e.Unparallel.spillAction", "end": {"col": 27, "line": 114, "offset": 3354}, "start": {"col": 3, "line": 114, "offset": 3330}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/executor/sortexec/sort.go", "start": {"col": 3, "line": 19, "offset": 631}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 18, "offset": 629}, "extra": {"engine_kind": "OSS", "fingerprint": "c97fa581d0938e579af1cf6a027493ff94d8af7144be825042f1a81e905a281be3a35f857e39561af02328cbcd31edd7c1e1452f7ce45b1976bb2761825cb543_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "New", "end": {"col": 36, "line": 28, "offset": 872}, "start": {"col": 33, "line": 28, "offset": 869}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 18, "offset": 629}, "start": {"col": 3, "line": 18, "offset": 620}}, "$RAND": {"abstract_content": "errors", "end": {"col": 32, "line": 28, "offset": 868}, "start": {"col": 26, "line": 28, "offset": 862}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/executor/sortexec/sort_util.go", "start": {"col": 3, "line": 18, "offset": 620}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 20, "offset": 658}, "extra": {"engine_kind": "OSS", "fingerprint": "fadc8a81b3bf5d13b3f9cabfa7c95d96cbe89a05d1ba4249b39196cccaac68895da5b128b38fdff607610d8833b75a4b1edd8d9b3c6c85bd3e6d416608ec0783_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "NewTracker", "end": {"col": 34, "line": 72, "offset": 2492}, "start": {"col": 24, "line": 72, "offset": 2482}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 20, "offset": 658}, "start": {"col": 3, "line": 20, "offset": 649}}, "$RAND": {"abstract_content": "memory", "end": {"col": 23, "line": 72, "offset": 2481}, "start": {"col": 17, "line": 72, "offset": 2475}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/executor/sortexec/topn.go", "start": {"col": 3, "line": 20, "offset": 649}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 19, "offset": 647}, "extra": {"engine_kind": "OSS", "fingerprint": "cc39ecf069aaa086f4b320d11cb07a264197236df51cef75d51474e7cf98aa8375669bbaef7b057d88786a05102b3f70a1aed9761c48844ce367fd50732e275c_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "init", "end": {"col": 16, "line": 65, "offset": 1860}, "start": {"col": 12, "line": 65, "offset": 1856}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 19, "offset": 647}, "start": {"col": 3, "line": 19, "offset": 638}}, "$RAND": {"abstract_content": "t.chkHeap", "end": {"col": 11, "line": 65, "offset": 1855}, "start": {"col": 2, "line": 65, "offset": 1846}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/executor/sortexec/topn_worker.go", "start": {"col": 3, "line": 19, "offset": 638}}, {"check_id": "trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "end": {"col": 2, "line": 1040, "offset": 53590}, "extra": {"engine_kind": "OSS", "fingerprint": "90225c93ec4393de36ca4b30542042a098b4ca854458350a7b974b503359f83c74500435ea4863159a4093e5a96b5b23039f616e4772a6c519c0d2341c7d6354_0", "is_ignored": false, "lines": "var funcs = map[string]functionClass{\n\t// common functions\n\tast.Coalesce: &coalesceFunctionClass{baseFunctionClass{ast.Coalesce, 1, -1}},\n\tast.IsNull:   &isNullFunctionClass{baseFunctionClass{ast.IsNull, 1, 1}},\n\tast.Greatest: &greatestFunctionClass{baseFunctionClass{ast.Greatest, 2, -1}},\n\tast.Least:    &leastFunctionClass{baseFunctionClass{ast.Least, 2, -1}},\n\tast.Interval: &intervalFunctionClass{baseFunctionClass{ast.Interval, 2, -1}},\n\n\t// math functions\n\tast.Abs:      &absFunctionClass{baseFunctionClass{ast.Abs, 1, 1}},\n\tast.Acos:     &acosFunctionClass{baseFunctionClass{ast.Acos, 1, 1}},\n\tast.Asin:     &asinFunctionClass{baseFunctionClass{ast.Asin, 1, 1}},\n\tast.Atan:     &atanFunctionClass{baseFunctionClass{ast.Atan, 1, 2}},\n\tast.Atan2:    &atanFunctionClass{baseFunctionClass{ast.Atan2, 2, 2}},\n\tast.Ceil:     &ceilFunctionClass{baseFunctionClass{ast.Ceil, 1, 1}},\n\tast.Ceiling:  &ceilFunctionClass{baseFunctionClass{ast.Ceiling, 1, 1}},\n\tast.Conv:     &convFunctionClass{baseFunctionClass{ast.Conv, 3, 3}},\n\tast.Cos:      &cosFunctionClass{baseFunctionClass{ast.Cos, 1, 1}},\n\tast.Cot:      &cotFunctionClass{baseFunctionClass{ast.Cot, 1, 1}},\n\tast.CRC32:    &crc32FunctionClass{baseFunctionClass{ast.CRC32, 1, 1}},\n\tast.Degrees:  &degreesFunctionClass{baseFunctionClass{ast.Degrees, 1, 1}},\n\tast.Exp:      &expFunctionClass{baseFunctionClass{ast.Exp, 1, 1}},\n\tast.Floor:    &floorFunctionClass{baseFunctionClass{ast.Floor, 1, 1}},\n\tast.Ln:       &logFunctionClass{baseFunctionClass{ast.Ln, 1, 1}},\n\tast.Log:      &logFunctionClass{baseFunctionClass{ast.Log, 1, 2}},\n\tast.Log2:     &log2FunctionClass{baseFunctionClass{ast.Log2, 1, 1}},\n\tast.Log10:    &log10FunctionClass{baseFunctionClass{ast.Log10, 1, 1}},\n\tast.PI:       &piFunctionClass{baseFunctionClass{ast.PI, 0, 0}},\n\tast.Pow:      &powFunctionClass{baseFunctionClass{ast.Pow, 2, 2}},\n\tast.Power:    &powFunctionClass{baseFunctionClass{ast.Power, 2, 2}},\n\tast.Radians:  &radiansFunctionClass{baseFunctionClass{ast.Radians, 1, 1}},\n\tast.Rand:     &randFunctionClass{baseFunctionClass{ast.Rand, 0, 1}},\n\tast.Round:    &roundFunctionClass{baseFunctionClass{ast.Round, 1, 2}},\n\tast.Sign:     &signFunctionClass{baseFunctionClass{ast.Sign, 1, 1}},\n\tast.Sin:      &sinFunctionClass{baseFunctionClass{ast.Sin, 1, 1}},\n\tast.Sqrt:     &sqrtFunctionClass{baseFunctionClass{ast.Sqrt, 1, 1}},\n\tast.Tan:      &tanFunctionClass{baseFunctionClass{ast.Tan, 1, 1}},\n\tast.Truncate: &truncateFunctionClass{baseFunctionClass{ast.Truncate, 2, 2}},\n\n\t// time functions\n\tast.AddDate:          &addSubDateFunctionClass{baseFunctionClass{ast.AddDate, 3, 3}, addTime, addDuration, setAdd},\n\tast.DateAdd:          &addSubDateFunctionClass{baseFunctionClass{ast.DateAdd, 3, 3}, addTime, addDuration, setAdd},\n\tast.SubDate:          &addSubDateFunctionClass{baseFunctionClass{ast.SubDate, 3, 3}, subTime, subDuration, setSub},\n\tast.DateSub:          &addSubDateFunctionClass{baseFunctionClass{ast.DateSub, 3, 3}, subTime, subDuration, setSub},\n\tast.AddTime:          &addTimeFunctionClass{baseFunctionClass{ast.AddTime, 2, 2}},\n\tast.ConvertTz:        &convertTzFunctionClass{baseFunctionClass{ast.ConvertTz, 3, 3}},\n\tast.Curdate:          &currentDateFunctionClass{baseFunctionClass{ast.Curdate, 0, 0}},\n\tast.CurrentDate:      &currentDateFunctionClass{baseFunctionClass{ast.CurrentDate, 0, 0}},\n\tast.CurrentTime:      &currentTimeFunctionClass{baseFunctionClass{ast.CurrentTime, 0, 1}},\n\tast.CurrentTimestamp: &nowFunctionClass{baseFunctionClass{ast.CurrentTimestamp, 0, 1}},\n\tast.Curtime:          &currentTimeFunctionClass{baseFunctionClass{ast.Curtime, 0, 1}},\n\tast.Date:             &dateFunctionClass{baseFunctionClass{ast.Date, 1, 1}},\n\tast.DateLiteral:      &dateLiteralFunctionClass{baseFunctionClass{ast.DateLiteral, 1, 1}},\n\tast.DateFormat:       &dateFormatFunctionClass{baseFunctionClass{ast.DateFormat, 2, 2}},\n\tast.DateDiff:         &dateDiffFunctionClass{baseFunctionClass{ast.DateDiff, 2, 2}},\n\tast.Day:              &dayOfMonthFunctionClass{baseFunctionClass{ast.Day, 1, 1}},\n\tast.DayName:          &dayNameFunctionClass{baseFunctionClass{ast.DayName, 1, 1}},\n\tast.DayOfMonth:       &dayOfMonthFunctionClass{baseFunctionClass{ast.DayOfMonth, 1, 1}},\n\tast.DayOfWeek:        &dayOfWeekFunctionClass{baseFunctionClass{ast.DayOfWeek, 1, 1}},\n\tast.DayOfYear:        &dayOfYearFunctionClass{baseFunctionClass{ast.DayOfYear, 1, 1}},\n\tast.Extract:          &extractFunctionClass{baseFunctionClass{ast.Extract, 2, 2}},\n\tast.FromDays:         &fromDaysFunctionClass{baseFunctionClass{ast.FromDays, 1, 1}},\n\tast.FromUnixTime:     &fromUnixTimeFunctionClass{baseFunctionClass{ast.FromUnixTime, 1, 2}},\n\tast.GetFormat:        &getFormatFunctionClass{baseFunctionClass{ast.GetFormat, 2, 2}},\n\tast.Hour:             &hourFunctionClass{baseFunctionClass{ast.Hour, 1, 1}},\n\tast.LocalTime:        &nowFunctionClass{baseFunctionClass{ast.LocalTime, 0, 1}},\n\tast.LocalTimestamp:   &nowFunctionClass{baseFunctionClass{ast.LocalTimestamp, 0, 1}},\n\tast.MakeDate:         &makeDateFunctionClass{baseFunctionClass{ast.MakeDate, 2, 2}},\n\tast.MakeTime:         &makeTimeFunctionClass{baseFunctionClass{ast.MakeTime, 3, 3}},\n\tast.MicroSecond:      &microSecondFunctionClass{baseFunctionClass{ast.MicroSecond, 1, 1}},\n\tast.Minute:           &minuteFunctionClass{baseFunctionClass{ast.Minute, 1, 1}},\n\tast.Month:            &monthFunctionClass{baseFunctionClass{ast.Month, 1, 1}},\n\tast.MonthName:        &monthNameFunctionClass{baseFunctionClass{ast.MonthName, 1, 1}},\n\tast.Now:              &nowFunctionClass{baseFunctionClass{ast.Now, 0, 1}},\n\tast.PeriodAdd:        &periodAddFunctionClass{baseFunctionClass{ast.PeriodAdd, 2, 2}},\n\tast.PeriodDiff:       &periodDiffFunctionClass{baseFunctionClass{ast.PeriodDiff, 2, 2}},\n\tast.Quarter:          &quarterFunctionClass{baseFunctionClass{ast.Quarter, 1, 1}},\n\tast.SecToTime:        &secToTimeFunctionClass{baseFunctionClass{ast.SecToTime, 1, 1}},\n\tast.Second:           &secondFunctionClass{baseFunctionClass{ast.Second, 1, 1}},\n\tast.StrToDate:        &strToDateFunctionClass{baseFunctionClass{ast.StrToDate, 2, 2}},\n\tast.SubTime:          &subTimeFunctionClass{baseFunctionClass{ast.SubTime, 2, 2}},\n\tast.Sysdate:          &sysDateFunctionClass{baseFunctionClass{ast.Sysdate, 0, 1}},\n\tast.Time:             &timeFunctionClass{baseFunctionClass{ast.Time, 1, 1}},\n\tast.TimeLiteral:      &timeLiteralFunctionClass{baseFunctionClass{ast.TimeLiteral, 1, 1}},\n\tast.TimeFormat:       &timeFormatFunctionClass{baseFunctionClass{ast.TimeFormat, 2, 2}},\n\tast.TimeToSec:        &timeToSecFunctionClass{baseFunctionClass{ast.TimeToSec, 1, 1}},\n\tast.TimeDiff:         &timeDiffFunctionClass{baseFunctionClass{ast.TimeDiff, 2, 2}},\n\tast.Timestamp:        &timestampFunctionClass{baseFunctionClass{ast.Timestamp, 1, 2}},\n\tast.TimestampLiteral: &timestampLiteralFunctionClass{baseFunctionClass{ast.TimestampLiteral, 1, 2}},\n\tast.TimestampAdd:     &timestampAddFunctionClass{baseFunctionClass{ast.TimestampAdd, 3, 3}},\n\tast.TimestampDiff:    &timestampDiffFunctionClass{baseFunctionClass{ast.TimestampDiff, 3, 3}},\n\tast.ToDays:           &toDaysFunctionClass{baseFunctionClass{ast.ToDays, 1, 1}},\n\tast.ToSeconds:        &toSecondsFunctionClass{baseFunctionClass{ast.ToSeconds, 1, 1}},\n\tast.UnixTimestamp:    &unixTimestampFunctionClass{baseFunctionClass{ast.UnixTimestamp, 0, 1}},\n\tast.UTCDate:          &utcDateFunctionClass{baseFunctionClass{ast.UTCDate, 0, 0}},\n\tast.UTCTime:          &utcTimeFunctionClass{baseFunctionClass{ast.UTCTime, 0, 1}},\n\tast.UTCTimestamp:     &utcTimestampFunctionClass{baseFunctionClass{ast.UTCTimestamp, 0, 1}},\n\tast.Week:             &weekFunctionClass{baseFunctionClass{ast.Week, 1, 2}},\n\tast.Weekday:          &weekDayFunctionClass{baseFunctionClass{ast.Weekday, 1, 1}},\n\tast.WeekOfYear:       &weekOfYearFunctionClass{baseFunctionClass{ast.WeekOfYear, 1, 1}},\n\tast.Year:             &yearFunctionClass{baseFunctionClass{ast.Year, 1, 1}},\n\tast.YearWeek:         &yearWeekFunctionClass{baseFunctionClass{ast.YearWeek, 1, 2}},\n\tast.LastDay:          &lastDayFunctionClass{baseFunctionClass{ast.LastDay, 1, 1}},\n\t// TSO functions\n\tast.TiDBBoundedStaleness: &tidbBoundedStalenessFunctionClass{baseFunctionClass{ast.TiDBBoundedStaleness, 2, 2}},\n\tast.TiDBParseTso:         &tidbParseTsoFunctionClass{baseFunctionClass{ast.TiDBParseTso, 1, 1}},\n\tast.TiDBParseTsoLogical:  &tidbParseTsoLogicalFunctionClass{baseFunctionClass{ast.TiDBParseTsoLogical, 1, 1}},\n\tast.TiDBCurrentTso:       &tidbCurrentTsoFunctionClass{baseFunctionClass{ast.TiDBCurrentTso, 0, 0}},\n\n\t// string functions\n\tast.ASCII:           &asciiFunctionClass{baseFunctionClass{ast.ASCII, 1, 1}},\n\tast.Bin:             &binFunctionClass{baseFunctionClass{ast.Bin, 1, 1}},\n\tast.BitLength:       &bitLengthFunctionClass{baseFunctionClass{ast.BitLength, 1, 1}},\n\tast.CharFunc:        &charFunctionClass{baseFunctionClass{ast.CharFunc, 2, -1}},\n\tast.CharLength:      &charLengthFunctionClass{baseFunctionClass{ast.CharLength, 1, 1}},\n\tast.CharacterLength: &charLengthFunctionClass{baseFunctionClass{ast.CharacterLength, 1, 1}},\n\tast.Concat:          &concatFunctionClass{baseFunctionClass{ast.Concat, 1, -1}},\n\tast.ConcatWS:        &concatWSFunctionClass{baseFunctionClass{ast.ConcatWS, 2, -1}},\n\tast.Convert:         &convertFunctionClass{baseFunctionClass{ast.Convert, 2, 2}},\n\tast.Elt:             &eltFunctionClass{baseFunctionClass{ast.Elt, 2, -1}},\n\tast.ExportSet:       &exportSetFunctionClass{baseFunctionClass{ast.ExportSet, 3, 5}},\n\tast.Field:           &fieldFunctionClass{baseFunctionClass{ast.Field, 2, -1}},\n\tast.Format:          &formatFunctionClass{baseFunctionClass{ast.Format, 2, 3}},\n\tast.FromBase64:      &fromBase64FunctionClass{baseFunctionClass{ast.FromBase64, 1, 1}},\n\tast.FindInSet:       &findInSetFunctionClass{baseFunctionClass{ast.FindInSet, 2, 2}},\n\tast.Hex:             &hexFunctionClass{baseFunctionClass{ast.Hex, 1, 1}},\n\tast.InsertFunc:      &insertFunctionClass{baseFunctionClass{ast.InsertFunc, 4, 4}},\n\tast.Instr:           &instrFunctionClass{baseFunctionClass{ast.Instr, 2, 2}},\n\tast.Lcase:           &lowerFunctionClass{baseFunctionClass{ast.Lcase, 1, 1}},\n\tast.Left:            &leftFunctionClass{baseFunctionClass{ast.Left, 2, 2}},\n\tast.Length:          &lengthFunctionClass{baseFunctionClass{ast.Length, 1, 1}},\n\tast.LoadFile:        &loadFileFunctionClass{baseFunctionClass{ast.LoadFile, 1, 1}},\n\tast.Locate:          &locateFunctionClass{baseFunctionClass{ast.Locate, 2, 3}},\n\tast.Lower:           &lowerFunctionClass{baseFunctionClass{ast.Lower, 1, 1}},\n\tast.Lpad:            &lpadFunctionClass{baseFunctionClass{ast.Lpad, 3, 3}},\n\tast.LTrim:           &lTrimFunctionClass{baseFunctionClass{ast.LTrim, 1, 1}},\n\tast.Mid:             &substringFunctionClass{baseFunctionClass{ast.Mid, 2, 3}},\n\tast.MakeSet:         &makeSetFunctionClass{baseFunctionClass{ast.MakeSet, 2, -1}},\n\tast.Oct:             &octFunctionClass{baseFunctionClass{ast.Oct, 1, 1}},\n\tast.OctetLength:     &lengthFunctionClass{baseFunctionClass{ast.OctetLength, 1, 1}},\n\tast.Ord:             &ordFunctionClass{baseFunctionClass{ast.Ord, 1, 1}},\n\tast.Position:        &locateFunctionClass{baseFunctionClass{ast.Position, 2, 2}},\n\tast.Quote:           &quoteFunctionClass{baseFunctionClass{ast.Quote, 1, 1}},\n\tast.Repeat:          &repeatFunctionClass{baseFunctionClass{ast.Repeat, 2, 2}},\n\tast.Replace:         &replaceFunctionClass{baseFunctionClass{ast.Replace, 3, 3}},\n\tast.Reverse:         &reverseFunctionClass{baseFunctionClass{ast.Reverse, 1, 1}},\n\tast.Right:           &rightFunctionClass{baseFunctionClass{ast.Right, 2, 2}},\n\tast.RTrim:           &rTrimFunctionClass{baseFunctionClass{ast.RTrim, 1, 1}},\n\tast.Rpad:            &rpadFunctionClass{baseFunctionClass{ast.Rpad, 3, 3}},\n\tast.Space:           &spaceFunctionClass{baseFunctionClass{ast.Space, 1, 1}},\n\tast.Strcmp:          &strcmpFunctionClass{baseFunctionClass{ast.Strcmp, 2, 2}},\n\tast.Substring:       &substringFunctionClass{baseFunctionClass{ast.Substring, 2, 3}},\n\tast.Substr:          &substringFunctionClass{baseFunctionClass{ast.Substr, 2, 3}},\n\tast.SubstringIndex:  &substringIndexFunctionClass{baseFunctionClass{ast.SubstringIndex, 3, 3}},\n\tast.ToBase64:        &toBase64FunctionClass{baseFunctionClass{ast.ToBase64, 1, 1}},\n\tast.Trim:            &trimFunctionClass{baseFunctionClass{ast.Trim, 1, 3}},\n\tast.Translate:       &translateFunctionClass{baseFunctionClass{ast.Translate, 3, 3}},\n\tast.Upper:           &upperFunctionClass{baseFunctionClass{ast.Upper, 1, 1}},\n\tast.Ucase:           &upperFunctionClass{baseFunctionClass{ast.Ucase, 1, 1}},\n\tast.Unhex:           &unhexFunctionClass{baseFunctionClass{ast.Unhex, 1, 1}},\n\tast.WeightString:    &weightStringFunctionClass{baseFunctionClass{ast.WeightString, 1, 3}},\n\n\t// information functions\n\tast.ConnectionID:         &connectionIDFunctionClass{baseFunctionClass{ast.ConnectionID, 0, 0}},\n\tast.CurrentUser:          &currentUserFunctionClass{baseFunctionClass{ast.CurrentUser, 0, 0}},\n\tast.CurrentRole:          &currentRoleFunctionClass{baseFunctionClass{ast.CurrentRole, 0, 0}},\n\tast.Database:             &databaseFunctionClass{baseFunctionClass{ast.Database, 0, 0}},\n\tast.CurrentResourceGroup: &currentResourceGroupFunctionClass{baseFunctionClass{ast.CurrentResourceGroup, 0, 0}},\n\n\t// This function is a synonym for DATABASE().\n\t// See http://dev.mysql.com/doc/refman/5.7/en/information-functions.html#function_schema\n\tast.Schema:       &databaseFunctionClass{baseFunctionClass{ast.Schema, 0, 0}},\n\tast.FoundRows:    &foundRowsFunctionClass{baseFunctionClass{ast.FoundRows, 0, 0}},\n\tast.LastInsertId: &lastInsertIDFunctionClass{baseFunctionClass{ast.LastInsertId, 0, 1}},\n\tast.User:         &userFunctionClass{baseFunctionClass{ast.User, 0, 0}},\n\tast.Version:      &versionFunctionClass{baseFunctionClass{ast.Version, 0, 0}},\n\tast.Benchmark:    &benchmarkFunctionClass{baseFunctionClass{ast.Benchmark, 2, 2}},\n\tast.Charset:      &charsetFunctionClass{baseFunctionClass{ast.Charset, 1, 1}},\n\tast.Coercibility: &coercibilityFunctionClass{baseFunctionClass{ast.Coercibility, 1, 1}},\n\tast.Collation:    &collationFunctionClass{baseFunctionClass{ast.Collation, 1, 1}},\n\tast.RowCount:     &rowCountFunctionClass{baseFunctionClass{ast.RowCount, 0, 0}},\n\tast.SessionUser:  &userFunctionClass{baseFunctionClass{ast.SessionUser, 0, 0}},\n\tast.SystemUser:   &userFunctionClass{baseFunctionClass{ast.SystemUser, 0, 0}},\n\n\t// See https://dev.mysql.com/doc/refman/8.0/en/performance-schema-functions.html\n\tast.FormatBytes:    &formatBytesFunctionClass{baseFunctionClass{ast.FormatBytes, 1, 1}},\n\tast.FormatNanoTime: &formatNanoTimeFunctionClass{baseFunctionClass{ast.FormatNanoTime, 1, 1}},\n\n\t// control functions\n\tast.If:     &ifFunctionClass{baseFunctionClass{ast.If, 3, 3}},\n\tast.Ifnull: &ifNullFunctionClass{baseFunctionClass{ast.Ifnull, 2, 2}},\n\n\t// miscellaneous functions\n\tast.Sleep:           &sleepFunctionClass{baseFunctionClass{ast.Sleep, 1, 1}},\n\tast.AnyValue:        &anyValueFunctionClass{baseFunctionClass{ast.AnyValue, 1, 1}},\n\tast.DefaultFunc:     &defaultFunctionClass{baseFunctionClass{ast.DefaultFunc, 1, 1}},\n\tast.InetAton:        &inetAtonFunctionClass{baseFunctionClass{ast.InetAton, 1, 1}},\n\tast.InetNtoa:        &inetNtoaFunctionClass{baseFunctionClass{ast.InetNtoa, 1, 1}},\n\tast.Inet6Aton:       &inet6AtonFunctionClass{baseFunctionClass{ast.Inet6Aton, 1, 1}},\n\tast.Inet6Ntoa:       &inet6NtoaFunctionClass{baseFunctionClass{ast.Inet6Ntoa, 1, 1}},\n\tast.IsFreeLock:      &isFreeLockFunctionClass{baseFunctionClass{ast.IsFreeLock, 1, 1}},\n\tast.IsIPv4:          &isIPv4FunctionClass{baseFunctionClass{ast.IsIPv4, 1, 1}},\n\tast.IsIPv4Compat:    &isIPv4CompatFunctionClass{baseFunctionClass{ast.IsIPv4Compat, 1, 1}},\n\tast.IsIPv4Mapped:    &isIPv4MappedFunctionClass{baseFunctionClass{ast.IsIPv4Mapped, 1, 1}},\n\tast.IsIPv6:          &isIPv6FunctionClass{baseFunctionClass{ast.IsIPv6, 1, 1}},\n\tast.IsUsedLock:      &isUsedLockFunctionClass{baseFunctionClass{ast.IsUsedLock, 1, 1}},\n\tast.IsUUID:          &isUUIDFunctionClass{baseFunctionClass{ast.IsUUID, 1, 1}},\n\tast.MasterPosWait:   &masterPosWaitFunctionClass{baseFunctionClass{ast.MasterPosWait, 2, 4}},\n\tast.NameConst:       &nameConstFunctionClass{baseFunctionClass{ast.NameConst, 2, 2}},\n\tast.ReleaseAllLocks: &releaseAllLocksFunctionClass{baseFunctionClass{ast.ReleaseAllLocks, 0, 0}},\n\tast.UUID:            &uuidFunctionClass{baseFunctionClass{ast.UUID, 0, 0}},\n\tast.UUIDShort:       &uuidShortFunctionClass{baseFunctionClass{ast.UUIDShort, 0, 0}},\n\tast.VitessHash:      &vitessHashFunctionClass{baseFunctionClass{ast.VitessHash, 1, 1}},\n\tast.UUIDToBin:       &uuidToBinFunctionClass{baseFunctionClass{ast.UUIDToBin, 1, 2}},\n\tast.BinToUUID:       &binToUUIDFunctionClass{baseFunctionClass{ast.BinToUUID, 1, 2}},\n\tast.TiDBShard:       &tidbShardFunctionClass{baseFunctionClass{ast.TiDBShard, 1, 1}},\n\tast.TiDBRowChecksum: &tidbRowChecksumFunctionClass{baseFunctionClass{ast.TiDBRowChecksum, 0, 0}},\n\tast.Grouping:        &groupingImplFunctionClass{baseFunctionClass{ast.Grouping, 1, 1}},\n\n\tast.GetLock:     &lockFunctionClass{baseFunctionClass{ast.GetLock, 2, 2}},\n\tast.ReleaseLock: &releaseLockFunctionClass{baseFunctionClass{ast.ReleaseLock, 1, 1}},\n\n\tast.LogicAnd:           &logicAndFunctionClass{baseFunctionClass{ast.LogicAnd, 2, 2}},\n\tast.LogicOr:            &logicOrFunctionClass{baseFunctionClass{ast.LogicOr, 2, 2}},\n\tast.LogicXor:           &logicXorFunctionClass{baseFunctionClass{ast.LogicXor, 2, 2}},\n\tast.GE:                 &compareFunctionClass{baseFunctionClass{ast.GE, 2, 2}, opcode.GE},\n\tast.LE:                 &compareFunctionClass{baseFunctionClass{ast.LE, 2, 2}, opcode.LE},\n\tast.EQ:                 &compareFunctionClass{baseFunctionClass{ast.EQ, 2, 2}, opcode.EQ},\n\tast.NE:                 &compareFunctionClass{baseFunctionClass{ast.NE, 2, 2}, opcode.NE},\n\tast.LT:                 &compareFunctionClass{baseFunctionClass{ast.LT, 2, 2}, opcode.LT},\n\tast.GT:                 &compareFunctionClass{baseFunctionClass{ast.GT, 2, 2}, opcode.GT},\n\tast.NullEQ:             &compareFunctionClass{baseFunctionClass{ast.NullEQ, 2, 2}, opcode.NullEQ},\n\tast.Plus:               &arithmeticPlusFunctionClass{baseFunctionClass{ast.Plus, 2, 2}},\n\tast.Minus:              &arithmeticMinusFunctionClass{baseFunctionClass{ast.Minus, 2, 2}},\n\tast.Mod:                &arithmeticModFunctionClass{baseFunctionClass{ast.Mod, 2, 2}},\n\tast.Div:                &arithmeticDivideFunctionClass{baseFunctionClass{ast.Div, 2, 2}},\n\tast.Mul:                &arithmeticMultiplyFunctionClass{baseFunctionClass{ast.Mul, 2, 2}},\n\tast.IntDiv:             &arithmeticIntDivideFunctionClass{baseFunctionClass{ast.IntDiv, 2, 2}},\n\tast.BitNeg:             &bitNegFunctionClass{baseFunctionClass{ast.BitNeg, 1, 1}},\n\tast.And:                &bitAndFunctionClass{baseFunctionClass{ast.And, 2, 2}},\n\tast.LeftShift:          &leftShiftFunctionClass{baseFunctionClass{ast.LeftShift, 2, 2}},\n\tast.RightShift:         &rightShiftFunctionClass{baseFunctionClass{ast.RightShift, 2, 2}},\n\tast.UnaryNot:           &unaryNotFunctionClass{baseFunctionClass{ast.UnaryNot, 1, 1}},\n\tast.Or:                 &bitOrFunctionClass{baseFunctionClass{ast.Or, 2, 2}},\n\tast.Xor:                &bitXorFunctionClass{baseFunctionClass{ast.Xor, 2, 2}},\n\tast.UnaryMinus:         &unaryMinusFunctionClass{baseFunctionClass{ast.UnaryMinus, 1, 1}},\n\tast.In:                 &inFunctionClass{baseFunctionClass{ast.In, 2, -1}},\n\tast.IsTruthWithoutNull: &isTrueOrFalseFunctionClass{baseFunctionClass{ast.IsTruthWithoutNull, 1, 1}, opcode.IsTruth, false},\n\tast.IsTruthWithNull:    &isTrueOrFalseFunctionClass{baseFunctionClass{ast.IsTruthWithNull, 1, 1}, opcode.IsTruth, true},\n\tast.IsFalsity:          &isTrueOrFalseFunctionClass{baseFunctionClass{ast.IsFalsity, 1, 1}, opcode.IsFalsity, false},\n\tast.Like:               &likeFunctionClass{baseFunctionClass{ast.Like, 3, 3}},\n\tast.Ilike:              &ilikeFunctionClass{baseFunctionClass{ast.Ilike, 3, 3}},\n\tast.Regexp:             &regexpLikeFunctionClass{baseFunctionClass{ast.Regexp, 2, 2}},\n\tast.RegexpLike:         &regexpLikeFunctionClass{baseFunctionClass{ast.RegexpLike, 2, 3}},\n\tast.RegexpSubstr:       &regexpSubstrFunctionClass{baseFunctionClass{ast.RegexpSubstr, 2, 5}},\n\tast.RegexpInStr:        &regexpInStrFunctionClass{baseFunctionClass{ast.RegexpInStr, 2, 6}},\n\tast.RegexpReplace:      &regexpReplaceFunctionClass{baseFunctionClass{ast.RegexpReplace, 3, 6}},\n\tast.Case:               &caseWhenFunctionClass{baseFunctionClass{ast.Case, 1, -1}},\n\tast.RowFunc:            &rowFunctionClass{baseFunctionClass{ast.RowFunc, 2, -1}},\n\tast.SetVar:             &setVarFunctionClass{baseFunctionClass{ast.SetVar, 2, 2}},\n\tast.BitCount:           &bitCountFunctionClass{baseFunctionClass{ast.BitCount, 1, 1}},\n\tast.GetParam:           &getParamFunctionClass{baseFunctionClass{ast.GetParam, 1, 1}},\n\n\t// encryption and compression functions\n\tast.AesDecrypt:               &aesDecryptFunctionClass{baseFunctionClass{ast.AesDecrypt, 2, 3}},\n\tast.AesEncrypt:               &aesEncryptFunctionClass{baseFunctionClass{ast.AesEncrypt, 2, 3}},\n\tast.Compress:                 &compressFunctionClass{baseFunctionClass{ast.Compress, 1, 1}},\n\tast.Decode:                   &decodeFunctionClass{baseFunctionClass{ast.Decode, 2, 2}},\n\tast.DesDecrypt:               &desDecryptFunctionClass{baseFunctionClass{ast.DesDecrypt, 1, 2}},\n\tast.DesEncrypt:               &desEncryptFunctionClass{baseFunctionClass{ast.DesEncrypt, 1, 2}},\n\tast.Encode:                   &encodeFunctionClass{baseFunctionClass{ast.Encode, 2, 2}},\n\tast.Encrypt:                  &encryptFunctionClass{baseFunctionClass{ast.Encrypt, 1, 2}},\n\tast.MD5:                      &md5FunctionClass{baseFunctionClass{ast.MD5, 1, 1}},\n\tast.OldPassword:              &oldPasswordFunctionClass{baseFunctionClass{ast.OldPassword, 1, 1}},\n\tast.PasswordFunc:             &passwordFunctionClass{baseFunctionClass{ast.PasswordFunc, 1, 1}},\n\tast.RandomBytes:              &randomBytesFunctionClass{baseFunctionClass{ast.RandomBytes, 1, 1}},\n\tast.SHA1:                     &sha1FunctionClass{baseFunctionClass{ast.SHA1, 1, 1}},\n\tast.SHA:                      &sha1FunctionClass{baseFunctionClass{ast.SHA, 1, 1}},\n\tast.SHA2:                     &sha2FunctionClass{baseFunctionClass{ast.SHA2, 2, 2}},\n\tast.SM3:                      &sm3FunctionClass{baseFunctionClass{ast.SM3, 1, 1}},\n\tast.Uncompress:               &uncompressFunctionClass{baseFunctionClass{ast.Uncompress, 1, 1}},\n\tast.UncompressedLength:       &uncompressedLengthFunctionClass{baseFunctionClass{ast.UncompressedLength, 1, 1}},\n\tast.ValidatePasswordStrength: &validatePasswordStrengthFunctionClass{baseFunctionClass{ast.ValidatePasswordStrength, 1, 1}},\n\n\t// json functions\n\tast.JSONType:          &jsonTypeFunctionClass{baseFunctionClass{ast.JSONType, 1, 1}},\n\tast.JSONExtract:       &jsonExtractFunctionClass{baseFunctionClass{ast.JSONExtract, 2, -1}},\n\tast.JSONUnquote:       &jsonUnquoteFunctionClass{baseFunctionClass{ast.JSONUnquote, 1, 1}},\n\tast.JSONSet:           &jsonSetFunctionClass{baseFunctionClass{ast.JSONSet, 3, -1}},\n\tast.JSONInsert:        &jsonInsertFunctionClass{baseFunctionClass{ast.JSONInsert, 3, -1}},\n\tast.JSONReplace:       &jsonReplaceFunctionClass{baseFunctionClass{ast.JSONReplace, 3, -1}},\n\tast.JSONRemove:        &jsonRemoveFunctionClass{baseFunctionClass{ast.JSONRemove, 2, -1}},\n\tast.JSONMerge:         &jsonMergeFunctionClass{baseFunctionClass{ast.JSONMerge, 2, -1}},\n\tast.JSONObject:        &jsonObjectFunctionClass{baseFunctionClass{ast.JSONObject, 0, -1}},\n\tast.JSONArray:         &jsonArrayFunctionClass{baseFunctionClass{ast.JSONArray, 0, -1}},\n\tast.JSONMemberOf:      &jsonMemberOfFunctionClass{baseFunctionClass{ast.JSONMemberOf, 2, 2}},\n\tast.JSONContains:      &jsonContainsFunctionClass{baseFunctionClass{ast.JSONContains, 2, 3}},\n\tast.JSONOverlaps:      &jsonOverlapsFunctionClass{baseFunctionClass{ast.JSONOverlaps, 2, 2}},\n\tast.JSONContainsPath:  &jsonContainsPathFunctionClass{baseFunctionClass{ast.JSONContainsPath, 3, -1}},\n\tast.JSONValid:         &jsonValidFunctionClass{baseFunctionClass{ast.JSONValid, 1, 1}},\n\tast.JSONArrayAppend:   &jsonArrayAppendFunctionClass{baseFunctionClass{ast.JSONArrayAppend, 3, -1}},\n\tast.JSONArrayInsert:   &jsonArrayInsertFunctionClass{baseFunctionClass{ast.JSONArrayInsert, 3, -1}},\n\tast.JSONMergePatch:    &jsonMergePatchFunctionClass{baseFunctionClass{ast.JSONMergePatch, 2, -1}},\n\tast.JSONMergePreserve: &jsonMergePreserveFunctionClass{baseFunctionClass{ast.JSONMergePreserve, 2, -1}},\n\tast.JSONPretty:        &jsonPrettyFunctionClass{baseFunctionClass{ast.JSONPretty, 1, 1}},\n\tast.JSONQuote:         &jsonQuoteFunctionClass{baseFunctionClass{ast.JSONQuote, 1, 1}},\n\tast.JSONSchemaValid:   &jsonSchemaValidFunctionClass{baseFunctionClass{ast.JSONSchemaValid, 2, 2}},\n\tast.JSONSearch:        &jsonSearchFunctionClass{baseFunctionClass{ast.JSONSearch, 3, -1}},\n\tast.JSONStorageFree:   &jsonStorageFreeFunctionClass{baseFunctionClass{ast.JSONStorageFree, 1, 1}},\n\tast.JSONStorageSize:   &jsonStorageSizeFunctionClass{baseFunctionClass{ast.JSONStorageSize, 1, 1}},\n\tast.JSONDepth:         &jsonDepthFunctionClass{baseFunctionClass{ast.JSONDepth, 1, 1}},\n\tast.JSONKeys:          &jsonKeysFunctionClass{baseFunctionClass{ast.JSONKeys, 1, 2}},\n\tast.JSONLength:        &jsonLengthFunctionClass{baseFunctionClass{ast.JSONLength, 1, 2}},\n\n\t// vector functions (TiDB extension)\n\tast.VecDims:                 &vecDimsFunctionClass{baseFunctionClass{ast.VecDims, 1, 1}},\n\tast.VecL1Distance:           &vecL1DistanceFunctionClass{baseFunctionClass{ast.VecL1Distance, 2, 2}},\n\tast.VecL2Distance:           &vecL2DistanceFunctionClass{baseFunctionClass{ast.VecL2Distance, 2, 2}},\n\tast.VecNegativeInnerProduct: &vecNegativeInnerProductFunctionClass{baseFunctionClass{ast.VecNegativeInnerProduct, 2, 2}},\n\tast.VecCosineDistance:       &vecCosineDistanceFunctionClass{baseFunctionClass{ast.VecCosineDistance, 2, 2}},\n\tast.VecL2Norm:               &vecL2NormFunctionClass{baseFunctionClass{ast.VecL2Norm, 1, 1}},\n\tast.VecFromText:             &vecFromTextFunctionClass{baseFunctionClass{ast.VecFromText, 1, 1}},\n\tast.VecAsText:               &vecAsTextFunctionClass{baseFunctionClass{ast.VecAsText, 1, 1}},\n\n\t// TiDB internal function.\n\tast.TiDBDecodeKey:       &tidbDecodeKeyFunctionClass{baseFunctionClass{ast.TiDBDecodeKey, 1, 1}},\n\tast.TiDBMVCCInfo:        &tidbMVCCInfoFunctionClass{baseFunctionClass: baseFunctionClass{ast.TiDBMVCCInfo, 1, 1}},\n\tast.TiDBEncodeRecordKey: &tidbEncodeRecordKeyClass{baseFunctionClass{ast.TiDBEncodeRecordKey, 3, -1}},\n\tast.TiDBEncodeIndexKey:  &tidbEncodeIndexKeyClass{baseFunctionClass{ast.TiDBEncodeIndexKey, 4, -1}},\n\t// This function is used to show tidb-server version info.\n\tast.TiDBVersion:          &tidbVersionFunctionClass{baseFunctionClass{ast.TiDBVersion, 0, 0}},\n\tast.TiDBIsDDLOwner:       &tidbIsDDLOwnerFunctionClass{baseFunctionClass{ast.TiDBIsDDLOwner, 0, 0}},\n\tast.TiDBDecodePlan:       &tidbDecodePlanFunctionClass{baseFunctionClass{ast.TiDBDecodePlan, 1, 1}},\n\tast.TiDBDecodeBinaryPlan: &tidbDecodePlanFunctionClass{baseFunctionClass{ast.TiDBDecodeBinaryPlan, 1, 1}},\n\tast.TiDBDecodeSQLDigests: &tidbDecodeSQLDigestsFunctionClass{baseFunctionClass{ast.TiDBDecodeSQLDigests, 1, 2}},\n\tast.TiDBEncodeSQLDigest:  &tidbEncodeSQLDigestFunctionClass{baseFunctionClass{ast.TiDBEncodeSQLDigest, 1, 1}},\n\n\t// TiDB Sequence function.\n\tast.NextVal: &nextValFunctionClass{baseFunctionClass{ast.NextVal, 1, 1}},\n\tast.LastVal: &lastValFunctionClass{baseFunctionClass{ast.LastVal, 1, 1}},\n\tast.SetVal:  &setValFunctionClass{baseFunctionClass{ast.SetVal, 2, 2}},\n}\n\n// IsFunctionSupported check if given function name is a builtin sql function.\nfunc IsFunctionSupported(name string) bool {\n\t_, ok := funcs[name]\n\treturn ok\n}\n\n// GetDisplayName translate a function name to its display name\nfunc GetDisplayName(name string) string {\n\tif funClass, ok := funcs[name]; ok {\n\t\tif funClass, ok := funClass.(functionClassWithName); ok {\n\t\t\treturn funClass.getDisplayName()\n\t\t}\n\t}\n\n\treturn name\n}\n\n// GetBuiltinList returns a list of builtin functions\nfunc GetBuiltinList() []string {\n\tres := make([]string, 0, len(funcs))\n\tnotImplementedFunctions := []string{ast.RowFunc, ast.IsTruthWithNull}\n\tfor funcName := range funcs {\n\t\tskipFunc := false\n\t\t// Skip not implemented functions\n\t\tfor _, notImplFunc := range notImplementedFunctions {\n\t\t\tif funcName == notImplFunc {\n\t\t\t\tskipFunc = true\n\t\t\t}\n\t\t}\n\t\t// Skip literal functions\n\t\t// (their names are not readable: 'tidb`.(dateliteral, for example)\n\t\t// See: https://github.com/pingcap/parser/pull/591\n\t\tif strings.HasPrefix(funcName, \"'tidb`.(\") {\n\t\t\tskipFunc = true\n\t\t}\n\t\tif skipFunc {\n\t\t\tcontinue\n\t\t}\n\t\tres = append(res, funcName)\n\t}\n\n\textensionFuncs.Range(func(key, _ any) bool {\n\t\tfuncName := key.(string)\n\t\tres = append(res, funcName)\n\t\treturn true\n\t})\n\n\tslices.Sort(res)\n\treturn res\n}", "message": "Iteration over a possibly empty map `funcs`. This is likely a bug or redundant code", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": "CWE-665: Improper Initialization", "description": "Probably redundant iteration over an empty map", "impact": "LOW", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17198, "rule_id": "wdUlww", "rv_id": 833266, "url": "https://semgrep.dev/playground/r/pZTXjeW/trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "version_id": "pZTXjeW"}}, "shortlink": "https://sg.run/08jj", "source": "https://semgrep.dev/r/trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$C": {"abstract_content": "funcs", "end": {"col": 10, "line": 648, "offset": 24686}, "start": {"col": 5, "line": 648, "offset": 24681}}, "$K": {"abstract_content": "funcName", "end": {"col": 14, "line": 1012, "offset": 52959}, "start": {"col": 6, "line": 1012, "offset": 52951}}, "$T1": {"abstract_content": "string", "end": {"col": 23, "line": 648, "offset": 24699}, "start": {"col": 17, "line": 648, "offset": 24693}}, "$T2": {"abstract_content": "functionClass", "end": {"col": 37, "line": 648, "offset": 24713}, "start": {"col": 24, "line": 648, "offset": 24700}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/expression/builtin.go", "start": {"col": 5, "line": 648, "offset": 24681}}, {"check_id": "go.lang.security.audit.crypto.use_of_weak_crypto.use-of-md5", "end": {"col": 29, "line": 638, "offset": 19562}, "extra": {"engine_kind": "OSS", "fingerprint": "7eb25f29737d2ff54451806d76ee0aff1c7eb2965c7e4a308dc75fc9a7b345d63dd66ecc79487b7c4834ae9e1a30d608582395dcc7c52acdd0e39f7083dd50fa_0", "is_ignored": false, "lines": "\tsum := md5.Sum([]byte(arg)) // #nosec G401", "message": "Detected MD5 hash algorithm which is considered insecure. MD5 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-328: Use of Weak Hash"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9119, "rule_id": "x8Un6q", "rv_id": 833838, "url": "https://semgrep.dev/playground/r/gETy2dl/go.lang.security.audit.crypto.use_of_weak_crypto.use-of-md5", "version_id": "gETy2dl"}}, "shortlink": "https://sg.run/2xB5", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.use_of_weak_crypto.use-of-md5", "source-rule-url": "https://github.com/securego/gosec#available-rules", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Insecure Hashing Algorithm"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/expression/builtin_encryption.go", "start": {"col": 9, "line": 638, "offset": 19542}}, {"check_id": "go.lang.security.audit.crypto.use_of_weak_crypto.use-of-sha1", "end": {"col": 22, "line": 683, "offset": 20815}, "extra": {"engine_kind": "OSS", "fingerprint": "c1c74881100af22594ac9f7081a4d2f3615213ce6b36298b7ba317b02eff0975c028488cff47fbe40f32f1737ef119202d665c99b57df2ae336f2d50df8dc7d2_0", "is_ignored": false, "lines": "\thasher := sha1.New() // #nosec G401", "message": "Detected SHA1 hash algorithm which is considered insecure. SHA1 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-328: Use of Weak Hash"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9120, "rule_id": "OrU31O", "rv_id": 833839, "url": "https://semgrep.dev/playground/r/QkTkrPb/go.lang.security.audit.crypto.use_of_weak_crypto.use-of-sha1", "version_id": "QkTkrPb"}}, "shortlink": "https://sg.run/XBYA", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.use_of_weak_crypto.use-of-sha1", "source-rule-url": "https://github.com/securego/gosec#available-rules", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Insecure Hashing Algorithm"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/expression/builtin_encryption.go", "start": {"col": 12, "line": 683, "offset": 20805}}, {"check_id": "go.lang.security.decompression_bomb.potential-dos-via-decompression-bomb", "end": {"col": 30, "line": 832, "offset": 24462}, "extra": {"engine_kind": "OSS", "fingerprint": "9d4155954403ea873bf1eac5934d3bd7dfdaa4d750b8a4ff9ddcb41ded8933a945c600e4958742a3462d71bd005ca85fb44f0036dd57e4a5bb7e23906d7d29a3_0", "fix": "io.CopyN(io., io., 1024*1024*256)", "is_ignored": false, "lines": "\tif _, err = io.Copy(&out, r); err != nil {", "message": "Detected a possible denial-of-service via a zip bomb attack. By limiting the max bytes read, you can mitigate this attack. `io.CopyN()` can specify a size. ", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-400: Uncontrolled Resource Consumption"], "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "references": ["https://golang.org/pkg/io/#CopyN", "https://github.com/securego/gosec/blob/master/rules/decompression-bomb.go"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9105, "rule_id": "oqUeqn", "rv_id": 833878, "url": "https://semgrep.dev/playground/r/yeTN1o1/go.lang.security.decompression_bomb.potential-dos-via-decompression-bomb", "version_id": "yeTN1o1"}}, "shortlink": "https://sg.run/RodK", "source": "https://semgrep.dev/r/go.lang.security.decompression_bomb.potential-dos-via-decompression-bomb", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Denial-of-Service (DoS)"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/expression/builtin_encryption.go", "start": {"col": 14, "line": 832, "offset": 24446}}, {"check_id": "go.lang.security.audit.crypto.use_of_weak_crypto.use-of-md5", "end": {"col": 21, "line": 433, "offset": 11369}, "extra": {"engine_kind": "OSS", "fingerprint": "d5b79b9bce9896b83af9f7e27153351b509217b3b63244d86dd1037305256276bac39ec72b2b76db3db18fb1a365d55a396f545d4ed70430f22edb13594bc180_0", "is_ignored": false, "lines": "\tdigest := md5.New() // #nosec G401", "message": "Detected MD5 hash algorithm which is considered insecure. MD5 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-328: Use of Weak Hash"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9119, "rule_id": "x8Un6q", "rv_id": 833838, "url": "https://semgrep.dev/playground/r/gETy2dl/go.lang.security.audit.crypto.use_of_weak_crypto.use-of-md5", "version_id": "gETy2dl"}}, "shortlink": "https://sg.run/2xB5", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.use_of_weak_crypto.use-of-md5", "source-rule-url": "https://github.com/securego/gosec#available-rules", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Insecure Hashing Algorithm"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/expression/builtin_encryption_vec.go", "start": {"col": 12, "line": 433, "offset": 11360}}, {"check_id": "go.lang.security.audit.crypto.use_of_weak_crypto.use-of-sha1", "end": {"col": 22, "line": 762, "offset": 19117}, "extra": {"engine_kind": "OSS", "fingerprint": "bafcdaac80cfc0cebe4548fb837828dfd1eacfe04e3a177a51254491098f91fcfe45408a4cfa412a613b12594c72058bd3d9ab27fd83fd67414f03a4dd0ca64c_0", "is_ignored": false, "lines": "\thasher := sha1.New() // #nosec G401", "message": "Detected SHA1 hash algorithm which is considered insecure. SHA1 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-328: Use of Weak Hash"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9120, "rule_id": "OrU31O", "rv_id": 833839, "url": "https://semgrep.dev/playground/r/QkTkrPb/go.lang.security.audit.crypto.use_of_weak_crypto.use-of-sha1", "version_id": "QkTkrPb"}}, "shortlink": "https://sg.run/XBYA", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.use_of_weak_crypto.use-of-sha1", "source-rule-url": "https://github.com/securego/gosec#available-rules", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Insecure Hashing Algorithm"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/expression/builtin_encryption_vec.go", "start": {"col": 12, "line": 762, "offset": 19107}}, {"check_id": "go.lang.security.audit.xss.import-text-template.import-text-template", "end": {"col": 16, "line": 27, "offset": 725}, "extra": {"engine_kind": "OSS", "fingerprint": "d770b093c06b7258090b2de6d3cf6cca4f7313bc04e79cfdec11502a2ce02d54f5be9b3c128eb9a12d6d17b27cffe2a7dd3724047ac881dd39f592235ec8e386_0", "fix": "html/template", "is_ignored": false, "lines": "\t\"text/template\"", "message": "When working with web applications that involve rendering user-generated  content, it's important to properly escape any HTML content to prevent  Cross-Site Scripting (XSS) attacks. In Go, the `text/template` package does  not automatically escape HTML content, which can leave your application  vulnerable to these types of attacks. To mitigate this risk, it's  recommended to use the `html/template` package instead, which provides  built-in functionality for HTML escaping. By using `html/template` to render  your HTML content, you can help to ensure that your web application is more  secure and less susceptible to XSS vulnerabilities.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www.veracode.com/blog/secure-development/use-golang-these-mistakes-could-compromise-your-apps-security"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9136, "rule_id": "5rUOZQ", "rv_id": 833868, "url": "https://semgrep.dev/playground/r/YDTl0LG/go.lang.security.audit.xss.import-text-template.import-text-template", "version_id": "YDTl0LG"}}, "shortlink": "https://sg.run/ndEO", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.import-text-template.import-text-template", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$1": {"abstract_content": "text/template", "end": {"col": 14, "line": 1, "offset": 13}, "start": {"col": 1, "line": 1, "offset": 0}}, "$IMPORT": {"abstract_content": "text/template", "end": {"col": 16, "line": 27, "offset": 725}, "start": {"col": 3, "line": 27, "offset": 712}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/expression/generator/compare_vec.go", "start": {"col": 3, "line": 27, "offset": 712}}, {"check_id": "go.lang.security.audit.xss.import-text-template.import-text-template", "end": {"col": 16, "line": 26, "offset": 717}, "extra": {"engine_kind": "OSS", "fingerprint": "c5aa8868d4a8638b64d9e92117dbd52b39ad2a5038ae60a19266f2ad6cc48bdf7774d0d83a991fd53363a03cb22e4783de1319b503b244a9a442fb1fc0c10f32_0", "fix": "html/template", "is_ignored": false, "lines": "\t\"text/template\"", "message": "When working with web applications that involve rendering user-generated  content, it's important to properly escape any HTML content to prevent  Cross-Site Scripting (XSS) attacks. In Go, the `text/template` package does  not automatically escape HTML content, which can leave your application  vulnerable to these types of attacks. To mitigate this risk, it's  recommended to use the `html/template` package instead, which provides  built-in functionality for HTML escaping. By using `html/template` to render  your HTML content, you can help to ensure that your web application is more  secure and less susceptible to XSS vulnerabilities.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www.veracode.com/blog/secure-development/use-golang-these-mistakes-could-compromise-your-apps-security"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9136, "rule_id": "5rUOZQ", "rv_id": 833868, "url": "https://semgrep.dev/playground/r/YDTl0LG/go.lang.security.audit.xss.import-text-template.import-text-template", "version_id": "YDTl0LG"}}, "shortlink": "https://sg.run/ndEO", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.import-text-template.import-text-template", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$1": {"abstract_content": "text/template", "end": {"col": 14, "line": 1, "offset": 13}, "start": {"col": 1, "line": 1, "offset": 0}}, "$IMPORT": {"abstract_content": "text/template", "end": {"col": 16, "line": 26, "offset": 717}, "start": {"col": 3, "line": 26, "offset": 704}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/expression/generator/control_vec.go", "start": {"col": 3, "line": 26, "offset": 704}}, {"check_id": "go.lang.security.audit.xss.import-text-template.import-text-template", "end": {"col": 16, "line": 26, "offset": 717}, "extra": {"engine_kind": "OSS", "fingerprint": "77a1c885a1cedda3dbbfefae391c0a888f5bf3a385c80177b54c53e9f98cf4a02e71cbf1dc0d936c022ded3f1eb2bf57f82b357109a7cbbed9bd4d1a64306fc7_0", "fix": "html/template", "is_ignored": false, "lines": "\t\"text/template\"", "message": "When working with web applications that involve rendering user-generated  content, it's important to properly escape any HTML content to prevent  Cross-Site Scripting (XSS) attacks. In Go, the `text/template` package does  not automatically escape HTML content, which can leave your application  vulnerable to these types of attacks. To mitigate this risk, it's  recommended to use the `html/template` package instead, which provides  built-in functionality for HTML escaping. By using `html/template` to render  your HTML content, you can help to ensure that your web application is more  secure and less susceptible to XSS vulnerabilities.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www.veracode.com/blog/secure-development/use-golang-these-mistakes-could-compromise-your-apps-security"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9136, "rule_id": "5rUOZQ", "rv_id": 833868, "url": "https://semgrep.dev/playground/r/YDTl0LG/go.lang.security.audit.xss.import-text-template.import-text-template", "version_id": "YDTl0LG"}}, "shortlink": "https://sg.run/ndEO", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.import-text-template.import-text-template", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$1": {"abstract_content": "text/template", "end": {"col": 14, "line": 1, "offset": 13}, "start": {"col": 1, "line": 1, "offset": 0}}, "$IMPORT": {"abstract_content": "text/template", "end": {"col": 16, "line": 26, "offset": 717}, "start": {"col": 3, "line": 26, "offset": 704}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/expression/generator/other_vec.go", "start": {"col": 3, "line": 26, "offset": 704}}, {"check_id": "go.lang.security.audit.xss.import-text-template.import-text-template", "end": {"col": 16, "line": 27, "offset": 725}, "extra": {"engine_kind": "OSS", "fingerprint": "0923f3551f7adfc58614d2e167f8121b6f91f2d4c4a25c6c632ede4e486b5ef8f7219542d73f06835a6045613489c38838d2c90d4871a12a1a6f5af0e185966c_0", "fix": "html/template", "is_ignored": false, "lines": "\t\"text/template\"", "message": "When working with web applications that involve rendering user-generated  content, it's important to properly escape any HTML content to prevent  Cross-Site Scripting (XSS) attacks. In Go, the `text/template` package does  not automatically escape HTML content, which can leave your application  vulnerable to these types of attacks. To mitigate this risk, it's  recommended to use the `html/template` package instead, which provides  built-in functionality for HTML escaping. By using `html/template` to render  your HTML content, you can help to ensure that your web application is more  secure and less susceptible to XSS vulnerabilities.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www.veracode.com/blog/secure-development/use-golang-these-mistakes-could-compromise-your-apps-security"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9136, "rule_id": "5rUOZQ", "rv_id": 833868, "url": "https://semgrep.dev/playground/r/YDTl0LG/go.lang.security.audit.xss.import-text-template.import-text-template", "version_id": "YDTl0LG"}}, "shortlink": "https://sg.run/ndEO", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.import-text-template.import-text-template", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$1": {"abstract_content": "text/template", "end": {"col": 14, "line": 1, "offset": 13}, "start": {"col": 1, "line": 1, "offset": 0}}, "$IMPORT": {"abstract_content": "text/template", "end": {"col": 16, "line": 27, "offset": 725}, "start": {"col": 3, "line": 27, "offset": 712}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/expression/generator/string_vec.go", "start": {"col": 3, "line": 27, "offset": 712}}, {"check_id": "go.lang.security.audit.xss.import-text-template.import-text-template", "end": {"col": 16, "line": 26, "offset": 717}, "extra": {"engine_kind": "OSS", "fingerprint": "01a4a4b79457a457e09b80dbb6e22570f8df8df3d43591b28190a1c682d9fc6e000052eb84bee584eeb34fbd4754764776844f2ce21f030a48737f1be1068d73_0", "fix": "html/template", "is_ignored": false, "lines": "\t\"text/template\"", "message": "When working with web applications that involve rendering user-generated  content, it's important to properly escape any HTML content to prevent  Cross-Site Scripting (XSS) attacks. In Go, the `text/template` package does  not automatically escape HTML content, which can leave your application  vulnerable to these types of attacks. To mitigate this risk, it's  recommended to use the `html/template` package instead, which provides  built-in functionality for HTML escaping. By using `html/template` to render  your HTML content, you can help to ensure that your web application is more  secure and less susceptible to XSS vulnerabilities.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www.veracode.com/blog/secure-development/use-golang-these-mistakes-could-compromise-your-apps-security"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9136, "rule_id": "5rUOZQ", "rv_id": 833868, "url": "https://semgrep.dev/playground/r/YDTl0LG/go.lang.security.audit.xss.import-text-template.import-text-template", "version_id": "YDTl0LG"}}, "shortlink": "https://sg.run/ndEO", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.import-text-template.import-text-template", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$1": {"abstract_content": "text/template", "end": {"col": 14, "line": 1, "offset": 13}, "start": {"col": 1, "line": 1, "offset": 0}}, "$IMPORT": {"abstract_content": "text/template", "end": {"col": 16, "line": 26, "offset": 717}, "start": {"col": 3, "line": 26, "offset": 704}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/expression/generator/time_vec.go", "start": {"col": 3, "line": 26, "offset": 704}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 22, "offset": 659}, "extra": {"engine_kind": "OSS", "fingerprint": "ab2554bdbdaf6e9bb48a788c79aeaa5b19efe96164688b43dab26cf90b5cc7bcb4c5be3e53ee89a61b8d9d9d708f23b6ebaa9720e0930ea6dd8293429163e24d_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "Lock", "end": {"col": 21, "line": 54, "offset": 1556}, "start": {"col": 17, "line": 54, "offset": 1552}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 22, "offset": 659}, "start": {"col": 3, "line": 22, "offset": 650}}, "$RAND": {"abstract_content": "ib.innerTSLock", "end": {"col": 16, "line": 54, "offset": 1551}, "start": {"col": 2, "line": 54, "offset": 1537}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/kv/txn.go", "start": {"col": 3, "line": 22, "offset": 650}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 19, "offset": 634}, "extra": {"engine_kind": "OSS", "fingerprint": "7d4d4fe416d101b34f23c6bce278af99b7ff9648ef47cdb2f72e0e75323609cb0c98c24162584911170b7887341a53be2e5f707ef41a90998d6ad137b917b7f1_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "NewExtraHandleColInfo", "end": {"col": 56, "line": 45, "offset": 1473}, "start": {"col": 35, "line": 45, "offset": 1452}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 19, "offset": 634}, "start": {"col": 3, "line": 19, "offset": 625}}, "$RAND": {"abstract_content": "model", "end": {"col": 34, "line": 45, "offset": 1451}, "start": {"col": 29, "line": 45, "offset": 1446}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/lightning/backend/kv/base.go", "start": {"col": 3, "line": 19, "offset": 625}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 19, "offset": 631}, "extra": {"engine_kind": "OSS", "fingerprint": "2379d41f324445c0a77caaf991e502bcfbcb0d812a3d9effe57f40af437dc2886c8c6e58900e12dd58bdc4d8d05209595ba8fd0ad57d0a3910281413aa1f052b_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "WithTruncateAsWarning", "end": {"col": 24, "line": 52, "offset": 1899}, "start": {"col": 3, "line": 52, "offset": 1878}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 19, "offset": 631}, "start": {"col": 3, "line": 19, "offset": 622}}, "$RAND": {"abstract_content": "types.DefaultStmtFlags", "end": {"col": 33, "line": 51, "offset": 1874}, "start": {"col": 11, "line": 51, "offset": 1852}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/lightning/backend/kv/context.go", "start": {"col": 3, "line": 19, "offset": 622}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 60, "line": 643, "offset": 19511}, "extra": {"engine_kind": "OSS", "fingerprint": "baf265f44bd98cee5daa61a2097fe78b1249884c8724dba3beb594587573f17c2dd0718bc73bc3c235284bd2308601f4fe6efd7398f6dcb8d069a78443867de3_0", "is_ignored": false, "lines": "\tquery := fmt.Sprintf(\"SHOW VARIABLES LIKE '%s'\", variable)", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CTX": {"abstract_content": "ctx", "end": {"col": 34, "line": 644, "offset": 19545}, "start": {"col": 31, "line": 644, "offset": 19542}}, "$FUNC": {"abstract_content": "getSessionVariable", "end": {"col": 24, "line": 642, "offset": 19373}, "start": {"col": 6, "line": 642, "offset": 19355}}, "$OBJ": {"abstract_content": "db", "end": {"col": 17, "line": 644, "offset": 19528}, "start": {"col": 15, "line": 644, "offset": 19526}}, "$QUERY": {"abstract_content": "query", "end": {"col": 7, "line": 643, "offset": 19458}, "start": {"col": 2, "line": 643, "offset": 19453}}, "$SQLSTR": {"abstract_content": "SHOW VARIABLES LIKE '%s'", "end": {"col": 48, "line": 643, "offset": 19499}, "start": {"col": 24, "line": 643, "offset": 19475}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/lightning/common/util.go", "start": {"col": 2, "line": 643, "offset": 19453}}, {"check_id": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "end": {"col": 42, "line": 644, "offset": 19553}, "extra": {"engine_kind": "OSS", "fingerprint": "91348a71b4ea291d8b1b6ac677fc76888fd8c191509644dd5425968ac6f5a09e5d32df025f0408bf3c585da0a4c7f63b3cfe2ea69b980d7ee7d15675d6929a36_0", "is_ignored": false, "lines": "\trows, err := db.QueryContext(ctx, query)", "message": "Detected string concatenation with a non-literal variable in a \"database/sql\" Go SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use prepared statements with the 'Prepare' and 'PrepareContext' calls.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10258, "rule_id": "YGUrnQ", "rv_id": 833862, "url": "https://semgrep.dev/playground/r/DkTG0E7/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "version_id": "DkTG0E7"}}, "shortlink": "https://sg.run/YgOX", "source": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "QueryContext", "end": {"col": 13, "line": 1, "offset": 12}, "start": {"col": 1, "line": 1, "offset": 0}}, "$DB": {"abstract_content": "db", "end": {"col": 17, "line": 644, "offset": 19528}, "start": {"col": 15, "line": 644, "offset": 19526}}, "$FUNCNAME": {"abstract_content": "getSessionVariable", "end": {"col": 24, "line": 642, "offset": 19373}, "start": {"col": 6, "line": 642, "offset": 19355}}, "$METHOD": {"abstract_content": "QueryContext", "end": {"col": 30, "line": 644, "offset": 19541}, "start": {"col": 18, "line": 644, "offset": 19529}}, "$PARAM1": {"abstract_content": "variable", "end": {"col": 59, "line": 643, "offset": 19510}, "start": {"col": 51, "line": 643, "offset": 19502}}, "$QUERY": {"abstract_content": "query", "end": {"col": 41, "line": 644, "offset": 19552}, "propagated_value": {"svalue_abstract_content": "fmt.Sprintf(\"SHOW VARIABLES LIKE '%s'\"variable)", "svalue_end": {"col": 60, "line": 643, "offset": 19511}, "svalue_start": {"col": 11, "line": 643, "offset": 19462}}, "start": {"col": 36, "line": 644, "offset": 19547}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "pkg/lightning/common/util.go", "start": {"col": 15, "line": 644, "offset": 19526}}, {"check_id": "problem-based-packs.insecure-transport.go-stdlib.bypass-tls-verification.bypass-tls-verification", "end": {"col": 5, "line": 203, "offset": 7174}, "extra": {"engine_kind": "OSS", "fingerprint": "77f9c7052fde4697f1a7f2531cb54aeaed0ecf1f19fb400e30cd6f3c664a1cb3de587b3ed13b25947289415ded2b81ff1fffe7b5c6c2ff8f6b99a0828ba01cfe_0", "is_ignored": false, "lines": "\t\t\td.Security.TLSConfig = &tls.Config{\n\t\t\t\tMinVersion:         tls.VersionTLS12,\n\t\t\t\tInsecureSkipVerify: true,\n\t\t\t\tNextProtos:         []string{\"h2\", \"http/1.1\"}, // specify `h2` to let Go use HTTP/2.\n\t\t\t}", "message": "Checks for disabling of TLS/SSL certificate verification. This should only be used for debugging purposes because it leads to vulnerability to MTM attacks.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": "CWE-319: Cleartext Transmission of Sensitive Information", "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "HIGH", "owasp": "A03:2017 - Sensitive Data Exposure", "references": ["https://stackoverflow.com/questions/12122159/how-to-do-a-https-request-with-bad-certificate"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9400, "rule_id": "DbUpjg", "rv_id": 834309, "url": "https://semgrep.dev/playground/r/BjTe0EO/problem-based-packs.insecure-transport.go-stdlib.bypass-tls-verification.bypass-tls-verification", "version_id": "BjTe0EO"}}, "shortlink": "https://sg.run/4xj5", "source": "https://semgrep.dev/r/problem-based-packs.insecure-transport.go-stdlib.bypass-tls-verification.bypass-tls-verification", "subcategory": ["vuln"], "technology": ["go"], "vulnerability": "Insecure Transport", "vulnerability_class": ["Mishandled Sensitive Information"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/lightning/config/config.go", "start": {"col": 28, "line": 199, "offset": 6996}}, {"check_id": "trailofbits.go.waitgroup-add-called-inside-goroutine.waitgroup-add-called-inside-goroutine", "end": {"col": 5, "line": 538, "offset": 16994}, "extra": {"engine_kind": "OSS", "fingerprint": "1f0fd03d377a244f7f72beb50625069fb83dad0305b58ed11fd3eee8dde844832178462b024712e996d1228d219021073d71b4ad12e2fc8b07f27c9d87d31d13_0", "is_ignored": false, "lines": "\tindexTaskWg := &sync.WaitGroup{}\n\tindexG, indexGCtx := errgroup.WithContext(ctx)\n\n\tgo func() {\n\t\t//nolint:staticcheck\n\t\t//lint:ignore SA2000\n\t\tindexTaskWg.Add(1)\n\t\tindexTaskCh <- [2]int64{0, math.MaxInt64}\n\t\tindexTaskWg.Wait()\n\t\tclose(indexTaskCh)\n\t}()", "message": "Calling `indexTaskWg.Add` inside of an anonymous goroutine may result in `indexTaskWg.Wait`\nwaiting for more or less calls to `indexTaskWg.Done()` than expected\n", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": "CWE-667: Improper Locking", "description": "Calls to `sync.WaitGroup.Add` inside of anonymous goroutines", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "MEDIUM", "references": ["https://go101.org/article/concurrent-common-mistakes.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 11761, "rule_id": "JDUQ3v", "rv_id": 833276, "url": "https://semgrep.dev/playground/r/kbT2l5k/trailofbits.go.waitgroup-add-called-inside-goroutine.waitgroup-add-called-inside-goroutine", "version_id": "kbT2l5k"}}, "shortlink": "https://sg.run/z98W", "source": "https://semgrep.dev/r/trailofbits.go.waitgroup-add-called-inside-goroutine.waitgroup-add-called-inside-goroutine", "subcategory": ["vuln"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$WG": {"abstract_content": "indexTaskWg", "end": {"col": 13, "line": 528, "offset": 16753}, "start": {"col": 2, "line": 528, "offset": 16742}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "pkg/lightning/errormanager/errormanager.go", "start": {"col": 2, "line": 528, "offset": 16742}}, {"check_id": "trailofbits.go.waitgroup-add-called-inside-goroutine.waitgroup-add-called-inside-goroutine", "end": {"col": 5, "line": 739, "offset": 23514}, "extra": {"engine_kind": "OSS", "fingerprint": "b577a5937e71821e46febea3aee7d012741dc177b0ffe2d8d0bc68f66cf55d3ea3387bdcf810ef2dd31b0c69bef0fc2685a66ef81689db5aefacb0182917cfd2_0", "is_ignored": false, "lines": "\tdataTaskWg := &sync.WaitGroup{}\n\tdataG, dataGCtx := errgroup.WithContext(ctx)\n\n\tgo func() {\n\t\t//nolint:staticcheck\n\t\t//lint:ignore SA2000\n\t\tdataTaskWg.Add(1)\n\t\tdataTaskCh <- [2]int64{0, math.MaxInt64}\n\t\tdataTaskWg.Wait()\n\t\tclose(dataTaskCh)\n\t}()", "message": "Calling `dataTaskWg.Add` inside of an anonymous goroutine may result in `dataTaskWg.Wait`\nwaiting for more or less calls to `dataTaskWg.Done()` than expected\n", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": "CWE-667: Improper Locking", "description": "Calls to `sync.WaitGroup.Add` inside of anonymous goroutines", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "MEDIUM", "references": ["https://go101.org/article/concurrent-common-mistakes.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 11761, "rule_id": "JDUQ3v", "rv_id": 833276, "url": "https://semgrep.dev/playground/r/kbT2l5k/trailofbits.go.waitgroup-add-called-inside-goroutine.waitgroup-add-called-inside-goroutine", "version_id": "kbT2l5k"}}, "shortlink": "https://sg.run/z98W", "source": "https://semgrep.dev/r/trailofbits.go.waitgroup-add-called-inside-goroutine.waitgroup-add-called-inside-goroutine", "subcategory": ["vuln"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$WG": {"abstract_content": "dataTaskWg", "end": {"col": 12, "line": 729, "offset": 23279}, "start": {"col": 2, "line": 729, "offset": 23269}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "pkg/lightning/errormanager/errormanager.go", "start": {"col": 2, "line": 729, "offset": 23269}}, {"check_id": "go.lang.security.audit.crypto.use_of_weak_crypto.use-of-sha1", "end": {"col": 21, "line": 44, "offset": 1491}, "extra": {"engine_kind": "OSS", "fingerprint": "b3bcf9a44d14358d685475e1ec6a85074de988ddc0d838a25c17199ed6ae7c7771a13dee005234708f436437c0f3d725e6a022e671a11d905422d82b2a5369fc_0", "is_ignored": false, "lines": "\tcrypt := sha1.New()", "message": "Detected SHA1 hash algorithm which is considered insecure. SHA1 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-328: Use of Weak Hash"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9120, "rule_id": "OrU31O", "rv_id": 833839, "url": "https://semgrep.dev/playground/r/QkTkrPb/go.lang.security.audit.crypto.use_of_weak_crypto.use-of-sha1", "version_id": "QkTkrPb"}}, "shortlink": "https://sg.run/XBYA", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.use_of_weak_crypto.use-of-sha1", "source-rule-url": "https://github.com/securego/gosec#available-rules", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Insecure Hashing Algorithm"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/parser/auth/mysql_native_password.go", "start": {"col": 11, "line": 44, "offset": 1481}}, {"check_id": "go.lang.security.audit.crypto.use_of_weak_crypto.use-of-sha1", "end": {"col": 21, "line": 64, "offset": 1942}, "extra": {"engine_kind": "OSS", "fingerprint": "b3bcf9a44d14358d685475e1ec6a85074de988ddc0d838a25c17199ed6ae7c7771a13dee005234708f436437c0f3d725e6a022e671a11d905422d82b2a5369fc_1", "is_ignored": false, "lines": "\tcrypt := sha1.New()", "message": "Detected SHA1 hash algorithm which is considered insecure. SHA1 is not collision resistant and is therefore not suitable as a cryptographic signature. Use SHA256 or SHA3 instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-328: Use of Weak Hash"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9120, "rule_id": "OrU31O", "rv_id": 833839, "url": "https://semgrep.dev/playground/r/QkTkrPb/go.lang.security.audit.crypto.use_of_weak_crypto.use-of-sha1", "version_id": "QkTkrPb"}}, "shortlink": "https://sg.run/XBYA", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.use_of_weak_crypto.use-of-sha1", "source-rule-url": "https://github.com/securego/gosec#available-rules", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Insecure Hashing Algorithm"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/parser/auth/mysql_native_password.go", "start": {"col": 11, "line": 64, "offset": 1932}}, {"check_id": "trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "end": {"col": 16, "line": 275, "offset": 9449}, "extra": {"engine_kind": "OSS", "fingerprint": "74541ac76b1a0a2cdd5f8f0d6035ec5099b898df23e68367bbab125a8d446830c236697382cfc49f50ee349d5dd9c348439199198ad5ecf4dc27fba6e0ae219c_0", "is_ignored": false, "lines": "\tn, err := strconv.ParseUint(str, 10, 64)\n\tif err != nil {\n\t\te := err.(*strconv.NumError)\n\t\tif e.Err == strconv.ErrRange {\n\t\t\t// TODO: toDecimal maybe out of range still.\n\t\t\t// This kind of error should be throw to higher level, because truncated data maybe legal.\n\t\t\t// For example, this SQL returns error:\n\t\t\t// create table test (id decimal(30, 0));\n\t\t\t// insert into test values(123456789012345678901234567890123094839045793405723406801943850);\n\t\t\t// While this SQL:\n\t\t\t// select 1234567890123456789012345678901230948390457934057234068019438509023041874359081325875128590860234789847359871045943057;\n\t\t\t// get value 99999999999999999999999999999999999999999999999999999999999999999\n\t\t\treturn toDecimal(l, lval, str)\n\t\t}\n\t\tl.AppendError(l.Errorf(\"integer literal: %v\", err))\n\t\treturn invalid\n\t}\n\n\tswitch {\n\tcase n <= math.MaxInt64:\n\t\tlval.item = int64(n)\n\tdefault:\n\t\tlval.item = n", "message": "Downcasting or changing sign of an integer with `$CAST_METHOD` method", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-681: Incorrect Conversion between Numeric Types", "description": "Integer underflows", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://github.com/golang/go/issues/30209"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 11759, "rule_id": "4bU2AZ", "rv_id": 833273, "url": "https://semgrep.dev/playground/r/rxTDzNy/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "version_id": "rxTDzNy"}}, "shortlink": "https://sg.run/65WB", "source": "https://semgrep.dev/r/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$X": {"abstract_content": "n", "end": {"col": 3, "line": 253, "offset": 8568}, "start": {"col": 2, "line": 253, "offset": 8567}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/parser/yy_parser.go", "start": {"col": 2, "line": 253, "offset": 8567}}, {"check_id": "trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "end": {"col": 4, "line": 2818, "offset": 102683}, "extra": {"engine_kind": "OSS", "fingerprint": "9ef3334f73ba6c65a83fd8e5033ca7778fcfa05c21fe2c32dc6c92d612e53613856c2ba1a695bf449c21ca34174db856b29406268444534aa47b21e663dfc087_0", "is_ignored": false, "lines": "\t\tcolMap := make(map[*types.FieldName]struct{}, len(p.Schema().Columns))\n\t\tallColFromAggExprNode(p, aggFunc, colMap)\n\t\tfor k := range colMap {\n\t\t\tcolName := &ast.ColumnName{\n\t\t\t\tSchema: k.DBName,\n\t\t\t\tTable:  k.TblName,\n\t\t\t\tName:   k.ColName,\n\t\t\t}\n\t\t\t// Add the column referred in the agg func into the select list. So that we can resolve the agg func correctly.\n\t\t\t// And we need set the AuxiliaryColInAgg to true to help our only_full_group_by checker work correctly.\n\t\t\tsel.Fields.Fields = append(sel.Fields.Fields, &ast.SelectField{\n\t\t\t\tAuxiliary:         true,\n\t\t\t\tAuxiliaryColInAgg: true,\n\t\t\t\tExpr:              &ast.ColumnNameExpr{Name: colName},\n\t\t\t})\n\t\t}", "message": "Iteration over a possibly empty map `colMap`. This is likely a bug or redundant code", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": "CWE-665: Improper Initialization", "description": "Probably redundant iteration over an empty map", "impact": "LOW", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17198, "rule_id": "wdUlww", "rv_id": 833266, "url": "https://semgrep.dev/playground/r/pZTXjeW/trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "version_id": "pZTXjeW"}}, "shortlink": "https://sg.run/08jj", "source": "https://semgrep.dev/r/trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$C": {"abstract_content": "colMap", "end": {"col": 9, "line": 2803, "offset": 102029}, "start": {"col": 3, "line": 2803, "offset": 102023}}, "$K": {"abstract_content": "k", "end": {"col": 8, "line": 2805, "offset": 102145}, "start": {"col": 7, "line": 2805, "offset": 102144}}, "$T1": {"abstract_content": "*types FieldName", "end": {"col": 38, "line": 2803, "offset": 102058}, "start": {"col": 22, "line": 2803, "offset": 102042}}, "$T2": {"abstract_content": "struct{}", "end": {"col": 47, "line": 2803, "offset": 102067}, "start": {"col": 39, "line": 2803, "offset": 102059}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/planner/core/logical_plan_builder.go", "start": {"col": 3, "line": 2803, "offset": 102023}}, {"check_id": "trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "end": {"col": 3, "line": 3184, "offset": 113518}, "extra": {"engine_kind": "OSS", "fingerprint": "677e3c8e132f9137e225e20426590daf59a79a99c27306eacc5c1c6a07ab74909897320d4f481abbcee8b6d40b9656f90afa7c3fb83d4235141a33d57d8c8383_0", "is_ignored": false, "lines": "\tcolMap := make(map[*types.FieldName]struct{}, len(p.Schema().Columns))\n\tallColFromExprNode(p, expr, colMap)\n\tfor col := range colMap {\n\t\tif _, ok := gbyOrSingleValueColNames[col]; !ok {\n\t\t\tnotInGbyOrSingleValueColNames[col] = ErrExprLoc{Offset: offset, Loc: loc}\n\t\t}\n\t}", "message": "Iteration over a possibly empty map `colMap`. This is likely a bug or redundant code", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": "CWE-665: Improper Initialization", "description": "Probably redundant iteration over an empty map", "impact": "LOW", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17198, "rule_id": "wdUlww", "rv_id": 833266, "url": "https://semgrep.dev/playground/r/pZTXjeW/trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "version_id": "pZTXjeW"}}, "shortlink": "https://sg.run/08jj", "source": "https://semgrep.dev/r/trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$C": {"abstract_content": "colMap", "end": {"col": 8, "line": 3178, "offset": 113255}, "start": {"col": 2, "line": 3178, "offset": 113249}}, "$K": {"abstract_content": "col", "end": {"col": 9, "line": 3180, "offset": 113365}, "start": {"col": 6, "line": 3180, "offset": 113362}}, "$T1": {"abstract_content": "*types FieldName", "end": {"col": 37, "line": 3178, "offset": 113284}, "start": {"col": 21, "line": 3178, "offset": 113268}}, "$T2": {"abstract_content": "struct{}", "end": {"col": 46, "line": 3178, "offset": 113293}, "start": {"col": 38, "line": 3178, "offset": 113285}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/planner/core/logical_plan_builder.go", "start": {"col": 2, "line": 3178, "offset": 113249}}, {"check_id": "trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "end": {"col": 4, "line": 635, "offset": 21914}, "extra": {"engine_kind": "OSS", "fingerprint": "28a8acf7f129674a26f493c46af51227afe47db961800e59dd0ae47e8438e5e385967e990458facc8e9bfe5c28d02cabb7ee3ec081ce5101caae8755af2ab869_0", "is_ignored": false, "lines": "\t\tintVal, err := strconv.Atoi(val.(string))\n\t\tif err == nil {\n\t\t\tfailpoint.Return(true, uint64(intVal))\n\t\t} else {\n\t\t\tfailpoint.Return(false, 0)\n\t\t}", "message": "Downcasting or changing sign of an integer with `$CAST_METHOD` method", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-681: Incorrect Conversion between Numeric Types", "description": "Integer underflows", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://github.com/golang/go/issues/30209"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 11759, "rule_id": "4bU2AZ", "rv_id": 833273, "url": "https://semgrep.dev/playground/r/rxTDzNy/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "version_id": "rxTDzNy"}}, "shortlink": "https://sg.run/65WB", "source": "https://semgrep.dev/r/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$X": {"abstract_content": "intVal", "end": {"col": 9, "line": 630, "offset": 21774}, "start": {"col": 3, "line": 630, "offset": 21768}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/planner/core/optimizer.go", "start": {"col": 3, "line": 630, "offset": 21768}}, {"check_id": "trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "end": {"col": 5, "line": 647, "offset": 22431}, "extra": {"engine_kind": "OSS", "fingerprint": "0659eec510d8b01d22e4d55601b4ead3ce610bb02fa4ae89abf4f9026b779581b6810cbfdac3d978163c5862e374eefe45ccec1f7474c542d9809ceedd0d9968_0", "is_ignored": false, "lines": "\t\t\tlogicalCpus, err := strconv.Atoi(row[5].GetString())\n\t\t\tif err == nil && logicalCpus > 0 {\n\t\t\t\tminLogicalCores = min(minLogicalCores, uint64(logicalCpus))\n\t\t\t}", "message": "Downcasting or changing sign of an integer with `$CAST_METHOD` method", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-681: Incorrect Conversion between Numeric Types", "description": "Integer underflows", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://github.com/golang/go/issues/30209"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 11759, "rule_id": "4bU2AZ", "rv_id": 833273, "url": "https://semgrep.dev/playground/r/rxTDzNy/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "version_id": "rxTDzNy"}}, "shortlink": "https://sg.run/65WB", "source": "https://semgrep.dev/r/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$X": {"abstract_content": "logicalCpus", "end": {"col": 15, "line": 644, "offset": 22283}, "start": {"col": 4, "line": 644, "offset": 22272}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/planner/core/optimizer.go", "start": {"col": 4, "line": 644, "offset": 22272}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 20, "offset": 647}, "extra": {"engine_kind": "OSS", "fingerprint": "549f1818bb37a3d9d787d08f658c2b88182aac832f29d966259114cb9511b2475d5a3030f97294eeafe358cfd1a30b34c810c13923eb88f87b22078d1cde40df_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "GetPreparedStmt", "end": {"col": 43, "line": 58, "offset": 2167}, "start": {"col": 28, "line": 58, "offset": 2152}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 20, "offset": 647}, "start": {"col": 3, "line": 20, "offset": 638}}, "$RAND": {"abstract_content": "core", "end": {"col": 27, "line": 58, "offset": 2151}, "start": {"col": 23, "line": 58, "offset": 2147}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/planner/optimize.go", "start": {"col": 3, "line": 20, "offset": 638}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 33, "line": 78, "offset": 2202}, "extra": {"engine_kind": "OSS", "fingerprint": "992c79bd5e6f9b39e0fa07b6bb80129279b402da2d0f1c4833785836e1a9055a58d455afb5c9ddd2a7050d3618efac4103c0d0ba31662cc91e1684ea6ad2464f_0", "is_ignored": false, "lines": "\t\t_, err = w.Write([]byte(name))", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "ServeHTTP", "end": {"col": 44, "line": 52, "offset": 1466}, "start": {"col": 35, "line": 52, "offset": 1457}}, "$WRITER": {"abstract_content": "w", "end": {"col": 13, "line": 78, "offset": 2182}, "start": {"col": 12, "line": 78, "offset": 2181}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/handler/extractorhandler/extractor.go", "start": {"col": 12, "line": 78, "offset": 2181}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 27, "line": 90, "offset": 2505}, "extra": {"engine_kind": "OSS", "fingerprint": "992c79bd5e6f9b39e0fa07b6bb80129279b402da2d0f1c4833785836e1a9055a58d455afb5c9ddd2a7050d3618efac4103c0d0ba31662cc91e1684ea6ad2464f_1", "is_ignored": false, "lines": "\t_, err = w.Write(content)", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "ServeHTTP", "end": {"col": 44, "line": 52, "offset": 1466}, "start": {"col": 35, "line": 52, "offset": 1457}}, "$WRITER": {"abstract_content": "w", "end": {"col": 12, "line": 90, "offset": 2490}, "start": {"col": 11, "line": 90, "offset": 2489}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/handler/extractorhandler/extractor.go", "start": {"col": 11, "line": 90, "offset": 2489}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 28, "line": 122, "offset": 3659}, "extra": {"engine_kind": "OSS", "fingerprint": "799b1d295166031d9bfdecd990e116bc21575d4ba6d8bec6b355a6ad624c34ae615d9140ea20e0bf8233722b5ab957637760f630180c59eb90246e94a24eb38b_0", "is_ignored": false, "lines": "\t\t_, err = w.Write(content)", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "handleDownloadFile", "end": {"col": 24, "line": 87, "offset": 2734}, "start": {"col": 6, "line": 87, "offset": 2716}}, "$WRITER": {"abstract_content": "w", "end": {"col": 13, "line": 122, "offset": 3644}, "start": {"col": 12, "line": 122, "offset": 3643}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/handler/optimizor/plan_replayer.go", "start": {"col": 12, "line": 122, "offset": 3643}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 28, "line": 176, "offset": 5693}, "extra": {"engine_kind": "OSS", "fingerprint": "799b1d295166031d9bfdecd990e116bc21575d4ba6d8bec6b355a6ad624c34ae615d9140ea20e0bf8233722b5ab957637760f630180c59eb90246e94a24eb38b_1", "is_ignored": false, "lines": "\t\t_, err = w.Write(content)", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "handleDownloadFile", "end": {"col": 24, "line": 87, "offset": 2734}, "start": {"col": 6, "line": 87, "offset": 2716}}, "$WRITER": {"abstract_content": "w", "end": {"col": 13, "line": 176, "offset": 5678}, "start": {"col": 12, "line": 176, "offset": 5677}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/handler/optimizor/plan_replayer.go", "start": {"col": 12, "line": 176, "offset": 5677}}, {"check_id": "go.lang.security.audit.xss.no-fprintf-to-responsewriter.no-fprintf-to-responsewriter", "end": {"col": 79, "line": 191, "offset": 6436}, "extra": {"engine_kind": "OSS", "fingerprint": "d6a5298edba3692f195ab040c1063c7764cb95a9dcf9845f755e6dd4600b504420e63a9c2ef8f6b4811240b59f67a1fb0dbe5b67656a31c514de339ac56445b4_0", "is_ignored": false, "lines": "\t_, err = fmt.Fprintf(w, \"can't find dump file %s in any remote server\", name)", "message": "Detected 'Fprintf' or similar writing to 'http.ResponseWriter'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package to render data to users.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9138, "rule_id": "ReUgyJ", "rv_id": 833870, "url": "https://semgrep.dev/playground/r/o5TBEAp/go.lang.security.audit.xss.no-fprintf-to-responsewriter.no-fprintf-to-responsewriter", "version_id": "o5TBEAp"}}, "shortlink": "https://sg.run/7oqR", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-fprintf-to-responsewriter.no-fprintf-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "handleDownloadFile", "end": {"col": 24, "line": 87, "offset": 2734}, "start": {"col": 6, "line": 87, "offset": 2716}}, "$PRINTF": {"abstract_content": "Fprintf", "end": {"col": 22, "line": 191, "offset": 6379}, "start": {"col": 15, "line": 191, "offset": 6372}}, "$WRITER": {"abstract_content": "w", "end": {"col": 24, "line": 191, "offset": 6381}, "start": {"col": 23, "line": 191, "offset": 6380}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/handler/optimizor/plan_replayer.go", "start": {"col": 11, "line": 191, "offset": 6368}}, {"check_id": "trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "end": {"col": 5, "line": 488, "offset": 14881}, "extra": {"engine_kind": "OSS", "fingerprint": "84cf17c31ec8492c2835a354cb8e6876bfeda5fc4d98d34ac8dce51e2ac402e82e375b882b026cb5e270fac3d6f27db6899420bc28bbfc38b8ad2cfe22f1c1d2_0", "is_ignored": false, "lines": "\t\t\tthreshold, err1 := strconv.Atoi(ddlSlowThreshold)\n\t\t\tif err1 != nil {\n\t\t\t\thandler.WriteError(w, err1)\n\t\t\t\treturn\n\t\t\t}\n\t\t\tif threshold > 0 {\n\t\t\t\tatomic.StoreUint32(&variable.DDLSlowOprThreshold, uint32(threshold))\n\t\t\t}", "message": "Downcasting or changing sign of an integer with `uint32` method", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-681: Incorrect Conversion between Numeric Types", "description": "Integer underflows", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://github.com/golang/go/issues/30209"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 11759, "rule_id": "4bU2AZ", "rv_id": 833273, "url": "https://semgrep.dev/playground/r/rxTDzNy/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "version_id": "rxTDzNy"}}, "shortlink": "https://sg.run/65WB", "source": "https://semgrep.dev/r/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$CAST_METHOD": {"abstract_content": "uint32", "end": {"col": 61, "line": 487, "offset": 14864}, "start": {"col": 55, "line": 487, "offset": 14858}}, "$X": {"abstract_content": "threshold", "end": {"col": 13, "line": 481, "offset": 14673}, "start": {"col": 4, "line": 481, "offset": 14664}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/handler/tikvhandler/tikv_handler.go", "start": {"col": 4, "line": 481, "offset": 14664}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 38, "line": 901, "offset": 28682}, "extra": {"engine_kind": "OSS", "fingerprint": "b824a36c28d12966c16f3797b6d05e18e375e1444f81b466f92e47fc9f19a6c465315fe4d9a6d405d035f895f330f8a19f78e02145467442588036e8b3899cd1_0", "is_ignored": false, "lines": "\t_, err := w.Write(hack.Slice(\"[\\n\"))", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "manualWriteJSONArray", "end": {"col": 26, "line": 893, "offset": 28388}, "start": {"col": 6, "line": 893, "offset": 28368}}, "$WRITER": {"abstract_content": "w", "end": {"col": 13, "line": 901, "offset": 28657}, "start": {"col": 12, "line": 901, "offset": 28656}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/handler/tikvhandler/tikv_handler.go", "start": {"col": 12, "line": 901, "offset": 28656}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 39, "line": 909, "offset": 28839}, "extra": {"engine_kind": "OSS", "fingerprint": "b824a36c28d12966c16f3797b6d05e18e375e1444f81b466f92e47fc9f19a6c465315fe4d9a6d405d035f895f330f8a19f78e02145467442588036e8b3899cd1_1", "is_ignored": false, "lines": "\t\t\t_, err = w.Write(hack.Slice(\",\\n\"))", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "manualWriteJSONArray", "end": {"col": 26, "line": 893, "offset": 28388}, "start": {"col": 6, "line": 893, "offset": 28368}}, "$WRITER": {"abstract_content": "w", "end": {"col": 14, "line": 909, "offset": 28814}, "start": {"col": 13, "line": 909, "offset": 28813}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/handler/tikvhandler/tikv_handler.go", "start": {"col": 13, "line": 909, "offset": 28813}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 23, "line": 922, "offset": 29073}, "extra": {"engine_kind": "OSS", "fingerprint": "b824a36c28d12966c16f3797b6d05e18e375e1444f81b466f92e47fc9f19a6c465315fe4d9a6d405d035f895f330f8a19f78e02145467442588036e8b3899cd1_2", "is_ignored": false, "lines": "\t\t_, err = w.Write(js)", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "manualWriteJSONArray", "end": {"col": 26, "line": 893, "offset": 28388}, "start": {"col": 6, "line": 893, "offset": 28368}}, "$WRITER": {"abstract_content": "w", "end": {"col": 13, "line": 922, "offset": 29063}, "start": {"col": 12, "line": 922, "offset": 29062}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/handler/tikvhandler/tikv_handler.go", "start": {"col": 12, "line": 922, "offset": 29062}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 37, "line": 928, "offset": 29178}, "extra": {"engine_kind": "OSS", "fingerprint": "b824a36c28d12966c16f3797b6d05e18e375e1444f81b466f92e47fc9f19a6c465315fe4d9a6d405d035f895f330f8a19f78e02145467442588036e8b3899cd1_3", "is_ignored": false, "lines": "\t_, err = w.Write(hack.Slice(\"\\n]\"))", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "manualWriteJSONArray", "end": {"col": 26, "line": 893, "offset": 28388}, "start": {"col": 6, "line": 893, "offset": 28368}}, "$WRITER": {"abstract_content": "w", "end": {"col": 12, "line": 928, "offset": 29153}, "start": {"col": 11, "line": 928, "offset": 29152}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/handler/tikvhandler/tikv_handler.go", "start": {"col": 11, "line": 928, "offset": 29152}}, {"check_id": "trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "end": {"col": 33, "line": 1462, "offset": 44286}, "extra": {"engine_kind": "OSS", "fingerprint": "6d7362d5eb33385558441d878a78272a381e128eb567a577b924ce35b6ae5fb9cf4b28a7ff7ad565677df629c775e8a7613c72158709ab26ea6e0a92d78e1381_0", "is_ignored": false, "lines": "\tregionIDInt, err := strconv.ParseInt(params[handler.RegionID], 0, 64)\n\tif err != nil {\n\t\thandler.WriteError(w, err)\n\t\treturn\n\t}\n\tregionID := uint64(regionIDInt)", "message": "Downcasting or changing sign of an integer with `$CAST_METHOD` method", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-681: Incorrect Conversion between Numeric Types", "description": "Integer underflows", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://github.com/golang/go/issues/30209"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 11759, "rule_id": "4bU2AZ", "rv_id": 833273, "url": "https://semgrep.dev/playground/r/rxTDzNy/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "version_id": "rxTDzNy"}}, "shortlink": "https://sg.run/65WB", "source": "https://semgrep.dev/r/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$X": {"abstract_content": "regionIDInt", "end": {"col": 13, "line": 1457, "offset": 44137}, "start": {"col": 2, "line": 1457, "offset": 44126}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/handler/tikvhandler/tikv_handler.go", "start": {"col": 2, "line": 1457, "offset": 44126}}, {"check_id": "trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "end": {"col": 62, "line": 1707, "offset": 51152}, "extra": {"engine_kind": "OSS", "fingerprint": "ca8ea2d26e5ebd1747404491910e92ed550f7f4c3ce8ab430ff28aca5c0266f55a1e34bfd9d55ce0aee5217585daf8a407a9e8b5862207be6b6a3d4009a421ee_0", "is_ignored": false, "lines": "\tstartTS, err := strconv.ParseInt(params[handler.StartTS], 0, 64)\n\tif err != nil {\n\t\treturn nil, errors.Trace(err)\n\t}\n\ttableID, err := h.GetTableID(params[handler.DBName], params[handler.TableName])\n\tif err != nil {\n\t\treturn nil, errors.Trace(err)\n\t}\n\tstartKey := tablecodec.EncodeTablePrefix(tableID)\n\tendKey := tablecodec.EncodeRowKeyWithHandle(tableID, kv.IntHandle(math.MaxInt64))\n\treturn h.GetMvccByStartTs(uint64(startTS), startKey, endKey)", "message": "Downcasting or changing sign of an integer with `$CAST_METHOD` method", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-681: Incorrect Conversion between Numeric Types", "description": "Integer underflows", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://github.com/golang/go/issues/30209"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 11759, "rule_id": "4bU2AZ", "rv_id": 833273, "url": "https://semgrep.dev/playground/r/rxTDzNy/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "version_id": "rxTDzNy"}}, "shortlink": "https://sg.run/65WB", "source": "https://semgrep.dev/r/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$X": {"abstract_content": "startTS", "end": {"col": 9, "line": 1697, "offset": 50714}, "start": {"col": 2, "line": 1697, "offset": 50707}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/handler/tikvhandler/tikv_handler.go", "start": {"col": 2, "line": 1697, "offset": 50707}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 30, "line": 1883, "offset": 57160}, "extra": {"engine_kind": "OSS", "fingerprint": "110e14cf726915712f96c7f58064259b223fbd110731bbebe9053d3d9825b5542641c01a617cc211bf8004da5b4262d839210390d7bfbaef2ff6704f2412ab05_0", "is_ignored": false, "lines": "\t_, err = w.Write(pb.Build())", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "ServeHTTP", "end": {"col": 34, "line": 1845, "offset": 56214}, "start": {"col": 25, "line": 1845, "offset": 56205}}, "$WRITER": {"abstract_content": "w", "end": {"col": 12, "line": 1883, "offset": 57142}, "start": {"col": 11, "line": 1883, "offset": 57141}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/handler/tikvhandler/tikv_handler.go", "start": {"col": 11, "line": 1883, "offset": 57141}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 39, "line": 79, "offset": 2002}, "extra": {"engine_kind": "OSS", "fingerprint": "a0dc740c6cafea989ba1b1aa317ff9ddda576d8d3c549ec5cae221db09e828361df0a4e14979e00727fdf298a394e56677c495214b9fb3da200fe07160bb276a_0", "is_ignored": false, "lines": "\t_, err = w.Write([]byte(err.Error()))", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "WriteError", "end": {"col": 16, "line": 77, "offset": 1889}, "start": {"col": 6, "line": 77, "offset": 1879}}, "$WRITER": {"abstract_content": "w", "end": {"col": 12, "line": 79, "offset": 1975}, "start": {"col": 11, "line": 79, "offset": 1974}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/handler/util.go", "start": {"col": 11, "line": 79, "offset": 1974}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 22, "line": 93, "offset": 2343}, "extra": {"engine_kind": "OSS", "fingerprint": "99e80d4f9566192a48142c5c299cecd62b3366c62720082fd9aa43f8db34127634b284fafbf88a6adae0de55f1bfe1734060cb1b8dd90f1f6c6c191cb7c2aa12_0", "is_ignored": false, "lines": "\t_, err = w.Write(js)", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "WriteData", "end": {"col": 15, "line": 84, "offset": 2089}, "start": {"col": 6, "line": 84, "offset": 2080}}, "$WRITER": {"abstract_content": "w", "end": {"col": 12, "line": 93, "offset": 2333}, "start": {"col": 11, "line": 93, "offset": 2332}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/handler/util.go", "start": {"col": 11, "line": 93, "offset": 2332}}, {"check_id": "go.lang.security.audit.xss.no-fprintf-to-responsewriter.no-fprintf-to-responsewriter", "end": {"col": 32, "line": 85, "offset": 2551}, "extra": {"engine_kind": "OSS", "fingerprint": "de865f60892a19190a68bc73f03046b63593e8340a757e2a1218ca77dd87dc1db91c1f2411ffa9c1139f399cd188cca83afea289c828badcc10e854cb608b9aa_0", "is_ignored": false, "lines": "\t_, err := fmt.Fprintln(w, txt)", "message": "Detected 'Fprintf' or similar writing to 'http.ResponseWriter'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package to render data to users.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9138, "rule_id": "ReUgyJ", "rv_id": 833870, "url": "https://semgrep.dev/playground/r/o5TBEAp/go.lang.security.audit.xss.no-fprintf-to-responsewriter.no-fprintf-to-responsewriter", "version_id": "o5TBEAp"}}, "shortlink": "https://sg.run/7oqR", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-fprintf-to-responsewriter.no-fprintf-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "serveError", "end": {"col": 16, "line": 80, "offset": 2312}, "start": {"col": 6, "line": 80, "offset": 2302}}, "$PRINTF": {"abstract_content": "Fprintln", "end": {"col": 24, "line": 85, "offset": 2543}, "start": {"col": 16, "line": 85, "offset": 2535}}, "$WRITER": {"abstract_content": "w", "end": {"col": 26, "line": 85, "offset": 2545}, "start": {"col": 25, "line": 85, "offset": 2544}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/http_status.go", "start": {"col": 12, "line": 85, "offset": 2531}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 56, "line": 184, "offset": 5526}, "extra": {"engine_kind": "OSS", "fingerprint": "b9aabbec69d1684aa88a776b052890d04e54a21984a3a9c2043886131e2b3a364cd2e7a9b997c8138e4b5f97183e461c597ccf7ef26ab94d16e4c3222f47cc1a_0", "is_ignored": false, "lines": "\t\t\t_, err := w.Write([]byte(strconv.Itoa(b.GetSize())))", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$WRITER": {"abstract_content": "w", "end": {"col": 15, "line": 184, "offset": 5485}, "start": {"col": 14, "line": 184, "offset": 5484}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/http_status.go", "start": {"col": 14, "line": 184, "offset": 5484}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 41, "line": 199, "offset": 5881}, "extra": {"engine_kind": "OSS", "fingerprint": "b9aabbec69d1684aa88a776b052890d04e54a21984a3a9c2043886131e2b3a364cd2e7a9b997c8138e4b5f97183e461c597ccf7ef26ab94d16e4c3222f47cc1a_1", "is_ignored": false, "lines": "\t\t\t\tif _, err := w.Write([]byte(errStr)); err != nil {", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$WRITER": {"abstract_content": "w", "end": {"col": 19, "line": 199, "offset": 5859}, "start": {"col": 18, "line": 199, "offset": 5858}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/http_status.go", "start": {"col": 18, "line": 199, "offset": 5858}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 59, "line": 316, "offset": 11979}, "extra": {"engine_kind": "OSS", "fingerprint": "b9aabbec69d1684aa88a776b052890d04e54a21984a3a9c2043886131e2b3a364cd2e7a9b997c8138e4b5f97183e461c597ccf7ef26ab94d16e4c3222f47cc1a_2", "is_ignored": false, "lines": "\t\t\t_, err := w.Write([]byte(strconv.Itoa(util.GetGOGC())))", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$WRITER": {"abstract_content": "w", "end": {"col": 15, "line": 316, "offset": 11935}, "start": {"col": 14, "line": 316, "offset": 11934}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/http_status.go", "start": {"col": 14, "line": 316, "offset": 11934}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 46, "line": 328, "offset": 12261}, "extra": {"engine_kind": "OSS", "fingerprint": "b9aabbec69d1684aa88a776b052890d04e54a21984a3a9c2043886131e2b3a364cd2e7a9b997c8138e4b5f97183e461c597ccf7ef26ab94d16e4c3222f47cc1a_3", "is_ignored": false, "lines": "\t\t\t\tif _, err := w.Write([]byte(err.Error())); err != nil {", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$WRITER": {"abstract_content": "w", "end": {"col": 19, "line": 328, "offset": 12234}, "start": {"col": 18, "line": 328, "offset": 12233}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/http_status.go", "start": {"col": 18, "line": 328, "offset": 12233}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 56, "line": 463, "offset": 16631}, "extra": {"engine_kind": "OSS", "fingerprint": "a8857b40e2bb366fae06ff7e6c29f645f7b4bcad4c584d4686914cf81d1b7e03ccec25918a54df57c9e5c705bc7d7289d4747e7ab35d473df2c9dea16fdd5c36_0", "is_ignored": false, "lines": "\t\t_, err = responseWriter.Write(httpRouterPage.Bytes())", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$WRITER": {"abstract_content": "responseWriter", "end": {"col": 26, "line": 463, "offset": 16601}, "start": {"col": 12, "line": 463, "offset": 16587}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/http_status.go", "start": {"col": 12, "line": 463, "offset": 16587}}, {"check_id": "go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "end": {"col": 22, "line": 595, "offset": 20958}, "extra": {"engine_kind": "OSS", "fingerprint": "74c7fe72da9898a5367d49d99fd64eb43662d2739f1d33ea2b99362cf03d74548f16853718cb52ce214a9307bd7880c83989f991041d4208d757fbe4b0b4568e_0", "is_ignored": false, "lines": "\t_, err = w.Write(js)", "message": "Detected directly writing or similar in 'http.ResponseWriter.write()'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package and render data using 'template.Execute()'.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9137, "rule_id": "GdU71y", "rv_id": 833869, "url": "https://semgrep.dev/playground/r/6xTDgBO/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "version_id": "6xTDgBO"}}, "shortlink": "https://sg.run/EkbA", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "handleStatus", "end": {"col": 30, "line": 571, "offset": 20084}, "start": {"col": 18, "line": 571, "offset": 20072}}, "$WRITER": {"abstract_content": "w", "end": {"col": 12, "line": 595, "offset": 20948}, "start": {"col": 11, "line": 595, "offset": 20947}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/http_status.go", "start": {"col": 11, "line": 595, "offset": 20947}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 72, "line": 164, "offset": 4968}, "extra": {"engine_kind": "OSS", "fingerprint": "7bb9a94bce97d9a5b49bfd4f45427a4f9ecf6c2c403b1d4e1c894b7671ed7d0629f87893d2af07853d93fdd862ad89467c13a6d3a19243c818731b394909e435_0", "is_ignored": false, "lines": "\t_, err = db.Exec(fmt.Sprintf(\"DROP DATABASE IF EXISTS `%s`;\", dbName))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$OBJ": {"abstract_content": "db", "end": {"col": 13, "line": 164, "offset": 4909}, "start": {"col": 11, "line": 164, "offset": 4907}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 30, "line": 164, "offset": 4926}, "start": {"col": 23, "line": 164, "offset": 4919}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 11, "line": 164, "offset": 4907}}, {"check_id": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "end": {"col": 72, "line": 164, "offset": 4968}, "extra": {"engine_kind": "OSS", "fingerprint": "803af8b128031f2716fb2c2c0a366ba1d76a3e0a68bfcde478571ea4aa3801f0d91397a3226fb49b78b6ad3595f4467dbd14af035b2716d4c549d1e53dccefb7_0", "is_ignored": false, "lines": "\t_, err = db.Exec(fmt.Sprintf(\"DROP DATABASE IF EXISTS `%s`;\", dbName))", "message": "Detected string concatenation with a non-literal variable in a \"database/sql\" Go SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use prepared statements with the 'Prepare' and 'PrepareContext' calls.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10258, "rule_id": "YGUrnQ", "rv_id": 833862, "url": "https://semgrep.dev/playground/r/DkTG0E7/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "version_id": "DkTG0E7"}}, "shortlink": "https://sg.run/YgOX", "source": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Exec", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$DB": {"abstract_content": "db", "end": {"col": 13, "line": 164, "offset": 4909}, "start": {"col": 11, "line": 164, "offset": 4907}}, "$METHOD": {"abstract_content": "Exec", "end": {"col": 18, "line": 164, "offset": 4914}, "start": {"col": 14, "line": 164, "offset": 4910}}, "$PARAM1": {"abstract_content": "dbName", "end": {"col": 70, "line": 164, "offset": 4966}, "start": {"col": 64, "line": 164, "offset": 4960}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 11, "line": 164, "offset": 4907}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 64, "line": 170, "offset": 5141}, "extra": {"engine_kind": "OSS", "fingerprint": "7bb9a94bce97d9a5b49bfd4f45427a4f9ecf6c2c403b1d4e1c894b7671ed7d0629f87893d2af07853d93fdd862ad89467c13a6d3a19243c818731b394909e435_1", "is_ignored": false, "lines": "\t_, err = db.Exec(fmt.Sprintf(\"CREATE DATABASE `%s`;\", dbName))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$OBJ": {"abstract_content": "db", "end": {"col": 13, "line": 170, "offset": 5090}, "start": {"col": 11, "line": 170, "offset": 5088}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 30, "line": 170, "offset": 5107}, "start": {"col": 23, "line": 170, "offset": 5100}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 11, "line": 170, "offset": 5088}}, {"check_id": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "end": {"col": 64, "line": 170, "offset": 5141}, "extra": {"engine_kind": "OSS", "fingerprint": "803af8b128031f2716fb2c2c0a366ba1d76a3e0a68bfcde478571ea4aa3801f0d91397a3226fb49b78b6ad3595f4467dbd14af035b2716d4c549d1e53dccefb7_1", "is_ignored": false, "lines": "\t_, err = db.Exec(fmt.Sprintf(\"CREATE DATABASE `%s`;\", dbName))", "message": "Detected string concatenation with a non-literal variable in a \"database/sql\" Go SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use prepared statements with the 'Prepare' and 'PrepareContext' calls.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10258, "rule_id": "YGUrnQ", "rv_id": 833862, "url": "https://semgrep.dev/playground/r/DkTG0E7/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "version_id": "DkTG0E7"}}, "shortlink": "https://sg.run/YgOX", "source": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Exec", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$DB": {"abstract_content": "db", "end": {"col": 13, "line": 170, "offset": 5090}, "start": {"col": 11, "line": 170, "offset": 5088}}, "$METHOD": {"abstract_content": "Exec", "end": {"col": 18, "line": 170, "offset": 5095}, "start": {"col": 14, "line": 170, "offset": 5091}}, "$PARAM1": {"abstract_content": "dbName", "end": {"col": 62, "line": 170, "offset": 5139}, "start": {"col": 56, "line": 170, "offset": 5133}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 11, "line": 170, "offset": 5088}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 73, "line": 174, "offset": 5302}, "extra": {"engine_kind": "OSS", "fingerprint": "7bb9a94bce97d9a5b49bfd4f45427a4f9ecf6c2c403b1d4e1c894b7671ed7d0629f87893d2af07853d93fdd862ad89467c13a6d3a19243c818731b394909e435_2", "is_ignored": false, "lines": "\t\t_, err = db.Exec(fmt.Sprintf(\"DROP DATABASE IF EXISTS `%s`;\", dbName))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$OBJ": {"abstract_content": "db", "end": {"col": 14, "line": 174, "offset": 5243}, "start": {"col": 12, "line": 174, "offset": 5241}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 31, "line": 174, "offset": 5260}, "start": {"col": 24, "line": 174, "offset": 5253}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 12, "line": 174, "offset": 5241}}, {"check_id": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "end": {"col": 73, "line": 174, "offset": 5302}, "extra": {"engine_kind": "OSS", "fingerprint": "803af8b128031f2716fb2c2c0a366ba1d76a3e0a68bfcde478571ea4aa3801f0d91397a3226fb49b78b6ad3595f4467dbd14af035b2716d4c549d1e53dccefb7_2", "is_ignored": false, "lines": "\t\t_, err = db.Exec(fmt.Sprintf(\"DROP DATABASE IF EXISTS `%s`;\", dbName))", "message": "Detected string concatenation with a non-literal variable in a \"database/sql\" Go SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use prepared statements with the 'Prepare' and 'PrepareContext' calls.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10258, "rule_id": "YGUrnQ", "rv_id": 833862, "url": "https://semgrep.dev/playground/r/DkTG0E7/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "version_id": "DkTG0E7"}}, "shortlink": "https://sg.run/YgOX", "source": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Exec", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$DB": {"abstract_content": "db", "end": {"col": 14, "line": 174, "offset": 5243}, "start": {"col": 12, "line": 174, "offset": 5241}}, "$METHOD": {"abstract_content": "Exec", "end": {"col": 19, "line": 174, "offset": 5248}, "start": {"col": 15, "line": 174, "offset": 5244}}, "$PARAM1": {"abstract_content": "dbName", "end": {"col": 71, "line": 174, "offset": 5300}, "start": {"col": 65, "line": 174, "offset": 5294}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 12, "line": 174, "offset": 5241}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 52, "line": 178, "offset": 5430}, "extra": {"engine_kind": "OSS", "fingerprint": "7bb9a94bce97d9a5b49bfd4f45427a4f9ecf6c2c403b1d4e1c894b7671ed7d0629f87893d2af07853d93fdd862ad89467c13a6d3a19243c818731b394909e435_3", "is_ignored": false, "lines": "\t_, err = db.Exec(fmt.Sprintf(\"USE `%s`;\", dbName))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$OBJ": {"abstract_content": "db", "end": {"col": 13, "line": 178, "offset": 5391}, "start": {"col": 11, "line": 178, "offset": 5389}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 30, "line": 178, "offset": 5408}, "start": {"col": 23, "line": 178, "offset": 5401}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 11, "line": 178, "offset": 5389}}, {"check_id": "go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "end": {"col": 52, "line": 178, "offset": 5430}, "extra": {"engine_kind": "OSS", "fingerprint": "803af8b128031f2716fb2c2c0a366ba1d76a3e0a68bfcde478571ea4aa3801f0d91397a3226fb49b78b6ad3595f4467dbd14af035b2716d4c549d1e53dccefb7_3", "is_ignored": false, "lines": "\t_, err = db.Exec(fmt.Sprintf(\"USE `%s`;\", dbName))", "message": "Detected string concatenation with a non-literal variable in a \"database/sql\" Go SQL statement. This could lead to SQL injection if the variable is user-controlled and not properly sanitized. In order to prevent SQL injection, use parameterized queries or prepared statements instead. You can use prepared statements with the 'Prepare' and 'PrepareContext' calls.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://golang.org/pkg/database/sql/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10258, "rule_id": "YGUrnQ", "rv_id": 833862, "url": "https://semgrep.dev/playground/r/DkTG0E7/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "version_id": "DkTG0E7"}}, "shortlink": "https://sg.run/YgOX", "source": "https://semgrep.dev/r/go.lang.security.audit.sqli.gosql-sqli.gosql-sqli", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "Exec", "end": {"col": 5, "line": 1, "offset": 4}, "start": {"col": 1, "line": 1, "offset": 0}}, "$DB": {"abstract_content": "db", "end": {"col": 13, "line": 178, "offset": 5391}, "start": {"col": 11, "line": 178, "offset": 5389}}, "$METHOD": {"abstract_content": "Exec", "end": {"col": 18, "line": 178, "offset": 5396}, "start": {"col": 14, "line": 178, "offset": 5392}}, "$PARAM1": {"abstract_content": "dbName", "end": {"col": 50, "line": 178, "offset": 5428}, "start": {"col": 44, "line": 178, "offset": 5422}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 11, "line": 178, "offset": 5389}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 104, "line": 665, "offset": 22481}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_0", "is_ignored": false, "lines": "\t\t_, err := dbt.GetDB().Exec(fmt.Sprintf(\"load data local infile %q into table t with thread=1\", path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 24, "line": 665, "offset": 22401}, "start": {"col": 13, "line": 665, "offset": 22390}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 41, "line": 665, "offset": 22418}, "start": {"col": 34, "line": 665, "offset": 22411}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 13, "line": 665, "offset": 22390}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 114, "line": 719, "offset": 25074}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_1", "is_ignored": false, "lines": "\t\t_, err := dbt.GetDB().Exec(fmt.Sprintf(\"load data local infile %q into table t (id,name) with thread=1\", path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 24, "line": 719, "offset": 24984}, "start": {"col": 13, "line": 719, "offset": 24973}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 41, "line": 719, "offset": 25001}, "start": {"col": 34, "line": 719, "offset": 24994}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 13, "line": 719, "offset": 24973}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 104, "line": 772, "offset": 27504}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_2", "is_ignored": false, "lines": "\t\t_, err := dbt.GetDB().Exec(fmt.Sprintf(\"load data local infile %q into table t with thread=1\", path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 24, "line": 772, "offset": 27424}, "start": {"col": 13, "line": 772, "offset": 27413}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 41, "line": 772, "offset": 27441}, "start": {"col": 34, "line": 772, "offset": 27434}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 13, "line": 772, "offset": 27413}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 104, "line": 814, "offset": 29588}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_3", "is_ignored": false, "lines": "\t\t_, err := dbt.GetDB().Exec(fmt.Sprintf(\"load data local infile %q into table t with thread=1\", path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 24, "line": 814, "offset": 29508}, "start": {"col": 13, "line": 814, "offset": 29497}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 41, "line": 814, "offset": 29525}, "start": {"col": 34, "line": 814, "offset": 29518}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 13, "line": 814, "offset": 29497}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 103, "line": 824, "offset": 30127}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_4", "is_ignored": false, "lines": "\t\t_, err = dbt.GetDB().Exec(fmt.Sprintf(\"load data local infile %q into table t with thread=1\", path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 23, "line": 824, "offset": 30047}, "start": {"col": 12, "line": 824, "offset": 30036}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 40, "line": 824, "offset": 30064}, "start": {"col": 33, "line": 824, "offset": 30057}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 12, "line": 824, "offset": 30036}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 103, "line": 830, "offset": 30472}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_5", "is_ignored": false, "lines": "\t\t_, err = dbt.GetDB().Exec(fmt.Sprintf(\"load data local infile %q into table t with thread=1\", path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 23, "line": 830, "offset": 30392}, "start": {"col": 12, "line": 830, "offset": 30381}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 40, "line": 830, "offset": 30409}, "start": {"col": 33, "line": 830, "offset": 30402}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 12, "line": 830, "offset": 30381}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 174, "line": 1016, "offset": 37873}, "extra": {"engine_kind": "OSS", "fingerprint": "55101aabca44dfd751f05beb335c0bcf70e9855dd9b2adc061fa54d47475ce099214c976cca56e2d211f2cd72cf85fd08aacae9e525d788f5b98f4376c08c51b_0", "is_ignored": false, "lines": "\t\t_, err = db.GetDB().Exec(fmt.Sprintf(\"LOAD DATA LOCAL INFILE '%s' INTO TABLE t66 FIELDS TERMINATED BY ',' ENCLOSED BY '\\\\\\\"' IGNORE 1 LINES (c1, c2) with thread=1\", path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 9, "line": 1, "offset": 8}, "start": {"col": 7, "line": 1, "offset": 6}}, "$OBJ": {"abstract_content": "db.GetDB()", "end": {"col": 22, "line": 1016, "offset": 37721}, "start": {"col": 12, "line": 1016, "offset": 37711}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 39, "line": 1016, "offset": 37738}, "start": {"col": 32, "line": 1016, "offset": 37731}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 12, "line": 1016, "offset": 37711}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 84, "line": 1198, "offset": 43691}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_6", "is_ignored": false, "lines": "\t\t\t_, err = dbt.GetDB().Exec(fmt.Sprintf(\"load data infile %q into table t\", path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 24, "line": 1198, "offset": 43631}, "start": {"col": 13, "line": 1198, "offset": 43620}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 41, "line": 1198, "offset": 43648}, "start": {"col": 34, "line": 1198, "offset": 43641}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 13, "line": 1198, "offset": 43620}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 104, "line": 1261, "offset": 46206}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_7", "is_ignored": false, "lines": "\t\t_, err = dbt.GetDB().Exec(fmt.Sprintf(\"load data local infile %q into table v1 with thread=1\", path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 23, "line": 1261, "offset": 46125}, "start": {"col": 12, "line": 1261, "offset": 46114}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 40, "line": 1261, "offset": 46142}, "start": {"col": 33, "line": 1261, "offset": 46135}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 12, "line": 1261, "offset": 46114}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 104, "line": 1264, "offset": 46438}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_8", "is_ignored": false, "lines": "\t\t_, err = dbt.GetDB().Exec(fmt.Sprintf(\"load data local infile %q into table s1 with thread=1\", path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 23, "line": 1264, "offset": 46357}, "start": {"col": 12, "line": 1264, "offset": 46346}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 40, "line": 1264, "offset": 46374}, "start": {"col": 33, "line": 1264, "offset": 46367}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 12, "line": 1264, "offset": 46346}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 125, "line": 1268, "offset": 46692}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_9", "is_ignored": false, "lines": "\t\trs, err1 := dbt.GetDB().Exec(fmt.Sprintf(\"load data local infile %q into table test with batch_size = 3, thread=1\", path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 26, "line": 1268, "offset": 46593}, "start": {"col": 15, "line": 1268, "offset": 46582}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 43, "line": 1268, "offset": 46610}, "start": {"col": 36, "line": 1268, "offset": 46603}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 15, "line": 1268, "offset": 46582}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 195, "line": 1318, "offset": 48405}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_10", "is_ignored": false, "lines": "\t\trs, err = dbt.GetDB().Exec(fmt.Sprintf(\"load data local infile %q into table test fields terminated by '\\t- ' lines starting by 'xxx ' terminated by '\\n' with batch_size = 3, thread=1\", path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 24, "line": 1318, "offset": 48234}, "start": {"col": 13, "line": 1318, "offset": 48223}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 41, "line": 1318, "offset": 48251}, "start": {"col": 34, "line": 1318, "offset": 48244}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 13, "line": 1318, "offset": 48223}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 195, "line": 1361, "offset": 50055}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_11", "is_ignored": false, "lines": "\t\trs, err = dbt.GetDB().Exec(fmt.Sprintf(\"load data local infile %q into table test fields terminated by '\\t- ' lines starting by 'xxx ' terminated by '\\n' with batch_size = 3, thread=1\", path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 24, "line": 1361, "offset": 49884}, "start": {"col": 13, "line": 1361, "offset": 49873}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 41, "line": 1361, "offset": 49901}, "start": {"col": 34, "line": 1361, "offset": 49894}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 13, "line": 1361, "offset": 49873}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 129, "line": 1365, "offset": 50326}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_12", "is_ignored": false, "lines": "\t\t_, err = dbt.GetDB().Exec(fmt.Sprintf(\"load data local infile %q into table test lines terminated by '' with thread=1\", path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 23, "line": 1365, "offset": 50220}, "start": {"col": 12, "line": 1365, "offset": 50209}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 40, "line": 1365, "offset": 50237}, "start": {"col": 33, "line": 1365, "offset": 50230}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 12, "line": 1365, "offset": 50209}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 165, "line": 1394, "offset": 51257}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_13", "is_ignored": false, "lines": "\t\t_, err1 := dbt.GetDB().Exec(fmt.Sprintf(`load data local infile %q into table test FIELDS TERMINATED BY ',' enclosed by '\"' with batch_size = 3, thread=1`, path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 25, "line": 1394, "offset": 51117}, "start": {"col": 14, "line": 1394, "offset": 51106}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 42, "line": 1394, "offset": 51134}, "start": {"col": 35, "line": 1394, "offset": 51127}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 14, "line": 1394, "offset": 51106}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 149, "line": 1442, "offset": 52721}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_14", "is_ignored": false, "lines": "\t\t_, err1 := dbt.GetDB().Exec(fmt.Sprintf(`load data local infile %q into table test FIELDS TERMINATED BY ',' with batch_size = 3, thread=1`, path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 25, "line": 1442, "offset": 52597}, "start": {"col": 14, "line": 1442, "offset": 52586}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 42, "line": 1442, "offset": 52614}, "start": {"col": 35, "line": 1442, "offset": 52607}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 14, "line": 1442, "offset": 52586}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 165, "line": 1498, "offset": 54567}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_15", "is_ignored": false, "lines": "\t\t_, err1 := dbt.GetDB().Exec(fmt.Sprintf(`load data local infile %q into table test FIELDS TERMINATED BY ',' enclosed by '\"' with batch_size = 3, thread=1`, path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 25, "line": 1498, "offset": 54427}, "start": {"col": 14, "line": 1498, "offset": 54416}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 42, "line": 1498, "offset": 54444}, "start": {"col": 35, "line": 1498, "offset": 54437}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 14, "line": 1498, "offset": 54416}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 192, "line": 1544, "offset": 56049}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_16", "is_ignored": false, "lines": "\t\t_, err1 := dbt.GetDB().Exec(fmt.Sprintf(`load data local infile %q into table test FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '\\\"' IGNORE 1 LINES with batch_size = 3, thread=1`, path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 25, "line": 1544, "offset": 55882}, "start": {"col": 14, "line": 1544, "offset": 55871}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 42, "line": 1544, "offset": 55899}, "start": {"col": 35, "line": 1544, "offset": 55892}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 14, "line": 1544, "offset": 55871}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 106, "line": 1569, "offset": 56962}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_17", "is_ignored": false, "lines": "\t\t_, err = dbt.GetDB().Exec(fmt.Sprintf(\"load data local infile %q into table test with thread=1\", path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 23, "line": 1569, "offset": 56879}, "start": {"col": 12, "line": 1569, "offset": 56868}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 40, "line": 1569, "offset": 56896}, "start": {"col": 33, "line": 1569, "offset": 56889}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 12, "line": 1569, "offset": 56868}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 148, "line": 1596, "offset": 57783}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_18", "is_ignored": false, "lines": "\t\t_, err1 := dbt.GetDB().Exec(fmt.Sprintf(`load data local infile %q into table pn FIELDS TERMINATED BY ','  with batch_size = 1, thread=1`, path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 25, "line": 1596, "offset": 57660}, "start": {"col": 14, "line": 1596, "offset": 57649}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 42, "line": 1596, "offset": 57677}, "start": {"col": 35, "line": 1596, "offset": 57670}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 14, "line": 1596, "offset": 57649}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 130, "line": 1617, "offset": 58545}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_19", "is_ignored": false, "lines": "\t\t_, err1 = dbt.GetDB().Exec(fmt.Sprintf(`load data local infile %q into table pn FIELDS TERMINATED BY ',' with thread=1`, path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 24, "line": 1617, "offset": 58439}, "start": {"col": 13, "line": 1617, "offset": 58428}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 41, "line": 1617, "offset": 58456}, "start": {"col": 34, "line": 1617, "offset": 58449}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 13, "line": 1617, "offset": 58428}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 156, "line": 1647, "offset": 59525}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_20", "is_ignored": false, "lines": "\t\t_, err1 := dbt.GetDB().Exec(fmt.Sprintf(`load data local infile %q into table pn FIELDS TERMINATED BY ',' (c1, c2) with batch_size = 1, thread=1`, path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 25, "line": 1647, "offset": 59394}, "start": {"col": 14, "line": 1647, "offset": 59383}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 42, "line": 1647, "offset": 59411}, "start": {"col": 35, "line": 1647, "offset": 59404}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 14, "line": 1647, "offset": 59383}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 160, "line": 1690, "offset": 60785}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_21", "is_ignored": false, "lines": "\t\t_, err1 := dbt.GetDB().Exec(fmt.Sprintf(`load data local infile %q into table pn FIELDS TERMINATED BY ',' (c1, @dummy) with batch_size = 1, thread=1`, path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 25, "line": 1690, "offset": 60650}, "start": {"col": 14, "line": 1690, "offset": 60639}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 42, "line": 1690, "offset": 60667}, "start": {"col": 35, "line": 1690, "offset": 60660}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 14, "line": 1690, "offset": 60639}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 217, "line": 1736, "offset": 62201}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_22", "is_ignored": false, "lines": "\t\t_, err1 := dbt.GetDB().Exec(fmt.Sprintf(`load data local infile %q into table pn FIELDS TERMINATED BY ',' (c1, @val1, @val2) SET c3 = @val2 * 100, c2 = CAST(@val1 AS UNSIGNED) with batch_size = 1, thread=1`, path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 25, "line": 1736, "offset": 62009}, "start": {"col": 14, "line": 1736, "offset": 61998}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 42, "line": 1736, "offset": 62026}, "start": {"col": 35, "line": 1736, "offset": 62019}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 14, "line": 1736, "offset": 61998}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 217, "line": 1768, "offset": 63332}, "extra": {"engine_kind": "OSS", "fingerprint": "7be322925d0c7106f5da84e5ec99a0c91424efc216e233985cb29d3ba6cbc25deb4f2fbb5c7288570dbc7735313c53bafd387c6804fe281bd62a78cc170fa6d3_23", "is_ignored": false, "lines": "\t\t_, err1 := dbt.GetDB().Exec(fmt.Sprintf(`load data local infile %q into table pn FIELDS TERMINATED BY ',' (c1, @VAL1, @VAL2) SET c3 = @VAL2 * 100, c2 = CAST(@VAL1 AS UNSIGNED) with batch_size = 1, thread=1`, path))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "DB", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 8, "line": 1, "offset": 7}}, "$OBJ": {"abstract_content": "dbt.GetDB()", "end": {"col": 25, "line": 1768, "offset": 63140}, "start": {"col": 14, "line": 1768, "offset": 63129}}, "$P": {"abstract_content": "Sprintf", "end": {"col": 42, "line": 1768, "offset": 63157}, "start": {"col": 35, "line": 1768, "offset": 63150}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/internal/testserverclient/server_client.go", "start": {"col": 14, "line": 1768, "offset": 63129}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 21, "offset": 656}, "extra": {"engine_kind": "OSS", "fingerprint": "9a361a85ef679eedbee3ea427328ab06677d7a990d0fc8fb584241be16f100589a65f78deefeb4f470f565e7123745556b52ed7ee7925c9ed4c9fae78c7255b6_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "handleQuery", "end": {"col": 23, "line": 60, "offset": 1849}, "start": {"col": 12, "line": 60, "offset": 1838}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 21, "offset": 656}, "start": {"col": 3, "line": 21, "offset": 647}}, "$RAND": {"abstract_content": "mc", "end": {"col": 11, "line": 60, "offset": 1837}, "start": {"col": 9, "line": 60, "offset": 1835}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/server/mock_conn.go", "start": {"col": 3, "line": 21, "offset": 647}}, {"check_id": "trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "end": {"col": 3, "line": 2178, "offset": 86501}, "extra": {"engine_kind": "OSS", "fingerprint": "842bb222d6b35fb2c3822b27f6aeda946e25fb34abcca68256ebbeb707dbbc71cc60fd64c573305b2f32b15aca8fc6add377992f85509d9dd9217684d9763d61_0", "is_ignored": false, "lines": "\tdefValues := map[string]string{\n\t\tvariable.TiDBIndexLookupConcurrency:     \"4\",\n\t\tvariable.TiDBIndexLookupJoinConcurrency: \"4\",\n\t\tvariable.TiDBHashAggFinalConcurrency:    \"4\",\n\t\tvariable.TiDBHashAggPartialConcurrency:  \"4\",\n\t\tvariable.TiDBWindowConcurrency:          \"4\",\n\t\tvariable.TiDBProjectionConcurrency:      \"4\",\n\t\tvariable.TiDBHashJoinConcurrency:        \"5\",\n\t}\n\tnames := make([]string, 0, len(defValues))\n\tfor n := range defValues {\n\t\tnames = append(names, n)\n\t}", "message": "Iteration over a possibly empty map `defValues`. This is likely a bug or redundant code", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": "CWE-665: Improper Initialization", "description": "Probably redundant iteration over an empty map", "impact": "LOW", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17198, "rule_id": "wdUlww", "rv_id": 833266, "url": "https://semgrep.dev/playground/r/pZTXjeW/trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "version_id": "pZTXjeW"}}, "shortlink": "https://sg.run/08jj", "source": "https://semgrep.dev/r/trailofbits.go.iterate-over-empty-map.iterate-over-empty-map", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$C": {"abstract_content": "defValues", "end": {"col": 11, "line": 2166, "offset": 86038}, "start": {"col": 2, "line": 2166, "offset": 86029}}, "$K": {"abstract_content": "n", "end": {"col": 7, "line": 2176, "offset": 86450}, "start": {"col": 6, "line": 2176, "offset": 86449}}, "$T1": {"abstract_content": "string", "end": {"col": 25, "line": 2166, "offset": 86052}, "start": {"col": 19, "line": 2166, "offset": 86046}}, "$T2": {"abstract_content": "string", "end": {"col": 32, "line": 2166, "offset": 86059}, "start": {"col": 26, "line": 2166, "offset": 86053}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/session/bootstrap.go", "start": {"col": 2, "line": 2166, "offset": 86029}}, {"check_id": "trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "end": {"col": 3, "line": 2793, "offset": 92076}, "extra": {"engine_kind": "OSS", "fingerprint": "17fe9a9f377672e91f000f2d1515ee96687fb70ba5be09910fe6e8efb4e5e506a2bd0a33a12760b86ee070ad8e4bcde80d96965d95f7019582e2f9b76916bb01_0", "is_ignored": false, "lines": "\tinfo, err := pm.ConnectionVerification(user, authUser.Username, authUser.Hostname, authentication, salt, s.sessionVars, authConn)\n\tif err != nil {\n\t\tif info.FailedDueToWrongPassword {\n\t\t\t// when user enables the account locking function for consecutive login failures,\n\t\t\t// the system updates the login failure count and determines whether to lock the account when authentication fails.\n\t\t\tif enableAutoLock {\n\t\t\t\terr := failedLoginTrackingBegin(s)\n\t\t\t\tif err != nil {\n\t\t\t\t\treturn err\n\t\t\t\t}\n\t\t\t\tlockStatusChanged, passwordLocking, trackingErr := authFailedTracking(s, authUser.Username, authUser.Hostname)\n\t\t\t\tif trackingErr != nil {\n\t\t\t\t\tif rollBackErr := failedLoginTrackingRollback(s); rollBackErr != nil {\n\t\t\t\t\t\treturn rollBackErr\n\t\t\t\t\t}\n\t\t\t\t\treturn trackingErr\n\t\t\t\t}\n\t\t\t\tif err := failedLoginTrackingCommit(s); err != nil {\n\t\t\t\t\tif rollBackErr := failedLoginTrackingRollback(s); rollBackErr != nil {\n\t\t\t\t\t\treturn rollBackErr\n\t\t\t\t\t}\n\t\t\t\t\treturn err\n\t\t\t\t}\n\t\t\t\tif lockStatusChanged {\n\t\t\t\t\t// Notification auto lock.\n\t\t\t\t\terr := autolockAction(s, passwordLocking, authUser.Username, authUser.Hostname)\n\t\t\t\t\tif err != nil {\n\t\t\t\t\t\treturn err\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn err\n\t}", "message": "Variable `info` is likely modified and later used on error. In some cases this could result  in panics due to a nil dereference", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-665: Improper Initialization", "description": "Possible unintentional assignment when an error occurs", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "MEDIUM", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17197, "rule_id": "kxU6Xb", "rv_id": 833265, "url": "https://semgrep.dev/playground/r/zyTWJNZ/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "version_id": "zyTWJNZ"}}, "shortlink": "https://sg.run/WWQ2", "source": "https://semgrep.dev/r/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$ERR": {"abstract_content": "err", "end": {"col": 11, "line": 2760, "offset": 90906}, "start": {"col": 8, "line": 2760, "offset": 90903}}, "$X": {"abstract_content": "info", "end": {"col": 6, "line": 2760, "offset": 90901}, "start": {"col": 2, "line": 2760, "offset": 90897}}, "$Y": {"abstract_content": "FailedDueToWrongPassword", "end": {"col": 35, "line": 2762, "offset": 91078}, "start": {"col": 11, "line": 2762, "offset": 91054}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/session/session.go", "start": {"col": 2, "line": 2760, "offset": 90897}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 26, "offset": 722}, "extra": {"engine_kind": "OSS", "fingerprint": "bdb6a339f9b625c9c8016f3292ed0edeb2f3f3b559799dcdee67474bed5bfad7dfc54f8daf68669aa1731ede0ba590306e56dcdee8097ff092f779af81959ea0_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "SwapUint32", "end": {"col": 26, "line": 96, "offset": 3292}, "start": {"col": 16, "line": 96, "offset": 3282}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 26, "offset": 722}, "start": {"col": 3, "line": 26, "offset": 713}}, "$RAND": {"abstract_content": "atomic", "end": {"col": 15, "line": 96, "offset": 3281}, "start": {"col": 9, "line": 96, "offset": 3275}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/sessionctx/variable/session.go", "start": {"col": 3, "line": 26, "offset": 713}}, {"check_id": "trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "end": {"col": 5, "line": 1423, "offset": 78662}, "extra": {"engine_kind": "OSS", "fingerprint": "d9b819ca52efdf1e71587c7e201045a7850f7a2ed6292afaaca76a707622910a98baa83bd80cca9798a18eb78fff41e2118b05629137156ae2120cc8e417f998_0", "is_ignored": false, "lines": "\t\t\tnum, err := strconv.ParseInt(val, 10, 64)\n\t\t\tif err == nil {\n\t\t\t\tAutoAnalyzeConcurrency.Store(int32(num))\n\t\t\t}", "message": "Downcasting or changing sign of an integer with `int32` method", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-681: Incorrect Conversion between Numeric Types", "description": "Integer underflows", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://github.com/golang/go/issues/30209"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 11759, "rule_id": "4bU2AZ", "rv_id": 833273, "url": "https://semgrep.dev/playground/r/rxTDzNy/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "version_id": "rxTDzNy"}}, "shortlink": "https://sg.run/65WB", "source": "https://semgrep.dev/r/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$CAST_METHOD": {"abstract_content": "int32", "end": {"col": 39, "line": 1422, "offset": 78651}, "start": {"col": 34, "line": 1422, "offset": 78646}}, "$X": {"abstract_content": "num", "end": {"col": 7, "line": 1420, "offset": 78555}, "start": {"col": 4, "line": 1420, "offset": 78552}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/sessionctx/variable/sysvar.go", "start": {"col": 4, "line": 1420, "offset": 78552}}, {"check_id": "trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "end": {"col": 40, "line": 2891, "offset": 163458}, "extra": {"engine_kind": "OSS", "fingerprint": "eff38f977163a0ed34852ef50c2aac1b2bc7993aee2e4a90c8e2907318cde7a8240d33a45552249ebc6832286c4bdfdc8e77135f1c2de34eab93fd8f5a6f0257_0", "is_ignored": false, "lines": "\t\t\tval, err := strconv.ParseInt(s, 10, 64)\n\t\t\tif err != nil {\n\t\t\t\treturn err\n\t\t\t}\n\t\t\tTTLScanWorkerCount.Store(int32(val))", "message": "Downcasting or changing sign of an integer with `int32` method", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-681: Incorrect Conversion between Numeric Types", "description": "Integer underflows", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://github.com/golang/go/issues/30209"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 11759, "rule_id": "4bU2AZ", "rv_id": 833273, "url": "https://semgrep.dev/playground/r/rxTDzNy/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "version_id": "rxTDzNy"}}, "shortlink": "https://sg.run/65WB", "source": "https://semgrep.dev/r/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$CAST_METHOD": {"abstract_content": "int32", "end": {"col": 34, "line": 2891, "offset": 163452}, "start": {"col": 29, "line": 2891, "offset": 163447}}, "$X": {"abstract_content": "val", "end": {"col": 7, "line": 2887, "offset": 163343}, "start": {"col": 4, "line": 2887, "offset": 163340}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/sessionctx/variable/sysvar.go", "start": {"col": 4, "line": 2887, "offset": 163340}}, {"check_id": "trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "end": {"col": 42, "line": 2903, "offset": 163973}, "extra": {"engine_kind": "OSS", "fingerprint": "eff38f977163a0ed34852ef50c2aac1b2bc7993aee2e4a90c8e2907318cde7a8240d33a45552249ebc6832286c4bdfdc8e77135f1c2de34eab93fd8f5a6f0257_1", "is_ignored": false, "lines": "\t\t\tval, err := strconv.ParseInt(s, 10, 64)\n\t\t\tif err != nil {\n\t\t\t\treturn err\n\t\t\t}\n\t\t\tTTLDeleteWorkerCount.Store(int32(val))", "message": "Downcasting or changing sign of an integer with `int32` method", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-681: Incorrect Conversion between Numeric Types", "description": "Integer underflows", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://github.com/golang/go/issues/30209"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 11759, "rule_id": "4bU2AZ", "rv_id": 833273, "url": "https://semgrep.dev/playground/r/rxTDzNy/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "version_id": "rxTDzNy"}}, "shortlink": "https://sg.run/65WB", "source": "https://semgrep.dev/r/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$CAST_METHOD": {"abstract_content": "int32", "end": {"col": 36, "line": 2903, "offset": 163967}, "start": {"col": 31, "line": 2903, "offset": 163962}}, "$X": {"abstract_content": "val", "end": {"col": 7, "line": 2899, "offset": 163856}, "start": {"col": 4, "line": 2899, "offset": 163853}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/sessionctx/variable/sysvar.go", "start": {"col": 4, "line": 2899, "offset": 163853}}, {"check_id": "trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "end": {"col": 36, "line": 2972, "offset": 167853}, "extra": {"engine_kind": "OSS", "fingerprint": "eff38f977163a0ed34852ef50c2aac1b2bc7993aee2e4a90c8e2907318cde7a8240d33a45552249ebc6832286c4bdfdc8e77135f1c2de34eab93fd8f5a6f0257_2", "is_ignored": false, "lines": "\t\tval, err := strconv.ParseInt(s, 10, 64)\n\t\tif err != nil {\n\t\t\treturn err\n\t\t}\n\t\tTTLRunningTasks.Store(int32(val))", "message": "Downcasting or changing sign of an integer with `int32` method", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-681: Incorrect Conversion between Numeric Types", "description": "Integer underflows", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://github.com/golang/go/issues/30209"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 11759, "rule_id": "4bU2AZ", "rv_id": 833273, "url": "https://semgrep.dev/playground/r/rxTDzNy/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "version_id": "rxTDzNy"}}, "shortlink": "https://sg.run/65WB", "source": "https://semgrep.dev/r/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$CAST_METHOD": {"abstract_content": "int32", "end": {"col": 30, "line": 2972, "offset": 167847}, "start": {"col": 25, "line": 2972, "offset": 167842}}, "$X": {"abstract_content": "val", "end": {"col": 6, "line": 2968, "offset": 167745}, "start": {"col": 3, "line": 2968, "offset": 167742}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/sessionctx/variable/sysvar.go", "start": {"col": 3, "line": 2968, "offset": 167742}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 20, "offset": 650}, "extra": {"engine_kind": "OSS", "fingerprint": "080566551f9fccd2c0ec17797457aec455154b1a2ef7e778c9f3d0ba46d87d7c765ca65fec11648ad21b67d9befded65432ceae8880e838ae74d651e89c6e2a6_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "NewRefresher", "end": {"col": 29, "line": 70, "offset": 2717}, "start": {"col": 17, "line": 70, "offset": 2705}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 20, "offset": 650}, "start": {"col": 3, "line": 20, "offset": 641}}, "$RAND": {"abstract_content": "refresher", "end": {"col": 16, "line": 70, "offset": 2704}, "start": {"col": 7, "line": 70, "offset": 2695}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/statistics/handle/autoanalyze/autoanalyze.go", "start": {"col": 3, "line": 20, "offset": 641}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 19, "offset": 636}, "extra": {"engine_kind": "OSS", "fingerprint": "c34839969424a9c4389c8ce4a23670c3586de2f27e4cd698ab229adba800c8816de1ab03bb04ca5b49520481be8e3597fe1dc9d5965f8ca3a51c687f8294bb54_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "GOMAXPROCS", "end": {"col": 28, "line": 50, "offset": 1693}, "start": {"col": 18, "line": 50, "offset": 1683}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 19, "offset": 636}, "start": {"col": 3, "line": 19, "offset": 627}}, "$RAND": {"abstract_content": "runtime", "end": {"col": 17, "line": 50, "offset": 1682}, "start": {"col": 10, "line": 50, "offset": 1675}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/statistics/handle/syncload/stats_syncload.go", "start": {"col": 3, "line": 19, "offset": 627}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 20, "offset": 660}, "extra": {"engine_kind": "OSS", "fingerprint": "da4062e9c984d8e165e8010c464322da9fee3923720373fe7fbac19ed5d77137c7af20f708d3989bf41114f1075e832f219165be75dbba96d096889ad4eb7dc2_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "Sizeof", "end": {"col": 57, "line": 75, "offset": 2256}, "start": {"col": 51, "line": 75, "offset": 2250}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 20, "offset": 660}, "start": {"col": 3, "line": 20, "offset": 651}}, "$RAND": {"abstract_content": "unsafe", "end": {"col": 50, "line": 75, "offset": 2249}, "start": {"col": 44, "line": 75, "offset": 2243}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/statistics/row_sampler.go", "start": {"col": 3, "line": 20, "offset": 651}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 23, "offset": 666}, "extra": {"engine_kind": "OSS", "fingerprint": "5d8d700ec46562725e62101095d16f1361e0d6859c80b187ce299dc377a8e0b67907b0a1df1c612769a059a413b15cee007eb08cd3612a04cce1175512e7276d_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "Size", "end": {"col": 38, "line": 107, "offset": 3221}, "start": {"col": 34, "line": 107, "offset": 3217}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 23, "offset": 666}, "start": {"col": 3, "line": 23, "offset": 657}}, "$RAND": {"abstract_content": "rs.pbResp", "end": {"col": 33, "line": 107, "offset": 3216}, "start": {"col": 24, "line": 107, "offset": 3207}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/store/copr/batch_coprocessor.go", "start": {"col": 3, "line": 23, "offset": 657}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 19, "offset": 636}, "extra": {"engine_kind": "OSS", "fingerprint": "6a53c5581d50a78b30969b8995ef5b8c11211b743e9a81c0231addd7d766cf4f9c692be1c10f8601b497df39a43133ddd61b56ce015a90c74066584c23f9d06f_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "GetRegionCache", "end": {"col": 44, "line": 41, "offset": 1236}, "start": {"col": 30, "line": 41, "offset": 1222}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 19, "offset": 636}, "start": {"col": 3, "line": 19, "offset": 627}}, "$RAND": {"abstract_content": "s.store", "end": {"col": 29, "line": 41, "offset": 1221}, "start": {"col": 22, "line": 41, "offset": 1214}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/store/copr/store.go", "start": {"col": 3, "line": 19, "offset": 627}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 21, "offset": 667}, "extra": {"engine_kind": "OSS", "fingerprint": "b7ad6038c727955e03f61015067a508b5d9ae092789b8321be6ca8d6636068679d4714a1cd7cc39d48f16860ba0d82b8952a91be11541091f765ea851243e627_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "Unmarshal", "end": {"col": 24, "line": 57, "offset": 1891}, "start": {"col": 15, "line": 57, "offset": 1882}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 21, "offset": 667}, "start": {"col": 3, "line": 21, "offset": 658}}, "$RAND": {"abstract_content": "proto", "end": {"col": 14, "line": 57, "offset": 1881}, "start": {"col": 9, "line": 57, "offset": 1876}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/store/mockstore/unistore/cophandler/analyze.go", "start": {"col": 3, "line": 21, "offset": 658}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 20, "offset": 655}, "extra": {"engine_kind": "OSS", "fingerprint": "fc9290dff52c15a406b251f8a0a86add2afbb4c1f5db41a7977dc86286936ef3ee68d0e73d6e4761e89813f8d432aaab42960776adbf9868b351a59078f94f6a_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "Sizeof", "end": {"col": 36, "line": 41, "offset": 1177}, "start": {"col": 30, "line": 41, "offset": 1171}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 20, "offset": 655}, "start": {"col": 3, "line": 20, "offset": 646}}, "$RAND": {"abstract_content": "unsafe", "end": {"col": 29, "line": 41, "offset": 1170}, "start": {"col": 23, "line": 41, "offset": 1164}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/store/mockstore/unistore/lockstore/lockstore.go", "start": {"col": 3, "line": 20, "offset": 646}}, {"check_id": "trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "end": {"col": 29, "line": 646, "offset": 22007}, "extra": {"engine_kind": "OSS", "fingerprint": "c5bdb9ae0e68f9370f50f2a0848807c332a7389d09aed3e9e234249212642b762db2287ea533742173d45417a323aeba80b92fffee73d9bde6bfac50326ed081_0", "is_ignored": false, "lines": "\t\t\t\ttmp, err = strconv.ParseUint(defs[i].LessThan[0], 10, 64)\n\t\t\t\tlessThan[i] = int64(tmp)", "message": "Downcasting or changing sign of an integer with `$CAST_METHOD` method", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-681: Incorrect Conversion between Numeric Types", "description": "Integer underflows", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://github.com/golang/go/issues/30209"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 11759, "rule_id": "4bU2AZ", "rv_id": 833273, "url": "https://semgrep.dev/playground/r/rxTDzNy/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "version_id": "rxTDzNy"}}, "shortlink": "https://sg.run/65WB", "source": "https://semgrep.dev/r/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$X": {"abstract_content": "tmp", "end": {"col": 8, "line": 645, "offset": 21924}, "start": {"col": 5, "line": 645, "offset": 21921}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/table/tables/partition.go", "start": {"col": 5, "line": 645, "offset": 21921}}, {"check_id": "go.lang.security.bad_tmp.bad-tmp-file-creation", "end": {"col": 34, "line": 92, "offset": 2641}, "extra": {"engine_kind": "OSS", "fingerprint": "d8549ff299024f34ddd4457e7e6781c70a934b49736e4ce20b040839e32572f4ec1853d22059204710ae512821de57336a9f5db674b825d28059f3c851d2737d_0", "is_ignored": false, "lines": "\tlock, err := os.Create(lockFile)", "message": "File creation in shared tmp directory without using ioutil.Tempfile", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-377: Insecure Temporary File"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2021 - Broken Access Control"], "references": ["https://owasp.org/Top10/A01_2021-Broken_Access_Control"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9104, "rule_id": "6JUjnL", "rv_id": 833877, "url": "https://semgrep.dev/playground/r/9lTJ0pP/go.lang.security.bad_tmp.bad-tmp-file-creation", "version_id": "9lTJ0pP"}}, "shortlink": "https://sg.run/Gejn", "source": "https://semgrep.dev/r/go.lang.security.bad_tmp.bad-tmp-file-creation", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Other"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/testkit/mockstore.go", "start": {"col": 15, "line": 92, "offset": 2622}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 22, "offset": 665}, "extra": {"engine_kind": "OSS", "fingerprint": "6a27bf424ed92b52648de6c6723c0a8692718e32c672c2fe0b55027bade5f4b96c96e9b3a9800e8f68d4c7c0c28d588db56dfefb3a67a316e02710b9845cb3e5_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "True", "end": {"col": 15, "line": 76, "offset": 2354}, "start": {"col": 11, "line": 76, "offset": 2350}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 22, "offset": 665}, "start": {"col": 3, "line": 22, "offset": 656}}, "$RAND": {"abstract_content": "require", "end": {"col": 10, "line": 76, "offset": 2349}, "start": {"col": 3, "line": 76, "offset": 2342}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/testkit/testkit.go", "start": {"col": 3, "line": 22, "offset": 656}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 20, "offset": 648}, "extra": {"engine_kind": "OSS", "fingerprint": "e6d5cdf486ce41686ccf50afc7456d0095673bae9874236deec052871b9ee33462fed384b0fba2f42f19e008a960e40b2e70f9957a6df6df3e483415dff7b67e_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "Compare", "end": {"col": 28, "line": 31, "offset": 1065}, "start": {"col": 21, "line": 31, "offset": 1058}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 20, "offset": 648}, "start": {"col": 3, "line": 20, "offset": 639}}, "$RAND": {"abstract_content": "actual", "end": {"col": 20, "line": 31, "offset": 1057}, "start": {"col": 14, "line": 31, "offset": 1051}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/testkit/testutil/require.go", "start": {"col": 3, "line": 20, "offset": 639}}, {"check_id": "trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "end": {"col": 5, "line": 221, "offset": 6757}, "extra": {"engine_kind": "OSS", "fingerprint": "b6b47c147e6bb84a238a435d57889c2770b65d6dc82ddf3211e3c509547dd87ca8489c0f8e0c4320f6ddb34e49f8f35b89196ed380d4891de83d5a3e5f64e034_0", "is_ignored": false, "lines": "\t\t\ttimer, err = g.cli.GetTimerByID(ctx, timer.ID)\n\t\t\tif err != nil {\n\t\t\t\tlogutil.BgLogger().Error(\"failed to get timer\", zap.Error(err), zap.String(\"timerID\", timer.ID))\n\t\t\t} else {\n\t\t\t\tg.key2Timers[key] = timer\n\t\t\t}", "message": "Variable `timer` is likely modified and later used on error. In some cases this could result  in panics due to a nil dereference", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-665: Improper Initialization", "description": "Possible unintentional assignment when an error occurs", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "MEDIUM", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17197, "rule_id": "kxU6Xb", "rv_id": 833265, "url": "https://semgrep.dev/playground/r/zyTWJNZ/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "version_id": "zyTWJNZ"}}, "shortlink": "https://sg.run/WWQ2", "source": "https://semgrep.dev/r/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$ERR": {"abstract_content": "err", "end": {"col": 14, "line": 216, "offset": 6554}, "start": {"col": 11, "line": 216, "offset": 6551}}, "$X": {"abstract_content": "timer", "end": {"col": 9, "line": 216, "offset": 6549}, "start": {"col": 4, "line": 216, "offset": 6544}}, "$Y": {"abstract_content": "ID", "end": {"col": 99, "line": 218, "offset": 6708}, "start": {"col": 97, "line": 218, "offset": 6706}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/ttl/ttlworker/timer_sync.go", "start": {"col": 4, "line": 216, "offset": 6544}}, {"check_id": "trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "end": {"col": 3, "line": 140, "offset": 3900}, "extra": {"engine_kind": "OSS", "fingerprint": "307d068bc5066355ca05d16d53403f5100993c7d13a4388f8e106a13a365e6810e31ea12dbcea05e8f644c7841133b3a2f685deda184c661e3daf47efefa3b07_0", "is_ignored": false, "lines": "\tt1, err := t.GoTime(gotime.UTC)\n\t// allow invalid dates\n\tif err != nil {\n\t\treturn t1.Weekday()\n\t}", "message": "Variable `t1` is likely modified and later used on error. In some cases this could result  in panics due to a nil dereference", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-665: Improper Initialization", "description": "Possible unintentional assignment when an error occurs", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "MEDIUM", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17197, "rule_id": "kxU6Xb", "rv_id": 833265, "url": "https://semgrep.dev/playground/r/zyTWJNZ/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "version_id": "zyTWJNZ"}}, "shortlink": "https://sg.run/WWQ2", "source": "https://semgrep.dev/r/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$ERR": {"abstract_content": "err", "end": {"col": 9, "line": 136, "offset": 3810}, "start": {"col": 6, "line": 136, "offset": 3807}}, "$X": {"abstract_content": "t1", "end": {"col": 4, "line": 136, "offset": 3805}, "start": {"col": 2, "line": 136, "offset": 3803}}, "$Y": {"abstract_content": "Weekday", "end": {"col": 20, "line": 139, "offset": 3895}, "start": {"col": 13, "line": 139, "offset": 3888}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/types/core_time.go", "start": {"col": 2, "line": 136, "offset": 3803}}, {"check_id": "trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "end": {"col": 4, "line": 1361, "offset": 36702}, "extra": {"engine_kind": "OSS", "fingerprint": "b831d6c965788097aaf869e057adfab53b069a869ef4941a48cd5cd000bb4e627cbd4677756ab9596c262f9b0416840ae687e765e9e4c3f66577428fbec17899_0", "is_ignored": false, "lines": "\t\tt, err = d.GetMysqlTime().Convert(ctx, target.GetType())\n\t\tif err != nil {\n\t\t\t// t might be an invalid Timestamp, but should still be comparable, since same representation (KindMysqlTime)\n\t\t\tret.SetMysqlTime(t)\n\t\t\treturn ret, errors.Trace(ErrWrongValue.GenWithStackByArgs(TimestampStr, t.String()))\n\t\t}", "message": "Variable `t` is likely modified and later used on error. In some cases this could result  in panics due to a nil dereference", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-665: Improper Initialization", "description": "Possible unintentional assignment when an error occurs", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "MEDIUM", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17197, "rule_id": "kxU6Xb", "rv_id": 833265, "url": "https://semgrep.dev/playground/r/zyTWJNZ/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "version_id": "zyTWJNZ"}}, "shortlink": "https://sg.run/WWQ2", "source": "https://semgrep.dev/r/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$ERR": {"abstract_content": "err", "end": {"col": 9, "line": 1356, "offset": 36406}, "start": {"col": 6, "line": 1356, "offset": 36403}}, "$X": {"abstract_content": "t", "end": {"col": 4, "line": 1356, "offset": 36401}, "start": {"col": 3, "line": 1356, "offset": 36400}}, "$Y": {"abstract_content": "String", "end": {"col": 84, "line": 1360, "offset": 36694}, "start": {"col": 78, "line": 1360, "offset": 36688}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/types/datum.go", "start": {"col": 3, "line": 1356, "offset": 36400}}, {"check_id": "trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "end": {"col": 4, "line": 1665, "offset": 45496}, "extra": {"engine_kind": "OSS", "fingerprint": "4c1cdd645b2d87431e644c96754832bdf31f645b9cbb614336648ba4adac4ec07ca8b82d2944431e2f3157fabd880be1ea66223b3919c01dd63442d50f1345e3_0", "is_ignored": false, "lines": "\t\tret, err = d.convertToInt(ctx, NewFieldType(mysql.TypeLonglong))\n\t\tif err != nil {\n\t\t\t_, err = invalidConv(d, target.GetType())\n\t\t\tret.SetInt64(0)\n\t\t\treturn ret, err\n\t\t}", "message": "Variable `ret` is likely modified and later used on error. In some cases this could result  in panics due to a nil dereference", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-665: Improper Initialization", "description": "Possible unintentional assignment when an error occurs", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "MEDIUM", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17197, "rule_id": "kxU6Xb", "rv_id": 833265, "url": "https://semgrep.dev/playground/r/zyTWJNZ/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "version_id": "zyTWJNZ"}}, "shortlink": "https://sg.run/WWQ2", "source": "https://semgrep.dev/r/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$ERR": {"abstract_content": "err", "end": {"col": 11, "line": 1660, "offset": 45335}, "start": {"col": 8, "line": 1660, "offset": 45332}}, "$X": {"abstract_content": "ret", "end": {"col": 6, "line": 1660, "offset": 45330}, "start": {"col": 3, "line": 1660, "offset": 45327}}, "$Y": {"abstract_content": "SetInt64", "end": {"col": 16, "line": 1663, "offset": 45470}, "start": {"col": 8, "line": 1663, "offset": 45462}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/types/datum.go", "start": {"col": 3, "line": 1660, "offset": 45327}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 19, "offset": 632}, "extra": {"engine_kind": "OSS", "fingerprint": "dcbf70892aa0adbca3208a5aee3ba9b61a4d2bd74b917ea1e9797bdf1fda5108b3223c79f5e28bdc25125faba5651640c7f5732846244bea1b3a57bf01a5181b_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "Sizeof", "end": {"col": 36, "line": 33, "offset": 943}, "start": {"col": 30, "line": 33, "offset": 937}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 19, "offset": 632}, "start": {"col": 3, "line": 19, "offset": 623}}, "$RAND": {"abstract_content": "unsafe", "end": {"col": 29, "line": 33, "offset": 936}, "start": {"col": 23, "line": 33, "offset": 930}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/chunk/chunk_in_disk.go", "start": {"col": 3, "line": 19, "offset": 623}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 20, "offset": 646}, "extra": {"engine_kind": "OSS", "fingerprint": "58129871846c84f872014d5318ab211ab7e5602cc638bf4f1168e048c68dd37459b4f4cb0de370cfe1a4eccb69301c861a7033868e53958b1af5ebb2ad6defab_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "AppendInt64", "end": {"col": 15, "line": 32, "offset": 907}, "start": {"col": 4, "line": 32, "offset": 896}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 20, "offset": 646}, "start": {"col": 3, "line": 20, "offset": 637}}, "$RAND": {"abstract_content": "c", "end": {"col": 3, "line": 32, "offset": 895}, "start": {"col": 2, "line": 32, "offset": 894}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/chunk/column.go", "start": {"col": 3, "line": 20, "offset": 637}}, {"check_id": "go.lang.security.audit.xss.import-text-template.import-text-template", "end": {"col": 16, "line": 23, "offset": 676}, "extra": {"engine_kind": "OSS", "fingerprint": "2ef1c2f57d6107737be5ef80f359b0046426d819fc4688562564cb90552d96c78b6ba15b86df3a69d02a8f7bf34a913343e4fda1cc19898002376092e15a27cf_0", "fix": "html/template", "is_ignored": false, "lines": "\t\"text/template\"", "message": "When working with web applications that involve rendering user-generated  content, it's important to properly escape any HTML content to prevent  Cross-Site Scripting (XSS) attacks. In Go, the `text/template` package does  not automatically escape HTML content, which can leave your application  vulnerable to these types of attacks. To mitigate this risk, it's  recommended to use the `html/template` package instead, which provides  built-in functionality for HTML escaping. By using `html/template` to render  your HTML content, you can help to ensure that your web application is more  secure and less susceptible to XSS vulnerabilities.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www.veracode.com/blog/secure-development/use-golang-these-mistakes-could-compromise-your-apps-security"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9136, "rule_id": "5rUOZQ", "rv_id": 833868, "url": "https://semgrep.dev/playground/r/YDTl0LG/go.lang.security.audit.xss.import-text-template.import-text-template", "version_id": "YDTl0LG"}}, "shortlink": "https://sg.run/ndEO", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.import-text-template.import-text-template", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$1": {"abstract_content": "text/template", "end": {"col": 14, "line": 1, "offset": 13}, "start": {"col": 1, "line": 1, "offset": 0}}, "$IMPORT": {"abstract_content": "text/template", "end": {"col": 16, "line": 23, "offset": 676}, "start": {"col": 3, "line": 23, "offset": 663}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/collate/ucadata/generator/main.go", "start": {"col": 3, "line": 23, "offset": 663}}, {"check_id": "go.lang.security.audit.xss.import-text-template.import-text-template", "end": {"col": 16, "line": 20, "offset": 646}, "extra": {"engine_kind": "OSS", "fingerprint": "12c5228b34ed940e8c0baf4712a5a06d08f762d5b15580c1653652195758738a549f174e0c6d9261ade78585b5aa67fcc87a753872ff8bf21bbac6534277a344_0", "fix": "html/template", "is_ignored": false, "lines": "\t\"text/template\"", "message": "When working with web applications that involve rendering user-generated  content, it's important to properly escape any HTML content to prevent  Cross-Site Scripting (XSS) attacks. In Go, the `text/template` package does  not automatically escape HTML content, which can leave your application  vulnerable to these types of attacks. To mitigate this risk, it's  recommended to use the `html/template` package instead, which provides  built-in functionality for HTML escaping. By using `html/template` to render  your HTML content, you can help to ensure that your web application is more  secure and less susceptible to XSS vulnerabilities.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www.veracode.com/blog/secure-development/use-golang-these-mistakes-could-compromise-your-apps-security"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9136, "rule_id": "5rUOZQ", "rv_id": 833868, "url": "https://semgrep.dev/playground/r/YDTl0LG/go.lang.security.audit.xss.import-text-template.import-text-template", "version_id": "YDTl0LG"}}, "shortlink": "https://sg.run/ndEO", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.import-text-template.import-text-template", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$1": {"abstract_content": "text/template", "end": {"col": 14, "line": 1, "offset": 13}, "start": {"col": 1, "line": 1, "offset": 0}}, "$IMPORT": {"abstract_content": "text/template", "end": {"col": 16, "line": 20, "offset": 646}, "start": {"col": 3, "line": 20, "offset": 633}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/collate/ucaimpl/main.go", "start": {"col": 3, "line": 20, "offset": 633}}, {"check_id": "go.lang.security.audit.xss.no-fprintf-to-responsewriter.no-fprintf-to-responsewriter", "end": {"col": 32, "line": 204, "offset": 5575}, "extra": {"engine_kind": "OSS", "fingerprint": "6e6b22cdcec80be0fb153a9f18bd9cc128ae5723304d89ff07d0f36a10f1c917e277e6867ee3c5a2b71e6428d1e1cfef049c93043e120d02078219d184d0d479_0", "is_ignored": false, "lines": "\t_, err := fmt.Fprintln(w, txt)", "message": "Detected 'Fprintf' or similar writing to 'http.ResponseWriter'. This bypasses HTML escaping that prevents cross-site scripting vulnerabilities. Instead, use the 'html/template' package to render data to users.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9138, "rule_id": "ReUgyJ", "rv_id": 833870, "url": "https://semgrep.dev/playground/r/o5TBEAp/go.lang.security.audit.xss.no-fprintf-to-responsewriter.no-fprintf-to-responsewriter", "version_id": "o5TBEAp"}}, "shortlink": "https://sg.run/7oqR", "source": "https://semgrep.dev/r/go.lang.security.audit.xss.no-fprintf-to-responsewriter.no-fprintf-to-responsewriter", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$HANDLER": {"abstract_content": "serveError", "end": {"col": 16, "line": 199, "offset": 5336}, "start": {"col": 6, "line": 199, "offset": 5326}}, "$PRINTF": {"abstract_content": "Fprintln", "end": {"col": 24, "line": 204, "offset": 5567}, "start": {"col": 16, "line": 204, "offset": 5559}}, "$WRITER": {"abstract_content": "w", "end": {"col": 26, "line": 204, "offset": 5569}, "start": {"col": 25, "line": 204, "offset": 5568}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/cpuprofile/pprof_api.go", "start": {"col": 12, "line": 204, "offset": 5555}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 80, "line": 159, "offset": 4674}, "extra": {"engine_kind": "OSS", "fingerprint": "d1de5ea447273fcbb5429930045d47e3b81cfa641390604a80a74fc69c5dd121651aeb3c5287975e8635aa785eec1303f78b58023a039914ccf2db22a6a5f235_0", "is_ignored": false, "lines": "\tquery := fmt.Sprintf(\"SHOW CREATE TABLE %s\", TableName(schemaName, tableName))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CTX": {"abstract_content": "ctx", "end": {"col": 31, "line": 162, "offset": 4743}, "start": {"col": 28, "line": 162, "offset": 4740}}, "$FUNC": {"abstract_content": "GetCreateTableSQL", "end": {"col": 23, "line": 146, "offset": 3857}, "start": {"col": 6, "line": 146, "offset": 3840}}, "$OBJ": {"abstract_content": "db", "end": {"col": 11, "line": 162, "offset": 4723}, "start": {"col": 9, "line": 162, "offset": 4721}}, "$QUERY": {"abstract_content": "query", "end": {"col": 7, "line": 159, "offset": 4601}, "start": {"col": 2, "line": 159, "offset": 4596}}, "$SQLSTR": {"abstract_content": "SHOW CREATE TABLE %s", "end": {"col": 44, "line": 159, "offset": 4638}, "start": {"col": 24, "line": 159, "offset": 4618}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/dbutil/common.go", "start": {"col": 2, "line": 159, "offset": 4596}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 87, "line": 186, "offset": 5458}, "extra": {"engine_kind": "OSS", "fingerprint": "76aae8b3369d300b4bc15dbf1dc8ff97605887bb274812807bcac22c473ebc20ffdf4a43002146b7c486128bf803f2862b4ae8a24591d4a65c0800c9250c69cd_0", "is_ignored": false, "lines": "\tquery := fmt.Sprintf(\"SELECT COUNT(1) cnt FROM %s\", TableName(schemaName, tableName))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CTX": {"abstract_content": "ctx", "end": {"col": 31, "line": 193, "offset": 5661}, "start": {"col": 28, "line": 193, "offset": 5658}}, "$FUNC": {"abstract_content": "GetRowCount", "end": {"col": 17, "line": 175, "offset": 5094}, "start": {"col": 6, "line": 175, "offset": 5083}}, "$OBJ": {"abstract_content": "db", "end": {"col": 11, "line": 193, "offset": 5641}, "start": {"col": 9, "line": 193, "offset": 5639}}, "$QUERY": {"abstract_content": "query", "end": {"col": 7, "line": 186, "offset": 5378}, "start": {"col": 2, "line": 186, "offset": 5373}}, "$SQLSTR": {"abstract_content": "SELECT COUNT(1) cnt FROM %s", "end": {"col": 51, "line": 186, "offset": 5422}, "start": {"col": 24, "line": 186, "offset": 5395}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/dbutil/common.go", "start": {"col": 2, "line": 186, "offset": 5373}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 115, "line": 440, "offset": 13110}, "extra": {"engine_kind": "OSS", "fingerprint": "d2d3cdcf8a13ce5ec0c77a4a6fcaae677a1c02c0d600e1ecb05022bed00f8c08117bb6d5a3f3de7a6058b80165d867e96ad4a121eceef8d3c207f47b6cd05007_0", "is_ignored": false, "lines": "\tquery := fmt.Sprintf(\"SELECT BIT_XOR(CAST(CRC32(CONCAT_WS(',', %s, CONCAT(%s)))AS UNSIGNED)) AS checksum FROM %s WHERE %s;\",\n\t\tstrings.Join(columnNames, \", \"), strings.Join(columnIsNull, \", \"), TableName(schemaName, tableName), limitRange)", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CTX": {"abstract_content": "ctx", "end": {"col": 31, "line": 444, "offset": 13246}, "start": {"col": 28, "line": 444, "offset": 13243}}, "$FUNC": {"abstract_content": "GetCRC32Checksum", "end": {"col": 22, "line": 422, "offset": 12117}, "start": {"col": 6, "line": 422, "offset": 12101}}, "$OBJ": {"abstract_content": "db", "end": {"col": 11, "line": 444, "offset": 13226}, "start": {"col": 9, "line": 444, "offset": 13224}}, "$QUERY": {"abstract_content": "query", "end": {"col": 7, "line": 439, "offset": 12876}, "start": {"col": 2, "line": 439, "offset": 12871}}, "$SQLSTR": {"abstract_content": "SELECT BIT_XOR(CAST(CRC32(CONCAT_WS(',', %s, CONCAT(%s)))AS UNSIGNED)) AS checksum FROM %s WHERE %s;", "end": {"col": 124, "line": 439, "offset": 12993}, "start": {"col": 24, "line": 439, "offset": 12893}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/dbutil/common.go", "start": {"col": 2, "line": 439, "offset": 12871}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 60, "line": 666, "offset": 20694}, "extra": {"engine_kind": "OSS", "fingerprint": "e3d4dac3c4bf85ba06cb0ba60eb8a403a14f9de5106dfc872edeedda5a25ced799cf6f28aeadd773e1d27993ed4c87b85cd4e839df18640617280eebd0d030c1_0", "is_ignored": false, "lines": "\tquery := fmt.Sprintf(\"SHOW VARIABLES LIKE '%s'\", variable)", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CTX": {"abstract_content": "ctx", "end": {"col": 34, "line": 667, "offset": 20728}, "start": {"col": 31, "line": 667, "offset": 20725}}, "$FUNC": {"abstract_content": "GetSessionVariable", "end": {"col": 24, "line": 665, "offset": 20550}, "start": {"col": 6, "line": 665, "offset": 20532}}, "$OBJ": {"abstract_content": "db", "end": {"col": 17, "line": 667, "offset": 20711}, "start": {"col": 15, "line": 667, "offset": 20709}}, "$QUERY": {"abstract_content": "query", "end": {"col": 7, "line": 666, "offset": 20641}, "start": {"col": 2, "line": 666, "offset": 20636}}, "$SQLSTR": {"abstract_content": "SHOW VARIABLES LIKE '%s'", "end": {"col": 48, "line": 666, "offset": 20682}, "start": {"col": 24, "line": 666, "offset": 20658}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/dbutil/common.go", "start": {"col": 2, "line": 666, "offset": 20636}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 126, "line": 846, "offset": 25564}, "extra": {"engine_kind": "OSS", "fingerprint": "e10ce68ba55e99663769b3e877380b1b25fd19fdc091b68988ed5935e777dda4bafcde803b272c5c9905881328b5d9ccd845b3eda8fafef185b42221641bac23_0", "is_ignored": false, "lines": "\tdeleteSQL := fmt.Sprintf(\"DELETE FROM %s WHERE %s limit %d;\", TableName(schemaName, tableName), where, DefaultDeleteRowsNum)", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CTX": {"abstract_content": "ctx", "end": {"col": 35, "line": 847, "offset": 25599}, "start": {"col": 32, "line": 847, "offset": 25596}}, "$FUNC": {"abstract_content": "DeleteRows", "end": {"col": 16, "line": 845, "offset": 25331}, "start": {"col": 6, "line": 845, "offset": 25321}}, "$OBJ": {"abstract_content": "db", "end": {"col": 19, "line": 847, "offset": 25583}, "start": {"col": 17, "line": 847, "offset": 25581}}, "$QUERY": {"abstract_content": "deleteSQL", "end": {"col": 11, "line": 846, "offset": 25449}, "start": {"col": 2, "line": 846, "offset": 25440}}, "$SQLSTR": {"abstract_content": "DELETE FROM %s WHERE %s limit %d;", "end": {"col": 61, "line": 846, "offset": 25499}, "start": {"col": 28, "line": 846, "offset": 25466}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/dbutil/common.go", "start": {"col": 2, "line": 846, "offset": 25440}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 74, "line": 50, "offset": 2202}, "extra": {"engine_kind": "OSS", "fingerprint": "05042240ed834feda2c5b682a40899361370126fa59813744ee9bae3b60e28be58a724a3d5e0593426bc4e3242df057452007c4cc721a8988434374dd5c48196_0", "is_ignored": false, "lines": "\tquery := fmt.Sprintf(\"SHOW INDEX FROM %s\", TableName(schemaName, table))", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CTX": {"abstract_content": "ctx", "end": {"col": 34, "line": 51, "offset": 2236}, "start": {"col": 31, "line": 51, "offset": 2233}}, "$FUNC": {"abstract_content": "ShowIndex", "end": {"col": 15, "line": 38, "offset": 985}, "start": {"col": 6, "line": 38, "offset": 976}}, "$OBJ": {"abstract_content": "db", "end": {"col": 17, "line": 51, "offset": 2219}, "start": {"col": 15, "line": 51, "offset": 2217}}, "$QUERY": {"abstract_content": "query", "end": {"col": 7, "line": 50, "offset": 2135}, "start": {"col": 2, "line": 50, "offset": 2130}}, "$SQLSTR": {"abstract_content": "SHOW INDEX FROM %s", "end": {"col": 42, "line": 50, "offset": 2170}, "start": {"col": 24, "line": 50, "offset": 2152}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/dbutil/index.go", "start": {"col": 2, "line": 50, "offset": 2130}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 68, "line": 62, "offset": 2289}, "extra": {"engine_kind": "OSS", "fingerprint": "05736ddb8773b7d2308e96366254d4036706b757135f03a494a8641eaa00bce1d8919aafcaf0a3ba7969c1bde56aac751b03f8653eec537bc2a76162c911f06c_0", "is_ignored": false, "lines": "\tquery := fmt.Sprintf(\"SHOW GLOBAL VARIABLES LIKE '%s';\", variable)", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CTX": {"abstract_content": "ctx", "end": {"col": 30, "line": 63, "offset": 2319}, "start": {"col": 27, "line": 63, "offset": 2316}}, "$FUNC": {"abstract_content": "ShowMySQLVariable", "end": {"col": 23, "line": 61, "offset": 2137}, "start": {"col": 6, "line": 61, "offset": 2120}}, "$OBJ": {"abstract_content": "db", "end": {"col": 10, "line": 63, "offset": 2299}, "start": {"col": 8, "line": 63, "offset": 2297}}, "$QUERY": {"abstract_content": "query", "end": {"col": 7, "line": 62, "offset": 2228}, "start": {"col": 2, "line": 62, "offset": 2223}}, "$SQLSTR": {"abstract_content": "SHOW GLOBAL VARIABLES LIKE '%s';", "end": {"col": 56, "line": 62, "offset": 2277}, "start": {"col": 24, "line": 62, "offset": 2245}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/dbutil/variable.go", "start": {"col": 2, "line": 62, "offset": 2223}}, {"check_id": "go.lang.security.audit.database.string-formatted-query.string-formatted-query", "end": {"col": 63, "line": 82, "offset": 2866}, "extra": {"engine_kind": "OSS", "fingerprint": "9536219e11b70443f868155fd1278752e446a880229811320281b075654f0c1e18c9485087678a04cc7318124668ca4f172a51678784892365e7e22cc62a3eeb_0", "is_ignored": false, "lines": "\t\tquery = fmt.Sprintf(\"SHOW GRANTS FOR '%s'@'%s'\", user, host)", "message": "String-formatted SQL query detected. This could lead to SQL injection if the string is not sanitized properly. Audit this call to ensure the SQL is not manipulable by external data.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A01:2017 - Injection", "A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9124, "rule_id": "ZqU5bD", "rv_id": 833847, "url": "https://semgrep.dev/playground/r/A8T37Br/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "version_id": "A8T37Br"}}, "shortlink": "https://sg.run/ydEr", "source": "https://semgrep.dev/r/go.lang.security.audit.database.string-formatted-query.string-formatted-query", "source-rule-url": "https://github.com/securego/gosec", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["SQL Injection"]}, "metavars": {"$1": {"abstract_content": "db", "end": {"col": 3, "line": 1, "offset": 2}, "start": {"col": 1, "line": 1, "offset": 0}}, "$CTX": {"abstract_content": "ctx", "end": {"col": 35, "line": 86, "offset": 2951}, "start": {"col": 32, "line": 86, "offset": 2948}}, "$FUNC": {"abstract_content": "ShowGrants", "end": {"col": 16, "line": 72, "offset": 2582}, "start": {"col": 6, "line": 72, "offset": 2572}}, "$OBJ": {"abstract_content": "db", "end": {"col": 18, "line": 86, "offset": 2934}, "start": {"col": 16, "line": 86, "offset": 2932}}, "$QUERY": {"abstract_content": "query", "end": {"col": 8, "line": 82, "offset": 2811}, "start": {"col": 3, "line": 82, "offset": 2806}}, "$SQLSTR": {"abstract_content": "SHOW GRANTS FOR '%s'@'%s'", "end": {"col": 49, "line": 82, "offset": 2852}, "start": {"col": 24, "line": 82, "offset": 2827}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/dbutil/variable.go", "start": {"col": 3, "line": 82, "offset": 2806}}, {"check_id": "trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "end": {"col": 3, "line": 63, "offset": 1525}, "extra": {"engine_kind": "OSS", "fingerprint": "28d8baee4b5dbdb9cc47eb81c824160bf6febffa524c59e233db1091e2bed026613083563ff40a7e064f4a11df85f19ef9dbcf953cc206e24865af208cbc4c4f_0", "is_ignored": false, "lines": "\tif val, err := strconv.Atoi(os.Getenv(\"GOGC\")); err == nil {\n\t\tdefaultGCPercent = uint32(val)\n\t}", "message": "Downcasting or changing sign of an integer with `uint32` method", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-681: Incorrect Conversion between Numeric Types", "description": "Integer underflows", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "LOW", "references": ["https://github.com/golang/go/issues/30209"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 11759, "rule_id": "4bU2AZ", "rv_id": 833273, "url": "https://semgrep.dev/playground/r/rxTDzNy/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "version_id": "rxTDzNy"}}, "shortlink": "https://sg.run/65WB", "source": "https://semgrep.dev/r/trailofbits.go.string-to-int-signedness-cast.string-to-int-signedness-cast", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$CAST_METHOD": {"abstract_content": "uint32", "end": {"col": 28, "line": 62, "offset": 1517}, "start": {"col": 22, "line": 62, "offset": 1511}}, "$X": {"abstract_content": "val", "end": {"col": 8, "line": 61, "offset": 1435}, "start": {"col": 5, "line": 61, "offset": 1432}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/gctuner/tuner.go", "start": {"col": 2, "line": 61, "offset": 1429}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 19, "offset": 636}, "extra": {"engine_kind": "OSS", "fingerprint": "72b878c76f775539639a77a6d7871c8e9209a9abf3f73688c411d2ef6acb7918b2a739770f1737c7246ad162dd8b588e83cdd57a080e14f650bfb1eaffdad785_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "Intn", "end": {"col": 24, "line": 38, "offset": 1193}, "start": {"col": 20, "line": 38, "offset": 1189}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 19, "offset": 636}, "start": {"col": 3, "line": 19, "offset": 627}}, "$RAND": {"abstract_content": "rand", "end": {"col": 19, "line": 38, "offset": 1188}, "start": {"col": 15, "line": 38, "offset": 1184}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/importer/rand.go", "start": {"col": 3, "line": 19, "offset": 627}}, {"check_id": "trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "end": {"col": 3, "line": 202, "offset": 8087}, "extra": {"engine_kind": "OSS", "fingerprint": "adbdace052f1f9b8e33ff1e4f48b867c2c51314817e205df27ca518066ab74778143cd22322e9478295ce8a53ccd9a91bbce52cadc506cc8ce8ce87c3c0c04a4_0", "is_ignored": false, "lines": "\tcasted, err := point.value.ConvertTo(sctx.TypeCtx, newTp)\n\tif err != nil {\n\t\tif sctx.InPreparedPlanBuilding {\n\t\t\t// skip plan cache in this case for safety.\n\t\t\tsctx.SetSkipPlanCache(fmt.Sprintf(\"%s when converting %v\", err.Error(), point.value))\n\t\t}\n\t\t//revive:disable:empty-block\n\t\tif newTp.GetType() == mysql.TypeYear && terror.ErrorEqual(err, types.ErrWarnDataOutOfRange) {\n\t\t\t// see issue #20101: overflow when converting integer to year\n\t\t} else if newTp.GetType() == mysql.TypeBit && terror.ErrorEqual(err, types.ErrDataTooLong) {\n\t\t\t// see issue #19067: we should ignore the types.ErrDataTooLong when we convert value to TypeBit value\n\t\t} else if (newTp.GetType() == mysql.TypeNewDecimal || mysql.IsIntegerType(newTp.GetType()) || newTp.GetType() == mysql.TypeFloat) && terror.ErrorEqual(err, types.ErrOverflow) {\n\t\t\t// Ignore the types.ErrOverflow when we convert TypeNewDecimal/TypeTiny/TypeShort/TypeInt24/TypeLong/TypeLonglong/TypeFloat values.\n\t\t\t// A trimmed valid boundary point value would be returned then. Accordingly, the `excl` of the point\n\t\t\t// would be adjusted. Impossible ranges would be skipped by the `validInterval` call later.\n\t\t\t// tests in TestIndexRange/TestIndexRangeForDecimal\n\t\t} else if point.value.Kind() == types.KindMysqlTime && newTp.GetType() == mysql.TypeTimestamp && terror.ErrorEqual(err, types.ErrWrongValue) {\n\t\t\t// See issue #28424: query failed after add index\n\t\t\t// Ignore conversion from Date[Time] to Timestamp since it must be either out of range or impossible date, which will not match a point select\n\t\t} else if newTp.GetType() == mysql.TypeEnum && terror.ErrorEqual(err, types.ErrTruncated) {\n\t\t\t// Ignore the types.ErrorTruncated when we convert TypeEnum values.\n\t\t\t// We should cover Enum upper overflow, and convert to the biggest value.\n\t\t\tif point.value.GetInt64() > 0 {\n\t\t\t\tupperEnum, err := types.ParseEnumValue(newTp.GetElems(), uint64(len(newTp.GetElems())))\n\t\t\t\tif err != nil {\n\t\t\t\t\treturn nil, err\n\t\t\t\t}\n\t\t\t\tcasted.SetMysqlEnum(upperEnum, newTp.GetCollate())\n\t\t\t}\n\t\t} else if terror.ErrorEqual(err, charset.ErrInvalidCharacterString) {\n\t\t\t// The invalid string can be produced by changing datum's underlying bytes directly.\n\t\t\t// For example, newBuildFromPatternLike calculates the end point by adding 1 to bytes.\n\t\t\t// We need to skip these invalid strings.\n\t\t\treturn point, nil\n\t\t} else {\n\t\t\treturn point, errors.Trace(err)\n\t\t}\n\t\t//revive:enable:empty-block\n\t}", "message": "Variable `casted` is likely modified and later used on error. In some cases this could result  in panics due to a nil dereference", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-665: Improper Initialization", "description": "Possible unintentional assignment when an error occurs", "impact": "MEDIUM", "license": "AGPL-3.0 license", "likelihood": "MEDIUM", "references": ["https://blog.trailofbits.com/2019/11/07/attacking-go-vr-ttps/"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 17197, "rule_id": "kxU6Xb", "rv_id": 833265, "url": "https://semgrep.dev/playground/r/zyTWJNZ/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "version_id": "zyTWJNZ"}}, "shortlink": "https://sg.run/WWQ2", "source": "https://semgrep.dev/r/trailofbits.go.invalid-usage-of-modified-variable.invalid-usage-of-modified-variable", "subcategory": ["audit"], "technology": ["--no-technology--"], "vulnerability_class": ["Other"]}, "metavars": {"$ERR": {"abstract_content": "err", "end": {"col": 13, "line": 164, "offset": 5670}, "start": {"col": 10, "line": 164, "offset": 5667}}, "$X": {"abstract_content": "casted", "end": {"col": 8, "line": 164, "offset": 5665}, "start": {"col": 2, "line": 164, "offset": 5659}}, "$Y": {"abstract_content": "SetMysqlEnum", "end": {"col": 24, "line": 191, "offset": 7652}, "start": {"col": 12, "line": 191, "offset": 7640}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/ranger/ranger.go", "start": {"col": 2, "line": 164, "offset": 5659}}, {"check_id": "problem-based-packs.insecure-transport.go-stdlib.bypass-tls-verification.bypass-tls-verification", "end": {"col": 3, "line": 197, "offset": 6356}, "extra": {"engine_kind": "OSS", "fingerprint": "6704cc657674d5c1d8f507fa5096c53ddfccd7dbc5e1be4da732d05963de6b4c7d501f5ef410a786b0ff69871a052a8e4d8851e56876f921589dbb355a5e02b1_0", "is_ignored": false, "lines": "\ttlsCfg := &tls.Config{\n\t\tMinVersion:         tls.VersionTLS12,\n\t\tInsecureSkipVerify: true,\n\t\tNextProtos:         []string{\"h2\", \"http/1.2\"}, // specify `h2` to let Go use HTTP/2.\n\t}", "message": "Checks for disabling of TLS/SSL certificate verification. This should only be used for debugging purposes because it leads to vulnerability to MTM attacks.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": "CWE-319: Cleartext Transmission of Sensitive Information", "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "HIGH", "owasp": "A03:2017 - Sensitive Data Exposure", "references": ["https://stackoverflow.com/questions/12122159/how-to-do-a-https-request-with-bad-certificate"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9400, "rule_id": "DbUpjg", "rv_id": 834309, "url": "https://semgrep.dev/playground/r/BjTe0EO/problem-based-packs.insecure-transport.go-stdlib.bypass-tls-verification.bypass-tls-verification", "version_id": "BjTe0EO"}}, "shortlink": "https://sg.run/4xj5", "source": "https://semgrep.dev/r/problem-based-packs.insecure-transport.go-stdlib.bypass-tls-verification.bypass-tls-verification", "subcategory": ["vuln"], "technology": ["go"], "vulnerability": "Insecure Transport", "vulnerability_class": ["Mishandled Sensitive Information"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/security.go", "start": {"col": 13, "line": 193, "offset": 6186}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 18, "offset": 630}, "extra": {"engine_kind": "OSS", "fingerprint": "5f8fcedaacd324338f1b4dc1b18ce077b7d403b7ccc5f0525fcf2bbe8939212590c9408aab2dbe6fb842ae08422f587e28d255dcc261dd6b8c22e060fe4a2bc9_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "Len", "end": {"col": 39, "line": 28, "offset": 910}, "start": {"col": 36, "line": 28, "offset": 907}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 18, "offset": 630}, "start": {"col": 3, "line": 18, "offset": 621}}, "$RAND": {"abstract_content": "data", "end": {"col": 35, "line": 28, "offset": 906}, "start": {"col": 31, "line": 28, "offset": 902}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/selection/selection.go", "start": {"col": 3, "line": 18, "offset": 621}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 18, "offset": 630}, "extra": {"engine_kind": "OSS", "fingerprint": "27b37956f76b8cb5d818df28b9854108f8c4884983facf55b6a9d8f403d54ab60d8633469c3d58a1bb27a09aa1bfb1d02446cba8cbbd2a1efe881fe00a2634dc_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "LoadUint32", "end": {"col": 30, "line": 59, "offset": 2154}, "start": {"col": 20, "line": 59, "offset": 2144}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 18, "offset": 630}, "start": {"col": 3, "line": 18, "offset": 621}}, "$RAND": {"abstract_content": "atomic", "end": {"col": 19, "line": 59, "offset": 2143}, "start": {"col": 13, "line": 59, "offset": 2137}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/sqlkiller/sqlkiller.go", "start": {"col": 3, "line": 18, "offset": 621}}, {"check_id": "go.grpc.security.grpc-server-insecure-connection.grpc-server-insecure-connection", "end": {"col": 28, "line": 39, "offset": 1061}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 28, "line": 39, "offset": 1061}, "path": "pkg/util/topsql/reporter/mock/pubsub.go", "start": {"col": 12, "line": 39, "offset": 1045}}, "grpc.NewServer()"]], "taint_source": ["CliLoc", [{"end": {"col": 28, "line": 39, "offset": 1061}, "path": "pkg/util/topsql/reporter/mock/pubsub.go", "start": {"col": 12, "line": 39, "offset": 1045}}, "grpc.NewServer()"]]}, "engine_kind": "OSS", "fingerprint": "b918cc5748ac2984132fa34d4618ff7518dfc86be708c1cd2da19b744c4a4271b6c3dcbe82ad30e695fb8fbfd8ac288397a6533f080ea8084b80816a32fedb9e_0", "is_ignored": false, "lines": "\tserver := grpc.NewServer()", "message": "Found an insecure gRPC server without 'grpc.Creds()' or options with credentials. This allows for a connection without encryption to this server. A malicious attacker could tamper with the gRPC message, which could compromise the machine. Include credentials derived from an SSL certificate in order to create a secure gRPC connection. You can create credentials using 'credentials.NewServerTLSFromFile(\"cert.pem\", \"cert.key\")'.", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-300: Channel Accessible by Non-Endpoint"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2021 - Identification and Authentication Failures"], "references": ["https://blog.gopheracademy.com/advent-2019/go-grps-and-tls/#connection-without-encryption"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9091, "rule_id": "JDUy0B", "rv_id": 833817, "url": "https://semgrep.dev/playground/r/X0T5NDk/go.grpc.security.grpc-server-insecure-connection.grpc-server-insecure-connection", "version_id": "X0T5NDk"}}, "shortlink": "https://sg.run/5Q5l", "source": "https://semgrep.dev/r/go.grpc.security.grpc-server-insecure-connection.grpc-server-insecure-connection", "subcategory": ["audit"], "technology": ["grpc"], "vulnerability_class": ["Other"]}, "metavars": {}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/topsql/reporter/mock/pubsub.go", "start": {"col": 12, "line": 39, "offset": 1045}}, {"check_id": "go.grpc.security.grpc-server-insecure-connection.grpc-server-insecure-connection", "end": {"col": 28, "line": 51, "offset": 1312}, "extra": {"dataflow_trace": {"intermediate_vars": [], "taint_sink": ["CliLoc", [{"end": {"col": 28, "line": 51, "offset": 1312}, "path": "pkg/util/topsql/reporter/mock/server.go", "start": {"col": 12, "line": 51, "offset": 1296}}, "grpc.NewServer()"]], "taint_source": ["CliLoc", [{"end": {"col": 28, "line": 51, "offset": 1312}, "path": "pkg/util/topsql/reporter/mock/server.go", "start": {"col": 12, "line": 51, "offset": 1296}}, "grpc.NewServer()"]]}, "engine_kind": "OSS", "fingerprint": "db805e7f0bd4cec0a71d03c774a733a38055b3487c0d7d60ba95315eecd083f78762d08f34bc33448dcd31cfe6f152f0ad15c9ed0b03a8e6463c3ebabcd3938f_0", "is_ignored": false, "lines": "\tserver := grpc.NewServer()", "message": "Found an insecure gRPC server without 'grpc.Creds()' or options with credentials. This allows for a connection without encryption to this server. A malicious attacker could tamper with the gRPC message, which could compromise the machine. Include credentials derived from an SSL certificate in order to create a secure gRPC connection. You can create credentials using 'credentials.NewServerTLSFromFile(\"cert.pem\", \"cert.key\")'.", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-300: Channel Accessible by Non-Endpoint"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A07:2021 - Identification and Authentication Failures"], "references": ["https://blog.gopheracademy.com/advent-2019/go-grps-and-tls/#connection-without-encryption"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9091, "rule_id": "JDUy0B", "rv_id": 833817, "url": "https://semgrep.dev/playground/r/X0T5NDk/go.grpc.security.grpc-server-insecure-connection.grpc-server-insecure-connection", "version_id": "X0T5NDk"}}, "shortlink": "https://sg.run/5Q5l", "source": "https://semgrep.dev/r/go.grpc.security.grpc-server-insecure-connection.grpc-server-insecure-connection", "subcategory": ["audit"], "technology": ["grpc"], "vulnerability_class": ["Other"]}, "metavars": {}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/topsql/reporter/mock/server.go", "start": {"col": 12, "line": 51, "offset": 1296}}, {"check_id": "go.lang.security.audit.crypto.use_of_weak_crypto.use-of-DES", "end": {"col": 52, "line": 29, "offset": 825}, "extra": {"engine_kind": "OSS", "fingerprint": "8c0e02651a38994fcffe542a8df25b5ffb16bb1d208f2e004698dc0922c4fcc17bdd35162d60162ccab6149cacfd44c565e68c4b97788e821b1eb09479ca874b_0", "is_ignored": false, "lines": "\tnullKeyBlock, err = des.NewCipher(make([]byte, 8)) // #nosec G401 G502", "message": "Detected DES cipher algorithm which is insecure. The algorithm is considered weak and has been deprecated. Use AES instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-327: Use of a Broken or Risky Cryptographic Algorithm"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9121, "rule_id": "eqU8B3", "rv_id": 833840, "url": "https://semgrep.dev/playground/r/3ZT3Aqo/go.lang.security.audit.crypto.use_of_weak_crypto.use-of-DES", "version_id": "3ZT3Aqo"}}, "shortlink": "https://sg.run/jREA", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.use_of_weak_crypto.use-of-DES", "source-rule-url": "https://github.com/securego/gosec#available-rules", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "pkg/util/vitess/vitess_hash.go", "start": {"col": 22, "line": 29, "offset": 795}}, {"check_id": "go.lang.security.audit.crypto.math_random.math-random-used", "end": {"col": 12, "line": 26, "offset": 698}, "extra": {"engine_kind": "OSS", "fingerprint": "e147281d5540ea0d3433461f46bc2fe6e94a1e952783da5cd0e62e7bc2f356752ae708a9e30f26d325157c8675424a2cee81b1e042e945003b551f8216d03302_0", "fix": "crypto/rand", "is_ignored": false, "lines": "\t\"math/rand\"", "message": "Do not use `math/rand`. Use `crypto/rand` instead.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A02:2021 - Cryptographic Failures"], "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9115, "rule_id": "bwUwy8", "rv_id": 833834, "url": "https://semgrep.dev/playground/r/ExTrD7D/go.lang.security.audit.crypto.math_random.math-random-used", "version_id": "ExTrD7D"}}, "shortlink": "https://sg.run/6nK6", "source": "https://semgrep.dev/r/go.lang.security.audit.crypto.math_random.math-random-used", "subcategory": ["vuln"], "technology": ["go"], "vulnerability_class": ["Cryptographic Issues"]}, "metavars": {"$1": {"abstract_content": "math/rand", "end": {"col": 10, "line": 1, "offset": 9}, "start": {"col": 1, "line": 1, "offset": 0}}, "$FUNC": {"abstract_content": "Println", "end": {"col": 13, "line": 86, "offset": 1573}, "start": {"col": 6, "line": 86, "offset": 1566}}, "$MATH": {"abstract_content": "math/rand", "end": {"col": 12, "line": 26, "offset": 698}, "start": {"col": 3, "line": 26, "offset": 689}}, "$RAND": {"abstract_content": "fmt", "end": {"col": 5, "line": 86, "offset": 1565}, "start": {"col": 2, "line": 86, "offset": 1562}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "tools/check/ut.go", "start": {"col": 3, "line": 26, "offset": 689}}, {"check_id": "go.lang.security.audit.dangerous-exec-command.dangerous-exec-command", "end": {"col": 35, "line": 867, "offset": 18624}, "extra": {"engine_kind": "OSS", "fingerprint": "e3bbcbeaec360033f7442f1f438b1a653b628ee69e20ef3a72922e9b68bd9fc88a3129117f244acf4518e8cb6864585a92192efa0594312f6506352d9b0f684c_0", "is_ignored": false, "lines": "\treturn exec.Command(exe, args...)", "message": "Detected non-static command inside Command. Audit the input to 'exec.Command'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9109, "rule_id": "X5U8RQ", "rv_id": 833845, "url": "https://semgrep.dev/playground/r/GxTDE1v/go.lang.security.audit.dangerous-exec-command.dangerous-exec-command", "version_id": "GxTDE1v"}}, "shortlink": "https://sg.run/W8lA", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-command.dangerous-exec-command", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "exe", "end": {"col": 25, "line": 867, "offset": 18614}, "propagated_value": {"svalue_abstract_content": "strings.Join([]string{\".\"testFileName(pkg)}string(filepath.Separator))", "svalue_end": {"col": 83, "line": 849, "offset": 18011}, "svalue_start": {"col": 9, "line": 849, "offset": 17937}}, "start": {"col": 22, "line": 867, "offset": 18611}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "tools/check/ut.go", "start": {"col": 9, "line": 867, "offset": 18598}}, {"check_id": "go.lang.security.audit.dangerous-exec-command.dangerous-exec-command", "end": {"col": 48, "line": 974, "offset": 21766}, "extra": {"engine_kind": "OSS", "fingerprint": "e3bbcbeaec360033f7442f1f438b1a653b628ee69e20ef3a72922e9b68bd9fc88a3129117f244acf4518e8cb6864585a92192efa0594312f6506352d9b0f684c_1", "is_ignored": false, "lines": "\tcmd := exec.Command(exe, \"-test.list\", \"Test\")", "message": "Detected non-static command inside Command. Audit the input to 'exec.Command'. If unverified user data can reach this call site, this is a code injection vulnerability. A malicious actor can inject a malicious script to execute arbitrary code.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-94: Improper Control of Generation of Code ('Code Injection')"], "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2021 - Injection"], "references": ["https://owasp.org/Top10/A03_2021-Injection"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9109, "rule_id": "X5U8RQ", "rv_id": 833845, "url": "https://semgrep.dev/playground/r/GxTDE1v/go.lang.security.audit.dangerous-exec-command.dangerous-exec-command", "version_id": "GxTDE1v"}}, "shortlink": "https://sg.run/W8lA", "source": "https://semgrep.dev/r/go.lang.security.audit.dangerous-exec-command.dangerous-exec-command", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Code Injection"]}, "metavars": {"$CMD": {"abstract_content": "exe", "end": {"col": 25, "line": 974, "offset": 21743}, "propagated_value": {"svalue_abstract_content": "strings.Join([]string{\".\"testFileName(pkg)}string(filepath.Separator))", "svalue_end": {"col": 83, "line": 971, "offset": 21684}, "svalue_start": {"col": 9, "line": 971, "offset": 21610}}, "start": {"col": 22, "line": 974, "offset": 21740}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "tools/check/ut.go", "start": {"col": 9, "line": 974, "offset": 21727}}, {"check_id": "go.lang.security.audit.net.use-tls.use-tls", "end": {"col": 39, "line": 25, "offset": 867}, "extra": {"engine_kind": "OSS", "fingerprint": "e006f72b92c60a8600b55e723a2c7c0add4ca024f4afdacf8c098f17042f0c4e0d5c3eb3413edc03bbfb0f4e5b37c4c1bd64146185a5e699774d37d7257fe163_0", "fix": "http.ListenAndServeTLS(\":5000\", certFile, keyFile, nil)", "is_ignored": false, "lines": "\t_ = http.ListenAndServe(\":5000\", nil)", "message": "Found an HTTP server without TLS. Use 'http.ListenAndServeTLS' instead. See https://golang.org/pkg/net/http/#ListenAndServeTLS for more information.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-319: Cleartext Transmission of Sensitive Information"], "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A03:2017 - Sensitive Data Exposure", "A02:2021 - Cryptographic Failures"], "references": ["https://golang.org/pkg/net/http/#ListenAndServeTLS"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 9134, "rule_id": "PeUZ8X", "rv_id": 833859, "url": "https://semgrep.dev/playground/r/RGTKGyp/go.lang.security.audit.net.use-tls.use-tls", "version_id": "RGTKGyp"}}, "shortlink": "https://sg.run/dKbY", "source": "https://semgrep.dev/r/go.lang.security.audit.net.use-tls.use-tls", "subcategory": ["audit"], "technology": ["go"], "vulnerability_class": ["Mishandled Sensitive Information"]}, "metavars": {"$ADDR": {"abstract_content": "\":5000\"", "end": {"col": 33, "line": 25, "offset": 861}, "start": {"col": 26, "line": 25, "offset": 854}}, "$HANDLER": {"abstract_content": "nil", "end": {"col": 38, "line": 25, "offset": 866}, "start": {"col": 35, "line": 25, "offset": 863}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "tools/fake-oauth/main.go", "start": {"col": 6, "line": 25, "offset": 834}}, {"check_id": "dockerfile.security.no-sudo-in-dockerfile.no-sudo-in-dockerfile", "end": {"col": 51, "line": 40, "offset": 1533}, "extra": {"engine_kind": "OSS", "fingerprint": "0e7f682c4291da53b18aaca7e2895058fc6a67bc8f589d72e34b9b50f62001f8ebb96e000b427e9ec8ba64539fee8473fc04cdf7825bd813869f4ae9dc6564c5_0", "is_ignored": false, "lines": "RUN echo \"deb [signed-by=/usr/share/keyrings/cloud.google.gpg] https://packages.cloud.google.com/apt cloud-sdk main\" | sudo tee -a /etc/apt/sources.list.d/google-cloud-sdk.list && \\\n    curl https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key --keyring /usr/share/keyrings/cloud.google.gpg add - && \\\n    apt-get update && apt-get install google-cloud-cli", "message": "Avoid using sudo in Dockerfiles. Running processes as a non-root user can help  reduce the potential impact of configuration errors and security vulnerabilities.", "metadata": {"category": "security", "confidence": "HIGH", "cwe": ["CWE-250: Execution with Unnecessary Privileges"], "impact": "LOW", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration"], "references": ["https://cwe.mitre.org/data/definitions/250.html", "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#user"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 66384, "rule_id": "kxUlx1", "rv_id": 833487, "url": "https://semgrep.dev/playground/r/ExTrDbJ/dockerfile.security.no-sudo-in-dockerfile.no-sudo-in-dockerfile", "version_id": "ExTrDbJ"}}, "shortlink": "https://sg.run/80Q7", "source": "https://semgrep.dev/r/dockerfile.security.no-sudo-in-dockerfile.no-sudo-in-dockerfile", "subcategory": ["audit"], "technology": ["dockerfile"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "tools/patch-go/Dockerfile", "start": {"col": 1, "line": 38, "offset": 1165}}], "skipped_rules": [], "version": "1.58.0"}
