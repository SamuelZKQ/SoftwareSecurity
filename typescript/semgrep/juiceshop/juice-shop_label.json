{
    "results": [
        {
            "check_id": "javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 162,
                "line": 5,
                "offset": 432
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "criteria",
                            "location": {
                                "end": {
                                    "col": 17,
                                    "line": 3,
                                    "offset": 128
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/dbSchemaChallenge_1.ts",
                                "start": {
                                    "col": 9,
                                    "line": 3,
                                    "offset": 120
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 162,
                                    "line": 5,
                                    "offset": 432
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/dbSchemaChallenge_1.ts",
                                "start": {
                                    "col": 28,
                                    "line": 5,
                                    "offset": 298
                                }
                            },
                            "\"SELECT * FROM Products WHERE ((name LIKE '%\"+criteria+\"%' OR description LIKE '%\"+criteria+\"%') AND deletedAt IS NULL) ORDER BY name\""
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 69,
                                    "line": 3,
                                    "offset": 180
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/dbSchemaChallenge_1.ts",
                                "start": {
                                    "col": 60,
                                    "line": 3,
                                    "offset": 171
                                }
                            },
                            "req.query"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "68b23b0274eaba1c15e622ab81b78af181c453293dcd3244058e6dc4eb580ae63e8b07d92eb844301b54fdd9d04a89d99265c2aa9b8d371010a94a4d99635846_0",
                "is_ignored": false,
                "lines": "    models.sequelize.query(\"SELECT * FROM Products WHERE ((name LIKE '%\"+criteria+\"%' OR description LIKE '%\"+criteria+\"%') AND deletedAt IS NULL) ORDER BY name\")",
                "message": "Detected a sequelize statement that is tainted by user-input. This could lead to SQL injection if the variable is user-controlled and is not properly sanitized. In order to prevent SQL injection, it is recommended to use parameterized queries or prepared statements.",
                "metadata": {
                    "category": "security",
                    "confidence": "HIGH",
                    "cwe": [
                        "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "HIGH",
                    "interfile": true,
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://sequelize.org/docs/v6/core-concepts/raw-queries/#replacements"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22085,
                            "rule_id": "yyU0GX",
                            "rv_id": 834186,
                            "url": "https://semgrep.dev/playground/r/w8TAxwx/javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
                            "version_id": "w8TAxwx"
                        }
                    },
                    "shortlink": "https://sg.run/gjoe",
                    "source": "https://semgrep.dev/r/javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "SQL Injection"
                    ]
                },
                "metavars": {
                    "$DB": {
                        "abstract_content": "models",
                        "end": {
                            "col": 11,
                            "line": 5,
                            "offset": 281
                        },
                        "start": {
                            "col": 5,
                            "line": 5,
                            "offset": 275
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 44,
                            "line": 2,
                            "offset": 90
                        },
                        "start": {
                            "col": 40,
                            "line": 2,
                            "offset": 86
                        }
                    },
                    "$QUERY": {
                        "abstract_content": "\"SELECT * FROM Products WHERE ((name LIKE '%\"+criteria+\"%' OR description LIKE '%\"+criteria+\"%') AND deletedAt IS NULL) ORDER BY name\"",
                        "end": {
                            "col": 162,
                            "line": 5,
                            "offset": 432
                        },
                        "start": {
                            "col": 28,
                            "line": 5,
                            "offset": 298
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 63,
                            "line": 3,
                            "offset": 174
                        },
                        "start": {
                            "col": 60,
                            "line": 3,
                            "offset": 171
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 28,
                            "line": 2,
                            "offset": 74
                        },
                        "start": {
                            "col": 25,
                            "line": 2,
                            "offset": 71
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/data/static/codefixes/dbSchemaChallenge_1.ts",
            "start": {
                "col": 28,
                "line": 5,
                "offset": 298
            }
        },
        {
            "check_id": "javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 82,
                "line": 5,
                "offset": 352
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "criteria",
                            "location": {
                                "end": {
                                    "col": 17,
                                    "line": 3,
                                    "offset": 128
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/dbSchemaChallenge_1.ts",
                                "start": {
                                    "col": 9,
                                    "line": 3,
                                    "offset": 120
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 82,
                                    "line": 5,
                                    "offset": 352
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/dbSchemaChallenge_1.ts",
                                "start": {
                                    "col": 74,
                                    "line": 5,
                                    "offset": 344
                                }
                            },
                            "criteria"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 69,
                                    "line": 3,
                                    "offset": 180
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/dbSchemaChallenge_1.ts",
                                "start": {
                                    "col": 60,
                                    "line": 3,
                                    "offset": 171
                                }
                            },
                            "req.query"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "443d0d40dbf0502973d80e046a84b85704573eb01e89983dceb91ecda1a1d8a64fcc0107b423341455c8f8aa8f3dffd3b0431136288b755fb597fa39e92b710b_0",
                "is_ignored": false,
                "lines": "    models.sequelize.query(\"SELECT * FROM Products WHERE ((name LIKE '%\"+criteria+\"%' OR description LIKE '%\"+criteria+\"%') AND deletedAt IS NULL) ORDER BY name\")",
                "message": "Detected user input used to manually construct a SQL string. This is usually bad practice because manual construction could accidentally result in a SQL injection. An attacker could use a SQL injection to steal or modify contents of the database. Instead, use a parameterized query which is available by default in most database engines. Alternatively, consider using an object-relational mapper (ORM) such as Sequelize which will protect your queries.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/SQL_Injection"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 14715,
                            "rule_id": "NbUNpr",
                            "rv_id": 834108,
                            "url": "https://semgrep.dev/playground/r/DkTG0jd/javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
                            "version_id": "DkTG0jd"
                        }
                    },
                    "shortlink": "https://sg.run/66ZL",
                    "source": "https://semgrep.dev/r/javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "SQL Injection"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "SELECT",
                        "end": {
                            "col": 7,
                            "line": 1,
                            "offset": 6
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$EXPR": {
                        "abstract_content": "criteria",
                        "end": {
                            "col": 82,
                            "line": 5,
                            "offset": 352
                        },
                        "start": {
                            "col": 74,
                            "line": 5,
                            "offset": 344
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 63,
                            "line": 3,
                            "offset": 174
                        },
                        "start": {
                            "col": 60,
                            "line": 3,
                            "offset": 171
                        }
                    },
                    "$SQLSTR": {
                        "abstract_content": "SELECT * FROM Products WHERE ((name LIKE '%",
                        "end": {
                            "col": 72,
                            "line": 5,
                            "offset": 342
                        },
                        "start": {
                            "col": 29,
                            "line": 5,
                            "offset": 299
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/data/static/codefixes/dbSchemaChallenge_1.ts",
            "start": {
                "col": 74,
                "line": 5,
                "offset": 344
            }
        },
        {
            "check_id": "javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 159,
                "line": 11,
                "offset": 570
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "criteria",
                            "location": {
                                "end": {
                                    "col": 17,
                                    "line": 5,
                                    "offset": 175
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/dbSchemaChallenge_3.ts",
                                "start": {
                                    "col": 9,
                                    "line": 5,
                                    "offset": 167
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 159,
                                    "line": 11,
                                    "offset": 570
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/dbSchemaChallenge_3.ts",
                                "start": {
                                    "col": 28,
                                    "line": 11,
                                    "offset": 439
                                }
                            },
                            "`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 69,
                                    "line": 5,
                                    "offset": 227
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/dbSchemaChallenge_3.ts",
                                "start": {
                                    "col": 60,
                                    "line": 5,
                                    "offset": 218
                                }
                            },
                            "req.query"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "3b2d00cb519ccb8d9cf81ce995e1dc81c24a5d7fdb9c10f733af888eff490835bdf12db487789d8ff3e04538a54bcc9a6bf2ac87e432f5c2822f20a072e5b8f2_0",
                "is_ignored": false,
                "lines": "    models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)",
                "message": "Detected a sequelize statement that is tainted by user-input. This could lead to SQL injection if the variable is user-controlled and is not properly sanitized. In order to prevent SQL injection, it is recommended to use parameterized queries or prepared statements.",
                "metadata": {
                    "category": "security",
                    "confidence": "HIGH",
                    "cwe": [
                        "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "HIGH",
                    "interfile": true,
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://sequelize.org/docs/v6/core-concepts/raw-queries/#replacements"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22085,
                            "rule_id": "yyU0GX",
                            "rv_id": 834186,
                            "url": "https://semgrep.dev/playground/r/w8TAxwx/javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
                            "version_id": "w8TAxwx"
                        }
                    },
                    "shortlink": "https://sg.run/gjoe",
                    "source": "https://semgrep.dev/r/javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "SQL Injection"
                    ]
                },
                "metavars": {
                    "$DB": {
                        "abstract_content": "models",
                        "end": {
                            "col": 11,
                            "line": 11,
                            "offset": 422
                        },
                        "start": {
                            "col": 5,
                            "line": 11,
                            "offset": 416
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 44,
                            "line": 4,
                            "offset": 137
                        },
                        "start": {
                            "col": 40,
                            "line": 4,
                            "offset": 133
                        }
                    },
                    "$QUERY": {
                        "abstract_content": "`SELECT * FROM Products WHERE ((name LIKE '%criteria%' OR description LIKE '%criteria%') AND deletedAt IS NULL) ORDER BY name",
                        "end": {
                            "col": 159,
                            "line": 11,
                            "offset": 570
                        },
                        "start": {
                            "col": 28,
                            "line": 11,
                            "offset": 439
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 63,
                            "line": 5,
                            "offset": 221
                        },
                        "start": {
                            "col": 60,
                            "line": 5,
                            "offset": 218
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 28,
                            "line": 4,
                            "offset": 121
                        },
                        "start": {
                            "col": 25,
                            "line": 4,
                            "offset": 118
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/data/static/codefixes/dbSchemaChallenge_3.ts",
            "start": {
                "col": 28,
                "line": 11,
                "offset": 439
            }
        },
        {
            "check_id": "javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 82,
                "line": 11,
                "offset": 493
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "criteria",
                            "location": {
                                "end": {
                                    "col": 17,
                                    "line": 5,
                                    "offset": 175
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/dbSchemaChallenge_3.ts",
                                "start": {
                                    "col": 9,
                                    "line": 5,
                                    "offset": 167
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 82,
                                    "line": 11,
                                    "offset": 493
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/dbSchemaChallenge_3.ts",
                                "start": {
                                    "col": 74,
                                    "line": 11,
                                    "offset": 485
                                }
                            },
                            "criteria"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 69,
                                    "line": 5,
                                    "offset": 227
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/dbSchemaChallenge_3.ts",
                                "start": {
                                    "col": 60,
                                    "line": 5,
                                    "offset": 218
                                }
                            },
                            "req.query"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "6ab31d9240b21393fbfb346dee88e7e69210db0c0e28aae0a89450f96d2a383b0564a09d6f3087993660a1410b3ffe6896daa1083f34eb37f0381e375740fe89_0",
                "is_ignored": false,
                "lines": "    models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)",
                "message": "Detected user input used to manually construct a SQL string. This is usually bad practice because manual construction could accidentally result in a SQL injection. An attacker could use a SQL injection to steal or modify contents of the database. Instead, use a parameterized query which is available by default in most database engines. Alternatively, consider using an object-relational mapper (ORM) such as Sequelize which will protect your queries.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/SQL_Injection"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 14715,
                            "rule_id": "NbUNpr",
                            "rv_id": 834108,
                            "url": "https://semgrep.dev/playground/r/DkTG0jd/javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
                            "version_id": "DkTG0jd"
                        }
                    },
                    "shortlink": "https://sg.run/66ZL",
                    "source": "https://semgrep.dev/r/javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "SQL Injection"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "SELECT",
                        "end": {
                            "col": 7,
                            "line": 1,
                            "offset": 6
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$EXPR": {
                        "abstract_content": "criteria",
                        "end": {
                            "col": 82,
                            "line": 11,
                            "offset": 493
                        },
                        "start": {
                            "col": 74,
                            "line": 11,
                            "offset": 485
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 63,
                            "line": 5,
                            "offset": 221
                        },
                        "start": {
                            "col": 60,
                            "line": 5,
                            "offset": 218
                        }
                    },
                    "$SQLSTR": {
                        "abstract_content": "SELECT * FROM Products WHERE ((name LIKE '%",
                        "end": {
                            "col": 72,
                            "line": 11,
                            "offset": 483
                        },
                        "start": {
                            "col": 29,
                            "line": 11,
                            "offset": 440
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/data/static/codefixes/dbSchemaChallenge_3.ts",
            "start": {
                "col": 74,
                "line": 11,
                "offset": 485
            }
        },
        {
            "check_id": "javascript.audit.detect-replaceall-sanitization.detect-replaceall-sanitization",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 82,
                "line": 59,
                "offset": 2132
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "599ce46fa691da82be4f50560a15c8a70ff3d0bc3b642cba8f0985c789c86ce3560f30d90a6ed7fc7497a392c18932a4a5e1ddc2172150e41083d8bf53d2c3bc_0",
                "is_ignored": false,
                "lines": "      tableData[i].description = tableData[i].description.replaceAll('<', '&lt;').replaceAll('>', '&gt;')",
                "message": "Detected a call to `replaceAll()` in an attempt to HTML escape the string `tableData[i].description`. Manually sanitizing input through a manually built list can be circumvented in many situations, and it's better to use a well known sanitization library such as `sanitize-html` or `DOMPurify`.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "LOW",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A07:2017 - Cross-Site Scripting (XSS)",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://www.npmjs.com/package/dompurify",
                        "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22550,
                            "rule_id": "kxUYE9",
                            "rv_id": 834034,
                            "url": "https://semgrep.dev/playground/r/ZRTlPdK/javascript.audit.detect-replaceall-sanitization.detect-replaceall-sanitization",
                            "version_id": "ZRTlPdK"
                        }
                    },
                    "shortlink": "https://sg.run/AzoB",
                    "source": "https://semgrep.dev/r/javascript.audit.detect-replaceall-sanitization.detect-replaceall-sanitization",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "javascript",
                        "typescript"
                    ],
                    "vulnerability_class": [
                        "Cross-Site-Scripting (XSS)"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "replace",
                        "end": {
                            "col": 8,
                            "line": 1,
                            "offset": 7
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$FUNC": {
                        "abstract_content": "replaceAll",
                        "end": {
                            "col": 69,
                            "line": 59,
                            "offset": 2119
                        },
                        "start": {
                            "col": 59,
                            "line": 59,
                            "offset": 2109
                        }
                    },
                    "$STR": {
                        "abstract_content": "tableData[i].description",
                        "end": {
                            "col": 58,
                            "line": 59,
                            "offset": 2108
                        },
                        "start": {
                            "col": 34,
                            "line": 59,
                            "offset": 2084
                        }
                    }
                },
                "severity": "INFO",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/data/static/codefixes/restfulXssChallenge_2.ts",
            "start": {
                "col": 34,
                "line": 59,
                "offset": 2084
            }
        },
        {
            "check_id": "javascript.audit.detect-replaceall-sanitization.detect-replaceall-sanitization",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 106,
                "line": 59,
                "offset": 2156
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "c7c92e294adedf6f643be2fb0f0831b3590591a4d04f1cd0939479f029c535557922a1c2babd215ef36ad7146827b53ad8a5b68f7b49fe8260ab9f17c64d72de_0",
                "is_ignored": false,
                "lines": "      tableData[i].description = tableData[i].description.replaceAll('<', '&lt;').replaceAll('>', '&gt;')",
                "message": "Detected a call to `replaceAll()` in an attempt to HTML escape the string `tableData[i].description.replaceAll('<', '&lt;')`. Manually sanitizing input through a manually built list can be circumvented in many situations, and it's better to use a well known sanitization library such as `sanitize-html` or `DOMPurify`.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "LOW",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A07:2017 - Cross-Site Scripting (XSS)",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://www.npmjs.com/package/dompurify",
                        "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22550,
                            "rule_id": "kxUYE9",
                            "rv_id": 834034,
                            "url": "https://semgrep.dev/playground/r/ZRTlPdK/javascript.audit.detect-replaceall-sanitization.detect-replaceall-sanitization",
                            "version_id": "ZRTlPdK"
                        }
                    },
                    "shortlink": "https://sg.run/AzoB",
                    "source": "https://semgrep.dev/r/javascript.audit.detect-replaceall-sanitization.detect-replaceall-sanitization",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "javascript",
                        "typescript"
                    ],
                    "vulnerability_class": [
                        "Cross-Site-Scripting (XSS)"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "replace",
                        "end": {
                            "col": 8,
                            "line": 1,
                            "offset": 7
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$FUNC": {
                        "abstract_content": "replaceAll",
                        "end": {
                            "col": 93,
                            "line": 59,
                            "offset": 2143
                        },
                        "start": {
                            "col": 83,
                            "line": 59,
                            "offset": 2133
                        }
                    },
                    "$STR": {
                        "abstract_content": "tableData[i].description.replaceAll('<''&lt;')",
                        "end": {
                            "col": 82,
                            "line": 59,
                            "offset": 2132
                        },
                        "start": {
                            "col": 34,
                            "line": 59,
                            "offset": 2084
                        }
                    }
                },
                "severity": "INFO",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/data/static/codefixes/restfulXssChallenge_2.ts",
            "start": {
                "col": 34,
                "line": 59,
                "offset": 2084
            }
        },
        {
            "check_id": "javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 159,
                "line": 6,
                "offset": 472
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "criteria",
                            "location": {
                                "end": {
                                    "col": 17,
                                    "line": 3,
                                    "offset": 128
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/unionSqlInjectionChallenge_1.ts",
                                "start": {
                                    "col": 9,
                                    "line": 3,
                                    "offset": 120
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 159,
                                    "line": 6,
                                    "offset": 472
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/unionSqlInjectionChallenge_1.ts",
                                "start": {
                                    "col": 28,
                                    "line": 6,
                                    "offset": 341
                                }
                            },
                            "`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 69,
                                    "line": 3,
                                    "offset": 180
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/unionSqlInjectionChallenge_1.ts",
                                "start": {
                                    "col": 60,
                                    "line": 3,
                                    "offset": 171
                                }
                            },
                            "req.query"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "35c918857d6903e944da7c3a349447050efe0f3a912e5a436f28b2dc92851381e84e6a32171dde29a5150a78b726a48e95cab6b741cfb13e2dda56073c2a46de_0",
                "is_ignored": false,
                "lines": "    models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)",
                "message": "Detected a sequelize statement that is tainted by user-input. This could lead to SQL injection if the variable is user-controlled and is not properly sanitized. In order to prevent SQL injection, it is recommended to use parameterized queries or prepared statements.",
                "metadata": {
                    "category": "security",
                    "confidence": "HIGH",
                    "cwe": [
                        "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "HIGH",
                    "interfile": true,
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://sequelize.org/docs/v6/core-concepts/raw-queries/#replacements"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22085,
                            "rule_id": "yyU0GX",
                            "rv_id": 834186,
                            "url": "https://semgrep.dev/playground/r/w8TAxwx/javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
                            "version_id": "w8TAxwx"
                        }
                    },
                    "shortlink": "https://sg.run/gjoe",
                    "source": "https://semgrep.dev/r/javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "SQL Injection"
                    ]
                },
                "metavars": {
                    "$DB": {
                        "abstract_content": "models",
                        "end": {
                            "col": 11,
                            "line": 6,
                            "offset": 324
                        },
                        "start": {
                            "col": 5,
                            "line": 6,
                            "offset": 318
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 44,
                            "line": 2,
                            "offset": 90
                        },
                        "start": {
                            "col": 40,
                            "line": 2,
                            "offset": 86
                        }
                    },
                    "$QUERY": {
                        "abstract_content": "`SELECT * FROM Products WHERE ((name LIKE '%criteria%' OR description LIKE '%criteria%') AND deletedAt IS NULL) ORDER BY name",
                        "end": {
                            "col": 159,
                            "line": 6,
                            "offset": 472
                        },
                        "start": {
                            "col": 28,
                            "line": 6,
                            "offset": 341
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 63,
                            "line": 3,
                            "offset": 174
                        },
                        "start": {
                            "col": 60,
                            "line": 3,
                            "offset": 171
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 28,
                            "line": 2,
                            "offset": 74
                        },
                        "start": {
                            "col": 25,
                            "line": 2,
                            "offset": 71
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/data/static/codefixes/unionSqlInjectionChallenge_1.ts",
            "start": {
                "col": 28,
                "line": 6,
                "offset": 341
            }
        },
        {
            "check_id": "javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 82,
                "line": 6,
                "offset": 395
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "criteria",
                            "location": {
                                "end": {
                                    "col": 17,
                                    "line": 3,
                                    "offset": 128
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/unionSqlInjectionChallenge_1.ts",
                                "start": {
                                    "col": 9,
                                    "line": 3,
                                    "offset": 120
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 82,
                                    "line": 6,
                                    "offset": 395
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/unionSqlInjectionChallenge_1.ts",
                                "start": {
                                    "col": 74,
                                    "line": 6,
                                    "offset": 387
                                }
                            },
                            "criteria"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 69,
                                    "line": 3,
                                    "offset": 180
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/unionSqlInjectionChallenge_1.ts",
                                "start": {
                                    "col": 60,
                                    "line": 3,
                                    "offset": 171
                                }
                            },
                            "req.query"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "0b2903b0fb095d244526b76df747bb3f88ee4dec848e27fc40d9a8d7adb7a5491c9997480fc08d2e9b0ec67af40d46c24be68d1de87c99aaf0e52e70f47407e7_0",
                "is_ignored": false,
                "lines": "    models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)",
                "message": "Detected user input used to manually construct a SQL string. This is usually bad practice because manual construction could accidentally result in a SQL injection. An attacker could use a SQL injection to steal or modify contents of the database. Instead, use a parameterized query which is available by default in most database engines. Alternatively, consider using an object-relational mapper (ORM) such as Sequelize which will protect your queries.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/SQL_Injection"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 14715,
                            "rule_id": "NbUNpr",
                            "rv_id": 834108,
                            "url": "https://semgrep.dev/playground/r/DkTG0jd/javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
                            "version_id": "DkTG0jd"
                        }
                    },
                    "shortlink": "https://sg.run/66ZL",
                    "source": "https://semgrep.dev/r/javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "SQL Injection"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "SELECT",
                        "end": {
                            "col": 7,
                            "line": 1,
                            "offset": 6
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$EXPR": {
                        "abstract_content": "criteria",
                        "end": {
                            "col": 82,
                            "line": 6,
                            "offset": 395
                        },
                        "start": {
                            "col": 74,
                            "line": 6,
                            "offset": 387
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 63,
                            "line": 3,
                            "offset": 174
                        },
                        "start": {
                            "col": 60,
                            "line": 3,
                            "offset": 171
                        }
                    },
                    "$SQLSTR": {
                        "abstract_content": "SELECT * FROM Products WHERE ((name LIKE '%",
                        "end": {
                            "col": 72,
                            "line": 6,
                            "offset": 385
                        },
                        "start": {
                            "col": 29,
                            "line": 6,
                            "offset": 342
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/data/static/codefixes/unionSqlInjectionChallenge_1.ts",
            "start": {
                "col": 74,
                "line": 6,
                "offset": 387
            }
        },
        {
            "check_id": "javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 159,
                "line": 10,
                "offset": 608
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "criteria",
                            "location": {
                                "end": {
                                    "col": 17,
                                    "line": 3,
                                    "offset": 128
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/unionSqlInjectionChallenge_3.ts",
                                "start": {
                                    "col": 9,
                                    "line": 3,
                                    "offset": 120
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 159,
                                    "line": 10,
                                    "offset": 608
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/unionSqlInjectionChallenge_3.ts",
                                "start": {
                                    "col": 28,
                                    "line": 10,
                                    "offset": 477
                                }
                            },
                            "`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 69,
                                    "line": 3,
                                    "offset": 180
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/unionSqlInjectionChallenge_3.ts",
                                "start": {
                                    "col": 60,
                                    "line": 3,
                                    "offset": 171
                                }
                            },
                            "req.query"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "97975c12241a991d3fed70f924de7169984eb7ec78d427b2baa57956e7cbb5b3bf1573d2c51bdeafb01f322e20377f67b93d72788c82a98e4366b45d0f5e3d02_0",
                "is_ignored": false,
                "lines": "    models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)",
                "message": "Detected a sequelize statement that is tainted by user-input. This could lead to SQL injection if the variable is user-controlled and is not properly sanitized. In order to prevent SQL injection, it is recommended to use parameterized queries or prepared statements.",
                "metadata": {
                    "category": "security",
                    "confidence": "HIGH",
                    "cwe": [
                        "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "HIGH",
                    "interfile": true,
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://sequelize.org/docs/v6/core-concepts/raw-queries/#replacements"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22085,
                            "rule_id": "yyU0GX",
                            "rv_id": 834186,
                            "url": "https://semgrep.dev/playground/r/w8TAxwx/javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
                            "version_id": "w8TAxwx"
                        }
                    },
                    "shortlink": "https://sg.run/gjoe",
                    "source": "https://semgrep.dev/r/javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "SQL Injection"
                    ]
                },
                "metavars": {
                    "$DB": {
                        "abstract_content": "models",
                        "end": {
                            "col": 11,
                            "line": 10,
                            "offset": 460
                        },
                        "start": {
                            "col": 5,
                            "line": 10,
                            "offset": 454
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 44,
                            "line": 2,
                            "offset": 90
                        },
                        "start": {
                            "col": 40,
                            "line": 2,
                            "offset": 86
                        }
                    },
                    "$QUERY": {
                        "abstract_content": "`SELECT * FROM Products WHERE ((name LIKE '%criteria%' OR description LIKE '%criteria%') AND deletedAt IS NULL) ORDER BY name",
                        "end": {
                            "col": 159,
                            "line": 10,
                            "offset": 608
                        },
                        "start": {
                            "col": 28,
                            "line": 10,
                            "offset": 477
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 63,
                            "line": 3,
                            "offset": 174
                        },
                        "start": {
                            "col": 60,
                            "line": 3,
                            "offset": 171
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 28,
                            "line": 2,
                            "offset": 74
                        },
                        "start": {
                            "col": 25,
                            "line": 2,
                            "offset": 71
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/data/static/codefixes/unionSqlInjectionChallenge_3.ts",
            "start": {
                "col": 28,
                "line": 10,
                "offset": 477
            }
        },
        {
            "check_id": "javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 82,
                "line": 10,
                "offset": 531
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "criteria",
                            "location": {
                                "end": {
                                    "col": 17,
                                    "line": 3,
                                    "offset": 128
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/unionSqlInjectionChallenge_3.ts",
                                "start": {
                                    "col": 9,
                                    "line": 3,
                                    "offset": 120
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 82,
                                    "line": 10,
                                    "offset": 531
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/unionSqlInjectionChallenge_3.ts",
                                "start": {
                                    "col": 74,
                                    "line": 10,
                                    "offset": 523
                                }
                            },
                            "criteria"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 69,
                                    "line": 3,
                                    "offset": 180
                                },
                                "path": "TypeScript/juice-shop/data/static/codefixes/unionSqlInjectionChallenge_3.ts",
                                "start": {
                                    "col": 60,
                                    "line": 3,
                                    "offset": 171
                                }
                            },
                            "req.query"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "4d60885c66db8ac6a3e1698a62f3a9398bcfd32f32ca59193834624362b9e5457ec43d04e72ec1f49a83980b127ab9a97d76aac5e17c8bcb0ad1b9c445931449_0",
                "is_ignored": false,
                "lines": "    models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`)",
                "message": "Detected user input used to manually construct a SQL string. This is usually bad practice because manual construction could accidentally result in a SQL injection. An attacker could use a SQL injection to steal or modify contents of the database. Instead, use a parameterized query which is available by default in most database engines. Alternatively, consider using an object-relational mapper (ORM) such as Sequelize which will protect your queries.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/SQL_Injection"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 14715,
                            "rule_id": "NbUNpr",
                            "rv_id": 834108,
                            "url": "https://semgrep.dev/playground/r/DkTG0jd/javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
                            "version_id": "DkTG0jd"
                        }
                    },
                    "shortlink": "https://sg.run/66ZL",
                    "source": "https://semgrep.dev/r/javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "SQL Injection"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "SELECT",
                        "end": {
                            "col": 7,
                            "line": 1,
                            "offset": 6
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$EXPR": {
                        "abstract_content": "criteria",
                        "end": {
                            "col": 82,
                            "line": 10,
                            "offset": 531
                        },
                        "start": {
                            "col": 74,
                            "line": 10,
                            "offset": 523
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 63,
                            "line": 3,
                            "offset": 174
                        },
                        "start": {
                            "col": 60,
                            "line": 3,
                            "offset": 171
                        }
                    },
                    "$SQLSTR": {
                        "abstract_content": "SELECT * FROM Products WHERE ((name LIKE '%",
                        "end": {
                            "col": 72,
                            "line": 10,
                            "offset": 521
                        },
                        "start": {
                            "col": 29,
                            "line": 10,
                            "offset": 478
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/data/static/codefixes/unionSqlInjectionChallenge_3.ts",
            "start": {
                "col": 74,
                "line": 10,
                "offset": 523
            }
        },
        {
            "check_id": "generic.secrets.security.detected-generic-secret.detected-generic-secret",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 47,
                "line": 150,
                "offset": 3689
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "70be7fa6721ce21df9756e53b697f35aae86ddd05b0fe7c932030938ff577902c3d04f9332cd685b5eb528be5a6ac9fd5b046cb78d236e36e5eb99aac87d3b6c_0",
                "is_ignored": false,
                "lines": "  totpSecret: IFTXE3SPOEYVURT2MRYGI52TKJ4HC3KH",
                "message": "Generic Secret detected",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-798: Use of Hard-coded Credentials"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A07:2021 - Identification and Authentication Failures"
                    ],
                    "references": [
                        "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9057,
                            "rule_id": "r6Urqe",
                            "rv_id": 833768,
                            "url": "https://semgrep.dev/playground/r/6xTDg3J/generic.secrets.security.detected-generic-secret.detected-generic-secret",
                            "version_id": "6xTDg3J"
                        }
                    },
                    "shortlink": "https://sg.run/l2o5",
                    "source": "https://semgrep.dev/r/generic.secrets.security.detected-generic-secret.detected-generic-secret",
                    "source-rule-url": "https://github.com/dxa4481/truffleHogRegexes/blob/master/truffleHogRegexes/regexes.json",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "secrets"
                    ],
                    "vulnerability_class": [
                        "Hard-coded Secrets"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "IFTXE3SPOEYVURT2MRYGI52TKJ4HC3KH",
                        "end": {
                            "col": 47,
                            "line": 150,
                            "offset": 3689
                        },
                        "start": {
                            "col": 15,
                            "line": 150,
                            "offset": 3657
                        }
                    },
                    "$SECRET": {
                        "abstract_content": "IFTXE3SPOEYVURT2MRYGI52TKJ4HC3KH",
                        "end": {
                            "col": 47,
                            "line": 150,
                            "offset": 3689
                        },
                        "start": {
                            "col": 15,
                            "line": 150,
                            "offset": 3657
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/data/static/users.yml",
            "start": {
                "col": 7,
                "line": 150,
                "offset": 3649
            }
        },
        {
            "check_id": "javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 65,
                "line": 7,
                "offset": 258
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "file",
                            "location": {
                                "end": {
                                    "col": 43,
                                    "line": 6,
                                    "offset": 181
                                },
                                "path": "TypeScript/juice-shop/data/staticData.ts",
                                "start": {
                                    "col": 39,
                                    "line": 6,
                                    "offset": 177
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 65,
                                    "line": 7,
                                    "offset": 258
                                },
                                "path": "TypeScript/juice-shop/data/staticData.ts",
                                "start": {
                                    "col": 33,
                                    "line": 7,
                                    "offset": 226
                                }
                            },
                            "'./data/static/' + file + '.yml'"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 43,
                                    "line": 6,
                                    "offset": 181
                                },
                                "path": "TypeScript/juice-shop/data/staticData.ts",
                                "start": {
                                    "col": 39,
                                    "line": 6,
                                    "offset": 177
                                }
                            },
                            "file"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "7e54042bc681eb4443dcc50214da66641183e0703a9c75b74e0c585e837768f5d08f478fe913d363baf25e789870b63847a76ad479dbfaf3f40121660d27123b_0",
                "is_ignored": false,
                "lines": "  const filePath = path.resolve('./data/static/' + file + '.yml')",
                "message": "Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9331,
                            "rule_id": "8GUjrq",
                            "rv_id": 834146,
                            "url": "https://semgrep.dev/playground/r/JdTlrjW/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                            "version_id": "JdTlrjW"
                        }
                    },
                    "shortlink": "https://sg.run/OPqk",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$PATH": {
                        "abstract_content": "path",
                        "end": {
                            "col": 24,
                            "line": 7,
                            "offset": 217
                        },
                        "start": {
                            "col": 20,
                            "line": 7,
                            "offset": 213
                        }
                    },
                    "$SINK": {
                        "abstract_content": "'./data/static/'+file+'.yml'",
                        "end": {
                            "col": 65,
                            "line": 7,
                            "offset": 258
                        },
                        "start": {
                            "col": 33,
                            "line": 7,
                            "offset": 226
                        }
                    },
                    "$X": {
                        "abstract_content": "file",
                        "end": {
                            "col": 43,
                            "line": 6,
                            "offset": 181
                        },
                        "start": {
                            "col": 39,
                            "line": 6,
                            "offset": 177
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/data/staticData.ts",
            "start": {
                "col": 33,
                "line": 7,
                "offset": 226
            }
        },
        {
            "check_id": "generic.secrets.security.detected-jwt-token.detected-jwt-token",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 148,
                "line": 40,
                "offset": 1517
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "dc77d45af6cb9c005f88fe4fd304f68091e4e45ce9f708867ed784f3ddf76619af2e0ebb74b49001d14e086ef2b19d8338f969f9b2199681c988b9756424d5d5_0",
                "is_ignored": false,
                "lines": "    localStorage.setItem('token', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c')",
                "message": "JWT token detected",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-321: Use of Hard-coded Cryptographic Key"
                    ],
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A02:2021 - Cryptographic Failures"
                    ],
                    "references": [
                        "https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 12854,
                            "rule_id": "kxU8E8",
                            "rv_id": 833777,
                            "url": "https://semgrep.dev/playground/r/yeTN18Q/generic.secrets.security.detected-jwt-token.detected-jwt-token",
                            "version_id": "yeTN18Q"
                        }
                    },
                    "shortlink": "https://sg.run/05N5",
                    "source": "https://semgrep.dev/r/generic.secrets.security.detected-jwt-token.detected-jwt-token",
                    "source-rule-url": "https://github.com/Yelp/detect-secrets/blob/master/detect_secrets/plugins/jwt.py",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "secrets",
                        "jwt"
                    ],
                    "vulnerability_class": [
                        "Cryptographic Issues"
                    ]
                },
                "metavars": {},
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/frontend/src/app/app.guard.spec.ts",
            "start": {
                "col": 36,
                "line": 40,
                "offset": 1405
            }
        },
        {
            "check_id": "generic.secrets.security.detected-jwt-token.detected-jwt-token",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 120,
                "line": 50,
                "offset": 1798
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "0e9fc696b1cb26e3582b43825c7d647e6a299dd7464d9377f42e35d42db258a9d865db7e79c2490a5a6bb46db50cead66ceae4d32378cf55f36987393ea6df03_0",
                "is_ignored": false,
                "lines": "    localStorage.setItem('token', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7Imxhc3RMb2dpbklwIjoiMS4yLjMuNCJ9fQ.RAkmdqwNypuOxv3SDjPO4xMKvd1CddKvDFYDBfUt3bg')",
                "message": "JWT token detected",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-321: Use of Hard-coded Cryptographic Key"
                    ],
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A02:2021 - Cryptographic Failures"
                    ],
                    "references": [
                        "https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 12854,
                            "rule_id": "kxU8E8",
                            "rv_id": 833777,
                            "url": "https://semgrep.dev/playground/r/yeTN18Q/generic.secrets.security.detected-jwt-token.detected-jwt-token",
                            "version_id": "yeTN18Q"
                        }
                    },
                    "shortlink": "https://sg.run/05N5",
                    "source": "https://semgrep.dev/r/generic.secrets.security.detected-jwt-token.detected-jwt-token",
                    "source-rule-url": "https://github.com/Yelp/detect-secrets/blob/master/detect_secrets/plugins/jwt.py",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "secrets",
                        "jwt"
                    ],
                    "vulnerability_class": [
                        "Cryptographic Issues"
                    ]
                },
                "metavars": {},
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/frontend/src/app/last-login-ip/last-login-ip.component.spec.ts",
            "start": {
                "col": 36,
                "line": 50,
                "offset": 1714
            }
        },
        {
            "check_id": "generic.secrets.security.detected-jwt-token.detected-jwt-token",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 89,
                "line": 56,
                "offset": 2214
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "0e9fc696b1cb26e3582b43825c7d647e6a299dd7464d9377f42e35d42db258a9d865db7e79c2490a5a6bb46db50cead66ceae4d32378cf55f36987393ea6df03_1",
                "is_ignored": false,
                "lines": "    localStorage.setItem('token', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7fX0.bVBhvll6IaeR3aUdoOeyR8YZe2S2DfhGAxTGfd9enLw')",
                "message": "JWT token detected",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-321: Use of Hard-coded Cryptographic Key"
                    ],
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A02:2021 - Cryptographic Failures"
                    ],
                    "references": [
                        "https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 12854,
                            "rule_id": "kxU8E8",
                            "rv_id": 833777,
                            "url": "https://semgrep.dev/playground/r/yeTN18Q/generic.secrets.security.detected-jwt-token.detected-jwt-token",
                            "version_id": "yeTN18Q"
                        }
                    },
                    "shortlink": "https://sg.run/05N5",
                    "source": "https://semgrep.dev/r/generic.secrets.security.detected-jwt-token.detected-jwt-token",
                    "source-rule-url": "https://github.com/Yelp/detect-secrets/blob/master/detect_secrets/plugins/jwt.py",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "secrets",
                        "jwt"
                    ],
                    "vulnerability_class": [
                        "Cryptographic Issues"
                    ]
                },
                "metavars": {},
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/frontend/src/app/last-login-ip/last-login-ip.component.spec.ts",
            "start": {
                "col": 36,
                "line": 56,
                "offset": 2161
            }
        },
        {
            "check_id": "typescript.angular.angular-route-bypass-security-trust.angular-route-bypass-security-trust",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 75,
                "line": 151,
                "offset": 6575
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "queryParam",
                            "location": {
                                "end": {
                                    "col": 19,
                                    "line": 144,
                                    "offset": 6150
                                },
                                "path": "TypeScript/juice-shop/frontend/src/app/search-result/search-result.component.ts",
                                "start": {
                                    "col": 9,
                                    "line": 144,
                                    "offset": 6140
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 75,
                                    "line": 151,
                                    "offset": 6575
                                },
                                "path": "TypeScript/juice-shop/frontend/src/app/search-result/search-result.component.ts",
                                "start": {
                                    "col": 65,
                                    "line": 151,
                                    "offset": 6565
                                }
                            },
                            "queryParam"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 61,
                                    "line": 144,
                                    "offset": 6192
                                },
                                "path": "TypeScript/juice-shop/frontend/src/app/search-result/search-result.component.ts",
                                "start": {
                                    "col": 30,
                                    "line": 144,
                                    "offset": 6161
                                }
                            },
                            "this.route.snapshot.queryParams"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "b622bfba09ed982049de014aec796021055f0d6db9f57c09a8e8fe6ca2316000193703afdcf0e6c906668c3e65a0374854233ab6cdbe6e2209b97e3da4339fe4_0",
                "is_ignored": false,
                "lines": "      this.searchValue = this.sanitizer.bypassSecurityTrustHtml(queryParam) // vuln-code-snippet vuln-line localXssChallenge xssBonusChallenge",
                "message": "Untrusted input could be used to tamper with a web page rendering, which can lead to a Cross-site scripting (XSS) vulnerability. XSS vulnerabilities occur when untrusted input executes malicious JavaScript code, leading to issues such as account compromise and sensitive information leakage. Validate the user input, perform contextual output encoding, or sanitize the input. A popular library used to prevent XSS is DOMPurify. You can also use libraries and frameworks such as Angular, Vue, and React, which offer secure defaults when rendering input.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "functional-categories": [
                        "web::source::http-params::angular",
                        "web::source::http-body::angular",
                        "web::source::header::angular",
                        "web::source::url-path-params::angular",
                        "web::sink::html-webpage::angular"
                    ],
                    "impact": "MEDIUM",
                    "interfile": true,
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A07:2017 - Cross-Site Scripting (XSS)",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://angular.io/api/router/ActivatedRoute",
                        "https://angular.io/api/router/ActivatedRouteSnapshot",
                        "https://angular.io/api/platform-browser/DomSanitizer"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 40346,
                            "rule_id": "GdUWew",
                            "rv_id": 851224,
                            "url": "https://semgrep.dev/playground/r/K3TrNE2/typescript.angular.angular-route-bypass-security-trust.angular-route-bypass-security-trust",
                            "version_id": "K3TrNE2"
                        }
                    },
                    "shortlink": "https://sg.run/JpBW",
                    "source": "https://semgrep.dev/r/typescript.angular.angular-route-bypass-security-trust.angular-route-bypass-security-trust",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "angular"
                    ],
                    "vulnerability_class": [
                        "Cross-Site-Scripting (XSS)"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "queryParams",
                        "end": {
                            "col": 12,
                            "line": 1,
                            "offset": 11
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$BYPASS": {
                        "abstract_content": "bypassSecurityTrustHtml",
                        "end": {
                            "col": 64,
                            "line": 151,
                            "offset": 6564
                        },
                        "start": {
                            "col": 41,
                            "line": 151,
                            "offset": 6541
                        }
                    },
                    "$FOO": {
                        "abstract_content": "queryParam",
                        "end": {
                            "col": 75,
                            "line": 151,
                            "offset": 6575
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "queryParam.trim()",
                            "svalue_end": {
                                "col": 37,
                                "line": 146,
                                "offset": 6255
                            },
                            "svalue_start": {
                                "col": 20,
                                "line": 146,
                                "offset": 6238
                            }
                        },
                        "start": {
                            "col": 65,
                            "line": 151,
                            "offset": 6565
                        }
                    },
                    "$SN": {
                        "abstract_content": "this.route",
                        "end": {
                            "col": 40,
                            "line": 144,
                            "offset": 6171
                        },
                        "start": {
                            "col": 30,
                            "line": 144,
                            "offset": 6161
                        }
                    },
                    "$X": {
                        "abstract_content": "queryParams",
                        "end": {
                            "col": 61,
                            "line": 144,
                            "offset": 6192
                        },
                        "start": {
                            "col": 50,
                            "line": 144,
                            "offset": 6181
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/frontend/src/app/search-result/search-result.component.ts",
            "start": {
                "col": 65,
                "line": 151,
                "offset": 6565
            }
        },
        {
            "check_id": "javascript.lang.security.audit.prototype-pollution.prototype-pollution-loop.prototype-pollution-loop",
            "TP": 0,
            "FP": 1,
            "end": {
                "col": 54,
                "line": 38,
                "offset": 1109
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "4aabc6d5a201263ee0422f5cc6df2a8cdee1023e224a805ea7e27e33a2d5f26eb4fcedc7aa135049c21db6e691ea55c72672975b563690a26f0c92153773e9f1_0",
                "is_ignored": false,
                "lines": "        replacementValue = replacementValue[property]",
                "message": "Possibility of prototype polluting function detected. By adding or modifying attributes of an object prototype, it is possible to create attributes that exist on every object, or replace critical attributes with malicious ones. This can be problematic if the software depends on existence or non-existence of certain attributes, or uses pre-defined attributes of object prototype (such as hasOwnProperty, toString or valueOf). Possible mitigations might be: freezing the object prototype, using an object without prototypes (via Object.create(null) ), blocking modifications of attributes that resolve to object prototype, using Map instead of object.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-915: Improperly Controlled Modification of Dynamically-Determined Object Attributes"
                    ],
                    "impact": "LOW",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A08:2021 - Software and Data Integrity Failures"
                    ],
                    "references": [
                        "https://github.com/HoLyVieR/prototype-pollution-nsec18/blob/master/paper/JavaScript_prototype_pollution_attack_in_NodeJS.pdf"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 13373,
                            "rule_id": "QrUpbJ",
                            "rv_id": 834148,
                            "url": "https://semgrep.dev/playground/r/GxTDERG/javascript.lang.security.audit.prototype-pollution.prototype-pollution-loop.prototype-pollution-loop",
                            "version_id": "GxTDERG"
                        }
                    },
                    "shortlink": "https://sg.run/w1DB",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.prototype-pollution.prototype-pollution-loop.prototype-pollution-loop",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "typescript"
                    ],
                    "vulnerability_class": [
                        "Mass Assignment"
                    ]
                },
                "metavars": {
                    "$A": {
                        "abstract_content": "property",
                        "end": {
                            "col": 53,
                            "line": 38,
                            "offset": 1108
                        },
                        "start": {
                            "col": 45,
                            "line": 38,
                            "offset": 1100
                        }
                    },
                    "$SMTH": {
                        "abstract_content": "replacementValue",
                        "end": {
                            "col": 25,
                            "line": 38,
                            "offset": 1080
                        },
                        "start": {
                            "col": 9,
                            "line": 38,
                            "offset": 1064
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/frontend/src/hacking-instructor/helpers/helpers.ts",
            "start": {
                "col": 9,
                "line": 38,
                "offset": 1064
            }
        },
        {
            "check_id": "javascript.browser.security.insecure-document-method.insecure-document-method",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 43,
                "line": 111,
                "offset": 3733
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "59e0cc15643affd19541795cf1ce4b9ceecbdfc08bde84a5e05da4e5d0f69f62ddf9e021f2152bbed341465ab3fd7efdc964f279e4c79f6a61cea15de09cda70_0",
                "is_ignored": false,
                "lines": "  textBox.innerHTML = snarkdown(hint.text)",
                "message": "User controlled data in methods like `innerHTML`, `outerHTML` or `document.write` is an anti-pattern that can lead to XSS vulnerabilities",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "LOW",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A07:2017 - Cross-Site Scripting (XSS)",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/Top10/A03_2021-Injection"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9239,
                            "rule_id": "ReUg41",
                            "rv_id": 834049,
                            "url": "https://semgrep.dev/playground/r/A8T37l8/javascript.browser.security.insecure-document-method.insecure-document-method",
                            "version_id": "A8T37l8"
                        }
                    },
                    "shortlink": "https://sg.run/LwA9",
                    "source": "https://semgrep.dev/r/javascript.browser.security.insecure-document-method.insecure-document-method",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "browser"
                    ],
                    "vulnerability_class": [
                        "Cross-Site-Scripting (XSS)"
                    ]
                },
                "metavars": {
                    "$EL": {
                        "abstract_content": "textBox",
                        "end": {
                            "col": 10,
                            "line": 111,
                            "offset": 3700
                        },
                        "start": {
                            "col": 3,
                            "line": 111,
                            "offset": 3693
                        }
                    },
                    "$HTML": {
                        "abstract_content": "snarkdown(hint.text)",
                        "end": {
                            "col": 43,
                            "line": 111,
                            "offset": 3733
                        },
                        "start": {
                            "col": 23,
                            "line": 111,
                            "offset": 3713
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/frontend/src/hacking-instructor/index.ts",
            "start": {
                "col": 3,
                "line": 111,
                "offset": 3693
            }
        },
        {
            "check_id": "html.security.audit.missing-integrity.missing-integrity",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 127,
                "line": 14,
                "offset": 631
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "6723e9cea48321c35ca3254eb25d4eb4249b261827fc65446c9a85d124a31cbb98a1bbef2a317c7fb455d880c805023cae25f6b4980dc5614d5c4b359fa8f187_0",
                "is_ignored": false,
                "lines": "  <link rel=\"stylesheet\" type=\"text/css\" href=\"//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css\" />",
                "message": "This tag is missing an 'integrity' subresource integrity attribute. The 'integrity' attribute allows for the browser to verify that externally hosted files (for example from a CDN) are delivered without unexpected manipulation. Without this attribute, if an attacker can modify the externally hosted resource, this could lead to XSS and other types of attacks. To prevent this, include the base64-encoded cryptographic hash of the resource (file) you\u2019re telling the browser to fetch in the 'integrity' attribute for all externally hosted files.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-353: Missing Support for Integrity Check"
                    ],
                    "impact": "LOW",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A08:2021 - Software and Data Integrity Failures"
                    ],
                    "references": [
                        "https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 13728,
                            "rule_id": "AbUQzj",
                            "rv_id": 833890,
                            "url": "https://semgrep.dev/playground/r/nWTy4vO/html.security.audit.missing-integrity.missing-integrity",
                            "version_id": "nWTy4vO"
                        }
                    },
                    "shortlink": "https://sg.run/krXA",
                    "source": "https://semgrep.dev/r/html.security.audit.missing-integrity.missing-integrity",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "html"
                    ],
                    "vulnerability_class": [
                        "Cryptographic Issues"
                    ]
                },
                "metavars": {
                    "$...A": {
                        "abstract_content": " rel=\"stylesheet\" type=\"text/css\" href=\"//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css\" /",
                        "end": {
                            "col": 126,
                            "line": 14,
                            "offset": 630
                        },
                        "start": {
                            "col": 8,
                            "line": 14,
                            "offset": 512
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/frontend/src/index.html",
            "start": {
                "col": 3,
                "line": 14,
                "offset": 507
            }
        },
        {
            "check_id": "html.security.audit.missing-integrity.missing-integrity",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 101,
                "line": 15,
                "offset": 733
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "96c8d4a0ab0d6fd4cbe4fd12def45aa94129dbbc080e6ef81595ec4ca146649ad77afe62665213ca27abfbb805e00de413f50a10ee01825940ecc3fb8d79f045_0",
                "is_ignored": false,
                "lines": "  <script src=\"//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js\"></script>",
                "message": "This tag is missing an 'integrity' subresource integrity attribute. The 'integrity' attribute allows for the browser to verify that externally hosted files (for example from a CDN) are delivered without unexpected manipulation. Without this attribute, if an attacker can modify the externally hosted resource, this could lead to XSS and other types of attacks. To prevent this, include the base64-encoded cryptographic hash of the resource (file) you\u2019re telling the browser to fetch in the 'integrity' attribute for all externally hosted files.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-353: Missing Support for Integrity Check"
                    ],
                    "impact": "LOW",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A08:2021 - Software and Data Integrity Failures"
                    ],
                    "references": [
                        "https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 13728,
                            "rule_id": "AbUQzj",
                            "rv_id": 833890,
                            "url": "https://semgrep.dev/playground/r/nWTy4vO/html.security.audit.missing-integrity.missing-integrity",
                            "version_id": "nWTy4vO"
                        }
                    },
                    "shortlink": "https://sg.run/krXA",
                    "source": "https://semgrep.dev/r/html.security.audit.missing-integrity.missing-integrity",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "html"
                    ],
                    "vulnerability_class": [
                        "Cryptographic Issues"
                    ]
                },
                "metavars": {
                    "$...A": {
                        "abstract_content": " src=\"//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js\"",
                        "end": {
                            "col": 91,
                            "line": 15,
                            "offset": 723
                        },
                        "start": {
                            "col": 10,
                            "line": 15,
                            "offset": 642
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/frontend/src/index.html",
            "start": {
                "col": 3,
                "line": 15,
                "offset": 635
            }
        },
        {
            "check_id": "html.security.audit.missing-integrity.missing-integrity",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 86,
                "line": 16,
                "offset": 820
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "577897923f185fb10388e1548ea729931ed93ec5a6881b9bbaa6654960067b18ff365bf19bc08097bc4ef5bc0b277bbf29b80516ab35c686ee0589833f7543ca_0",
                "is_ignored": false,
                "lines": "  <script src=\"//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js\"></script>",
                "message": "This tag is missing an 'integrity' subresource integrity attribute. The 'integrity' attribute allows for the browser to verify that externally hosted files (for example from a CDN) are delivered without unexpected manipulation. Without this attribute, if an attacker can modify the externally hosted resource, this could lead to XSS and other types of attacks. To prevent this, include the base64-encoded cryptographic hash of the resource (file) you\u2019re telling the browser to fetch in the 'integrity' attribute for all externally hosted files.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-353: Missing Support for Integrity Check"
                    ],
                    "impact": "LOW",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A08:2021 - Software and Data Integrity Failures"
                    ],
                    "references": [
                        "https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 13728,
                            "rule_id": "AbUQzj",
                            "rv_id": 833890,
                            "url": "https://semgrep.dev/playground/r/nWTy4vO/html.security.audit.missing-integrity.missing-integrity",
                            "version_id": "nWTy4vO"
                        }
                    },
                    "shortlink": "https://sg.run/krXA",
                    "source": "https://semgrep.dev/r/html.security.audit.missing-integrity.missing-integrity",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "html"
                    ],
                    "vulnerability_class": [
                        "Cryptographic Issues"
                    ]
                },
                "metavars": {
                    "$...A": {
                        "abstract_content": " src=\"//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js\"",
                        "end": {
                            "col": 76,
                            "line": 16,
                            "offset": 810
                        },
                        "start": {
                            "col": 10,
                            "line": 16,
                            "offset": 744
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/frontend/src/index.html",
            "start": {
                "col": 3,
                "line": 16,
                "offset": 737
            }
        },
        {
            "check_id": "javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 48,
                "line": 24,
                "offset": 787
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "paths",
                            "location": {
                                "end": {
                                    "col": 56,
                                    "line": 18,
                                    "offset": 471
                                },
                                "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
                                "start": {
                                    "col": 51,
                                    "line": 18,
                                    "offset": 466
                                }
                            }
                        },
                        {
                            "content": "currPath",
                            "location": {
                                "end": {
                                    "col": 22,
                                    "line": 20,
                                    "offset": 563
                                },
                                "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
                                "start": {
                                    "col": 14,
                                    "line": 20,
                                    "offset": 555
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 48,
                                    "line": 24,
                                    "offset": 787
                                },
                                "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
                                "start": {
                                    "col": 40,
                                    "line": 24,
                                    "offset": 779
                                }
                            },
                            "currPath"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 56,
                                    "line": 18,
                                    "offset": 471
                                },
                                "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
                                "start": {
                                    "col": 51,
                                    "line": 18,
                                    "offset": 466
                                }
                            },
                            "paths"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "707e3f0426ee3d7fbf900aa9340d3f0d877c77e77645d9718304c74720871290f71bc4dace0cc0c8d2d2b54abe84d77e894691d1c93395d725c23c81e1ff46bb_0",
                "is_ignored": false,
                "lines": "        files.map(file => path.resolve(currPath, file))",
                "message": "Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9331,
                            "rule_id": "8GUjrq",
                            "rv_id": 834146,
                            "url": "https://semgrep.dev/playground/r/JdTlrjW/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                            "version_id": "JdTlrjW"
                        }
                    },
                    "shortlink": "https://sg.run/OPqk",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$PATH": {
                        "abstract_content": "path",
                        "end": {
                            "col": 31,
                            "line": 24,
                            "offset": 770
                        },
                        "start": {
                            "col": 27,
                            "line": 24,
                            "offset": 766
                        }
                    },
                    "$SINK": {
                        "abstract_content": "currPath",
                        "end": {
                            "col": 48,
                            "line": 24,
                            "offset": 787
                        },
                        "start": {
                            "col": 40,
                            "line": 24,
                            "offset": 779
                        }
                    },
                    "$X": {
                        "abstract_content": "paths",
                        "end": {
                            "col": 56,
                            "line": 18,
                            "offset": 471
                        },
                        "start": {
                            "col": 51,
                            "line": 18,
                            "offset": 466
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
            "start": {
                "col": 40,
                "line": 24,
                "offset": 779
            }
        },
        {
            "check_id": "javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 54,
                "line": 24,
                "offset": 793
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "file",
                            "location": {
                                "end": {
                                    "col": 23,
                                    "line": 24,
                                    "offset": 762
                                },
                                "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
                                "start": {
                                    "col": 19,
                                    "line": 24,
                                    "offset": 758
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 54,
                                    "line": 24,
                                    "offset": 793
                                },
                                "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
                                "start": {
                                    "col": 50,
                                    "line": 24,
                                    "offset": 789
                                }
                            },
                            "file"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 23,
                                    "line": 24,
                                    "offset": 762
                                },
                                "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
                                "start": {
                                    "col": 19,
                                    "line": 24,
                                    "offset": 758
                                }
                            },
                            "file"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "51110895886cd24882c0627c98e46856ab2715e4276b1f42689b01f52981597a005d052a388ce0b1ae9a1e782485aa84f991c0351fc3bc27d8847878b8bc6e98_0",
                "is_ignored": false,
                "lines": "        files.map(file => path.resolve(currPath, file))",
                "message": "Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9331,
                            "rule_id": "8GUjrq",
                            "rv_id": 834146,
                            "url": "https://semgrep.dev/playground/r/JdTlrjW/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                            "version_id": "JdTlrjW"
                        }
                    },
                    "shortlink": "https://sg.run/OPqk",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$PATH": {
                        "abstract_content": "path",
                        "end": {
                            "col": 31,
                            "line": 24,
                            "offset": 770
                        },
                        "start": {
                            "col": 27,
                            "line": 24,
                            "offset": 766
                        }
                    },
                    "$SINK": {
                        "abstract_content": "file",
                        "end": {
                            "col": 54,
                            "line": 24,
                            "offset": 793
                        },
                        "start": {
                            "col": 50,
                            "line": 24,
                            "offset": 789
                        }
                    },
                    "$X": {
                        "abstract_content": "file",
                        "end": {
                            "col": 23,
                            "line": 24,
                            "offset": 762
                        },
                        "start": {
                            "col": 19,
                            "line": 24,
                            "offset": 758
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
            "start": {
                "col": 50,
                "line": 24,
                "offset": 789
            }
        },
        {
            "check_id": "javascript.lang.security.audit.detect-non-literal-regexp.detect-non-literal-regexp",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 67,
                "line": 76,
                "offset": 3108
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "challengeKey",
                            "location": {
                                "end": {
                                    "col": 73,
                                    "line": 58,
                                    "offset": 2042
                                },
                                "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
                                "start": {
                                    "col": 61,
                                    "line": 58,
                                    "offset": 2030
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 67,
                                    "line": 76,
                                    "offset": 3108
                                },
                                "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
                                "start": {
                                    "col": 9,
                                    "line": 76,
                                    "offset": 3050
                                }
                            },
                            "new RegExp(`vuln-code-snippet vuln-line.*${challengeKey}`)"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 73,
                                    "line": 58,
                                    "offset": 2042
                                },
                                "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
                                "start": {
                                    "col": 61,
                                    "line": 58,
                                    "offset": 2030
                                }
                            },
                            "challengeKey"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "c19df80dc6cda72278d00e2cabd01c151dc3299d9728f9ce6ac70b6bacb84612120bd6233014c1d5d83bd279d982dd6b1f7316bfb1f33e8a8bd141a630e894f8_0",
                "is_ignored": false,
                "lines": "    if (new RegExp(`vuln-code-snippet vuln-line.*${challengeKey}`).exec(lines[i]) != null) {",
                "message": "RegExp() called with a `challengeKey` function argument, this might allow an attacker to cause a Regular Expression Denial-of-Service (ReDoS) within your application as RegExP blocks the main thread. For this reason, it is recommended to use hardcoded regexes instead. If your regex is run on user-controlled input, consider performing input validation or use a regex checking/sanitization library such as https://www.npmjs.com/package/recheck to verify that the regex does not appear vulnerable to ReDoS.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-1333: Inefficient Regular Expression Complexity"
                    ],
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "MEDIUM",
                    "owasp": [
                        "A05:2021 - Security Misconfiguration",
                        "A06:2017 - Security Misconfiguration"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 12685,
                            "rule_id": "zdU1gD",
                            "rv_id": 834140,
                            "url": "https://semgrep.dev/playground/r/8KTGkZw/javascript.lang.security.audit.detect-non-literal-regexp.detect-non-literal-regexp",
                            "version_id": "8KTGkZw"
                        }
                    },
                    "shortlink": "https://sg.run/gr65",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.detect-non-literal-regexp.detect-non-literal-regexp",
                    "source-rule-url": "https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-non-literal-regexp.js",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript"
                    ],
                    "vulnerability_class": [
                        "Denial-of-Service (DoS)"
                    ]
                },
                "metavars": {
                    "$ARG": {
                        "abstract_content": "challengeKey",
                        "end": {
                            "col": 73,
                            "line": 58,
                            "offset": 2042
                        },
                        "start": {
                            "col": 61,
                            "line": 58,
                            "offset": 2030
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
            "start": {
                "col": 9,
                "line": 76,
                "offset": 3050
            }
        },
        {
            "check_id": "javascript.lang.security.audit.detect-non-literal-regexp.detect-non-literal-regexp",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 77,
                "line": 78,
                "offset": 3241
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "challengeKey",
                            "location": {
                                "end": {
                                    "col": 73,
                                    "line": 58,
                                    "offset": 2042
                                },
                                "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
                                "start": {
                                    "col": 61,
                                    "line": 58,
                                    "offset": 2030
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 77,
                                    "line": 78,
                                    "offset": 3241
                                },
                                "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
                                "start": {
                                    "col": 16,
                                    "line": 78,
                                    "offset": 3180
                                }
                            },
                            "new RegExp(`vuln-code-snippet neutral-line.*${challengeKey}`)"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 73,
                                    "line": 58,
                                    "offset": 2042
                                },
                                "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
                                "start": {
                                    "col": 61,
                                    "line": 58,
                                    "offset": 2030
                                }
                            },
                            "challengeKey"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "c19df80dc6cda72278d00e2cabd01c151dc3299d9728f9ce6ac70b6bacb84612120bd6233014c1d5d83bd279d982dd6b1f7316bfb1f33e8a8bd141a630e894f8_1",
                "is_ignored": false,
                "lines": "    } else if (new RegExp(`vuln-code-snippet neutral-line.*${challengeKey}`).exec(lines[i]) != null) {",
                "message": "RegExp() called with a `challengeKey` function argument, this might allow an attacker to cause a Regular Expression Denial-of-Service (ReDoS) within your application as RegExP blocks the main thread. For this reason, it is recommended to use hardcoded regexes instead. If your regex is run on user-controlled input, consider performing input validation or use a regex checking/sanitization library such as https://www.npmjs.com/package/recheck to verify that the regex does not appear vulnerable to ReDoS.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-1333: Inefficient Regular Expression Complexity"
                    ],
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "MEDIUM",
                    "owasp": [
                        "A05:2021 - Security Misconfiguration",
                        "A06:2017 - Security Misconfiguration"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 12685,
                            "rule_id": "zdU1gD",
                            "rv_id": 834140,
                            "url": "https://semgrep.dev/playground/r/8KTGkZw/javascript.lang.security.audit.detect-non-literal-regexp.detect-non-literal-regexp",
                            "version_id": "8KTGkZw"
                        }
                    },
                    "shortlink": "https://sg.run/gr65",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.detect-non-literal-regexp.detect-non-literal-regexp",
                    "source-rule-url": "https://github.com/nodesecurity/eslint-plugin-security/blob/master/rules/detect-non-literal-regexp.js",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript"
                    ],
                    "vulnerability_class": [
                        "Denial-of-Service (DoS)"
                    ]
                },
                "metavars": {
                    "$ARG": {
                        "abstract_content": "challengeKey",
                        "end": {
                            "col": 73,
                            "line": 58,
                            "offset": 2042
                        },
                        "start": {
                            "col": 61,
                            "line": 58,
                            "offset": 2030
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/lib/codingChallenges.ts",
            "start": {
                "col": 16,
                "line": 78,
                "offset": 3180
            }
        },
        {
            "check_id": "javascript.lang.hardcoded.strings.detected-private-key.detected-private-key",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 901,
                "line": 23,
                "offset": 1721
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "67ad0696eff48c828a54bfef68775657514a9d27657aba95ea53bd504be3e009bc7f51061f2229f152e708459976401522a01c8d80f86d03269c423e328caaf5_0",
                "is_ignored": false,
                "lines": "const privateKey = '-----BEGIN RSA PRIVATE KEY-----\\r\\nMIICXAIBAAKBgQDNwqLEe9wgTXCbC7+RPdDbBbeqjdbs4kOPOIGzqLpXvJXlxxW8iMz0EaM4BKUqYsIa+ndv3NAn2RxCd5ubVdJJcX43zO6Ko0TFEZx/65gY3BE0O6syCEmUP4qbSd6exou/F+WTISzbQ5FBVPVmhnYhG/kpwt/cIxK5iUn5hm+4tQIDAQABAoGBAI+8xiPoOrA+KMnG/T4jJsG6TsHQcDHvJi7o1IKC/hnIXha0atTX5AUkRRce95qSfvKFweXdJXSQ0JMGJyfuXgU6dI0TcseFRfewXAa/ssxAC+iUVR6KUMh1PE2wXLitfeI6JLvVtrBYswm2I7CtY0q8n5AGimHWVXJPLfGV7m0BAkEA+fqFt2LXbLtyg6wZyxMA/cnmt5Nt3U2dAu77MzFJvibANUNHE4HPLZxjGNXN+a6m0K6TD4kDdh5HfUYLWWRBYQJBANK3carmulBwqzcDBjsJ0YrIONBpCAsXxk8idXb8jL9aNIg15Wumm2enqqObahDHB5jnGOLmbasizvSVqypfM9UCQCQl8xIqy+YgURXzXCN+kwUgHinrutZms87Jyi+D8Br8NY0+Nlf+zHvXAomD2W5CsEK7C+8SLBr3k/TsnRWHJuECQHFE9RA2OP8WoaLPuGCyFXaxzICThSRZYluVnWkZtxsBhW2W8z1b8PvWUE7kMy7TnkzeJS2LSnaNHoyxi7IaPQUCQCwWU4U+v4lD7uYBw00Ga/xt+7+UqFPlPVdz1yyr4q24Zxaw0LgmuEvgU5dycq8N7JxjTubX0MIRR+G9fmDBBl8=\\r\\n-----END RSA PRIVATE KEY-----'",
                "message": "A secret is hard-coded in the application. Secrets stored in source code, such as credentials, identifiers, and other types of sensitive data, can be leaked and used by internal or external malicious actors. Use environment variables to securely provide credentials and other secrets or retrieve them from a secure vault or Hardware Security Module (HSM).",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-798: Use of Hard-coded Credentials"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "interfile": true,
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "MEDIUM",
                    "owasp": [
                        "A07:2021 - Identification and Authentication Failures"
                    ],
                    "references": [
                        "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 40963,
                            "rule_id": "6JUA6p",
                            "rv_id": 850641,
                            "url": "https://semgrep.dev/playground/r/jQTrO17/javascript.lang.hardcoded.strings.detected-private-key.detected-private-key",
                            "version_id": "jQTrO17"
                        }
                    },
                    "shortlink": "https://sg.run/2dRY",
                    "source": "https://semgrep.dev/r/javascript.lang.hardcoded.strings.detected-private-key.detected-private-key",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "secrets",
                        "rsa"
                    ],
                    "vulnerability_class": [
                        "Hard-coded Secrets"
                    ]
                },
                "metavars": {
                    "$X": {
                        "abstract_content": "-----BEGIN RSA PRIVATE KEY-----\\r\\nMIICXAIBAAKBgQDNwqLEe9wgTXCbC7+RPdDbBbeqjdbs4kOPOIGzqLpXvJXlxxW8iMz0EaM4BKUqYsIa+ndv3NAn2RxCd5ubVdJJcX43zO6Ko0TFEZx/65gY3BE0O6syCEmUP4qbSd6exou/F+WTISzbQ5FBVPVmhnYhG/kpwt/cIxK5iUn5hm+4tQIDAQABAoGBAI+8xiPoOrA+KMnG/T4jJsG6TsHQcDHvJi7o1IKC/hnIXha0atTX5AUkRRce95qSfvKFweXdJXSQ0JMGJyfuXgU6dI0TcseFRfewXAa/ssxAC+iUVR6KUMh1PE2wXLitfeI6JLvVtrBYswm2I7CtY0q8n5AGimHWVXJPLfGV7m0BAkEA+fqFt2LXbLtyg6wZyxMA/cnmt5Nt3U2dAu77MzFJvibANUNHE4HPLZxjGNXN+a6m0K6TD4kDdh5HfUYLWWRBYQJBANK3carmulBwqzcDBjsJ0YrIONBpCAsXxk8idXb8jL9aNIg15Wumm2enqqObahDHB5jnGOLmbasizvSVqypfM9UCQCQl8xIqy+YgURXzXCN+kwUgHinrutZms87Jyi+D8Br8NY0+Nlf+zHvXAomD2W5CsEK7C+8SLBr3k/TsnRWHJuECQHFE9RA2OP8WoaLPuGCyFXaxzICThSRZYluVnWkZtxsBhW2W8z1b8PvWUE7kMy7TnkzeJS2LSnaNHoyxi7IaPQUCQCwWU4U+v4lD7uYBw00Ga/xt+7+UqFPlPVdz1yyr4q24Zxaw0LgmuEvgU5dycq8N7JxjTubX0MIRR+G9fmDBBl8=\\r\\n-----END RSA PRIVATE KEY-----",
                        "end": {
                            "col": 901,
                            "line": 23,
                            "offset": 1721
                        },
                        "start": {
                            "col": 21,
                            "line": 23,
                            "offset": 841
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/lib/insecurity.ts",
            "start": {
                "col": 21,
                "line": 23,
                "offset": 841
            }
        },
        {
            "check_id": "javascript.lang.security.audit.hardcoded-hmac-key.hardcoded-hmac-key",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 94,
                "line": 44,
                "offset": 2425
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "8ec0963510c360ffce69b6811cd62bc27a4ac51b52da18d4a0c8021472479426143d358747b7f3b748a4bb44f8ec9b28c0bf1c28bfb0dc08df9a733d2793f7ce_0",
                "is_ignored": false,
                "lines": "export const hmac = (data: string) => crypto.createHmac('sha256', 'pa4qacea4VK9t9nGv7yZtwmj').update(data).digest('hex')",
                "message": "Detected a hardcoded hmac key. Avoid hardcoding secrets and consider using an alternate option such as reading the secret from a config file or using an environment variable.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-798: Use of Hard-coded Credentials"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "LOW",
                    "interfile": true,
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A07:2021 - Identification and Authentication Failures"
                    ],
                    "references": [
                        "https://rules.sonarsource.com/javascript/RSPEC-2068",
                        "https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#key-management"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22555,
                            "rule_id": "v8UGEw",
                            "rv_id": 834143,
                            "url": "https://semgrep.dev/playground/r/3ZT3A1w/javascript.lang.security.audit.hardcoded-hmac-key.hardcoded-hmac-key",
                            "version_id": "3ZT3A1w"
                        }
                    },
                    "shortlink": "https://sg.run/K9bn",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.hardcoded-hmac-key.hardcoded-hmac-key",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "crypto",
                        "hmac"
                    ],
                    "vulnerability_class": [
                        "Hard-coded Secrets"
                    ]
                },
                "metavars": {
                    "$ALGO": {
                        "abstract_content": "'sha256'",
                        "end": {
                            "col": 65,
                            "line": 44,
                            "offset": 2396
                        },
                        "start": {
                            "col": 57,
                            "line": 44,
                            "offset": 2388
                        }
                    },
                    "$CRYPTO": {
                        "abstract_content": "crypto",
                        "end": {
                            "col": 45,
                            "line": 44,
                            "offset": 2376
                        },
                        "start": {
                            "col": 39,
                            "line": 44,
                            "offset": 2370
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/lib/insecurity.ts",
            "start": {
                "col": 39,
                "line": 44,
                "offset": 2370
            }
        },
        {
            "check_id": "javascript.jsonwebtoken.security.jwt-hardcode.hardcoded-jwt-secret",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 66,
                "line": 56,
                "offset": 2877
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "privateKey",
                            "location": {
                                "end": {
                                    "col": 17,
                                    "line": 23,
                                    "offset": 837
                                },
                                "path": "TypeScript/juice-shop/lib/insecurity.ts",
                                "start": {
                                    "col": 7,
                                    "line": 23,
                                    "offset": 827
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 66,
                                    "line": 56,
                                    "offset": 2877
                                },
                                "path": "TypeScript/juice-shop/lib/insecurity.ts",
                                "start": {
                                    "col": 56,
                                    "line": 56,
                                    "offset": 2867
                                }
                            },
                            "privateKey"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 902,
                                    "line": 23,
                                    "offset": 1722
                                },
                                "path": "TypeScript/juice-shop/lib/insecurity.ts",
                                "start": {
                                    "col": 7,
                                    "line": 23,
                                    "offset": 827
                                }
                            },
                            "privateKey = '-----BEGIN RSA PRIVATE KEY-----\\r\\nMIICXAIBAAKBgQDNwqLEe9wgTXCbC7+RPdDbBbeqjdbs4kOPOIGzqLpXvJXlxxW8iMz0EaM4BKUqYsIa+ndv3NAn2RxCd5ubVdJJcX43zO6Ko0TFEZx/65gY3BE0O6syCEmUP4qbSd6exou/F+WTISzbQ5FBVPVmhnYhG/kpwt/cIxK5iUn5hm+4tQIDAQABAoGBAI+8xiPoOrA+KMnG/T4jJsG6TsHQcDHvJi7o1IKC/hnIXha0atTX5AUkRRce95qSfvKFweXdJXSQ0JMGJyfuXgU6dI0TcseFRfewXAa/ssxAC+iUVR6KUMh1PE2wXLitfeI6JLvVtrBYswm2I7CtY0q8n5AGimHWVXJPLfGV7m0BAkEA+fqFt2LXbLtyg6wZyxMA/cnmt5Nt3U2dAu77MzFJvibANUNHE4HPLZxjGNXN+a6m0K6TD4kDdh5HfUYLWWRBYQJBANK3carmulBwqzcDBjsJ0YrIONBpCAsXxk8idXb8jL9aNIg15Wumm2enqqObahDHB5jnGOLmbasizvSVqypfM9UCQCQl8xIqy+YgURXzXCN+kwUgHinrutZms87Jyi+D8Br8NY0+Nlf+zHvXAomD2W5CsEK7C+8SLBr3k/TsnRWHJuECQHFE9RA2OP8WoaLPuGCyFXaxzICThSRZYluVnWkZtxsBhW2W8z1b8PvWUE7kMy7TnkzeJS2LSnaNHoyxi7IaPQUCQCwWU4U+v4lD7uYBw00Ga/xt+7+UqFPlPVdz1yyr4q24Zxaw0LgmuEvgU5dycq8N7JxjTubX0MIRR+G9fmDBBl8=\\r\\n-----END RSA PRIVATE KEY-----'"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "9625ffe1e59593540c0aa80cd3999dd49f7a47d1224c0aeb4c8bd6dca43b2efc110d682e3570e04cac4562a924fd5e82993bc1c4e898d2116bdf471b23647e5d_0",
                "is_ignored": false,
                "lines": "export const authorize = (user = {}) => jwt.sign(user, privateKey, { expiresIn: '6h', algorithm: 'RS256' })",
                "message": "A hard-coded credential was detected. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).",
                "metadata": {
                    "asvs": {
                        "control_id": "3.5.2 Static API keys or secret",
                        "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x12-V3-Session-management.md#v35-token-based-session-management",
                        "section": "V3: Session Management Verification Requirements",
                        "version": "4"
                    },
                    "category": "security",
                    "confidence": "HIGH",
                    "cwe": [
                        "CWE-798: Use of Hard-coded Credentials"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A07:2021 - Identification and Authentication Failures"
                    ],
                    "references": [
                        "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9300,
                            "rule_id": "WAUon7",
                            "rv_id": 834122,
                            "url": "https://semgrep.dev/playground/r/1QTPLvy/javascript.jsonwebtoken.security.jwt-hardcode.hardcoded-jwt-secret",
                            "version_id": "1QTPLvy"
                        }
                    },
                    "shortlink": "https://sg.run/4xN9",
                    "source": "https://semgrep.dev/r/javascript.jsonwebtoken.security.jwt-hardcode.hardcoded-jwt-secret",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "jwt",
                        "javascript",
                        "secrets"
                    ],
                    "vulnerability_class": [
                        "Hard-coded Secrets"
                    ]
                },
                "metavars": {
                    "$DATA": {
                        "abstract_content": "user",
                        "end": {
                            "col": 54,
                            "line": 56,
                            "offset": 2865
                        },
                        "start": {
                            "col": 50,
                            "line": 56,
                            "offset": 2861
                        }
                    },
                    "$JWT": {
                        "abstract_content": "jwt",
                        "end": {
                            "col": 44,
                            "line": 56,
                            "offset": 2855
                        },
                        "start": {
                            "col": 41,
                            "line": 56,
                            "offset": 2852
                        }
                    },
                    "$VALUE": {
                        "abstract_content": "privateKey",
                        "end": {
                            "col": 66,
                            "line": 56,
                            "offset": 2877
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "'-----BEGIN RSA PRIVATE KEY-----\\r\\nMIICXAIBAAKBgQDNwqLEe9wgTXCbC7+RPdDbBbeqjdbs4kOPOIGzqLpXvJXlxxW8iMz0EaM4BKUqYsIa+ndv3NAn2RxCd5ubVdJJcX43zO6Ko0TFEZx/65gY3BE0O6syCEmUP4qbSd6exou/F+WTISzbQ5FBVPVmhnYhG/kpwt/cIxK5iUn5hm+4tQIDAQABAoGBAI+8xiPoOrA+KMnG/T4jJsG6TsHQcDHvJi7o1IKC/hnIXha0atTX5AUkRRce95qSfvKFweXdJXSQ0JMGJyfuXgU6dI0TcseFRfewXAa/ssxAC+iUVR6KUMh1PE2wXLitfeI6JLvVtrBYswm2I7CtY0q8n5AGimHWVXJPLfGV7m0BAkEA+fqFt2LXbLtyg6wZyxMA/cnmt5Nt3U2dAu77MzFJvibANUNHE4HPLZxjGNXN+a6m0K6TD4kDdh5HfUYLWWRBYQJBANK3carmulBwqzcDBjsJ0YrIONBpCAsXxk8idXb8jL9aNIg15Wumm2enqqObahDHB5jnGOLmbasizvSVqypfM9UCQCQl8xIqy+YgURXzXCN+kwUgHinrutZms87Jyi+D8Br8NY0+Nlf+zHvXAomD2W5CsEK7C+8SLBr3k/TsnRWHJuECQHFE9RA2OP8WoaLPuGCyFXaxzICThSRZYluVnWkZtxsBhW2W8z1b8PvWUE7kMy7TnkzeJS2LSnaNHoyxi7IaPQUCQCwWU4U+v4lD7uYBw00Ga/xt+7+UqFPlPVdz1yyr4q24Zxaw0LgmuEvgU5dycq8N7JxjTubX0MIRR+G9fmDBBl8=\\r\\n-----END RSA PRIVATE KEY-----'",
                            "svalue_end": {
                                "col": 902,
                                "line": 23,
                                "offset": 1722
                            },
                            "svalue_start": {
                                "col": 20,
                                "line": 23,
                                "offset": 840
                            }
                        },
                        "start": {
                            "col": 56,
                            "line": 56,
                            "offset": 2867
                        }
                    },
                    "$X": {
                        "abstract_content": "privateKey",
                        "end": {
                            "col": 17,
                            "line": 23,
                            "offset": 837
                        },
                        "start": {
                            "col": 7,
                            "line": 23,
                            "offset": 827
                        }
                    },
                    "$Y": {
                        "abstract_content": "-----BEGIN RSA PRIVATE KEY-----\\r\\nMIICXAIBAAKBgQDNwqLEe9wgTXCbC7+RPdDbBbeqjdbs4kOPOIGzqLpXvJXlxxW8iMz0EaM4BKUqYsIa+ndv3NAn2RxCd5ubVdJJcX43zO6Ko0TFEZx/65gY3BE0O6syCEmUP4qbSd6exou/F+WTISzbQ5FBVPVmhnYhG/kpwt/cIxK5iUn5hm+4tQIDAQABAoGBAI+8xiPoOrA+KMnG/T4jJsG6TsHQcDHvJi7o1IKC/hnIXha0atTX5AUkRRce95qSfvKFweXdJXSQ0JMGJyfuXgU6dI0TcseFRfewXAa/ssxAC+iUVR6KUMh1PE2wXLitfeI6JLvVtrBYswm2I7CtY0q8n5AGimHWVXJPLfGV7m0BAkEA+fqFt2LXbLtyg6wZyxMA/cnmt5Nt3U2dAu77MzFJvibANUNHE4HPLZxjGNXN+a6m0K6TD4kDdh5HfUYLWWRBYQJBANK3carmulBwqzcDBjsJ0YrIONBpCAsXxk8idXb8jL9aNIg15Wumm2enqqObahDHB5jnGOLmbasizvSVqypfM9UCQCQl8xIqy+YgURXzXCN+kwUgHinrutZms87Jyi+D8Br8NY0+Nlf+zHvXAomD2W5CsEK7C+8SLBr3k/TsnRWHJuECQHFE9RA2OP8WoaLPuGCyFXaxzICThSRZYluVnWkZtxsBhW2W8z1b8PvWUE7kMy7TnkzeJS2LSnaNHoyxi7IaPQUCQCwWU4U+v4lD7uYBw00Ga/xt+7+UqFPlPVdz1yyr4q24Zxaw0LgmuEvgU5dycq8N7JxjTubX0MIRR+G9fmDBBl8=\\r\\n-----END RSA PRIVATE KEY-----",
                        "end": {
                            "col": 901,
                            "line": 23,
                            "offset": 1721
                        },
                        "start": {
                            "col": 21,
                            "line": 23,
                            "offset": 841
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/lib/insecurity.ts",
            "start": {
                "col": 56,
                "line": 56,
                "offset": 2867
            }
        },
        {
            "check_id": "javascript.lang.security.audit.hardcoded-hmac-key.hardcoded-hmac-key",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 55,
                "line": 152,
                "offset": 6469
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "8ec0963510c360ffce69b6811cd62bc27a4ac51b52da18d4a0c8021472479426143d358747b7f3b748a4bb44f8ec9b28c0bf1c28bfb0dc08df9a733d2793f7ce_1",
                "is_ignored": false,
                "lines": "  const hmac = crypto.createHmac('sha256', privateKey)",
                "message": "Detected a hardcoded hmac key. Avoid hardcoding secrets and consider using an alternate option such as reading the secret from a config file or using an environment variable.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-798: Use of Hard-coded Credentials"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "LOW",
                    "interfile": true,
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A07:2021 - Identification and Authentication Failures"
                    ],
                    "references": [
                        "https://rules.sonarsource.com/javascript/RSPEC-2068",
                        "https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#key-management"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22555,
                            "rule_id": "v8UGEw",
                            "rv_id": 834143,
                            "url": "https://semgrep.dev/playground/r/3ZT3A1w/javascript.lang.security.audit.hardcoded-hmac-key.hardcoded-hmac-key",
                            "version_id": "3ZT3A1w"
                        }
                    },
                    "shortlink": "https://sg.run/K9bn",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.hardcoded-hmac-key.hardcoded-hmac-key",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "crypto",
                        "hmac"
                    ],
                    "vulnerability_class": [
                        "Hard-coded Secrets"
                    ]
                },
                "metavars": {
                    "$ALGO": {
                        "abstract_content": "'sha256'",
                        "end": {
                            "col": 42,
                            "line": 152,
                            "offset": 6456
                        },
                        "start": {
                            "col": 34,
                            "line": 152,
                            "offset": 6448
                        }
                    },
                    "$CRYPTO": {
                        "abstract_content": "crypto",
                        "end": {
                            "col": 22,
                            "line": 152,
                            "offset": 6436
                        },
                        "start": {
                            "col": 16,
                            "line": 152,
                            "offset": 6430
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/lib/insecurity.ts",
            "start": {
                "col": 16,
                "line": 152,
                "offset": 6430
            }
        },
        {
            "check_id": "javascript.express.session-fixation.session-fixation",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 36,
                "line": 195,
                "offset": 8113
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "token",
                            "location": {
                                "end": {
                                    "col": 14,
                                    "line": 189,
                                    "offset": 7808
                                },
                                "path": "TypeScript/juice-shop/lib/insecurity.ts",
                                "start": {
                                    "col": 9,
                                    "line": 189,
                                    "offset": 7803
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 36,
                                    "line": 195,
                                    "offset": 8113
                                },
                                "path": "TypeScript/juice-shop/lib/insecurity.ts",
                                "start": {
                                    "col": 31,
                                    "line": 195,
                                    "offset": 8108
                                }
                            },
                            "token"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 28,
                                    "line": 189,
                                    "offset": 7822
                                },
                                "path": "TypeScript/juice-shop/lib/insecurity.ts",
                                "start": {
                                    "col": 17,
                                    "line": 189,
                                    "offset": 7811
                                }
                            },
                            "req.cookies"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "41400aeb697177aaab3bc129cb2fbd162628e7cb2205c735f2f4b663a7afe9ec3a9da11cbc7849e0f0d958676986b1b6cd9e9267f0219410625781a19a9dfd64_0",
                "is_ignored": false,
                "lines": "          res.cookie('token', token)",
                "message": "Detected `req` argument which enters `res.cookie`, this can lead to session fixation vulnerabilities if an attacker can control the cookie value. This vulnerability can lead to unauthorized access to accounts, and in some esoteric cases, Cross-Site-Scripting (XSS). Users should not be able to influence cookies directly, for session cookies, they should be generated securely using an approved session management library. If the cookie does need to be set by a user, consider using an allow-list based approach to restrict the cookies which can be set.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-384: Session Fixation"
                    ],
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "web::sink::session-properties::express"
                    ],
                    "impact": "MEDIUM",
                    "interfile": true,
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A02:2017 - Broken Authentication",
                        "A07:2021 - Identification and Authentication Failures"
                    ],
                    "references": [
                        "https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures",
                        "https://owasp.org/www-community/attacks/Session_fixation"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 43798,
                            "rule_id": "10UnRQ",
                            "rv_id": 850630,
                            "url": "https://semgrep.dev/playground/r/0bTwWGZ/javascript.express.session-fixation.session-fixation",
                            "version_id": "0bTwWGZ"
                        }
                    },
                    "shortlink": "https://sg.run/0qDv",
                    "source": "https://semgrep.dev/r/javascript.express.session-fixation.session-fixation",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript",
                        "express",
                        "nodejs"
                    ],
                    "vulnerability_class": [
                        "Other"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "cookie",
                        "end": {
                            "col": 7,
                            "line": 1,
                            "offset": 6
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$HEADER": {
                        "abstract_content": "cookie",
                        "end": {
                            "col": 21,
                            "line": 195,
                            "offset": 8098
                        },
                        "start": {
                            "col": 15,
                            "line": 195,
                            "offset": 8092
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 20,
                            "line": 189,
                            "offset": 7814
                        },
                        "start": {
                            "col": 17,
                            "line": 189,
                            "offset": 7811
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 14,
                            "line": 195,
                            "offset": 8091
                        },
                        "start": {
                            "col": 11,
                            "line": 195,
                            "offset": 8088
                        }
                    },
                    "$SOURCE": {
                        "abstract_content": "token",
                        "end": {
                            "col": 36,
                            "line": 195,
                            "offset": 8113
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "req.cookies.token||utils.jwtFrom(req)",
                            "svalue_end": {
                                "col": 56,
                                "line": 189,
                                "offset": 7850
                            },
                            "svalue_start": {
                                "col": 17,
                                "line": 189,
                                "offset": 7811
                            }
                        },
                        "start": {
                            "col": 31,
                            "line": 195,
                            "offset": 8108
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/lib/insecurity.ts",
            "start": {
                "col": 31,
                "line": 195,
                "offset": 8108
            }
        },
        {
            "check_id": "javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 105,
                "line": 28,
                "offset": 1021
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "filename",
                            "location": {
                                "end": {
                                    "col": 32,
                                    "line": 27,
                                    "offset": 901
                                },
                                "path": "TypeScript/juice-shop/lib/startup/restoreOverwrittenFilesWithOriginals.ts",
                                "start": {
                                    "col": 24,
                                    "line": 27,
                                    "offset": 893
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 105,
                                    "line": 28,
                                    "offset": 1021
                                },
                                "path": "TypeScript/juice-shop/lib/startup/restoreOverwrittenFilesWithOriginals.ts",
                                "start": {
                                    "col": 56,
                                    "line": 28,
                                    "offset": 972
                                }
                            },
                            "filename.substring(filename.lastIndexOf('/') + 1)"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 32,
                                    "line": 27,
                                    "offset": 901
                                },
                                "path": "TypeScript/juice-shop/lib/startup/restoreOverwrittenFilesWithOriginals.ts",
                                "start": {
                                    "col": 24,
                                    "line": 27,
                                    "offset": 893
                                }
                            },
                            "filename"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "42b58a5a05be5f44297f81957dee54ab47f447aac9a516d4b6612b76b7e10a9d8babe92e4e520c9b74a21bb957d3fd7647a2a45fc592ebc855d3f703fccdfee4_0",
                "is_ignored": false,
                "lines": "        await copyFile(filename, path.resolve('i18n/', filename.substring(filename.lastIndexOf('/') + 1)))",
                "message": "Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9331,
                            "rule_id": "8GUjrq",
                            "rv_id": 834146,
                            "url": "https://semgrep.dev/playground/r/JdTlrjW/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                            "version_id": "JdTlrjW"
                        }
                    },
                    "shortlink": "https://sg.run/OPqk",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$PATH": {
                        "abstract_content": "path",
                        "end": {
                            "col": 38,
                            "line": 28,
                            "offset": 954
                        },
                        "start": {
                            "col": 34,
                            "line": 28,
                            "offset": 950
                        }
                    },
                    "$SINK": {
                        "abstract_content": "filename.substring(filename.lastIndexOf('/')+1)",
                        "end": {
                            "col": 105,
                            "line": 28,
                            "offset": 1021
                        },
                        "start": {
                            "col": 56,
                            "line": 28,
                            "offset": 972
                        }
                    },
                    "$X": {
                        "abstract_content": "filename",
                        "end": {
                            "col": 32,
                            "line": 27,
                            "offset": 901
                        },
                        "start": {
                            "col": 24,
                            "line": 27,
                            "offset": 893
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/lib/startup/restoreOverwrittenFilesWithOriginals.ts",
            "start": {
                "col": 56,
                "line": 28,
                "offset": 972
            }
        },
        {
            "check_id": "javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 61,
                "line": 120,
                "offset": 5193
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "pathRelativeToProjectRoot",
                            "location": {
                                "end": {
                                    "col": 74,
                                    "line": 117,
                                    "offset": 5014
                                },
                                "path": "TypeScript/juice-shop/lib/startup/validatePreconditions.ts",
                                "start": {
                                    "col": 49,
                                    "line": 117,
                                    "offset": 4989
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 61,
                                    "line": 120,
                                    "offset": 5193
                                },
                                "path": "TypeScript/juice-shop/lib/startup/validatePreconditions.ts",
                                "start": {
                                    "col": 36,
                                    "line": 120,
                                    "offset": 5168
                                }
                            },
                            "pathRelativeToProjectRoot"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 74,
                                    "line": 117,
                                    "offset": 5014
                                },
                                "path": "TypeScript/juice-shop/lib/startup/validatePreconditions.ts",
                                "start": {
                                    "col": 49,
                                    "line": 117,
                                    "offset": 4989
                                }
                            },
                            "pathRelativeToProjectRoot"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "ebeb396c27a10621ea80b7c803f5251ff4e3ef9bed6948b0b58223b0d9a751333ad14af54081c933cebd87ff88ff4e9220856b56f5ea458f2a3dd7abe1d809a0_0",
                "is_ignored": false,
                "lines": "  return await access(path.resolve(pathRelativeToProjectRoot)).then(() => {",
                "message": "Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9331,
                            "rule_id": "8GUjrq",
                            "rv_id": 834146,
                            "url": "https://semgrep.dev/playground/r/JdTlrjW/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                            "version_id": "JdTlrjW"
                        }
                    },
                    "shortlink": "https://sg.run/OPqk",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$PATH": {
                        "abstract_content": "path",
                        "end": {
                            "col": 27,
                            "line": 120,
                            "offset": 5159
                        },
                        "start": {
                            "col": 23,
                            "line": 120,
                            "offset": 5155
                        }
                    },
                    "$SINK": {
                        "abstract_content": "pathRelativeToProjectRoot",
                        "end": {
                            "col": 61,
                            "line": 120,
                            "offset": 5193
                        },
                        "start": {
                            "col": 36,
                            "line": 120,
                            "offset": 5168
                        }
                    },
                    "$X": {
                        "abstract_content": "pathRelativeToProjectRoot",
                        "end": {
                            "col": 74,
                            "line": 117,
                            "offset": 5014
                        },
                        "start": {
                            "col": 49,
                            "line": 117,
                            "offset": 4989
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/lib/startup/validatePreconditions.ts",
            "start": {
                "col": 36,
                "line": 120,
                "offset": 5168
            }
        },
        {
            "check_id": "javascript.jssha.jssha-sha1.jssha-sha1",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 44,
                "line": 90,
                "offset": 2913
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "e023b7b892a94447073e2ec0d9fec75ca1a1cdc6f3acf67060851d2969edb2bd9df2504b3ca0b3fc263f2fa0198197a5cc84daec740b3aca4caf3ed3fcb788a8_0",
                "is_ignored": false,
                "lines": "  const shaObj = new jsSHA('SHA-1', 'TEXT') // eslint-disable-line new-cap",
                "message": "The SHA1 hashing algorithm is considered to be weak. If this is used in any sensitive operation such as password hashing, or is used to ensure data integrity (collision sensitive) then you should use a stronger hashing algorithm. For passwords, consider using `Argon2id`, `scrypt`, or `bcrypt`. For data integrity, consider using `SHA-256`.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-327: Use of a Broken or Risky Cryptographic Algorithm"
                    ],
                    "functional-categories": [
                        "crypto::search::hash-algorithm::jssha"
                    ],
                    "impact": "MEDIUM",
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "LOW",
                    "owasp": [
                        "A03:2017 - Sensitive Data Exposure",
                        "A02:2021 - Cryptographic Failures"
                    ],
                    "references": [
                        "https://owasp.org/Top10/A02_2021-Cryptographic_Failures"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 46837,
                            "rule_id": "OrULl4",
                            "rv_id": 850632,
                            "url": "https://semgrep.dev/playground/r/qkTQlvg/javascript.jssha.jssha-sha1.jssha-sha1",
                            "version_id": "qkTQlvg"
                        }
                    },
                    "shortlink": "https://sg.run/ERyN",
                    "source": "https://semgrep.dev/r/javascript.jssha.jssha-sha1.jssha-sha1",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Cryptographic Issues"
                    ]
                },
                "metavars": {
                    "$X": {
                        "abstract_content": "jsSHA",
                        "end": {
                            "col": 27,
                            "line": 90,
                            "offset": 2896
                        },
                        "start": {
                            "col": 22,
                            "line": 90,
                            "offset": 2891
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/lib/utils.ts",
            "start": {
                "col": 18,
                "line": 90,
                "offset": 2887
            }
        },
        {
            "check_id": "javascript.sequelize.node-sequelize-hardcoded-secret-argument.node-sequelize-hardcoded-secret-argument",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 66,
                "line": 29,
                "offset": 1248
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "2e2c317a5a87747fd88fbb2bca993fa304a69526f26169deef181918648893cf653aa89494064a7327c8483c4a3e85f0ca9056111b6192cae0bdbeb362597c12_0",
                "is_ignored": false,
                "lines": "const sequelize = new Sequelize('database', 'username', 'password', {",
                "message": "A secret is hard-coded in the application. Secrets stored in source code, such as credentials, identifiers, and other types of sensitive data, can be leaked and used by internal or external malicious actors. Use environment variables to securely provide credentials and other secrets or retrieve them from a secure vault or Hardware Security Module (HSM).",
                "metadata": {
                    "category": "security",
                    "confidence": "HIGH",
                    "cwe": [
                        "CWE-798: Use of Hard-coded Credentials"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "interfile": true,
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A07:2021 - Identification and Authentication Failures"
                    ],
                    "references": [
                        "https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 37937,
                            "rule_id": "2ZUwo7",
                            "rv_id": 850657,
                            "url": "https://semgrep.dev/playground/r/ExTrBv4/javascript.sequelize.node-sequelize-hardcoded-secret-argument.node-sequelize-hardcoded-secret-argument",
                            "version_id": "ExTrBv4"
                        }
                    },
                    "shortlink": "https://sg.run/E7ZB",
                    "source": "https://semgrep.dev/r/javascript.sequelize.node-sequelize-hardcoded-secret-argument.node-sequelize-hardcoded-secret-argument",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "Sequelize",
                        "Nodejs",
                        "Secrets"
                    ],
                    "vulnerability_class": [
                        "Hard-coded Secrets"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "sequelize",
                        "end": {
                            "col": 10,
                            "line": 1,
                            "offset": 9
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$DB": {
                        "abstract_content": "'database'",
                        "end": {
                            "col": 43,
                            "line": 29,
                            "offset": 1225
                        },
                        "start": {
                            "col": 33,
                            "line": 29,
                            "offset": 1215
                        }
                    },
                    "$IMPORT": {
                        "abstract_content": "sequelize",
                        "end": {
                            "col": 50,
                            "line": 26,
                            "offset": 1153
                        },
                        "start": {
                            "col": 41,
                            "line": 26,
                            "offset": 1144
                        }
                    },
                    "$OPTS": {
                        "abstract_content": "{dialect'sqlite'retry{match[/SQLITE_BUSY/]name'query'max 5}transactionType Transaction.TYPES.IMMEDIATE storage'data/juiceshop.sqlite'logging false}",
                        "end": {
                            "col": 2,
                            "line": 39,
                            "offset": 1460
                        },
                        "start": {
                            "col": 69,
                            "line": 29,
                            "offset": 1251
                        }
                    },
                    "$PWD": {
                        "abstract_content": "password",
                        "end": {
                            "col": 66,
                            "line": 29,
                            "offset": 1248
                        },
                        "start": {
                            "col": 58,
                            "line": 29,
                            "offset": 1240
                        }
                    },
                    "$SQL": {
                        "abstract_content": "Sequelize",
                        "end": {
                            "col": 32,
                            "line": 29,
                            "offset": 1214
                        },
                        "start": {
                            "col": 23,
                            "line": 29,
                            "offset": 1205
                        }
                    },
                    "$USER": {
                        "abstract_content": "'username'",
                        "end": {
                            "col": 55,
                            "line": 29,
                            "offset": 1237
                        },
                        "start": {
                            "col": 45,
                            "line": 29,
                            "offset": 1227
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/models/index.ts",
            "start": {
                "col": 58,
                "line": 29,
                "offset": 1240
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-detect-notevil-usage.express-detect-notevil-usage",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 80,
                "line": 22,
                "offset": 929
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "d6c8cf6a9a66c1949683dff5368a8fdb8b2b43df8e4310f3c9b455a38f853d736d17eb8eeed2c4d9a2051e10c2ebdca2d5b6ff85aa7dcbca67d9bd6e4c5fcaf8_0",
                "is_ignored": false,
                "lines": "        vm.runInContext('safeEval(orderLinesData)', sandbox, { timeout: 2000 })",
                "message": "Detected usage of the `notevil` package, which is unmaintained and has vulnerabilities. Using any sort of `eval()` functionality can be very dangerous, but if you must, the `eval` package is an up to date alternative. Be sure that only trusted input reaches an `eval()` function.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-1104: Use of Unmaintained Third Party Components"
                    ],
                    "impact": "HIGH",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A06:2021 - Vulnerable and Outdated Components"
                    ],
                    "references": [
                        "https://github.com/mmckegg/notevil"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22553,
                            "rule_id": "OrUX9K",
                            "rv_id": 834067,
                            "url": "https://semgrep.dev/playground/r/K3Trqkz/javascript.express.security.audit.express-detect-notevil-usage.express-detect-notevil-usage",
                            "version_id": "K3Trqkz"
                        }
                    },
                    "shortlink": "https://sg.run/W70E",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-detect-notevil-usage.express-detect-notevil-usage",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "javascript",
                        "typescript"
                    ],
                    "vulnerability_class": [
                        "Other"
                    ]
                },
                "metavars": {
                    "$CMD": {
                        "abstract_content": "safeEval(orderLinesData)",
                        "end": {
                            "col": 50,
                            "line": 22,
                            "offset": 899
                        },
                        "start": {
                            "col": 26,
                            "line": 22,
                            "offset": 875
                        }
                    },
                    "$EVAL": {
                        "abstract_content": "safeEval",
                        "end": {
                            "col": 15,
                            "line": 13,
                            "offset": 435
                        },
                        "start": {
                            "col": 7,
                            "line": 13,
                            "offset": 427
                        }
                    },
                    "$VM": {
                        "abstract_content": "vm",
                        "end": {
                            "col": 11,
                            "line": 22,
                            "offset": 860
                        },
                        "start": {
                            "col": 9,
                            "line": 22,
                            "offset": 858
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/b2bOrder.ts",
            "start": {
                "col": 9,
                "line": 22,
                "offset": 858
            }
        },
        {
            "check_id": "javascript.browser.security.eval-detected.eval-detected",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 36,
                "line": 23,
                "offset": 950
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "61c98a1866507dd061c89d82319494e3c60cbf76a76c96d5aad87593f4d7d428311a2aa08ab2640b073379b3e0181b17d7fbc94b66ba7376d5159196bf77658e_0",
                "is_ignored": false,
                "lines": "    const answer = eval(expression).toString() // eslint-disable-line no-eval",
                "message": "Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.",
                "metadata": {
                    "asvs": {
                        "control_id": "5.2.4 Dynamic Code Execution Features",
                        "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing",
                        "section": "V5 Validation, Sanitization and Encoding",
                        "version": "4"
                    },
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
                    ],
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/Top10/A03_2021-Injection"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9238,
                            "rule_id": "GdU7dw",
                            "rv_id": 834048,
                            "url": "https://semgrep.dev/playground/r/RGTKGx8/javascript.browser.security.eval-detected.eval-detected",
                            "version_id": "RGTKGx8"
                        }
                    },
                    "shortlink": "https://sg.run/7ope",
                    "source": "https://semgrep.dev/r/javascript.browser.security.eval-detected.eval-detected",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "browser"
                    ],
                    "vulnerability_class": [
                        "Code Injection"
                    ]
                },
                "metavars": {},
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/captcha.ts",
            "start": {
                "col": 20,
                "line": 23,
                "offset": 934
            }
        },
        {
            "check_id": "javascript.express.security.injection.raw-html-format.raw-html-format",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 56,
                "line": 198,
                "offset": 6353
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "token",
                            "location": {
                                "end": {
                                    "col": 16,
                                    "line": 167,
                                    "offset": 5499
                                },
                                "path": "TypeScript/juice-shop/routes/chatbot.ts",
                                "start": {
                                    "col": 11,
                                    "line": 167,
                                    "offset": 5494
                                }
                            }
                        },
                        {
                            "content": "user",
                            "location": {
                                "end": {
                                    "col": 15,
                                    "line": 176,
                                    "offset": 5789
                                },
                                "path": "TypeScript/juice-shop/routes/chatbot.ts",
                                "start": {
                                    "col": 11,
                                    "line": 176,
                                    "offset": 5785
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 56,
                                    "line": 198,
                                    "offset": 6353
                                },
                                "path": "TypeScript/juice-shop/routes/chatbot.ts",
                                "start": {
                                    "col": 46,
                                    "line": 198,
                                    "offset": 6343
                                }
                            },
                            "`${user.id"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 30,
                                    "line": 167,
                                    "offset": 5513
                                },
                                "path": "TypeScript/juice-shop/routes/chatbot.ts",
                                "start": {
                                    "col": 19,
                                    "line": 167,
                                    "offset": 5502
                                }
                            },
                            "req.cookies"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "3a145d6dad590b43c54eeabe727d75ac6d836d6c6fa7875f949bc0a87ceb324e6c3060aef48ff60e3e47a68187764996b68b128a43894196e6ef646c26b0f7c7_0",
                "is_ignored": false,
                "lines": "        body: bot.training.state ? bot.greet(`${user.id}`) : `${config.get<string>('application.chatBot.name')} isn't ready at the moment, please wait while I set things up`",
                "message": "User data flows into the host portion of this manually-constructed HTML. This can introduce a Cross-Site-Scripting (XSS) vulnerability if this comes from user-provided input. Consider using a sanitization library such as DOMPurify to sanitize the HTML within.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A07:2017 - Cross-Site Scripting (XSS)",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 14691,
                            "rule_id": "5rUL0X",
                            "rv_id": 834107,
                            "url": "https://semgrep.dev/playground/r/BjTe0Z2/javascript.express.security.injection.raw-html-format.raw-html-format",
                            "version_id": "BjTe0Z2"
                        }
                    },
                    "shortlink": "https://sg.run/5DO3",
                    "source": "https://semgrep.dev/r/javascript.express.security.injection.raw-html-format.raw-html-format",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "Cross-Site-Scripting (XSS)"
                    ]
                },
                "metavars": {
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 50,
                            "line": 159,
                            "offset": 5225
                        },
                        "start": {
                            "col": 46,
                            "line": 159,
                            "offset": 5221
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 22,
                            "line": 167,
                            "offset": 5505
                        },
                        "start": {
                            "col": 19,
                            "line": 167,
                            "offset": 5502
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 34,
                            "line": 159,
                            "offset": 5209
                        },
                        "start": {
                            "col": 31,
                            "line": 159,
                            "offset": 5206
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/chatbot.ts",
            "start": {
                "col": 46,
                "line": 198,
                "offset": 6343
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-path-join-resolve-traversal.express-path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 60,
                "line": 69,
                "offset": 2397
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 60,
                                    "line": 69,
                                    "offset": 2397
                                },
                                "path": "TypeScript/juice-shop/routes/dataErasure.ts",
                                "start": {
                                    "col": 45,
                                    "line": 69,
                                    "offset": 2382
                                }
                            },
                            "req.body.layout"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 53,
                                    "line": 69,
                                    "offset": 2390
                                },
                                "path": "TypeScript/juice-shop/routes/dataErasure.ts",
                                "start": {
                                    "col": 45,
                                    "line": 69,
                                    "offset": 2382
                                }
                            },
                            "req.body"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "d8681db18e88feb69c8e669834dc6dfaf9cd9a2c147b34bfe8284f69d8998973dfa2bfe713129a2181433efe7fca2290fdfbc9c1622ebaef470568570fecda32_0",
                "is_ignored": false,
                "lines": "      const filePath: string = path.resolve(req.body.layout).toLowerCase()",
                "message": "Possible writing outside of the destination, make sure that the target path is nested in the intended destination",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9273,
                            "rule_id": "L1Uyb8",
                            "rv_id": 834072,
                            "url": "https://semgrep.dev/playground/r/o5TBED2/javascript.express.security.audit.express-path-join-resolve-traversal.express-path-join-resolve-traversal",
                            "version_id": "o5TBED2"
                        }
                    },
                    "shortlink": "https://sg.run/weRn",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-path-join-resolve-traversal.express-path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "post",
                        "end": {
                            "col": 5,
                            "line": 1,
                            "offset": 4
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$APP": {
                        "abstract_content": "router",
                        "end": {
                            "col": 7,
                            "line": 54,
                            "offset": 1789
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "express.Router()",
                            "svalue_end": {
                                "col": 32,
                                "line": 15,
                                "offset": 660
                            },
                            "svalue_start": {
                                "col": 16,
                                "line": 15,
                                "offset": 644
                            }
                        },
                        "start": {
                            "col": 1,
                            "line": 54,
                            "offset": 1783
                        }
                    },
                    "$METHOD": {
                        "abstract_content": "post",
                        "end": {
                            "col": 12,
                            "line": 54,
                            "offset": 1794
                        },
                        "start": {
                            "col": 8,
                            "line": 54,
                            "offset": 1790
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 134,
                            "line": 54,
                            "offset": 1916
                        },
                        "start": {
                            "col": 130,
                            "line": 54,
                            "offset": 1912
                        }
                    },
                    "$PATH": {
                        "abstract_content": "path",
                        "end": {
                            "col": 36,
                            "line": 69,
                            "offset": 2373
                        },
                        "start": {
                            "col": 32,
                            "line": 69,
                            "offset": 2369
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 48,
                            "line": 69,
                            "offset": 2385
                        },
                        "start": {
                            "col": 45,
                            "line": 69,
                            "offset": 2382
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 118,
                            "line": 54,
                            "offset": 1900
                        },
                        "start": {
                            "col": 115,
                            "line": 54,
                            "offset": 1897
                        }
                    },
                    "$SINK": {
                        "abstract_content": "req.body.layout",
                        "end": {
                            "col": 60,
                            "line": 69,
                            "offset": 2397
                        },
                        "start": {
                            "col": 45,
                            "line": 69,
                            "offset": 2382
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/dataErasure.ts",
            "start": {
                "col": 45,
                "line": 69,
                "offset": 2382
            }
        },
        {
            "check_id": "javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 60,
                "line": 69,
                "offset": 2397
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "req",
                            "location": {
                                "end": {
                                    "col": 28,
                                    "line": 54,
                                    "offset": 1810
                                },
                                "path": "TypeScript/juice-shop/routes/dataErasure.ts",
                                "start": {
                                    "col": 25,
                                    "line": 54,
                                    "offset": 1807
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 60,
                                    "line": 69,
                                    "offset": 2397
                                },
                                "path": "TypeScript/juice-shop/routes/dataErasure.ts",
                                "start": {
                                    "col": 45,
                                    "line": 69,
                                    "offset": 2382
                                }
                            },
                            "req.body.layout"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 28,
                                    "line": 54,
                                    "offset": 1810
                                },
                                "path": "TypeScript/juice-shop/routes/dataErasure.ts",
                                "start": {
                                    "col": 25,
                                    "line": 54,
                                    "offset": 1807
                                }
                            },
                            "req"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "a66edcbde0a549a64c974019c24341fa644f9c03c856bf7d39440be107e1a5409f4e0afe5ff8c1b4b22afad985e64d912b3cf2bfb5e0a2b09253b15f08ca354c_0",
                "is_ignored": false,
                "lines": "      const filePath: string = path.resolve(req.body.layout).toLowerCase()",
                "message": "Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9331,
                            "rule_id": "8GUjrq",
                            "rv_id": 834146,
                            "url": "https://semgrep.dev/playground/r/JdTlrjW/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                            "version_id": "JdTlrjW"
                        }
                    },
                    "shortlink": "https://sg.run/OPqk",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$PATH": {
                        "abstract_content": "path",
                        "end": {
                            "col": 36,
                            "line": 69,
                            "offset": 2373
                        },
                        "start": {
                            "col": 32,
                            "line": 69,
                            "offset": 2369
                        }
                    },
                    "$SINK": {
                        "abstract_content": "req.body.layout",
                        "end": {
                            "col": 60,
                            "line": 69,
                            "offset": 2397
                        },
                        "start": {
                            "col": 45,
                            "line": 69,
                            "offset": 2382
                        }
                    },
                    "$X": {
                        "abstract_content": "req",
                        "end": {
                            "col": 28,
                            "line": 54,
                            "offset": 1810
                        },
                        "start": {
                            "col": 25,
                            "line": 54,
                            "offset": 1807
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/dataErasure.ts",
            "start": {
                "col": 45,
                "line": 69,
                "offset": 2382
            }
        },
        {
            "check_id": "javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 55,
                "line": 61,
                "offset": 1976
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "loggedInUser",
                            "location": {
                                "end": {
                                    "col": 23,
                                    "line": 17,
                                    "offset": 635
                                },
                                "path": "TypeScript/juice-shop/routes/dataExport.ts",
                                "start": {
                                    "col": 11,
                                    "line": 17,
                                    "offset": 623
                                }
                            }
                        },
                        {
                            "content": "email",
                            "location": {
                                "end": {
                                    "col": 18,
                                    "line": 20,
                                    "offset": 853
                                },
                                "path": "TypeScript/juice-shop/routes/dataExport.ts",
                                "start": {
                                    "col": 13,
                                    "line": 20,
                                    "offset": 848
                                }
                            }
                        },
                        {
                            "content": "updatedEmail",
                            "location": {
                                "end": {
                                    "col": 25,
                                    "line": 21,
                                    "offset": 905
                                },
                                "path": "TypeScript/juice-shop/routes/dataExport.ts",
                                "start": {
                                    "col": 13,
                                    "line": 21,
                                    "offset": 893
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 55,
                                    "line": 61,
                                    "offset": 1976
                                },
                                "path": "TypeScript/juice-shop/routes/dataExport.ts",
                                "start": {
                                    "col": 32,
                                    "line": 61,
                                    "offset": 1953
                                }
                            },
                            "{ email: updatedEmail }"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 69,
                                    "line": 17,
                                    "offset": 681
                                },
                                "path": "TypeScript/juice-shop/routes/dataExport.ts",
                                "start": {
                                    "col": 58,
                                    "line": 17,
                                    "offset": 670
                                }
                            },
                            "req.headers"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "21861a1fb2ac14f3ac4b8b735f821aec3c75751270847e4c80017e56ac8d114a71c19c7f88d9121db0d02c78713e1d343f107320cb9e54f183f3769637368e59_0",
                "is_ignored": false,
                "lines": "      db.ordersCollection.find({ email: updatedEmail }).then((orders: Array<{",
                "message": "Detected a `../data/mongodb` statement that comes from a `req` argument. This could lead to NoSQL injection if the variable is user-controlled and is not properly sanitized. Be sure to properly sanitize the data if you absolutely must pass request data into a mongo query.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-943: Improper Neutralization of Special Elements in Data Query Logic"
                    ],
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "db::sink::sql-or-nosql-query::mongoose",
                        "db::sink::sql-or-nosql-query::mongojs",
                        "db::sink::sql-or-nosql-query::mongodb"
                    ],
                    "impact": "HIGH",
                    "interfile": true,
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/www-pdf-archive/GOD16-NOSQL.pdf"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 28086,
                            "rule_id": "WAUqgq",
                            "rv_id": 850621,
                            "url": "https://semgrep.dev/playground/r/YDTlXwn/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                            "version_id": "YDTlXwn"
                        }
                    },
                    "shortlink": "https://sg.run/Qqxq",
                    "source": "https://semgrep.dev/r/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "nodejs",
                        "mongodb"
                    ],
                    "vulnerability_class": [
                        "Improper Validation"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "mongodb",
                        "end": {
                            "col": 12,
                            "line": 2,
                            "offset": 15
                        },
                        "start": {
                            "col": 5,
                            "line": 2,
                            "offset": 8
                        }
                    },
                    "$DB": {
                        "abstract_content": "db",
                        "end": {
                            "col": 9,
                            "line": 61,
                            "offset": 1930
                        },
                        "start": {
                            "col": 7,
                            "line": 61,
                            "offset": 1928
                        }
                    },
                    "$IMPORT": {
                        "abstract_content": "../data/mongodb",
                        "end": {
                            "col": 37,
                            "line": 9,
                            "offset": 339
                        },
                        "start": {
                            "col": 22,
                            "line": 9,
                            "offset": 324
                        }
                    },
                    "$M": {
                        "abstract_content": "find",
                        "end": {
                            "col": 31,
                            "line": 61,
                            "offset": 1952
                        },
                        "start": {
                            "col": 27,
                            "line": 61,
                            "offset": 1948
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 61,
                            "line": 17,
                            "offset": 673
                        },
                        "start": {
                            "col": 58,
                            "line": 17,
                            "offset": 670
                        }
                    },
                    "$VALUE": {
                        "abstract_content": "{email updatedEmail}",
                        "end": {
                            "col": 55,
                            "line": 61,
                            "offset": 1976
                        },
                        "start": {
                            "col": 32,
                            "line": 61,
                            "offset": 1953
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/dataExport.ts",
            "start": {
                "col": 32,
                "line": 61,
                "offset": 1953
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-res-sendfile.express-res-sendfile",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 46,
                "line": 33,
                "offset": 1212
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 46,
                                    "line": 33,
                                    "offset": 1212
                                },
                                "path": "TypeScript/juice-shop/routes/fileServer.ts",
                                "start": {
                                    "col": 20,
                                    "line": 33,
                                    "offset": 1186
                                }
                            },
                            "path.resolve('ftp/', file)"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 4,
                                    "line": 38,
                                    "offset": 1325
                                },
                                "path": "TypeScript/juice-shop/routes/fileServer.ts",
                                "start": {
                                    "col": 3,
                                    "line": 26,
                                    "offset": 772
                                }
                            },
                            "function verify (file: string, res: Response, next: NextFunction) {\r\n    if (file && (endsWithAllowlistedFileType(file) || (file === 'incident-support.kdbx'))) {\r\n      file = security.cutOffPoisonNullByte(file)\r\n\r\n      challengeUtils.solveIf(challenges.directoryListingChallenge, () => { return file.toLowerCase() === 'acquisitions.md' })\r\n      verifySuccessfulPoisonNullByteExploit(file)\r\n\r\n      res.sendFile(path.resolve('ftp/', file))\r\n    } else {\r\n      res.status(403)\r\n      next(new Error('Only .md and .pdf files are allowed!'))\r\n    }\r\n  }"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "a95ff70d210b52a004b99ca2d7c87fd636e558a54e6cb9cbd49d1026a7c34649d8a75edc9f8b36957852dea7d753cc4a2ea18b7a90d3f86105a7d4dd0ba181f5_0",
                "is_ignored": false,
                "lines": "      res.sendFile(path.resolve('ftp/', file))",
                "message": "The application processes user-input, this is passed to res.sendFile which can allow an attacker to arbitrarily read files on the system through path traversal. It is recommended to perform input validation in addition to canonicalizing the path. This allows you to validate the path against the intended directory it should be accessing.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-73: External Control of File Name or Path"
                    ],
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A04:2021 - Insecure Design"
                    ],
                    "references": [
                        "https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22082,
                            "rule_id": "j2UzDx",
                            "rv_id": 834073,
                            "url": "https://semgrep.dev/playground/r/zyTWJ2W/javascript.express.security.audit.express-res-sendfile.express-res-sendfile",
                            "version_id": "zyTWJ2W"
                        }
                    },
                    "shortlink": "https://sg.run/7DJk",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-res-sendfile.express-res-sendfile",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "string",
                        "end": {
                            "col": 7,
                            "line": 1,
                            "offset": 6
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$METH": {
                        "abstract_content": "sendFile",
                        "end": {
                            "col": 19,
                            "line": 33,
                            "offset": 1185
                        },
                        "start": {
                            "col": 11,
                            "line": 33,
                            "offset": 1177
                        }
                    },
                    "$QUERY": {
                        "abstract_content": "path.resolve('ftp/'file)",
                        "end": {
                            "col": 46,
                            "line": 33,
                            "offset": 1212
                        },
                        "start": {
                            "col": 20,
                            "line": 33,
                            "offset": 1186
                        }
                    },
                    "$REQ": {
                        "abstract_content": "file",
                        "end": {
                            "col": 24,
                            "line": 26,
                            "offset": 793
                        },
                        "start": {
                            "col": 20,
                            "line": 26,
                            "offset": 789
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 10,
                            "line": 33,
                            "offset": 1176
                        },
                        "start": {
                            "col": 7,
                            "line": 33,
                            "offset": 1173
                        }
                    },
                    "$TYPE": {
                        "abstract_content": "string",
                        "end": {
                            "col": 32,
                            "line": 26,
                            "offset": 801
                        },
                        "start": {
                            "col": 26,
                            "line": 26,
                            "offset": 795
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/fileServer.ts",
            "start": {
                "col": 20,
                "line": 33,
                "offset": 1186
            }
        },
        {
            "check_id": "javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 45,
                "line": 33,
                "offset": 1211
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "file",
                            "location": {
                                "end": {
                                    "col": 24,
                                    "line": 26,
                                    "offset": 793
                                },
                                "path": "TypeScript/juice-shop/routes/fileServer.ts",
                                "start": {
                                    "col": 20,
                                    "line": 26,
                                    "offset": 789
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 45,
                                    "line": 33,
                                    "offset": 1211
                                },
                                "path": "TypeScript/juice-shop/routes/fileServer.ts",
                                "start": {
                                    "col": 41,
                                    "line": 33,
                                    "offset": 1207
                                }
                            },
                            "file"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 24,
                                    "line": 26,
                                    "offset": 793
                                },
                                "path": "TypeScript/juice-shop/routes/fileServer.ts",
                                "start": {
                                    "col": 20,
                                    "line": 26,
                                    "offset": 789
                                }
                            },
                            "file"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "09783d3ef79b49574d3f4c22ce98676320593787a698a8e0952c3cd355fe1edff4f0e789114174268c48f7c88a15cdad6235868013dd537b57306604a82a6987_0",
                "is_ignored": false,
                "lines": "      res.sendFile(path.resolve('ftp/', file))",
                "message": "Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9331,
                            "rule_id": "8GUjrq",
                            "rv_id": 834146,
                            "url": "https://semgrep.dev/playground/r/JdTlrjW/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                            "version_id": "JdTlrjW"
                        }
                    },
                    "shortlink": "https://sg.run/OPqk",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$SINK": {
                        "abstract_content": "file",
                        "end": {
                            "col": 45,
                            "line": 33,
                            "offset": 1211
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "security.cutOffPoisonNullByte(file)",
                            "svalue_end": {
                                "col": 49,
                                "line": 28,
                                "offset": 983
                            },
                            "svalue_start": {
                                "col": 14,
                                "line": 28,
                                "offset": 948
                            }
                        },
                        "start": {
                            "col": 41,
                            "line": 33,
                            "offset": 1207
                        }
                    },
                    "$X": {
                        "abstract_content": "file",
                        "end": {
                            "col": 24,
                            "line": 26,
                            "offset": 793
                        },
                        "start": {
                            "col": 20,
                            "line": 26,
                            "offset": 789
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/fileServer.ts",
            "start": {
                "col": 41,
                "line": 33,
                "offset": 1207
            }
        },
        {
            "check_id": "javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 55,
                "line": 29,
                "offset": 1047
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "file",
                            "location": {
                                "end": {
                                    "col": 37,
                                    "line": 24,
                                    "offset": 689
                                },
                                "path": "TypeScript/juice-shop/routes/fileUpload.ts",
                                "start": {
                                    "col": 33,
                                    "line": 24,
                                    "offset": 685
                                }
                            }
                        },
                        {
                            "content": "filename",
                            "location": {
                                "end": {
                                    "col": 21,
                                    "line": 28,
                                    "offset": 957
                                },
                                "path": "TypeScript/juice-shop/routes/fileUpload.ts",
                                "start": {
                                    "col": 13,
                                    "line": 28,
                                    "offset": 949
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 55,
                                    "line": 29,
                                    "offset": 1047
                                },
                                "path": "TypeScript/juice-shop/routes/fileUpload.ts",
                                "start": {
                                    "col": 47,
                                    "line": 29,
                                    "offset": 1039
                                }
                            },
                            "filename"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 48,
                                    "line": 24,
                                    "offset": 700
                                },
                                "path": "TypeScript/juice-shop/routes/fileUpload.ts",
                                "start": {
                                    "col": 31,
                                    "line": 24,
                                    "offset": 683
                                }
                            },
                            "{ file }: Request"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "71bf64d01c456cb0c8018881082e268cc2a9194478326e3c473e6e68670346a6e40b012f5b96d2cd8cd34b44774d8c8bcb8b39b4712a4942adbac5538c5bf79f_0",
                "is_ignored": false,
                "lines": "      const tempFile = path.join(os.tmpdir(), filename)",
                "message": "Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9331,
                            "rule_id": "8GUjrq",
                            "rv_id": 834146,
                            "url": "https://semgrep.dev/playground/r/JdTlrjW/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                            "version_id": "JdTlrjW"
                        }
                    },
                    "shortlink": "https://sg.run/OPqk",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$PATH": {
                        "abstract_content": "path",
                        "end": {
                            "col": 28,
                            "line": 29,
                            "offset": 1020
                        },
                        "start": {
                            "col": 24,
                            "line": 29,
                            "offset": 1016
                        }
                    },
                    "$SINK": {
                        "abstract_content": "filename",
                        "end": {
                            "col": 55,
                            "line": 29,
                            "offset": 1047
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "file.originalname.toLowerCase()",
                            "svalue_end": {
                                "col": 55,
                                "line": 28,
                                "offset": 991
                            },
                            "svalue_start": {
                                "col": 24,
                                "line": 28,
                                "offset": 960
                            }
                        },
                        "start": {
                            "col": 47,
                            "line": 29,
                            "offset": 1039
                        }
                    },
                    "$X": {
                        "abstract_content": "{file file}Request",
                        "end": {
                            "col": 48,
                            "line": 24,
                            "offset": 700
                        },
                        "start": {
                            "col": 31,
                            "line": 24,
                            "offset": 683
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/fileUpload.ts",
            "start": {
                "col": 47,
                "line": 29,
                "offset": 1039
            }
        },
        {
            "check_id": "javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 83,
                "line": 39,
                "offset": 1553
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "entry",
                            "location": {
                                "end": {
                                    "col": 43,
                                    "line": 37,
                                    "offset": 1416
                                },
                                "path": "TypeScript/juice-shop/routes/fileUpload.ts",
                                "start": {
                                    "col": 38,
                                    "line": 37,
                                    "offset": 1411
                                }
                            }
                        },
                        {
                            "content": "fileName",
                            "location": {
                                "end": {
                                    "col": 31,
                                    "line": 38,
                                    "offset": 1456
                                },
                                "path": "TypeScript/juice-shop/routes/fileUpload.ts",
                                "start": {
                                    "col": 23,
                                    "line": 38,
                                    "offset": 1448
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 83,
                                    "line": 39,
                                    "offset": 1553
                                },
                                "path": "TypeScript/juice-shop/routes/fileUpload.ts",
                                "start": {
                                    "col": 51,
                                    "line": 39,
                                    "offset": 1521
                                }
                            },
                            "'uploads/complaints/' + fileName"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 43,
                                    "line": 37,
                                    "offset": 1416
                                },
                                "path": "TypeScript/juice-shop/routes/fileUpload.ts",
                                "start": {
                                    "col": 38,
                                    "line": 37,
                                    "offset": 1411
                                }
                            },
                            "entry"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "00d57e4feb9da8e7a4b9253860ee304c0e95b5977e9d667802ec87411303785c9b8bcfaae520ba02ab3b0f08536958648cf473298bfc7a7b21f9e35268c2928f_0",
                "is_ignored": false,
                "lines": "                const absolutePath = path.resolve('uploads/complaints/' + fileName)",
                "message": "Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9331,
                            "rule_id": "8GUjrq",
                            "rv_id": 834146,
                            "url": "https://semgrep.dev/playground/r/JdTlrjW/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                            "version_id": "JdTlrjW"
                        }
                    },
                    "shortlink": "https://sg.run/OPqk",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$PATH": {
                        "abstract_content": "path",
                        "end": {
                            "col": 42,
                            "line": 39,
                            "offset": 1512
                        },
                        "start": {
                            "col": 38,
                            "line": 39,
                            "offset": 1508
                        }
                    },
                    "$SINK": {
                        "abstract_content": "'uploads/complaints/'+fileName",
                        "end": {
                            "col": 83,
                            "line": 39,
                            "offset": 1553
                        },
                        "start": {
                            "col": 51,
                            "line": 39,
                            "offset": 1521
                        }
                    },
                    "$X": {
                        "abstract_content": "entry",
                        "end": {
                            "col": 43,
                            "line": 37,
                            "offset": 1416
                        },
                        "start": {
                            "col": 38,
                            "line": 37,
                            "offset": 1411
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/fileUpload.ts",
            "start": {
                "col": 51,
                "line": 39,
                "offset": 1521
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-libxml-vm-noent.express-libxml-vm-noent",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 140,
                "line": 80,
                "offset": 3407
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "bff8c1eeaa9fefe11c0ebb528fcb3d274714e88ead5f2d49da48986de8e94d05d9d97b424c76ac1f27ff6e8290d34cb5d5e0c7398e267e56e67537ef163cf5e9_0",
                "is_ignored": false,
                "lines": "        const xmlDoc = vm.runInContext('libxml.parseXml(data, { noblanks: true, noent: true, nocdata: true })', sandbox, { timeout: 2000 })",
                "message": "Detected use of parseXml() function with the `noent` field set to `true`. This can lead to an XML External Entities (XXE) attack if untrusted data is passed into it.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-611: Improper Restriction of XML External Entity Reference"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "HIGH",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A04:2017 - XML External Entities (XXE)",
                        "A05:2021 - Security Misconfiguration"
                    ],
                    "references": [
                        "https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22080,
                            "rule_id": "2ZUY52",
                            "rv_id": 834070,
                            "url": "https://semgrep.dev/playground/r/YDTl0eQ/javascript.express.security.audit.express-libxml-vm-noent.express-libxml-vm-noent",
                            "version_id": "YDTl0eQ"
                        }
                    },
                    "shortlink": "https://sg.run/n8Ag",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-libxml-vm-noent.express-libxml-vm-noent",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "XML Injection"
                    ]
                },
                "metavars": {
                    "$CMD": {
                        "abstract_content": "libxml.parseXml(data, { noblanks: true, noent: true, nocdata: true })",
                        "end": {
                            "col": 110,
                            "line": 80,
                            "offset": 3377
                        },
                        "start": {
                            "col": 41,
                            "line": 80,
                            "offset": 3308
                        }
                    },
                    "$DATA": {
                        "abstract_content": "data",
                        "end": {
                            "col": 61,
                            "line": 80,
                            "offset": 3328
                        },
                        "start": {
                            "col": 57,
                            "line": 80,
                            "offset": 3324
                        }
                    },
                    "$LIBXML": {
                        "abstract_content": "libxml",
                        "end": {
                            "col": 47,
                            "line": 80,
                            "offset": 3314
                        },
                        "start": {
                            "col": 41,
                            "line": 80,
                            "offset": 3308
                        }
                    },
                    "$VM": {
                        "abstract_content": "vm",
                        "end": {
                            "col": 26,
                            "line": 80,
                            "offset": 3293
                        },
                        "start": {
                            "col": 24,
                            "line": 80,
                            "offset": 3291
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/fileUpload.ts",
            "start": {
                "col": 24,
                "line": 80,
                "offset": 3291
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-res-sendfile.express-res-sendfile",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 57,
                "line": 14,
                "offset": 471
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "params",
                            "location": {
                                "end": {
                                    "col": 19,
                                    "line": 10,
                                    "offset": 297
                                },
                                "path": "TypeScript/juice-shop/routes/keyServer.ts",
                                "start": {
                                    "col": 13,
                                    "line": 10,
                                    "offset": 291
                                }
                            }
                        },
                        {
                            "content": "file",
                            "location": {
                                "end": {
                                    "col": 15,
                                    "line": 11,
                                    "offset": 365
                                },
                                "path": "TypeScript/juice-shop/routes/keyServer.ts",
                                "start": {
                                    "col": 11,
                                    "line": 11,
                                    "offset": 361
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 57,
                                    "line": 14,
                                    "offset": 471
                                },
                                "path": "TypeScript/juice-shop/routes/keyServer.ts",
                                "start": {
                                    "col": 20,
                                    "line": 14,
                                    "offset": 434
                                }
                            },
                            "path.resolve('encryptionkeys/', file)"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 19,
                                    "line": 10,
                                    "offset": 297
                                },
                                "path": "TypeScript/juice-shop/routes/keyServer.ts",
                                "start": {
                                    "col": 13,
                                    "line": 10,
                                    "offset": 291
                                }
                            },
                            "params"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "90a5d61594f55739edcaec32fbcf53b7e079fb87c8a3802f2db01e93bfaa01effaa3337a6a6ca0677890acaee45ec0297e64726c70861fee85a41f91cd65c42a_0",
                "is_ignored": false,
                "lines": "      res.sendFile(path.resolve('encryptionkeys/', file))",
                "message": "The application processes user-input, this is passed to res.sendFile which can allow an attacker to arbitrarily read files on the system through path traversal. It is recommended to perform input validation in addition to canonicalizing the path. This allows you to validate the path against the intended directory it should be accessing.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-73: External Control of File Name or Path"
                    ],
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A04:2021 - Insecure Design"
                    ],
                    "references": [
                        "https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22082,
                            "rule_id": "j2UzDx",
                            "rv_id": 834073,
                            "url": "https://semgrep.dev/playground/r/zyTWJ2W/javascript.express.security.audit.express-res-sendfile.express-res-sendfile",
                            "version_id": "zyTWJ2W"
                        }
                    },
                    "shortlink": "https://sg.run/7DJk",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-res-sendfile.express-res-sendfile",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "sendFile",
                        "end": {
                            "col": 9,
                            "line": 1,
                            "offset": 8
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$METH": {
                        "abstract_content": "sendFile",
                        "end": {
                            "col": 19,
                            "line": 14,
                            "offset": 433
                        },
                        "start": {
                            "col": 11,
                            "line": 14,
                            "offset": 425
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 51,
                            "line": 10,
                            "offset": 329
                        },
                        "start": {
                            "col": 47,
                            "line": 10,
                            "offset": 325
                        }
                    },
                    "$QUERY": {
                        "abstract_content": "path.resolve('encryptionkeys/'file)",
                        "end": {
                            "col": 57,
                            "line": 14,
                            "offset": 471
                        },
                        "start": {
                            "col": 20,
                            "line": 14,
                            "offset": 434
                        }
                    },
                    "$REQ": {
                        "abstract_content": "params",
                        "end": {
                            "col": 19,
                            "line": 10,
                            "offset": 297
                        },
                        "start": {
                            "col": 13,
                            "line": 10,
                            "offset": 291
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 35,
                            "line": 10,
                            "offset": 313
                        },
                        "start": {
                            "col": 32,
                            "line": 10,
                            "offset": 310
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/keyServer.ts",
            "start": {
                "col": 20,
                "line": 14,
                "offset": 434
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-path-join-resolve-traversal.express-path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 56,
                "line": 14,
                "offset": 470
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "params",
                            "location": {
                                "end": {
                                    "col": 19,
                                    "line": 10,
                                    "offset": 297
                                },
                                "path": "TypeScript/juice-shop/routes/keyServer.ts",
                                "start": {
                                    "col": 13,
                                    "line": 10,
                                    "offset": 291
                                }
                            }
                        },
                        {
                            "content": "file",
                            "location": {
                                "end": {
                                    "col": 15,
                                    "line": 11,
                                    "offset": 365
                                },
                                "path": "TypeScript/juice-shop/routes/keyServer.ts",
                                "start": {
                                    "col": 11,
                                    "line": 11,
                                    "offset": 361
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 56,
                                    "line": 14,
                                    "offset": 470
                                },
                                "path": "TypeScript/juice-shop/routes/keyServer.ts",
                                "start": {
                                    "col": 52,
                                    "line": 14,
                                    "offset": 466
                                }
                            },
                            "file"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 19,
                                    "line": 10,
                                    "offset": 297
                                },
                                "path": "TypeScript/juice-shop/routes/keyServer.ts",
                                "start": {
                                    "col": 13,
                                    "line": 10,
                                    "offset": 291
                                }
                            },
                            "params"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "2131280f79a03df073301c39d2360221af884e7c498417e3185a18a570f9e8e99fbb3988f8b431cb2e3b642b48518debb70dce10ef68f8bee1890e8156794cbf_0",
                "is_ignored": false,
                "lines": "      res.sendFile(path.resolve('encryptionkeys/', file))",
                "message": "Possible writing outside of the destination, make sure that the target path is nested in the intended destination",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9273,
                            "rule_id": "L1Uyb8",
                            "rv_id": 834072,
                            "url": "https://semgrep.dev/playground/r/o5TBED2/javascript.express.security.audit.express-path-join-resolve-traversal.express-path-join-resolve-traversal",
                            "version_id": "o5TBED2"
                        }
                    },
                    "shortlink": "https://sg.run/weRn",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-path-join-resolve-traversal.express-path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 51,
                            "line": 10,
                            "offset": 329
                        },
                        "start": {
                            "col": 47,
                            "line": 10,
                            "offset": 325
                        }
                    },
                    "$REQ": {
                        "abstract_content": "params",
                        "end": {
                            "col": 19,
                            "line": 10,
                            "offset": 297
                        },
                        "start": {
                            "col": 13,
                            "line": 10,
                            "offset": 291
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 35,
                            "line": 10,
                            "offset": 313
                        },
                        "start": {
                            "col": 32,
                            "line": 10,
                            "offset": 310
                        }
                    },
                    "$SINK": {
                        "abstract_content": "file",
                        "end": {
                            "col": 56,
                            "line": 14,
                            "offset": 470
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "params.file",
                            "svalue_end": {
                                "col": 29,
                                "line": 11,
                                "offset": 379
                            },
                            "svalue_start": {
                                "col": 18,
                                "line": 11,
                                "offset": 368
                            }
                        },
                        "start": {
                            "col": 52,
                            "line": 14,
                            "offset": 466
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/keyServer.ts",
            "start": {
                "col": 52,
                "line": 14,
                "offset": 466
            }
        },
        {
            "check_id": "javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 56,
                "line": 14,
                "offset": 470
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "params",
                            "location": {
                                "end": {
                                    "col": 19,
                                    "line": 10,
                                    "offset": 297
                                },
                                "path": "TypeScript/juice-shop/routes/keyServer.ts",
                                "start": {
                                    "col": 13,
                                    "line": 10,
                                    "offset": 291
                                }
                            }
                        },
                        {
                            "content": "file",
                            "location": {
                                "end": {
                                    "col": 15,
                                    "line": 11,
                                    "offset": 365
                                },
                                "path": "TypeScript/juice-shop/routes/keyServer.ts",
                                "start": {
                                    "col": 11,
                                    "line": 11,
                                    "offset": 361
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 56,
                                    "line": 14,
                                    "offset": 470
                                },
                                "path": "TypeScript/juice-shop/routes/keyServer.ts",
                                "start": {
                                    "col": 52,
                                    "line": 14,
                                    "offset": 466
                                }
                            },
                            "file"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 30,
                                    "line": 10,
                                    "offset": 308
                                },
                                "path": "TypeScript/juice-shop/routes/keyServer.ts",
                                "start": {
                                    "col": 11,
                                    "line": 10,
                                    "offset": 289
                                }
                            },
                            "{ params }: Request"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "20e36b1bc39771df8cad5cf96b198fe6b22e579f0cdb537a6449a9e065f4d796ec02f2aea18cfd39bd2c19df724ad3cc3e45478a0b0a9a466b4a4977697dd878_0",
                "is_ignored": false,
                "lines": "      res.sendFile(path.resolve('encryptionkeys/', file))",
                "message": "Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9331,
                            "rule_id": "8GUjrq",
                            "rv_id": 834146,
                            "url": "https://semgrep.dev/playground/r/JdTlrjW/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                            "version_id": "JdTlrjW"
                        }
                    },
                    "shortlink": "https://sg.run/OPqk",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$SINK": {
                        "abstract_content": "file",
                        "end": {
                            "col": 56,
                            "line": 14,
                            "offset": 470
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "params.file",
                            "svalue_end": {
                                "col": 29,
                                "line": 11,
                                "offset": 379
                            },
                            "svalue_start": {
                                "col": 18,
                                "line": 11,
                                "offset": 368
                            }
                        },
                        "start": {
                            "col": 52,
                            "line": 14,
                            "offset": 466
                        }
                    },
                    "$X": {
                        "abstract_content": "{params params}Request",
                        "end": {
                            "col": 30,
                            "line": 10,
                            "offset": 308
                        },
                        "start": {
                            "col": 11,
                            "line": 10,
                            "offset": 289
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/keyServer.ts",
            "start": {
                "col": 52,
                "line": 14,
                "offset": 466
            }
        },
        {
            "check_id": "javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 45,
                "line": 18,
                "offset": 681
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "id",
                            "location": {
                                "end": {
                                    "col": 13,
                                    "line": 16,
                                    "offset": 565
                                },
                                "path": "TypeScript/juice-shop/routes/likeProductReviews.ts",
                                "start": {
                                    "col": 11,
                                    "line": 16,
                                    "offset": 563
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 45,
                                    "line": 18,
                                    "offset": 681
                                },
                                "path": "TypeScript/juice-shop/routes/likeProductReviews.ts",
                                "start": {
                                    "col": 34,
                                    "line": 18,
                                    "offset": 670
                                }
                            },
                            "{ _id: id }"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 24,
                                    "line": 16,
                                    "offset": 576
                                },
                                "path": "TypeScript/juice-shop/routes/likeProductReviews.ts",
                                "start": {
                                    "col": 16,
                                    "line": 16,
                                    "offset": 568
                                }
                            },
                            "req.body"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "de5b94b39f0df605f4fb9331b9f569de11a1da1bc2b6d297487250c87d00b8e113caaff43ebfc93d32f4a4a27a79edb444c558826ab7b18781d938ac5324a5ef_0",
                "is_ignored": false,
                "lines": "    db.reviewsCollection.findOne({ _id: id }).then((review: Review) => {",
                "message": "Detected a `../data/mongodb` statement that comes from a `req` argument. This could lead to NoSQL injection if the variable is user-controlled and is not properly sanitized. Be sure to properly sanitize the data if you absolutely must pass request data into a mongo query.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-943: Improper Neutralization of Special Elements in Data Query Logic"
                    ],
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "db::sink::sql-or-nosql-query::mongoose",
                        "db::sink::sql-or-nosql-query::mongojs",
                        "db::sink::sql-or-nosql-query::mongodb"
                    ],
                    "impact": "HIGH",
                    "interfile": true,
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/www-pdf-archive/GOD16-NOSQL.pdf"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 28086,
                            "rule_id": "WAUqgq",
                            "rv_id": 850621,
                            "url": "https://semgrep.dev/playground/r/YDTlXwn/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                            "version_id": "YDTlXwn"
                        }
                    },
                    "shortlink": "https://sg.run/Qqxq",
                    "source": "https://semgrep.dev/r/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "nodejs",
                        "mongodb"
                    ],
                    "vulnerability_class": [
                        "Improper Validation"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "mongodb",
                        "end": {
                            "col": 12,
                            "line": 2,
                            "offset": 15
                        },
                        "start": {
                            "col": 5,
                            "line": 2,
                            "offset": 8
                        }
                    },
                    "$DB": {
                        "abstract_content": "db",
                        "end": {
                            "col": 7,
                            "line": 18,
                            "offset": 643
                        },
                        "start": {
                            "col": 5,
                            "line": 18,
                            "offset": 641
                        }
                    },
                    "$IMPORT": {
                        "abstract_content": "../data/mongodb",
                        "end": {
                            "col": 37,
                            "line": 9,
                            "offset": 339
                        },
                        "start": {
                            "col": 22,
                            "line": 9,
                            "offset": 324
                        }
                    },
                    "$M": {
                        "abstract_content": "findOne",
                        "end": {
                            "col": 33,
                            "line": 18,
                            "offset": 669
                        },
                        "start": {
                            "col": 26,
                            "line": 18,
                            "offset": 662
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 19,
                            "line": 16,
                            "offset": 571
                        },
                        "start": {
                            "col": 16,
                            "line": 16,
                            "offset": 568
                        }
                    },
                    "$VALUE": {
                        "abstract_content": "{_id id}",
                        "end": {
                            "col": 45,
                            "line": 18,
                            "offset": 681
                        },
                        "start": {
                            "col": 34,
                            "line": 18,
                            "offset": 670
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/likeProductReviews.ts",
            "start": {
                "col": 34,
                "line": 18,
                "offset": 670
            }
        },
        {
            "check_id": "javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 24,
                "line": 25,
                "offset": 957
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "id",
                            "location": {
                                "end": {
                                    "col": 13,
                                    "line": 16,
                                    "offset": 565
                                },
                                "path": "TypeScript/juice-shop/routes/likeProductReviews.ts",
                                "start": {
                                    "col": 11,
                                    "line": 16,
                                    "offset": 563
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 24,
                                    "line": 25,
                                    "offset": 957
                                },
                                "path": "TypeScript/juice-shop/routes/likeProductReviews.ts",
                                "start": {
                                    "col": 13,
                                    "line": 25,
                                    "offset": 946
                                }
                            },
                            "{ _id: id }"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 24,
                                    "line": 16,
                                    "offset": 576
                                },
                                "path": "TypeScript/juice-shop/routes/likeProductReviews.ts",
                                "start": {
                                    "col": 16,
                                    "line": 16,
                                    "offset": 568
                                }
                            },
                            "req.body"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "350a00a66c923bc2446a7ad0f96edccebaf2c04ef3f0127c5c7696899d6c5b4343b6f6bfc58fe9e72f3549e3f58e195994bdacd6ce582360edfed72dd1ae2f86_0",
                "is_ignored": false,
                "lines": "            { _id: id },",
                "message": "Detected a `../data/mongodb` statement that comes from a `req` argument. This could lead to NoSQL injection if the variable is user-controlled and is not properly sanitized. Be sure to properly sanitize the data if you absolutely must pass request data into a mongo query.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-943: Improper Neutralization of Special Elements in Data Query Logic"
                    ],
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "db::sink::sql-or-nosql-query::mongoose",
                        "db::sink::sql-or-nosql-query::mongojs",
                        "db::sink::sql-or-nosql-query::mongodb"
                    ],
                    "impact": "HIGH",
                    "interfile": true,
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/www-pdf-archive/GOD16-NOSQL.pdf"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 28086,
                            "rule_id": "WAUqgq",
                            "rv_id": 850621,
                            "url": "https://semgrep.dev/playground/r/YDTlXwn/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                            "version_id": "YDTlXwn"
                        }
                    },
                    "shortlink": "https://sg.run/Qqxq",
                    "source": "https://semgrep.dev/r/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "nodejs",
                        "mongodb"
                    ],
                    "vulnerability_class": [
                        "Improper Validation"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "mongodb",
                        "end": {
                            "col": 12,
                            "line": 2,
                            "offset": 15
                        },
                        "start": {
                            "col": 5,
                            "line": 2,
                            "offset": 8
                        }
                    },
                    "$DB": {
                        "abstract_content": "db",
                        "end": {
                            "col": 13,
                            "line": 24,
                            "offset": 906
                        },
                        "start": {
                            "col": 11,
                            "line": 24,
                            "offset": 904
                        }
                    },
                    "$IMPORT": {
                        "abstract_content": "../data/mongodb",
                        "end": {
                            "col": 37,
                            "line": 9,
                            "offset": 339
                        },
                        "start": {
                            "col": 22,
                            "line": 9,
                            "offset": 324
                        }
                    },
                    "$M": {
                        "abstract_content": "update",
                        "end": {
                            "col": 38,
                            "line": 24,
                            "offset": 931
                        },
                        "start": {
                            "col": 32,
                            "line": 24,
                            "offset": 925
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 19,
                            "line": 16,
                            "offset": 571
                        },
                        "start": {
                            "col": 16,
                            "line": 16,
                            "offset": 568
                        }
                    },
                    "$VALUE": {
                        "abstract_content": "{_id id}",
                        "end": {
                            "col": 24,
                            "line": 25,
                            "offset": 957
                        },
                        "start": {
                            "col": 13,
                            "line": 25,
                            "offset": 946
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/likeProductReviews.ts",
            "start": {
                "col": 13,
                "line": 25,
                "offset": 946
            }
        },
        {
            "check_id": "javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 57,
                "line": 31,
                "offset": 1199
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "id",
                            "location": {
                                "end": {
                                    "col": 13,
                                    "line": 16,
                                    "offset": 565
                                },
                                "path": "TypeScript/juice-shop/routes/likeProductReviews.ts",
                                "start": {
                                    "col": 11,
                                    "line": 16,
                                    "offset": 563
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 57,
                                    "line": 31,
                                    "offset": 1199
                                },
                                "path": "TypeScript/juice-shop/routes/likeProductReviews.ts",
                                "start": {
                                    "col": 46,
                                    "line": 31,
                                    "offset": 1188
                                }
                            },
                            "{ _id: id }"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 24,
                                    "line": 16,
                                    "offset": 576
                                },
                                "path": "TypeScript/juice-shop/routes/likeProductReviews.ts",
                                "start": {
                                    "col": 16,
                                    "line": 16,
                                    "offset": 568
                                }
                            },
                            "req.body"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "de5b94b39f0df605f4fb9331b9f569de11a1da1bc2b6d297487250c87d00b8e113caaff43ebfc93d32f4a4a27a79edb444c558826ab7b18781d938ac5324a5ef_1",
                "is_ignored": false,
                "lines": "                db.reviewsCollection.findOne({ _id: id }).then((review: Review) => {",
                "message": "Detected a `../data/mongodb` statement that comes from a `req` argument. This could lead to NoSQL injection if the variable is user-controlled and is not properly sanitized. Be sure to properly sanitize the data if you absolutely must pass request data into a mongo query.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-943: Improper Neutralization of Special Elements in Data Query Logic"
                    ],
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "db::sink::sql-or-nosql-query::mongoose",
                        "db::sink::sql-or-nosql-query::mongojs",
                        "db::sink::sql-or-nosql-query::mongodb"
                    ],
                    "impact": "HIGH",
                    "interfile": true,
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/www-pdf-archive/GOD16-NOSQL.pdf"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 28086,
                            "rule_id": "WAUqgq",
                            "rv_id": 850621,
                            "url": "https://semgrep.dev/playground/r/YDTlXwn/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                            "version_id": "YDTlXwn"
                        }
                    },
                    "shortlink": "https://sg.run/Qqxq",
                    "source": "https://semgrep.dev/r/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "nodejs",
                        "mongodb"
                    ],
                    "vulnerability_class": [
                        "Improper Validation"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "mongodb",
                        "end": {
                            "col": 12,
                            "line": 2,
                            "offset": 15
                        },
                        "start": {
                            "col": 5,
                            "line": 2,
                            "offset": 8
                        }
                    },
                    "$DB": {
                        "abstract_content": "db",
                        "end": {
                            "col": 19,
                            "line": 31,
                            "offset": 1161
                        },
                        "start": {
                            "col": 17,
                            "line": 31,
                            "offset": 1159
                        }
                    },
                    "$IMPORT": {
                        "abstract_content": "../data/mongodb",
                        "end": {
                            "col": 37,
                            "line": 9,
                            "offset": 339
                        },
                        "start": {
                            "col": 22,
                            "line": 9,
                            "offset": 324
                        }
                    },
                    "$M": {
                        "abstract_content": "findOne",
                        "end": {
                            "col": 45,
                            "line": 31,
                            "offset": 1187
                        },
                        "start": {
                            "col": 38,
                            "line": 31,
                            "offset": 1180
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 19,
                            "line": 16,
                            "offset": 571
                        },
                        "start": {
                            "col": 16,
                            "line": 16,
                            "offset": 568
                        }
                    },
                    "$VALUE": {
                        "abstract_content": "{_id id}",
                        "end": {
                            "col": 57,
                            "line": 31,
                            "offset": 1199
                        },
                        "start": {
                            "col": 46,
                            "line": 31,
                            "offset": 1188
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/likeProductReviews.ts",
            "start": {
                "col": 46,
                "line": 31,
                "offset": 1188
            }
        },
        {
            "check_id": "javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 32,
                "line": 42,
                "offset": 1740
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "id",
                            "location": {
                                "end": {
                                    "col": 13,
                                    "line": 16,
                                    "offset": 565
                                },
                                "path": "TypeScript/juice-shop/routes/likeProductReviews.ts",
                                "start": {
                                    "col": 11,
                                    "line": 16,
                                    "offset": 563
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 32,
                                    "line": 42,
                                    "offset": 1740
                                },
                                "path": "TypeScript/juice-shop/routes/likeProductReviews.ts",
                                "start": {
                                    "col": 21,
                                    "line": 42,
                                    "offset": 1729
                                }
                            },
                            "{ _id: id }"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 24,
                                    "line": 16,
                                    "offset": 576
                                },
                                "path": "TypeScript/juice-shop/routes/likeProductReviews.ts",
                                "start": {
                                    "col": 16,
                                    "line": 16,
                                    "offset": 568
                                }
                            },
                            "req.body"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "350a00a66c923bc2446a7ad0f96edccebaf2c04ef3f0127c5c7696899d6c5b4343b6f6bfc58fe9e72f3549e3f58e195994bdacd6ce582360edfed72dd1ae2f86_1",
                "is_ignored": false,
                "lines": "                    { _id: id },",
                "message": "Detected a `../data/mongodb` statement that comes from a `req` argument. This could lead to NoSQL injection if the variable is user-controlled and is not properly sanitized. Be sure to properly sanitize the data if you absolutely must pass request data into a mongo query.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-943: Improper Neutralization of Special Elements in Data Query Logic"
                    ],
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "db::sink::sql-or-nosql-query::mongoose",
                        "db::sink::sql-or-nosql-query::mongojs",
                        "db::sink::sql-or-nosql-query::mongodb"
                    ],
                    "impact": "HIGH",
                    "interfile": true,
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/www-pdf-archive/GOD16-NOSQL.pdf"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 28086,
                            "rule_id": "WAUqgq",
                            "rv_id": 850621,
                            "url": "https://semgrep.dev/playground/r/YDTlXwn/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                            "version_id": "YDTlXwn"
                        }
                    },
                    "shortlink": "https://sg.run/Qqxq",
                    "source": "https://semgrep.dev/r/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "nodejs",
                        "mongodb"
                    ],
                    "vulnerability_class": [
                        "Improper Validation"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "mongodb",
                        "end": {
                            "col": 12,
                            "line": 2,
                            "offset": 15
                        },
                        "start": {
                            "col": 5,
                            "line": 2,
                            "offset": 8
                        }
                    },
                    "$DB": {
                        "abstract_content": "db",
                        "end": {
                            "col": 21,
                            "line": 41,
                            "offset": 1681
                        },
                        "start": {
                            "col": 19,
                            "line": 41,
                            "offset": 1679
                        }
                    },
                    "$IMPORT": {
                        "abstract_content": "../data/mongodb",
                        "end": {
                            "col": 37,
                            "line": 9,
                            "offset": 339
                        },
                        "start": {
                            "col": 22,
                            "line": 9,
                            "offset": 324
                        }
                    },
                    "$M": {
                        "abstract_content": "update",
                        "end": {
                            "col": 46,
                            "line": 41,
                            "offset": 1706
                        },
                        "start": {
                            "col": 40,
                            "line": 41,
                            "offset": 1700
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 19,
                            "line": 16,
                            "offset": 571
                        },
                        "start": {
                            "col": 16,
                            "line": 16,
                            "offset": 568
                        }
                    },
                    "$VALUE": {
                        "abstract_content": "{_id id}",
                        "end": {
                            "col": 32,
                            "line": 42,
                            "offset": 1740
                        },
                        "start": {
                            "col": 21,
                            "line": 42,
                            "offset": 1729
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/likeProductReviews.ts",
            "start": {
                "col": 21,
                "line": 42,
                "offset": 1729
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-res-sendfile.express-res-sendfile",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 47,
                "line": 14,
                "offset": 461
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "params",
                            "location": {
                                "end": {
                                    "col": 19,
                                    "line": 10,
                                    "offset": 297
                                },
                                "path": "TypeScript/juice-shop/routes/logfileServer.ts",
                                "start": {
                                    "col": 13,
                                    "line": 10,
                                    "offset": 291
                                }
                            }
                        },
                        {
                            "content": "file",
                            "location": {
                                "end": {
                                    "col": 15,
                                    "line": 11,
                                    "offset": 365
                                },
                                "path": "TypeScript/juice-shop/routes/logfileServer.ts",
                                "start": {
                                    "col": 11,
                                    "line": 11,
                                    "offset": 361
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 47,
                                    "line": 14,
                                    "offset": 461
                                },
                                "path": "TypeScript/juice-shop/routes/logfileServer.ts",
                                "start": {
                                    "col": 20,
                                    "line": 14,
                                    "offset": 434
                                }
                            },
                            "path.resolve('logs/', file)"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 19,
                                    "line": 10,
                                    "offset": 297
                                },
                                "path": "TypeScript/juice-shop/routes/logfileServer.ts",
                                "start": {
                                    "col": 13,
                                    "line": 10,
                                    "offset": 291
                                }
                            },
                            "params"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "61ac0c503834b8d6cf6d2e1de19a43f6169a5f2bf7c498b117929679fb9bdf8b2a07c2042833626290ad038c4220b5b2698bbe415d8f9c796e8c72d95448ed44_0",
                "is_ignored": false,
                "lines": "      res.sendFile(path.resolve('logs/', file))",
                "message": "The application processes user-input, this is passed to res.sendFile which can allow an attacker to arbitrarily read files on the system through path traversal. It is recommended to perform input validation in addition to canonicalizing the path. This allows you to validate the path against the intended directory it should be accessing.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-73: External Control of File Name or Path"
                    ],
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A04:2021 - Insecure Design"
                    ],
                    "references": [
                        "https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22082,
                            "rule_id": "j2UzDx",
                            "rv_id": 834073,
                            "url": "https://semgrep.dev/playground/r/zyTWJ2W/javascript.express.security.audit.express-res-sendfile.express-res-sendfile",
                            "version_id": "zyTWJ2W"
                        }
                    },
                    "shortlink": "https://sg.run/7DJk",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-res-sendfile.express-res-sendfile",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "sendFile",
                        "end": {
                            "col": 9,
                            "line": 1,
                            "offset": 8
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$METH": {
                        "abstract_content": "sendFile",
                        "end": {
                            "col": 19,
                            "line": 14,
                            "offset": 433
                        },
                        "start": {
                            "col": 11,
                            "line": 14,
                            "offset": 425
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 51,
                            "line": 10,
                            "offset": 329
                        },
                        "start": {
                            "col": 47,
                            "line": 10,
                            "offset": 325
                        }
                    },
                    "$QUERY": {
                        "abstract_content": "path.resolve('logs/'file)",
                        "end": {
                            "col": 47,
                            "line": 14,
                            "offset": 461
                        },
                        "start": {
                            "col": 20,
                            "line": 14,
                            "offset": 434
                        }
                    },
                    "$REQ": {
                        "abstract_content": "params",
                        "end": {
                            "col": 19,
                            "line": 10,
                            "offset": 297
                        },
                        "start": {
                            "col": 13,
                            "line": 10,
                            "offset": 291
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 35,
                            "line": 10,
                            "offset": 313
                        },
                        "start": {
                            "col": 32,
                            "line": 10,
                            "offset": 310
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/logfileServer.ts",
            "start": {
                "col": 20,
                "line": 14,
                "offset": 434
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-path-join-resolve-traversal.express-path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 46,
                "line": 14,
                "offset": 460
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "params",
                            "location": {
                                "end": {
                                    "col": 19,
                                    "line": 10,
                                    "offset": 297
                                },
                                "path": "TypeScript/juice-shop/routes/logfileServer.ts",
                                "start": {
                                    "col": 13,
                                    "line": 10,
                                    "offset": 291
                                }
                            }
                        },
                        {
                            "content": "file",
                            "location": {
                                "end": {
                                    "col": 15,
                                    "line": 11,
                                    "offset": 365
                                },
                                "path": "TypeScript/juice-shop/routes/logfileServer.ts",
                                "start": {
                                    "col": 11,
                                    "line": 11,
                                    "offset": 361
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 46,
                                    "line": 14,
                                    "offset": 460
                                },
                                "path": "TypeScript/juice-shop/routes/logfileServer.ts",
                                "start": {
                                    "col": 42,
                                    "line": 14,
                                    "offset": 456
                                }
                            },
                            "file"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 19,
                                    "line": 10,
                                    "offset": 297
                                },
                                "path": "TypeScript/juice-shop/routes/logfileServer.ts",
                                "start": {
                                    "col": 13,
                                    "line": 10,
                                    "offset": 291
                                }
                            },
                            "params"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "d77a9ab208d574861bc2a76171b885b1a4754cfd58332a31187438560c729aa54820a06d30a9cca9ad2dbb07531a85ead19d78d6e13aedb45c1f96cd5069ec3c_0",
                "is_ignored": false,
                "lines": "      res.sendFile(path.resolve('logs/', file))",
                "message": "Possible writing outside of the destination, make sure that the target path is nested in the intended destination",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9273,
                            "rule_id": "L1Uyb8",
                            "rv_id": 834072,
                            "url": "https://semgrep.dev/playground/r/o5TBED2/javascript.express.security.audit.express-path-join-resolve-traversal.express-path-join-resolve-traversal",
                            "version_id": "o5TBED2"
                        }
                    },
                    "shortlink": "https://sg.run/weRn",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-path-join-resolve-traversal.express-path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 51,
                            "line": 10,
                            "offset": 329
                        },
                        "start": {
                            "col": 47,
                            "line": 10,
                            "offset": 325
                        }
                    },
                    "$REQ": {
                        "abstract_content": "params",
                        "end": {
                            "col": 19,
                            "line": 10,
                            "offset": 297
                        },
                        "start": {
                            "col": 13,
                            "line": 10,
                            "offset": 291
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 35,
                            "line": 10,
                            "offset": 313
                        },
                        "start": {
                            "col": 32,
                            "line": 10,
                            "offset": 310
                        }
                    },
                    "$SINK": {
                        "abstract_content": "file",
                        "end": {
                            "col": 46,
                            "line": 14,
                            "offset": 460
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "params.file",
                            "svalue_end": {
                                "col": 29,
                                "line": 11,
                                "offset": 379
                            },
                            "svalue_start": {
                                "col": 18,
                                "line": 11,
                                "offset": 368
                            }
                        },
                        "start": {
                            "col": 42,
                            "line": 14,
                            "offset": 456
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/logfileServer.ts",
            "start": {
                "col": 42,
                "line": 14,
                "offset": 456
            }
        },
        {
            "check_id": "javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 46,
                "line": 14,
                "offset": 460
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "params",
                            "location": {
                                "end": {
                                    "col": 19,
                                    "line": 10,
                                    "offset": 297
                                },
                                "path": "TypeScript/juice-shop/routes/logfileServer.ts",
                                "start": {
                                    "col": 13,
                                    "line": 10,
                                    "offset": 291
                                }
                            }
                        },
                        {
                            "content": "file",
                            "location": {
                                "end": {
                                    "col": 15,
                                    "line": 11,
                                    "offset": 365
                                },
                                "path": "TypeScript/juice-shop/routes/logfileServer.ts",
                                "start": {
                                    "col": 11,
                                    "line": 11,
                                    "offset": 361
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 46,
                                    "line": 14,
                                    "offset": 460
                                },
                                "path": "TypeScript/juice-shop/routes/logfileServer.ts",
                                "start": {
                                    "col": 42,
                                    "line": 14,
                                    "offset": 456
                                }
                            },
                            "file"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 30,
                                    "line": 10,
                                    "offset": 308
                                },
                                "path": "TypeScript/juice-shop/routes/logfileServer.ts",
                                "start": {
                                    "col": 11,
                                    "line": 10,
                                    "offset": 289
                                }
                            },
                            "{ params }: Request"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "9b748bb4527d184c35529e85e6a379dec785ab580ddaaf3254633f039c7355f40cd8fefdfc4f4f607c7da6995ef6223b3a6acce56f6b4e685b87dd37c38f9b39_0",
                "is_ignored": false,
                "lines": "      res.sendFile(path.resolve('logs/', file))",
                "message": "Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9331,
                            "rule_id": "8GUjrq",
                            "rv_id": 834146,
                            "url": "https://semgrep.dev/playground/r/JdTlrjW/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                            "version_id": "JdTlrjW"
                        }
                    },
                    "shortlink": "https://sg.run/OPqk",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$SINK": {
                        "abstract_content": "file",
                        "end": {
                            "col": 46,
                            "line": 14,
                            "offset": 460
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "params.file",
                            "svalue_end": {
                                "col": 29,
                                "line": 11,
                                "offset": 379
                            },
                            "svalue_start": {
                                "col": 18,
                                "line": 11,
                                "offset": 368
                            }
                        },
                        "start": {
                            "col": 42,
                            "line": 14,
                            "offset": 456
                        }
                    },
                    "$X": {
                        "abstract_content": "{params params}Request",
                        "end": {
                            "col": 30,
                            "line": 10,
                            "offset": 308
                        },
                        "start": {
                            "col": 11,
                            "line": 10,
                            "offset": 289
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/logfileServer.ts",
            "start": {
                "col": 42,
                "line": 14,
                "offset": 456
            }
        },
        {
            "check_id": "javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 169,
                "line": 36,
                "offset": 1690
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 169,
                                    "line": 36,
                                    "offset": 1690
                                },
                                "path": "TypeScript/juice-shop/routes/login.ts",
                                "start": {
                                    "col": 28,
                                    "line": 36,
                                    "offset": 1549
                                }
                            },
                            "`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 74,
                                    "line": 36,
                                    "offset": 1595
                                },
                                "path": "TypeScript/juice-shop/routes/login.ts",
                                "start": {
                                    "col": 66,
                                    "line": 36,
                                    "offset": 1587
                                }
                            },
                            "req.body"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "cba2e58ce2699895c104cb74c95fa1714adce9788ffb30623d8cdd4bb0309bbd5accd153a61e72f73ce5aa06e7b3d58308203ca1765cd08ed7644ce817e0d085_0",
                "is_ignored": false,
                "lines": "    models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge loginBenderChallenge loginJimChallenge",
                "message": "Detected a sequelize statement that is tainted by user-input. This could lead to SQL injection if the variable is user-controlled and is not properly sanitized. In order to prevent SQL injection, it is recommended to use parameterized queries or prepared statements.",
                "metadata": {
                    "category": "security",
                    "confidence": "HIGH",
                    "cwe": [
                        "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "HIGH",
                    "interfile": true,
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://sequelize.org/docs/v6/core-concepts/raw-queries/#replacements"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22085,
                            "rule_id": "yyU0GX",
                            "rv_id": 834186,
                            "url": "https://semgrep.dev/playground/r/w8TAxwx/javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
                            "version_id": "w8TAxwx"
                        }
                    },
                    "shortlink": "https://sg.run/gjoe",
                    "source": "https://semgrep.dev/r/javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "SQL Injection"
                    ]
                },
                "metavars": {
                    "$DB": {
                        "abstract_content": "models",
                        "end": {
                            "col": 11,
                            "line": 36,
                            "offset": 1532
                        },
                        "start": {
                            "col": 5,
                            "line": 36,
                            "offset": 1526
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 44,
                            "line": 34,
                            "offset": 1434
                        },
                        "start": {
                            "col": 40,
                            "line": 34,
                            "offset": 1430
                        }
                    },
                    "$QUERY": {
                        "abstract_content": "`SELECT * FROM Users WHERE email = 'req.body.email||''' AND password = 'security.hash(req.body.password||'')' AND deletedAt IS NULL",
                        "end": {
                            "col": 169,
                            "line": 36,
                            "offset": 1690
                        },
                        "start": {
                            "col": 28,
                            "line": 36,
                            "offset": 1549
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 69,
                            "line": 36,
                            "offset": 1590
                        },
                        "start": {
                            "col": 66,
                            "line": 36,
                            "offset": 1587
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 28,
                            "line": 34,
                            "offset": 1418
                        },
                        "start": {
                            "col": 25,
                            "line": 34,
                            "offset": 1415
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/login.ts",
            "start": {
                "col": 28,
                "line": 36,
                "offset": 1549
            }
        },
        {
            "check_id": "javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 86,
                "line": 36,
                "offset": 1607
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 86,
                                    "line": 36,
                                    "offset": 1607
                                },
                                "path": "TypeScript/juice-shop/routes/login.ts",
                                "start": {
                                    "col": 66,
                                    "line": 36,
                                    "offset": 1587
                                }
                            },
                            "req.body.email || ''"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 74,
                                    "line": 36,
                                    "offset": 1595
                                },
                                "path": "TypeScript/juice-shop/routes/login.ts",
                                "start": {
                                    "col": 66,
                                    "line": 36,
                                    "offset": 1587
                                }
                            },
                            "req.body"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "0389451a7243bc67f932efc774f3eb12c34ba67b8ccf5fa61fdd527956cc7045413eeb844739164ebd68cf03782d9cc24948aee851afc61758cf6af140fba647_0",
                "is_ignored": false,
                "lines": "    models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge loginBenderChallenge loginJimChallenge",
                "message": "Detected user input used to manually construct a SQL string. This is usually bad practice because manual construction could accidentally result in a SQL injection. An attacker could use a SQL injection to steal or modify contents of the database. Instead, use a parameterized query which is available by default in most database engines. Alternatively, consider using an object-relational mapper (ORM) such as Sequelize which will protect your queries.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/SQL_Injection"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 14715,
                            "rule_id": "NbUNpr",
                            "rv_id": 834108,
                            "url": "https://semgrep.dev/playground/r/DkTG0jd/javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
                            "version_id": "DkTG0jd"
                        }
                    },
                    "shortlink": "https://sg.run/66ZL",
                    "source": "https://semgrep.dev/r/javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "SQL Injection"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "SELECT",
                        "end": {
                            "col": 7,
                            "line": 1,
                            "offset": 6
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$EXPR": {
                        "abstract_content": "req.body.email||''",
                        "end": {
                            "col": 86,
                            "line": 36,
                            "offset": 1607
                        },
                        "start": {
                            "col": 66,
                            "line": 36,
                            "offset": 1587
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 69,
                            "line": 36,
                            "offset": 1590
                        },
                        "start": {
                            "col": 66,
                            "line": 36,
                            "offset": 1587
                        }
                    },
                    "$SQLSTR": {
                        "abstract_content": "SELECT * FROM Users WHERE email = '",
                        "end": {
                            "col": 64,
                            "line": 36,
                            "offset": 1585
                        },
                        "start": {
                            "col": 29,
                            "line": 36,
                            "offset": 1550
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/login.ts",
            "start": {
                "col": 66,
                "line": 36,
                "offset": 1587
            }
        },
        {
            "check_id": "javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 85,
                "line": 45,
                "offset": 1813
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "req",
                            "location": {
                                "end": {
                                    "col": 14,
                                    "line": 34,
                                    "offset": 1060
                                },
                                "path": "TypeScript/juice-shop/routes/order.ts",
                                "start": {
                                    "col": 11,
                                    "line": 34,
                                    "offset": 1057
                                }
                            }
                        },
                        {
                            "content": "customer",
                            "location": {
                                "end": {
                                    "col": 25,
                                    "line": 39,
                                    "offset": 1363
                                },
                                "path": "TypeScript/juice-shop/routes/order.ts",
                                "start": {
                                    "col": 17,
                                    "line": 39,
                                    "offset": 1355
                                }
                            }
                        },
                        {
                            "content": "email",
                            "location": {
                                "end": {
                                    "col": 22,
                                    "line": 40,
                                    "offset": 1426
                                },
                                "path": "TypeScript/juice-shop/routes/order.ts",
                                "start": {
                                    "col": 17,
                                    "line": 40,
                                    "offset": 1421
                                }
                            }
                        },
                        {
                            "content": "orderId",
                            "location": {
                                "end": {
                                    "col": 24,
                                    "line": 41,
                                    "offset": 1510
                                },
                                "path": "TypeScript/juice-shop/routes/order.ts",
                                "start": {
                                    "col": 17,
                                    "line": 41,
                                    "offset": 1503
                                }
                            }
                        },
                        {
                            "content": "pdfFile",
                            "location": {
                                "end": {
                                    "col": 24,
                                    "line": 42,
                                    "offset": 1604
                                },
                                "path": "TypeScript/juice-shop/routes/order.ts",
                                "start": {
                                    "col": 17,
                                    "line": 42,
                                    "offset": 1597
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 85,
                                    "line": 45,
                                    "offset": 1813
                                },
                                "path": "TypeScript/juice-shop/routes/order.ts",
                                "start": {
                                    "col": 78,
                                    "line": 45,
                                    "offset": 1806
                                }
                            },
                            "pdfFile"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 14,
                                    "line": 34,
                                    "offset": 1060
                                },
                                "path": "TypeScript/juice-shop/routes/order.ts",
                                "start": {
                                    "col": 11,
                                    "line": 34,
                                    "offset": 1057
                                }
                            },
                            "req"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "206e8d9fe0d32a408128ff47470a12baacd2e64de2cdcaa3235acb6eae5808336b2a4a069ef8aa96d842e79af6c0d912ce0eec55b799465645dcc9668c022521_0",
                "is_ignored": false,
                "lines": "          const fileWriter = doc.pipe(fs.createWriteStream(path.join('ftp/', pdfFile)))",
                "message": "Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9331,
                            "rule_id": "8GUjrq",
                            "rv_id": 834146,
                            "url": "https://semgrep.dev/playground/r/JdTlrjW/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                            "version_id": "JdTlrjW"
                        }
                    },
                    "shortlink": "https://sg.run/OPqk",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$SINK": {
                        "abstract_content": "pdfFile",
                        "end": {
                            "col": 85,
                            "line": 45,
                            "offset": 1813
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "`order_ orderId.pdf",
                            "svalue_end": {
                                "col": 48,
                                "line": 42,
                                "offset": 1628
                            },
                            "svalue_start": {
                                "col": 27,
                                "line": 42,
                                "offset": 1607
                            }
                        },
                        "start": {
                            "col": 78,
                            "line": 45,
                            "offset": 1806
                        }
                    },
                    "$X": {
                        "abstract_content": "req",
                        "end": {
                            "col": 14,
                            "line": 34,
                            "offset": 1060
                        },
                        "start": {
                            "col": 11,
                            "line": 34,
                            "offset": 1057
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/order.ts",
            "start": {
                "col": 78,
                "line": 45,
                "offset": 1806
            }
        },
        {
            "check_id": "javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 72,
                "line": 17,
                "offset": 780
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "loggedInUser",
                            "location": {
                                "end": {
                                    "col": 23,
                                    "line": 13,
                                    "offset": 454
                                },
                                "path": "TypeScript/juice-shop/routes/orderHistory.ts",
                                "start": {
                                    "col": 11,
                                    "line": 13,
                                    "offset": 442
                                }
                            }
                        },
                        {
                            "content": "email",
                            "location": {
                                "end": {
                                    "col": 18,
                                    "line": 15,
                                    "offset": 621
                                },
                                "path": "TypeScript/juice-shop/routes/orderHistory.ts",
                                "start": {
                                    "col": 13,
                                    "line": 15,
                                    "offset": 616
                                }
                            }
                        },
                        {
                            "content": "updatedEmail",
                            "location": {
                                "end": {
                                    "col": 25,
                                    "line": 16,
                                    "offset": 673
                                },
                                "path": "TypeScript/juice-shop/routes/orderHistory.ts",
                                "start": {
                                    "col": 13,
                                    "line": 16,
                                    "offset": 661
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 72,
                                    "line": 17,
                                    "offset": 780
                                },
                                "path": "TypeScript/juice-shop/routes/orderHistory.ts",
                                "start": {
                                    "col": 49,
                                    "line": 17,
                                    "offset": 757
                                }
                            },
                            "{ email: updatedEmail }"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 69,
                                    "line": 13,
                                    "offset": 500
                                },
                                "path": "TypeScript/juice-shop/routes/orderHistory.ts",
                                "start": {
                                    "col": 58,
                                    "line": 13,
                                    "offset": 489
                                }
                            },
                            "req.headers"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "e9b9b316fb00d52f6abc244bcfceb7446a9e90c1c5b2e301d3c2c0f508f1aebd48d192c959af47f1057537b6a8fa3492a3bdad4bbb1ed73bb11866534c028cfb_0",
                "is_ignored": false,
                "lines": "      const order = await ordersCollection.find({ email: updatedEmail })",
                "message": "Detected a `../data/mongodb` statement that comes from a `req` argument. This could lead to NoSQL injection if the variable is user-controlled and is not properly sanitized. Be sure to properly sanitize the data if you absolutely must pass request data into a mongo query.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-943: Improper Neutralization of Special Elements in Data Query Logic"
                    ],
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "db::sink::sql-or-nosql-query::mongoose",
                        "db::sink::sql-or-nosql-query::mongojs",
                        "db::sink::sql-or-nosql-query::mongodb"
                    ],
                    "impact": "HIGH",
                    "interfile": true,
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/www-pdf-archive/GOD16-NOSQL.pdf"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 28086,
                            "rule_id": "WAUqgq",
                            "rv_id": 850621,
                            "url": "https://semgrep.dev/playground/r/YDTlXwn/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                            "version_id": "YDTlXwn"
                        }
                    },
                    "shortlink": "https://sg.run/Qqxq",
                    "source": "https://semgrep.dev/r/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "nodejs",
                        "mongodb"
                    ],
                    "vulnerability_class": [
                        "Improper Validation"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "mongodb",
                        "end": {
                            "col": 12,
                            "line": 2,
                            "offset": 15
                        },
                        "start": {
                            "col": 5,
                            "line": 2,
                            "offset": 8
                        }
                    },
                    "$DB": {
                        "abstract_content": "ordersCollection",
                        "end": {
                            "col": 43,
                            "line": 17,
                            "offset": 751
                        },
                        "start": {
                            "col": 27,
                            "line": 17,
                            "offset": 735
                        }
                    },
                    "$IMPORT": {
                        "abstract_content": "../data/mongodb",
                        "end": {
                            "col": 50,
                            "line": 7,
                            "offset": 249
                        },
                        "start": {
                            "col": 35,
                            "line": 7,
                            "offset": 234
                        }
                    },
                    "$M": {
                        "abstract_content": "find",
                        "end": {
                            "col": 48,
                            "line": 17,
                            "offset": 756
                        },
                        "start": {
                            "col": 44,
                            "line": 17,
                            "offset": 752
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 61,
                            "line": 13,
                            "offset": 492
                        },
                        "start": {
                            "col": 58,
                            "line": 13,
                            "offset": 489
                        }
                    },
                    "$VALUE": {
                        "abstract_content": "{email updatedEmail}",
                        "end": {
                            "col": 72,
                            "line": 17,
                            "offset": 780
                        },
                        "start": {
                            "col": 49,
                            "line": 17,
                            "offset": 757
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/orderHistory.ts",
            "start": {
                "col": 49,
                "line": 17,
                "offset": 757
            }
        },
        {
            "check_id": "javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 57,
                "line": 36,
                "offset": 1512
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 57,
                                    "line": 36,
                                    "offset": 1512
                                },
                                "path": "TypeScript/juice-shop/routes/orderHistory.ts",
                                "start": {
                                    "col": 35,
                                    "line": 36,
                                    "offset": 1490
                                }
                            },
                            "{ _id: req.params.id }"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 52,
                                    "line": 36,
                                    "offset": 1507
                                },
                                "path": "TypeScript/juice-shop/routes/orderHistory.ts",
                                "start": {
                                    "col": 42,
                                    "line": 36,
                                    "offset": 1497
                                }
                            },
                            "req.params"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "9c1eb77e998912907145f612b8c2af692af4a744dd8f5132c1a3f90c154cef1ce05ee5fbcdb20e2987d48b24abc5f74231c5c41c70e9e8eeb4851ed9c896f112_0",
                "is_ignored": false,
                "lines": "    await ordersCollection.update({ _id: req.params.id }, { $set: { delivered: deliveryStatus, eta } })",
                "message": "Detected a `../data/mongodb` statement that comes from a `req` argument. This could lead to NoSQL injection if the variable is user-controlled and is not properly sanitized. Be sure to properly sanitize the data if you absolutely must pass request data into a mongo query.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-943: Improper Neutralization of Special Elements in Data Query Logic"
                    ],
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "db::sink::sql-or-nosql-query::mongoose",
                        "db::sink::sql-or-nosql-query::mongojs",
                        "db::sink::sql-or-nosql-query::mongodb"
                    ],
                    "impact": "HIGH",
                    "interfile": true,
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/www-pdf-archive/GOD16-NOSQL.pdf"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 28086,
                            "rule_id": "WAUqgq",
                            "rv_id": 850621,
                            "url": "https://semgrep.dev/playground/r/YDTlXwn/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                            "version_id": "YDTlXwn"
                        }
                    },
                    "shortlink": "https://sg.run/Qqxq",
                    "source": "https://semgrep.dev/r/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "nodejs",
                        "mongodb"
                    ],
                    "vulnerability_class": [
                        "Improper Validation"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "mongodb",
                        "end": {
                            "col": 12,
                            "line": 2,
                            "offset": 15
                        },
                        "start": {
                            "col": 5,
                            "line": 2,
                            "offset": 8
                        }
                    },
                    "$DB": {
                        "abstract_content": "ordersCollection",
                        "end": {
                            "col": 27,
                            "line": 36,
                            "offset": 1482
                        },
                        "start": {
                            "col": 11,
                            "line": 36,
                            "offset": 1466
                        }
                    },
                    "$IMPORT": {
                        "abstract_content": "../data/mongodb",
                        "end": {
                            "col": 50,
                            "line": 7,
                            "offset": 249
                        },
                        "start": {
                            "col": 35,
                            "line": 7,
                            "offset": 234
                        }
                    },
                    "$M": {
                        "abstract_content": "update",
                        "end": {
                            "col": 34,
                            "line": 36,
                            "offset": 1489
                        },
                        "start": {
                            "col": 28,
                            "line": 36,
                            "offset": 1483
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 45,
                            "line": 36,
                            "offset": 1500
                        },
                        "start": {
                            "col": 42,
                            "line": 36,
                            "offset": 1497
                        }
                    },
                    "$VALUE": {
                        "abstract_content": "{_id req.params.id}",
                        "end": {
                            "col": 57,
                            "line": 36,
                            "offset": 1512
                        },
                        "start": {
                            "col": 35,
                            "line": 36,
                            "offset": 1490
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/orderHistory.ts",
            "start": {
                "col": 35,
                "line": 36,
                "offset": 1490
            }
        },
        {
            "check_id": "javascript.express.express-fs-filename.express-fs-filename",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 118,
                "line": 28,
                "offset": 1119
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "loggedInUser",
                            "location": {
                                "end": {
                                    "col": 27,
                                    "line": 26,
                                    "offset": 918
                                },
                                "path": "TypeScript/juice-shop/routes/profileImageFileUpload.ts",
                                "start": {
                                    "col": 15,
                                    "line": 26,
                                    "offset": 906
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 118,
                                    "line": 28,
                                    "offset": 1119
                                },
                                "path": "TypeScript/juice-shop/routes/profileImageFileUpload.ts",
                                "start": {
                                    "col": 19,
                                    "line": 28,
                                    "offset": 1020
                                }
                            },
                            "`frontend/dist/frontend/assets/public/images/uploads/${loggedInUser.data.id}.${uploadedFileType.ext"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 73,
                                    "line": 26,
                                    "offset": 964
                                },
                                "path": "TypeScript/juice-shop/routes/profileImageFileUpload.ts",
                                "start": {
                                    "col": 62,
                                    "line": 26,
                                    "offset": 953
                                }
                            },
                            "req.cookies"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "accce3c9686b6364cb7ac06c10cb849626572b340e3169bd45b3df739198475254a76d5e21c3ba386c4be98650ab7c3ff6ad2ff686946cd6e4d29fba2ede8a70_0",
                "is_ignored": false,
                "lines": "          fs.open(`frontend/dist/frontend/assets/public/images/uploads/${loggedInUser.data.id}.${uploadedFileType.ext}`, 'w', function (err, fd) {",
                "message": "The application builds a file path from potentially untrusted data, which can lead to a path traversal vulnerability. An attacker can manipulate the file path which the application uses to access files. If the application does not validate user input and sanitize file paths, sensitive files such as configuration or user data can be accessed, potentially creating or overwriting files. To prevent this vulnerability, validate and sanitize any input that is used to create references to file paths. Also, enforce strict file access controls. For example, choose privileges allowing public-facing applications to access only the required files.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "file::sink::file-access:nodejs.fs"
                    ],
                    "impact": "MEDIUM",
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 28654,
                            "rule_id": "kxUzPO",
                            "rv_id": 850619,
                            "url": "https://semgrep.dev/playground/r/qkTQlv4/javascript.express.express-fs-filename.express-fs-filename",
                            "version_id": "qkTQlv4"
                        }
                    },
                    "shortlink": "https://sg.run/0B9W",
                    "source": "https://semgrep.dev/r/javascript.express.express-fs-filename.express-fs-filename",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "nodejs"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$FILE": {
                        "abstract_content": "`frontend/dist/frontend/assets/public/images/uploads/loggedInUser.data.id.uploadedFileType.ext",
                        "end": {
                            "col": 118,
                            "line": 28,
                            "offset": 1119
                        },
                        "start": {
                            "col": 19,
                            "line": 28,
                            "offset": 1020
                        }
                    },
                    "$FS": {
                        "abstract_content": "fs",
                        "end": {
                            "col": 13,
                            "line": 28,
                            "offset": 1014
                        },
                        "start": {
                            "col": 11,
                            "line": 28,
                            "offset": 1012
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 50,
                            "line": 16,
                            "offset": 528
                        },
                        "start": {
                            "col": 46,
                            "line": 16,
                            "offset": 524
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 65,
                            "line": 26,
                            "offset": 956
                        },
                        "start": {
                            "col": 62,
                            "line": 26,
                            "offset": 953
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 34,
                            "line": 16,
                            "offset": 512
                        },
                        "start": {
                            "col": 31,
                            "line": 16,
                            "offset": 509
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/profileImageFileUpload.ts",
            "start": {
                "col": 19,
                "line": 28,
                "offset": 1020
            }
        },
        {
            "check_id": "javascript.express.request.ssrf-deepsemgrep.ssrf-deepsemgrep",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 19,
                "line": 23,
                "offset": 906
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "url",
                            "location": {
                                "end": {
                                    "col": 16,
                                    "line": 18,
                                    "offset": 611
                                },
                                "path": "TypeScript/juice-shop/routes/profileImageUrlUpload.ts",
                                "start": {
                                    "col": 13,
                                    "line": 18,
                                    "offset": 608
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 19,
                                    "line": 23,
                                    "offset": 906
                                },
                                "path": "TypeScript/juice-shop/routes/profileImageUrlUpload.ts",
                                "start": {
                                    "col": 16,
                                    "line": 23,
                                    "offset": 903
                                }
                            },
                            "url"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 27,
                                    "line": 18,
                                    "offset": 622
                                },
                                "path": "TypeScript/juice-shop/routes/profileImageUrlUpload.ts",
                                "start": {
                                    "col": 19,
                                    "line": 18,
                                    "offset": 614
                                }
                            },
                            "req.body"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "5ea5c3afb829767967465aa1fd7d961bc1349c469a6e8e212af55490c11481eec4947724edb8423075ebeaab4c758d48fcfe80b4f6f6765922b931fccf35edef_0",
                "is_ignored": false,
                "lines": "          .get(url)",
                "message": "Untrusted input might be used to build an HTTP request, which can lead to a Server-side request forgery (SSRF) vulnerability. SSRF allows an attacker to send crafted requests from the server side to other internal or external systems. SSRF can lead to unauthorized access to sensitive data and, in some cases, allow the attacker to control applications or systems that trust the vulnerable service. To prevent this vulnerability, avoid allowing user input to craft the base request. Instead, treat it as part of the path or query parameter and encode it appropriately. When user input is necessary to prepare the HTTP request, perform strict input validation. Additionally, whenever possible, use allowlists to only interact with expected, trusted domains.",
                "metadata": {
                    "category": "security",
                    "confidence": "HIGH",
                    "cwe": [
                        "CWE-918: Server-Side Request Forgery (SSRF)"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "net::sink::http-request::request"
                    ],
                    "impact": "HIGH",
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "MEDIUM",
                    "owasp": [
                        "A10:2021 - Server-Side Request Forgery (SSRF)"
                    ],
                    "references": [
                        "https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 43797,
                            "rule_id": "j2Up4D",
                            "rv_id": 850629,
                            "url": "https://semgrep.dev/playground/r/WrTdr7k/javascript.express.request.ssrf-deepsemgrep.ssrf-deepsemgrep",
                            "version_id": "WrTdr7k"
                        }
                    },
                    "shortlink": "https://sg.run/Wxn4",
                    "source": "https://semgrep.dev/r/javascript.express.request.ssrf-deepsemgrep.ssrf-deepsemgrep",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "Server-Side Request Forgery (SSRF)"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "get",
                        "end": {
                            "col": 4,
                            "line": 1,
                            "offset": 3
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$METHOD": {
                        "abstract_content": "get",
                        "end": {
                            "col": 15,
                            "line": 23,
                            "offset": 902
                        },
                        "start": {
                            "col": 12,
                            "line": 23,
                            "offset": 899
                        }
                    },
                    "$QUERY": {
                        "abstract_content": "url",
                        "end": {
                            "col": 19,
                            "line": 23,
                            "offset": 906
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "req.body.imageUrl",
                            "svalue_end": {
                                "col": 36,
                                "line": 18,
                                "offset": 631
                            },
                            "svalue_start": {
                                "col": 19,
                                "line": 18,
                                "offset": 614
                            }
                        },
                        "start": {
                            "col": 16,
                            "line": 23,
                            "offset": 903
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 22,
                            "line": 18,
                            "offset": 617
                        },
                        "start": {
                            "col": 19,
                            "line": 18,
                            "offset": 614
                        }
                    },
                    "$REQUIRE": {
                        "abstract_content": "request",
                        "end": {
                            "col": 37,
                            "line": 22,
                            "offset": 886
                        },
                        "start": {
                            "col": 30,
                            "line": 22,
                            "offset": 879
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/profileImageUrlUpload.ts",
            "start": {
                "col": 16,
                "line": 23,
                "offset": 903
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-ssrf.express-ssrf",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 19,
                "line": 23,
                "offset": 906
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "url",
                            "location": {
                                "end": {
                                    "col": 16,
                                    "line": 18,
                                    "offset": 611
                                },
                                "path": "TypeScript/juice-shop/routes/profileImageUrlUpload.ts",
                                "start": {
                                    "col": 13,
                                    "line": 18,
                                    "offset": 608
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 19,
                                    "line": 23,
                                    "offset": 906
                                },
                                "path": "TypeScript/juice-shop/routes/profileImageUrlUpload.ts",
                                "start": {
                                    "col": 16,
                                    "line": 23,
                                    "offset": 903
                                }
                            },
                            "url"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 27,
                                    "line": 18,
                                    "offset": 622
                                },
                                "path": "TypeScript/juice-shop/routes/profileImageUrlUpload.ts",
                                "start": {
                                    "col": 19,
                                    "line": 18,
                                    "offset": 614
                                }
                            },
                            "req.body"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "91a1fb297fd30a45197ca1eb5012e3e8b6c3514e2b4fcdcbe66f1b4b73749f30a036f49acd0a09416fa3b04419b5662ea1192a0f2c94c3479c2a9a0dbf21baae_0",
                "is_ignored": false,
                "lines": "          .get(url)",
                "message": "The following request request.get() was found to be crafted from user-input `req` which can lead to Server-Side Request Forgery (SSRF) vulnerabilities. It is recommended where possible to not allow user-input to craft the base request, but to be treated as part of the path or query parameter. When user-input is necessary to craft the request, it is recommeneded to follow OWASP best practices to prevent abuse. ",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-918: Server-Side Request Forgery (SSRF)"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "HIGH",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "MEDIUM",
                    "owasp": [
                        "A10:2021 - Server-Side Request Forgery (SSRF)"
                    ],
                    "references": [
                        "https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22554,
                            "rule_id": "eqU9l2",
                            "rv_id": 834075,
                            "url": "https://semgrep.dev/playground/r/2KT7x2Y/javascript.express.security.audit.express-ssrf.express-ssrf",
                            "version_id": "2KT7x2Y"
                        }
                    },
                    "shortlink": "https://sg.run/0PNw",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-ssrf.express-ssrf",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "Server-Side Request Forgery (SSRF)"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "get",
                        "end": {
                            "col": 4,
                            "line": 1,
                            "offset": 3
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$ASSIGN": {
                        "abstract_content": "url",
                        "end": {
                            "col": 19,
                            "line": 23,
                            "offset": 906
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "req.body.imageUrl",
                            "svalue_end": {
                                "col": 36,
                                "line": 18,
                                "offset": 631
                            },
                            "svalue_start": {
                                "col": 19,
                                "line": 18,
                                "offset": 614
                            }
                        },
                        "start": {
                            "col": 16,
                            "line": 23,
                            "offset": 903
                        }
                    },
                    "$METHOD": {
                        "abstract_content": "get",
                        "end": {
                            "col": 15,
                            "line": 23,
                            "offset": 902
                        },
                        "start": {
                            "col": 12,
                            "line": 23,
                            "offset": 899
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 22,
                            "line": 18,
                            "offset": 617
                        },
                        "start": {
                            "col": 19,
                            "line": 18,
                            "offset": 614
                        }
                    },
                    "$REQUEST": {
                        "abstract_content": "request",
                        "end": {
                            "col": 37,
                            "line": 22,
                            "offset": 886
                        },
                        "start": {
                            "col": 30,
                            "line": 22,
                            "offset": 879
                        }
                    },
                    "$VALUE": {
                        "abstract_content": "imageUrl",
                        "end": {
                            "col": 36,
                            "line": 18,
                            "offset": 631
                        },
                        "start": {
                            "col": 28,
                            "line": 18,
                            "offset": 623
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/profileImageUrlUpload.ts",
            "start": {
                "col": 16,
                "line": 23,
                "offset": 903
            }
        },
        {
            "check_id": "javascript.express.express-fs-filename.express-fs-filename",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 136,
                "line": 31,
                "offset": 1683
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "url",
                            "location": {
                                "end": {
                                    "col": 16,
                                    "line": 18,
                                    "offset": 611
                                },
                                "path": "TypeScript/juice-shop/routes/profileImageUrlUpload.ts",
                                "start": {
                                    "col": 13,
                                    "line": 18,
                                    "offset": 608
                                }
                            }
                        },
                        {
                            "content": "ext",
                            "location": {
                                "end": {
                                    "col": 24,
                                    "line": 30,
                                    "offset": 1403
                                },
                                "path": "TypeScript/juice-shop/routes/profileImageUrlUpload.ts",
                                "start": {
                                    "col": 21,
                                    "line": 30,
                                    "offset": 1400
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 136,
                                    "line": 31,
                                    "offset": 1683
                                },
                                "path": "TypeScript/juice-shop/routes/profileImageUrlUpload.ts",
                                "start": {
                                    "col": 54,
                                    "line": 31,
                                    "offset": 1601
                                }
                            },
                            "`frontend/dist/frontend/assets/public/images/uploads/${loggedInUser.data.id}.${ext"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 27,
                                    "line": 18,
                                    "offset": 622
                                },
                                "path": "TypeScript/juice-shop/routes/profileImageUrlUpload.ts",
                                "start": {
                                    "col": 19,
                                    "line": 18,
                                    "offset": 614
                                }
                            },
                            "req.body"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "1ee595853f6030c48ae47cef52b9de5cabdaea0f3db579a258c672f2db3d033911a0b352f555966db5634d60411d50f90a3d6872a47f648a3c0d7db84a3593eb_0",
                "is_ignored": false,
                "lines": "              imageRequest.pipe(fs.createWriteStream(`frontend/dist/frontend/assets/public/images/uploads/${loggedInUser.data.id}.${ext}`))",
                "message": "The application builds a file path from potentially untrusted data, which can lead to a path traversal vulnerability. An attacker can manipulate the file path which the application uses to access files. If the application does not validate user input and sanitize file paths, sensitive files such as configuration or user data can be accessed, potentially creating or overwriting files. To prevent this vulnerability, validate and sanitize any input that is used to create references to file paths. Also, enforce strict file access controls. For example, choose privileges allowing public-facing applications to access only the required files.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "file::sink::file-access:nodejs.fs"
                    ],
                    "impact": "MEDIUM",
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 28654,
                            "rule_id": "kxUzPO",
                            "rv_id": 850619,
                            "url": "https://semgrep.dev/playground/r/qkTQlv4/javascript.express.express-fs-filename.express-fs-filename",
                            "version_id": "qkTQlv4"
                        }
                    },
                    "shortlink": "https://sg.run/0B9W",
                    "source": "https://semgrep.dev/r/javascript.express.express-fs-filename.express-fs-filename",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "nodejs"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$FILE": {
                        "abstract_content": "`frontend/dist/frontend/assets/public/images/uploads/loggedInUser.data.id.ext",
                        "end": {
                            "col": 136,
                            "line": 31,
                            "offset": 1683
                        },
                        "start": {
                            "col": 54,
                            "line": 31,
                            "offset": 1601
                        }
                    },
                    "$FS": {
                        "abstract_content": "fs",
                        "end": {
                            "col": 35,
                            "line": 31,
                            "offset": 1582
                        },
                        "start": {
                            "col": 33,
                            "line": 31,
                            "offset": 1580
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 44,
                            "line": 16,
                            "offset": 530
                        },
                        "start": {
                            "col": 40,
                            "line": 16,
                            "offset": 526
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 22,
                            "line": 18,
                            "offset": 617
                        },
                        "start": {
                            "col": 19,
                            "line": 18,
                            "offset": 614
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 28,
                            "line": 16,
                            "offset": 514
                        },
                        "start": {
                            "col": 25,
                            "line": 16,
                            "offset": 511
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/profileImageUrlUpload.ts",
            "start": {
                "col": 54,
                "line": 31,
                "offset": 1601
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-res-sendfile.express-res-sendfile",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 57,
                "line": 14,
                "offset": 485
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "params",
                            "location": {
                                "end": {
                                    "col": 19,
                                    "line": 10,
                                    "offset": 304
                                },
                                "path": "TypeScript/juice-shop/routes/quarantineServer.ts",
                                "start": {
                                    "col": 13,
                                    "line": 10,
                                    "offset": 298
                                }
                            }
                        },
                        {
                            "content": "file",
                            "location": {
                                "end": {
                                    "col": 15,
                                    "line": 11,
                                    "offset": 379
                                },
                                "path": "TypeScript/juice-shop/routes/quarantineServer.ts",
                                "start": {
                                    "col": 11,
                                    "line": 11,
                                    "offset": 375
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 57,
                                    "line": 14,
                                    "offset": 485
                                },
                                "path": "TypeScript/juice-shop/routes/quarantineServer.ts",
                                "start": {
                                    "col": 20,
                                    "line": 14,
                                    "offset": 448
                                }
                            },
                            "path.resolve('ftp/quarantine/', file)"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 19,
                                    "line": 10,
                                    "offset": 304
                                },
                                "path": "TypeScript/juice-shop/routes/quarantineServer.ts",
                                "start": {
                                    "col": 13,
                                    "line": 10,
                                    "offset": 298
                                }
                            },
                            "params"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "795097a6d4861812ab5f1d8d0dc048703ede1bb7d8ea9636cd9856fd60d7c6664246611f9dc9996bb7be349ba32a7883e27013cc778ec9c375597f63c75d1690_0",
                "is_ignored": false,
                "lines": "      res.sendFile(path.resolve('ftp/quarantine/', file))",
                "message": "The application processes user-input, this is passed to res.sendFile which can allow an attacker to arbitrarily read files on the system through path traversal. It is recommended to perform input validation in addition to canonicalizing the path. This allows you to validate the path against the intended directory it should be accessing.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-73: External Control of File Name or Path"
                    ],
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A04:2021 - Insecure Design"
                    ],
                    "references": [
                        "https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22082,
                            "rule_id": "j2UzDx",
                            "rv_id": 834073,
                            "url": "https://semgrep.dev/playground/r/zyTWJ2W/javascript.express.security.audit.express-res-sendfile.express-res-sendfile",
                            "version_id": "zyTWJ2W"
                        }
                    },
                    "shortlink": "https://sg.run/7DJk",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-res-sendfile.express-res-sendfile",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "sendFile",
                        "end": {
                            "col": 9,
                            "line": 1,
                            "offset": 8
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$METH": {
                        "abstract_content": "sendFile",
                        "end": {
                            "col": 19,
                            "line": 14,
                            "offset": 447
                        },
                        "start": {
                            "col": 11,
                            "line": 14,
                            "offset": 439
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 58,
                            "line": 10,
                            "offset": 343
                        },
                        "start": {
                            "col": 54,
                            "line": 10,
                            "offset": 339
                        }
                    },
                    "$QUERY": {
                        "abstract_content": "path.resolve('ftp/quarantine/'file)",
                        "end": {
                            "col": 57,
                            "line": 14,
                            "offset": 485
                        },
                        "start": {
                            "col": 20,
                            "line": 14,
                            "offset": 448
                        }
                    },
                    "$REQ": {
                        "abstract_content": "params",
                        "end": {
                            "col": 19,
                            "line": 10,
                            "offset": 304
                        },
                        "start": {
                            "col": 13,
                            "line": 10,
                            "offset": 298
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 42,
                            "line": 10,
                            "offset": 327
                        },
                        "start": {
                            "col": 39,
                            "line": 10,
                            "offset": 324
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/quarantineServer.ts",
            "start": {
                "col": 20,
                "line": 14,
                "offset": 448
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-path-join-resolve-traversal.express-path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 56,
                "line": 14,
                "offset": 484
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "params",
                            "location": {
                                "end": {
                                    "col": 19,
                                    "line": 10,
                                    "offset": 304
                                },
                                "path": "TypeScript/juice-shop/routes/quarantineServer.ts",
                                "start": {
                                    "col": 13,
                                    "line": 10,
                                    "offset": 298
                                }
                            }
                        },
                        {
                            "content": "file",
                            "location": {
                                "end": {
                                    "col": 15,
                                    "line": 11,
                                    "offset": 379
                                },
                                "path": "TypeScript/juice-shop/routes/quarantineServer.ts",
                                "start": {
                                    "col": 11,
                                    "line": 11,
                                    "offset": 375
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 56,
                                    "line": 14,
                                    "offset": 484
                                },
                                "path": "TypeScript/juice-shop/routes/quarantineServer.ts",
                                "start": {
                                    "col": 52,
                                    "line": 14,
                                    "offset": 480
                                }
                            },
                            "file"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 19,
                                    "line": 10,
                                    "offset": 304
                                },
                                "path": "TypeScript/juice-shop/routes/quarantineServer.ts",
                                "start": {
                                    "col": 13,
                                    "line": 10,
                                    "offset": 298
                                }
                            },
                            "params"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "55647c7f4526211a37672d80dbcee86e1e6712eb7b22fd04cf393006d5ea1f77f4ac3efda282ca7799f02c10e16de55d5005d66ac6fe05e8c2412c8b33843c31_0",
                "is_ignored": false,
                "lines": "      res.sendFile(path.resolve('ftp/quarantine/', file))",
                "message": "Possible writing outside of the destination, make sure that the target path is nested in the intended destination",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9273,
                            "rule_id": "L1Uyb8",
                            "rv_id": 834072,
                            "url": "https://semgrep.dev/playground/r/o5TBED2/javascript.express.security.audit.express-path-join-resolve-traversal.express-path-join-resolve-traversal",
                            "version_id": "o5TBED2"
                        }
                    },
                    "shortlink": "https://sg.run/weRn",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-path-join-resolve-traversal.express-path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 58,
                            "line": 10,
                            "offset": 343
                        },
                        "start": {
                            "col": 54,
                            "line": 10,
                            "offset": 339
                        }
                    },
                    "$REQ": {
                        "abstract_content": "params",
                        "end": {
                            "col": 19,
                            "line": 10,
                            "offset": 304
                        },
                        "start": {
                            "col": 13,
                            "line": 10,
                            "offset": 298
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 42,
                            "line": 10,
                            "offset": 327
                        },
                        "start": {
                            "col": 39,
                            "line": 10,
                            "offset": 324
                        }
                    },
                    "$SINK": {
                        "abstract_content": "file",
                        "end": {
                            "col": 56,
                            "line": 14,
                            "offset": 484
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "params.file",
                            "svalue_end": {
                                "col": 29,
                                "line": 11,
                                "offset": 393
                            },
                            "svalue_start": {
                                "col": 18,
                                "line": 11,
                                "offset": 382
                            }
                        },
                        "start": {
                            "col": 52,
                            "line": 14,
                            "offset": 480
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/quarantineServer.ts",
            "start": {
                "col": 52,
                "line": 14,
                "offset": 480
            }
        },
        {
            "check_id": "javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 56,
                "line": 14,
                "offset": 484
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "params",
                            "location": {
                                "end": {
                                    "col": 19,
                                    "line": 10,
                                    "offset": 304
                                },
                                "path": "TypeScript/juice-shop/routes/quarantineServer.ts",
                                "start": {
                                    "col": 13,
                                    "line": 10,
                                    "offset": 298
                                }
                            }
                        },
                        {
                            "content": "file",
                            "location": {
                                "end": {
                                    "col": 15,
                                    "line": 11,
                                    "offset": 379
                                },
                                "path": "TypeScript/juice-shop/routes/quarantineServer.ts",
                                "start": {
                                    "col": 11,
                                    "line": 11,
                                    "offset": 375
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 56,
                                    "line": 14,
                                    "offset": 484
                                },
                                "path": "TypeScript/juice-shop/routes/quarantineServer.ts",
                                "start": {
                                    "col": 52,
                                    "line": 14,
                                    "offset": 480
                                }
                            },
                            "file"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 37,
                                    "line": 10,
                                    "offset": 322
                                },
                                "path": "TypeScript/juice-shop/routes/quarantineServer.ts",
                                "start": {
                                    "col": 11,
                                    "line": 10,
                                    "offset": 296
                                }
                            },
                            "{ params, query }: Request"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "b5cbaab15148d99695314229aac805699982831d906795fbce2150ebde4322454ba3d5369dedc2f8a83a866b0be042918dbda1e947827b0c3edd37ac56448ffc_0",
                "is_ignored": false,
                "lines": "      res.sendFile(path.resolve('ftp/quarantine/', file))",
                "message": "Detected possible user input going into a `path.join` or `path.resolve` function. This could possibly lead to a path traversal vulnerability,  where the attacker can access arbitrary files stored in the file system. Instead, be sure to sanitize or validate user input first.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9331,
                            "rule_id": "8GUjrq",
                            "rv_id": 834146,
                            "url": "https://semgrep.dev/playground/r/JdTlrjW/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                            "version_id": "JdTlrjW"
                        }
                    },
                    "shortlink": "https://sg.run/OPqk",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.path-traversal.path-join-resolve-traversal.path-join-resolve-traversal",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript",
                        "node.js"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$SINK": {
                        "abstract_content": "file",
                        "end": {
                            "col": 56,
                            "line": 14,
                            "offset": 484
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "params.file",
                            "svalue_end": {
                                "col": 29,
                                "line": 11,
                                "offset": 393
                            },
                            "svalue_start": {
                                "col": 18,
                                "line": 11,
                                "offset": 382
                            }
                        },
                        "start": {
                            "col": 52,
                            "line": 14,
                            "offset": 480
                        }
                    },
                    "$X": {
                        "abstract_content": "{params params query query}Request",
                        "end": {
                            "col": 37,
                            "line": 10,
                            "offset": 322
                        },
                        "start": {
                            "col": 11,
                            "line": 10,
                            "offset": 296
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/quarantineServer.ts",
            "start": {
                "col": 52,
                "line": 14,
                "offset": 480
            }
        },
        {
            "check_id": "javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 25,
                "line": 19,
                "offset": 1080
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "query",
                            "location": {
                                "end": {
                                    "col": 18,
                                    "line": 14,
                                    "offset": 462
                                },
                                "path": "TypeScript/juice-shop/routes/redirect.ts",
                                "start": {
                                    "col": 13,
                                    "line": 14,
                                    "offset": 457
                                }
                            }
                        },
                        {
                            "content": "toUrl",
                            "location": {
                                "end": {
                                    "col": 16,
                                    "line": 15,
                                    "offset": 531
                                },
                                "path": "TypeScript/juice-shop/routes/redirect.ts",
                                "start": {
                                    "col": 11,
                                    "line": 15,
                                    "offset": 526
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 25,
                                    "line": 19,
                                    "offset": 1080
                                },
                                "path": "TypeScript/juice-shop/routes/redirect.ts",
                                "start": {
                                    "col": 20,
                                    "line": 19,
                                    "offset": 1075
                                }
                            },
                            "toUrl"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 18,
                                    "line": 14,
                                    "offset": 462
                                },
                                "path": "TypeScript/juice-shop/routes/redirect.ts",
                                "start": {
                                    "col": 13,
                                    "line": 14,
                                    "offset": 457
                                }
                            },
                            "query"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "dbd25ed1f354a7971d992da6d3c9096bbbfdec187e19a7ed37fd23158fc87d56a99ca9a48641965ef3006e470a73b64f2f02ac529d9eeb43ac6f5ad4fcd79610_0",
                "is_ignored": false,
                "lines": "      res.redirect(toUrl)",
                "message": "The application builds a URL using user-controlled input which can lead to an open redirect vulnerability. An attacker can manipulate the URL and redirect users to an arbitrary domain. Open redirect vulnerabilities can lead to issues such as Cross-site scripting (XSS) or redirecting to a malicious domain for activities such as phishing to capture users' credentials. To prevent this vulnerability perform strict input validation of the domain against an allowlist of approved domains. Notify a user in your application that they are leaving the website. Display a domain where they are redirected to the user. A user can then either accept or deny the redirect to an untrusted site.",
                "metadata": {
                    "category": "security",
                    "confidence": "HIGH",
                    "cwe": [
                        "CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"
                    ],
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::sink::redirect::express"
                    ],
                    "impact": "MEDIUM",
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 43795,
                            "rule_id": "2ZUXkp",
                            "rv_id": 850625,
                            "url": "https://semgrep.dev/playground/r/RGTK1En/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep",
                            "version_id": "RGTK1En"
                        }
                    },
                    "shortlink": "https://sg.run/BDbW",
                    "source": "https://semgrep.dev/r/javascript.express.open-redirect-deepsemgrep.open-redirect-deepsemgrep",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "Open Redirect"
                    ]
                },
                "metavars": {
                    "$QUERY": {
                        "abstract_content": "toUrl",
                        "end": {
                            "col": 25,
                            "line": 19,
                            "offset": 1080
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "query.to as string",
                            "svalue_end": {
                                "col": 45,
                                "line": 15,
                                "offset": 560
                            },
                            "svalue_start": {
                                "col": 27,
                                "line": 15,
                                "offset": 542
                            }
                        },
                        "start": {
                            "col": 20,
                            "line": 19,
                            "offset": 1075
                        }
                    },
                    "$REQ": {
                        "abstract_content": "query",
                        "end": {
                            "col": 18,
                            "line": 14,
                            "offset": 462
                        },
                        "start": {
                            "col": 13,
                            "line": 14,
                            "offset": 457
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 10,
                            "line": 19,
                            "offset": 1065
                        },
                        "start": {
                            "col": 7,
                            "line": 19,
                            "offset": 1062
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/redirect.ts",
            "start": {
                "col": 20,
                "line": 19,
                "offset": 1075
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-open-redirect.express-open-redirect",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 25,
                "line": 19,
                "offset": 1080
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "query",
                            "location": {
                                "end": {
                                    "col": 18,
                                    "line": 14,
                                    "offset": 462
                                },
                                "path": "TypeScript/juice-shop/routes/redirect.ts",
                                "start": {
                                    "col": 13,
                                    "line": 14,
                                    "offset": 457
                                }
                            }
                        },
                        {
                            "content": "toUrl",
                            "location": {
                                "end": {
                                    "col": 16,
                                    "line": 15,
                                    "offset": 531
                                },
                                "path": "TypeScript/juice-shop/routes/redirect.ts",
                                "start": {
                                    "col": 11,
                                    "line": 15,
                                    "offset": 526
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 25,
                                    "line": 19,
                                    "offset": 1080
                                },
                                "path": "TypeScript/juice-shop/routes/redirect.ts",
                                "start": {
                                    "col": 20,
                                    "line": 19,
                                    "offset": 1075
                                }
                            },
                            "toUrl"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 18,
                                    "line": 14,
                                    "offset": 462
                                },
                                "path": "TypeScript/juice-shop/routes/redirect.ts",
                                "start": {
                                    "col": 13,
                                    "line": 14,
                                    "offset": 457
                                }
                            },
                            "query"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "8f71e9bad93e179ed1044779a6f9944b733a9c5cc7e03391d028e173807fd2f751e2137e8b86ccfbc82681b2fa169269865130aeda1efc74760928ec5a971b91_0",
                "is_ignored": false,
                "lines": "      res.redirect(toUrl)",
                "message": "The application redirects to a URL specified by user-supplied input `query` that is not validated. This could redirect users to malicious locations. Consider using an allow-list approach to validate URLs, or warn users they are being redirected to a third-party website.",
                "metadata": {
                    "category": "security",
                    "confidence": "HIGH",
                    "cwe": [
                        "CWE-601: URL Redirection to Untrusted Site ('Open Redirect')"
                    ],
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22081,
                            "rule_id": "X5ULkq",
                            "rv_id": 834071,
                            "url": "https://semgrep.dev/playground/r/6xTDg91/javascript.express.security.audit.express-open-redirect.express-open-redirect",
                            "version_id": "6xTDg91"
                        }
                    },
                    "shortlink": "https://sg.run/EpoP",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-open-redirect.express-open-redirect",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "Open Redirect"
                    ]
                },
                "metavars": {
                    "$ASSIGN": {
                        "abstract_content": "toUrl",
                        "end": {
                            "col": 25,
                            "line": 19,
                            "offset": 1080
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "query.to as string",
                            "svalue_end": {
                                "col": 45,
                                "line": 15,
                                "offset": 560
                            },
                            "svalue_start": {
                                "col": 27,
                                "line": 15,
                                "offset": 542
                            }
                        },
                        "start": {
                            "col": 20,
                            "line": 19,
                            "offset": 1075
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 50,
                            "line": 14,
                            "offset": 494
                        },
                        "start": {
                            "col": 46,
                            "line": 14,
                            "offset": 490
                        }
                    },
                    "$REQ": {
                        "abstract_content": "query",
                        "end": {
                            "col": 32,
                            "line": 15,
                            "offset": 547
                        },
                        "start": {
                            "col": 27,
                            "line": 15,
                            "offset": 542
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 10,
                            "line": 19,
                            "offset": 1065
                        },
                        "start": {
                            "col": 7,
                            "line": 19,
                            "offset": 1062
                        }
                    },
                    "$VALUE": {
                        "abstract_content": "to",
                        "end": {
                            "col": 35,
                            "line": 15,
                            "offset": 550
                        },
                        "start": {
                            "col": 33,
                            "line": 15,
                            "offset": 548
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/redirect.ts",
            "start": {
                "col": 20,
                "line": 19,
                "offset": 1075
            }
        },
        {
            "check_id": "javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 159,
                "line": 23,
                "offset": 1010
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "criteria",
                            "location": {
                                "end": {
                                    "col": 17,
                                    "line": 21,
                                    "offset": 709
                                },
                                "path": "TypeScript/juice-shop/routes/search.ts",
                                "start": {
                                    "col": 9,
                                    "line": 21,
                                    "offset": 701
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 159,
                                    "line": 23,
                                    "offset": 1010
                                },
                                "path": "TypeScript/juice-shop/routes/search.ts",
                                "start": {
                                    "col": 28,
                                    "line": 23,
                                    "offset": 879
                                }
                            },
                            "`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 69,
                                    "line": 21,
                                    "offset": 761
                                },
                                "path": "TypeScript/juice-shop/routes/search.ts",
                                "start": {
                                    "col": 60,
                                    "line": 21,
                                    "offset": 752
                                }
                            },
                            "req.query"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "c72ebc1536637562a0a431f6dc11d122cd5512201f234aa9cfebcb4dd5b49c40ee9a3d7290276e47b5fef6e176307af2b6d869ca3d31c4932f074d246a1d1525_0",
                "is_ignored": false,
                "lines": "    models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`) // vuln-code-snippet vuln-line unionSqlInjectionChallenge dbSchemaChallenge",
                "message": "Detected a sequelize statement that is tainted by user-input. This could lead to SQL injection if the variable is user-controlled and is not properly sanitized. In order to prevent SQL injection, it is recommended to use parameterized queries or prepared statements.",
                "metadata": {
                    "category": "security",
                    "confidence": "HIGH",
                    "cwe": [
                        "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "HIGH",
                    "interfile": true,
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://sequelize.org/docs/v6/core-concepts/raw-queries/#replacements"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22085,
                            "rule_id": "yyU0GX",
                            "rv_id": 834186,
                            "url": "https://semgrep.dev/playground/r/w8TAxwx/javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
                            "version_id": "w8TAxwx"
                        }
                    },
                    "shortlink": "https://sg.run/gjoe",
                    "source": "https://semgrep.dev/r/javascript.sequelize.security.audit.sequelize-injection-express.express-sequelize-injection",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "SQL Injection"
                    ]
                },
                "metavars": {
                    "$DB": {
                        "abstract_content": "models",
                        "end": {
                            "col": 11,
                            "line": 23,
                            "offset": 862
                        },
                        "start": {
                            "col": 5,
                            "line": 23,
                            "offset": 856
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 44,
                            "line": 20,
                            "offset": 671
                        },
                        "start": {
                            "col": 40,
                            "line": 20,
                            "offset": 667
                        }
                    },
                    "$QUERY": {
                        "abstract_content": "`SELECT * FROM Products WHERE ((name LIKE '%criteria%' OR description LIKE '%criteria%') AND deletedAt IS NULL) ORDER BY name",
                        "end": {
                            "col": 159,
                            "line": 23,
                            "offset": 1010
                        },
                        "start": {
                            "col": 28,
                            "line": 23,
                            "offset": 879
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 63,
                            "line": 21,
                            "offset": 755
                        },
                        "start": {
                            "col": 60,
                            "line": 21,
                            "offset": 752
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 28,
                            "line": 20,
                            "offset": 655
                        },
                        "start": {
                            "col": 25,
                            "line": 20,
                            "offset": 652
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/search.ts",
            "start": {
                "col": 28,
                "line": 23,
                "offset": 879
            }
        },
        {
            "check_id": "javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 82,
                "line": 23,
                "offset": 933
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "criteria",
                            "location": {
                                "end": {
                                    "col": 17,
                                    "line": 21,
                                    "offset": 709
                                },
                                "path": "TypeScript/juice-shop/routes/search.ts",
                                "start": {
                                    "col": 9,
                                    "line": 21,
                                    "offset": 701
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 82,
                                    "line": 23,
                                    "offset": 933
                                },
                                "path": "TypeScript/juice-shop/routes/search.ts",
                                "start": {
                                    "col": 74,
                                    "line": 23,
                                    "offset": 925
                                }
                            },
                            "criteria"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 69,
                                    "line": 21,
                                    "offset": 761
                                },
                                "path": "TypeScript/juice-shop/routes/search.ts",
                                "start": {
                                    "col": 60,
                                    "line": 21,
                                    "offset": 752
                                }
                            },
                            "req.query"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "5532697b493a463052bd82f9a20ef7d6dd3cdc9e1d18de4382377fa14b81022ace546b64457e18bed6c60eb4c1f58e421e37d6bcb12592ad24ed4eab345d0b11_0",
                "is_ignored": false,
                "lines": "    models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`) // vuln-code-snippet vuln-line unionSqlInjectionChallenge dbSchemaChallenge",
                "message": "Detected user input used to manually construct a SQL string. This is usually bad practice because manual construction could accidentally result in a SQL injection. An attacker could use a SQL injection to steal or modify contents of the database. Instead, use a parameterized query which is available by default in most database engines. Alternatively, consider using an object-relational mapper (ORM) such as Sequelize which will protect your queries.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/SQL_Injection"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 14715,
                            "rule_id": "NbUNpr",
                            "rv_id": 834108,
                            "url": "https://semgrep.dev/playground/r/DkTG0jd/javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
                            "version_id": "DkTG0jd"
                        }
                    },
                    "shortlink": "https://sg.run/66ZL",
                    "source": "https://semgrep.dev/r/javascript.express.security.injection.tainted-sql-string.tainted-sql-string",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "SQL Injection"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "SELECT",
                        "end": {
                            "col": 7,
                            "line": 1,
                            "offset": 6
                        },
                        "start": {
                            "col": 1,
                            "line": 1,
                            "offset": 0
                        }
                    },
                    "$EXPR": {
                        "abstract_content": "criteria",
                        "end": {
                            "col": 82,
                            "line": 23,
                            "offset": 933
                        },
                        "start": {
                            "col": 74,
                            "line": 23,
                            "offset": 925
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 63,
                            "line": 21,
                            "offset": 755
                        },
                        "start": {
                            "col": 60,
                            "line": 21,
                            "offset": 752
                        }
                    },
                    "$SQLSTR": {
                        "abstract_content": "SELECT * FROM Products WHERE ((name LIKE '%",
                        "end": {
                            "col": 72,
                            "line": 23,
                            "offset": 923
                        },
                        "start": {
                            "col": 29,
                            "line": 23,
                            "offset": 880
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/search.ts",
            "start": {
                "col": 74,
                "line": 23,
                "offset": 925
            }
        },
        {
            "check_id": "javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 66,
                "line": 34,
                "offset": 1262
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "id",
                            "location": {
                                "end": {
                                    "col": 13,
                                    "line": 30,
                                    "offset": 971
                                },
                                "path": "TypeScript/juice-shop/routes/showProductReviews.ts",
                                "start": {
                                    "col": 11,
                                    "line": 30,
                                    "offset": 969
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 66,
                                    "line": 34,
                                    "offset": 1262
                                },
                                "path": "TypeScript/juice-shop/routes/showProductReviews.ts",
                                "start": {
                                    "col": 31,
                                    "line": 34,
                                    "offset": 1227
                                }
                            },
                            "{ $where: 'this.product == ' + id }"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 95,
                                    "line": 30,
                                    "offset": 1053
                                },
                                "path": "TypeScript/juice-shop/routes/showProductReviews.ts",
                                "start": {
                                    "col": 85,
                                    "line": 30,
                                    "offset": 1043
                                }
                            },
                            "req.params"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "da64c4e8903bf0a21606a16efe59b1b46d487ca4185697cddd46d751f3d7dbb04bf03f8817e807b30279d1555aa2f16e6be6fc43fda0adf906f3991c6d8cf2fe_0",
                "is_ignored": false,
                "lines": "    db.reviewsCollection.find({ $where: 'this.product == ' + id }).then((reviews: Review[]) => {",
                "message": "Detected a `../data/mongodb` statement that comes from a `req` argument. This could lead to NoSQL injection if the variable is user-controlled and is not properly sanitized. Be sure to properly sanitize the data if you absolutely must pass request data into a mongo query.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-943: Improper Neutralization of Special Elements in Data Query Logic"
                    ],
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "db::sink::sql-or-nosql-query::mongoose",
                        "db::sink::sql-or-nosql-query::mongojs",
                        "db::sink::sql-or-nosql-query::mongodb"
                    ],
                    "impact": "HIGH",
                    "interfile": true,
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/www-pdf-archive/GOD16-NOSQL.pdf"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 28086,
                            "rule_id": "WAUqgq",
                            "rv_id": 850621,
                            "url": "https://semgrep.dev/playground/r/YDTlXwn/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                            "version_id": "YDTlXwn"
                        }
                    },
                    "shortlink": "https://sg.run/Qqxq",
                    "source": "https://semgrep.dev/r/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "nodejs",
                        "mongodb"
                    ],
                    "vulnerability_class": [
                        "Improper Validation"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "mongodb",
                        "end": {
                            "col": 12,
                            "line": 2,
                            "offset": 15
                        },
                        "start": {
                            "col": 5,
                            "line": 2,
                            "offset": 8
                        }
                    },
                    "$DB": {
                        "abstract_content": "db",
                        "end": {
                            "col": 7,
                            "line": 34,
                            "offset": 1203
                        },
                        "start": {
                            "col": 5,
                            "line": 34,
                            "offset": 1201
                        }
                    },
                    "$IMPORT": {
                        "abstract_content": "../data/mongodb",
                        "end": {
                            "col": 37,
                            "line": 10,
                            "offset": 376
                        },
                        "start": {
                            "col": 22,
                            "line": 10,
                            "offset": 361
                        }
                    },
                    "$M": {
                        "abstract_content": "find",
                        "end": {
                            "col": 30,
                            "line": 34,
                            "offset": 1226
                        },
                        "start": {
                            "col": 26,
                            "line": 34,
                            "offset": 1222
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 88,
                            "line": 30,
                            "offset": 1046
                        },
                        "start": {
                            "col": 85,
                            "line": 30,
                            "offset": 1043
                        }
                    },
                    "$VALUE": {
                        "abstract_content": "{$where'this.product == '+id}",
                        "end": {
                            "col": 66,
                            "line": 34,
                            "offset": 1262
                        },
                        "start": {
                            "col": 31,
                            "line": 34,
                            "offset": 1227
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/showProductReviews.ts",
            "start": {
                "col": 31,
                "line": 34,
                "offset": 1227
            }
        },
        {
            "check_id": "javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 68,
                "line": 17,
                "offset": 806
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "id",
                            "location": {
                                "end": {
                                    "col": 13,
                                    "line": 14,
                                    "offset": 468
                                },
                                "path": "TypeScript/juice-shop/routes/trackOrder.ts",
                                "start": {
                                    "col": 11,
                                    "line": 14,
                                    "offset": 466
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 68,
                                    "line": 17,
                                    "offset": 806
                                },
                                "path": "TypeScript/juice-shop/routes/trackOrder.ts",
                                "start": {
                                    "col": 30,
                                    "line": 17,
                                    "offset": 768
                                }
                            },
                            "{ $where: `this.orderId === '${id}'` }"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 136,
                                    "line": 14,
                                    "offset": 591
                                },
                                "path": "TypeScript/juice-shop/routes/trackOrder.ts",
                                "start": {
                                    "col": 126,
                                    "line": 14,
                                    "offset": 581
                                }
                            },
                            "req.params"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "72cf532059096b04460758a6cfa3617af670e4d96675d81781a84376356aba16a8e639d02a2e75e82ab1ed9c775183ca08c402832d283ac763a9cce58960d608_0",
                "is_ignored": false,
                "lines": "    db.ordersCollection.find({ $where: `this.orderId === '${id}'` }).then((order: any) => {",
                "message": "Detected a `../data/mongodb` statement that comes from a `req` argument. This could lead to NoSQL injection if the variable is user-controlled and is not properly sanitized. Be sure to properly sanitize the data if you absolutely must pass request data into a mongo query.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-943: Improper Neutralization of Special Elements in Data Query Logic"
                    ],
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "db::sink::sql-or-nosql-query::mongoose",
                        "db::sink::sql-or-nosql-query::mongojs",
                        "db::sink::sql-or-nosql-query::mongodb"
                    ],
                    "impact": "HIGH",
                    "interfile": true,
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/www-pdf-archive/GOD16-NOSQL.pdf"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 28086,
                            "rule_id": "WAUqgq",
                            "rv_id": 850621,
                            "url": "https://semgrep.dev/playground/r/YDTlXwn/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                            "version_id": "YDTlXwn"
                        }
                    },
                    "shortlink": "https://sg.run/Qqxq",
                    "source": "https://semgrep.dev/r/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "nodejs",
                        "mongodb"
                    ],
                    "vulnerability_class": [
                        "Improper Validation"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "mongodb",
                        "end": {
                            "col": 12,
                            "line": 2,
                            "offset": 15
                        },
                        "start": {
                            "col": 5,
                            "line": 2,
                            "offset": 8
                        }
                    },
                    "$DB": {
                        "abstract_content": "db",
                        "end": {
                            "col": 7,
                            "line": 17,
                            "offset": 745
                        },
                        "start": {
                            "col": 5,
                            "line": 17,
                            "offset": 743
                        }
                    },
                    "$IMPORT": {
                        "abstract_content": "../data/mongodb",
                        "end": {
                            "col": 37,
                            "line": 9,
                            "offset": 315
                        },
                        "start": {
                            "col": 22,
                            "line": 9,
                            "offset": 300
                        }
                    },
                    "$M": {
                        "abstract_content": "find",
                        "end": {
                            "col": 29,
                            "line": 17,
                            "offset": 767
                        },
                        "start": {
                            "col": 25,
                            "line": 17,
                            "offset": 763
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 129,
                            "line": 14,
                            "offset": 584
                        },
                        "start": {
                            "col": 126,
                            "line": 14,
                            "offset": 581
                        }
                    },
                    "$VALUE": {
                        "abstract_content": "{$where`this.orderId === 'id'}",
                        "end": {
                            "col": 68,
                            "line": 17,
                            "offset": 806
                        },
                        "start": {
                            "col": 30,
                            "line": 17,
                            "offset": 768
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/trackOrder.ts",
            "start": {
                "col": 30,
                "line": 17,
                "offset": 768
            }
        },
        {
            "check_id": "javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 27,
                "line": 18,
                "offset": 805
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 27,
                                    "line": 18,
                                    "offset": 805
                                },
                                "path": "TypeScript/juice-shop/routes/updateProductReviews.ts",
                                "start": {
                                    "col": 7,
                                    "line": 18,
                                    "offset": 785
                                }
                            },
                            "{ _id: req.body.id }"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 22,
                                    "line": 18,
                                    "offset": 800
                                },
                                "path": "TypeScript/juice-shop/routes/updateProductReviews.ts",
                                "start": {
                                    "col": 14,
                                    "line": 18,
                                    "offset": 792
                                }
                            },
                            "req.body"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "e91740209cd9f2dcd2ba273295d5005d2c3f8413da8906101eacab7ced3a201517673fc964aad645dfbfdf97b43a172d846237ce8286e18a9ee94325eaeef2b8_0",
                "is_ignored": false,
                "lines": "      { _id: req.body.id }, // vuln-code-snippet vuln-line noSqlReviewsChallenge forgedReviewChallenge",
                "message": "Detected a `../data/mongodb` statement that comes from a `req` argument. This could lead to NoSQL injection if the variable is user-controlled and is not properly sanitized. Be sure to properly sanitize the data if you absolutely must pass request data into a mongo query.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-943: Improper Neutralization of Special Elements in Data Query Logic"
                    ],
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "db::sink::sql-or-nosql-query::mongoose",
                        "db::sink::sql-or-nosql-query::mongojs",
                        "db::sink::sql-or-nosql-query::mongodb"
                    ],
                    "impact": "HIGH",
                    "interfile": true,
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A01:2017 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/www-pdf-archive/GOD16-NOSQL.pdf"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 28086,
                            "rule_id": "WAUqgq",
                            "rv_id": 850621,
                            "url": "https://semgrep.dev/playground/r/YDTlXwn/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                            "version_id": "YDTlXwn"
                        }
                    },
                    "shortlink": "https://sg.run/Qqxq",
                    "source": "https://semgrep.dev/r/javascript.express.mongodb.express-mongo-nosqli.express-mongo-nosqli",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "nodejs",
                        "mongodb"
                    ],
                    "vulnerability_class": [
                        "Improper Validation"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "mongodb",
                        "end": {
                            "col": 12,
                            "line": 2,
                            "offset": 15
                        },
                        "start": {
                            "col": 5,
                            "line": 2,
                            "offset": 8
                        }
                    },
                    "$DB": {
                        "abstract_content": "db",
                        "end": {
                            "col": 7,
                            "line": 17,
                            "offset": 695
                        },
                        "start": {
                            "col": 5,
                            "line": 17,
                            "offset": 693
                        }
                    },
                    "$IMPORT": {
                        "abstract_content": "../data/mongodb",
                        "end": {
                            "col": 37,
                            "line": 8,
                            "offset": 294
                        },
                        "start": {
                            "col": 22,
                            "line": 8,
                            "offset": 279
                        }
                    },
                    "$M": {
                        "abstract_content": "update",
                        "end": {
                            "col": 32,
                            "line": 17,
                            "offset": 720
                        },
                        "start": {
                            "col": 26,
                            "line": 17,
                            "offset": 714
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 17,
                            "line": 18,
                            "offset": 795
                        },
                        "start": {
                            "col": 14,
                            "line": 18,
                            "offset": 792
                        }
                    },
                    "$VALUE": {
                        "abstract_content": "{_id req.body.id}",
                        "end": {
                            "col": 27,
                            "line": 18,
                            "offset": 805
                        },
                        "start": {
                            "col": 7,
                            "line": 18,
                            "offset": 785
                        }
                    }
                },
                "severity": "ERROR",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/updateProductReviews.ts",
            "start": {
                "col": 7,
                "line": 18,
                "offset": 785
            }
        },
        {
            "check_id": "javascript.browser.security.eval-detected.eval-detected",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 36,
                "line": 36,
                "offset": 1546
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "405c92843ac38c6bf1b22847b774f4a02cd138a03b146a918788ba10c628abf7cb061ca399a06ef5d2675278963dfe1785c21cdd1e5b55d4d8a82220a08e0c53_0",
                "is_ignored": false,
                "lines": "              username = eval(code) // eslint-disable-line no-eval",
                "message": "Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.",
                "metadata": {
                    "asvs": {
                        "control_id": "5.2.4 Dynamic Code Execution Features",
                        "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing",
                        "section": "V5 Validation, Sanitization and Encoding",
                        "version": "4"
                    },
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
                    ],
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://owasp.org/Top10/A03_2021-Injection"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9238,
                            "rule_id": "GdU7dw",
                            "rv_id": 834048,
                            "url": "https://semgrep.dev/playground/r/RGTKGx8/javascript.browser.security.eval-detected.eval-detected",
                            "version_id": "RGTKGx8"
                        }
                    },
                    "shortlink": "https://sg.run/7ope",
                    "source": "https://semgrep.dev/r/javascript.browser.security.eval-detected.eval-detected",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "browser"
                    ],
                    "vulnerability_class": [
                        "Code Injection"
                    ]
                },
                "metavars": {},
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/userProfile.ts",
            "start": {
                "col": 26,
                "line": 36,
                "offset": 1536
            }
        },
        {
            "check_id": "javascript.express.security.express-insecure-template-usage.express-insecure-template-usage",
            "TP": 0,
            "FP": 1,
            "end": {
                "col": 43,
                "line": 56,
                "offset": 2671
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "loggedInUser",
                            "location": {
                                "end": {
                                    "col": 25,
                                    "line": 24,
                                    "offset": 909
                                },
                                "path": "TypeScript/juice-shop/routes/userProfile.ts",
                                "start": {
                                    "col": 13,
                                    "line": 24,
                                    "offset": 897
                                }
                            }
                        },
                        {
                            "content": "user",
                            "location": {
                                "end": {
                                    "col": 60,
                                    "line": 26,
                                    "offset": 1050
                                },
                                "path": "TypeScript/juice-shop/routes/userProfile.ts",
                                "start": {
                                    "col": 56,
                                    "line": 26,
                                    "offset": 1046
                                }
                            }
                        },
                        {
                            "content": "template",
                            "location": {
                                "end": {
                                    "col": 19,
                                    "line": 47,
                                    "offset": 1935
                                },
                                "path": "TypeScript/juice-shop/routes/userProfile.ts",
                                "start": {
                                    "col": 11,
                                    "line": 47,
                                    "offset": 1927
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 43,
                                    "line": 56,
                                    "offset": 2671
                                },
                                "path": "TypeScript/juice-shop/routes/userProfile.ts",
                                "start": {
                                    "col": 22,
                                    "line": 56,
                                    "offset": 2650
                                }
                            },
                            "pug.compile(template)"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 71,
                                    "line": 24,
                                    "offset": 955
                                },
                                "path": "TypeScript/juice-shop/routes/userProfile.ts",
                                "start": {
                                    "col": 60,
                                    "line": 24,
                                    "offset": 944
                                }
                            },
                            "req.cookies"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "388d61b1da80ad4c9b64a7adbd4b61153f72412e757209ba41e3fd8d02ef7de754f55f121fdada91c9854041ab30f37d573265e9d4047c57f81c75f9dd677d82_0",
                "is_ignored": false,
                "lines": "          const fn = pug.compile(template)",
                "message": "User data from `req` is being compiled into the template, which can lead to a Server Side Template Injection (SSTI) vulnerability.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-1336: Improper Neutralization of Special Elements Used in a Template Engine"
                    ],
                    "impact": "MEDIUM",
                    "interfile": true,
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "MEDIUM",
                    "owasp": [
                        "A03:2021 - Injection",
                        "A01:2017 - Injection"
                    ],
                    "references": [
                        "https://cheatsheetseries.owasp.org/cheatsheets/Injection_Prevention_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 19226,
                            "rule_id": "EwUr9k",
                            "rv_id": 834097,
                            "url": "https://semgrep.dev/playground/r/gETy27Q/javascript.express.security.express-insecure-template-usage.express-insecure-template-usage",
                            "version_id": "gETy27Q"
                        }
                    },
                    "shortlink": "https://sg.run/b49v",
                    "source": "https://semgrep.dev/r/javascript.express.security.express-insecure-template-usage.express-insecure-template-usage",
                    "source_rule_url": [
                        "https://github.com/github/codeql/blob/2ba2642c7ab29b9eedef33bcc2b8cd1d203d0c10/javascript/ql/test/query-tests/Security/CWE-094/CodeInjection/template-sinks.js"
                    ],
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "javascript",
                        "typescript",
                        "express",
                        "pug",
                        "jade",
                        "dot",
                        "ejs",
                        "nunjucks",
                        "lodash",
                        "handlbars",
                        "mustache",
                        "hogan.js",
                        "eta",
                        "squirrelly"
                    ],
                    "vulnerability_class": [
                        "Code Injection"
                    ]
                },
                "metavars": {
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 44,
                            "line": 21,
                            "offset": 765
                        },
                        "start": {
                            "col": 40,
                            "line": 21,
                            "offset": 761
                        }
                    },
                    "$PUG": {
                        "abstract_content": "pug",
                        "end": {
                            "col": 25,
                            "line": 56,
                            "offset": 2653
                        },
                        "start": {
                            "col": 22,
                            "line": 56,
                            "offset": 2650
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 63,
                            "line": 24,
                            "offset": 947
                        },
                        "start": {
                            "col": 60,
                            "line": 24,
                            "offset": 944
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 28,
                            "line": 21,
                            "offset": 749
                        },
                        "start": {
                            "col": 25,
                            "line": 21,
                            "offset": 746
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/userProfile.ts",
            "start": {
                "col": 22,
                "line": 56,
                "offset": 2650
            }
        },
        {
            "check_id": "javascript.lang.security.audit.unknown-value-with-script-tag.unknown-value-with-script-tag",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 94,
                "line": 57,
                "offset": 1957
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "3f742ff66917c0dc71cf9e8425e328ca29b8251f9d56e5ffc89bc445fc781e143d295c659cca4404c5a76786a2ea386b1b4895d2cfbcd5360b071591048117c6_0",
                "is_ignored": false,
                "lines": "      challengeUtils.solveIf(challenges.videoXssChallenge, () => { return utils.contains(subs, '</script><script>alert(`xss`)</script>') })",
                "message": "Cannot determine what 'subs' is and it is used with a '<script>' tag. This could be susceptible to cross-site scripting (XSS). Ensure 'subs' is not externally controlled, or sanitize this data.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "LOW",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A07:2017 - Cross-Site Scripting (XSS)",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://www.developsec.com/2017/11/09/xss-in-a-script-tag/",
                        "https://github.com/juice-shop/juice-shop/blob/1ceb8751e986dacd3214a618c37e7411be6bc11a/routes/videoHandler.ts#L68"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9322,
                            "rule_id": "OrU37Y",
                            "rv_id": 834154,
                            "url": "https://semgrep.dev/playground/r/0bTwbdy/javascript.lang.security.audit.unknown-value-with-script-tag.unknown-value-with-script-tag",
                            "version_id": "0bTwbdy"
                        }
                    },
                    "shortlink": "https://sg.run/1Zy1",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.unknown-value-with-script-tag.unknown-value-with-script-tag",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "javascript"
                    ],
                    "vulnerability_class": [
                        "Cross-Site-Scripting (XSS)"
                    ]
                },
                "metavars": {
                    "$ANYFUNC": {
                        "abstract_content": "getSubsFromFile",
                        "end": {
                            "col": 35,
                            "line": 55,
                            "offset": 1858
                        },
                        "start": {
                            "col": 20,
                            "line": 55,
                            "offset": 1843
                        }
                    },
                    "$OTHERFUNC": {
                        "abstract_content": "utils.contains",
                        "end": {
                            "col": 89,
                            "line": 57,
                            "offset": 1952
                        },
                        "start": {
                            "col": 75,
                            "line": 57,
                            "offset": 1938
                        }
                    },
                    "$UNK": {
                        "abstract_content": "subs",
                        "end": {
                            "col": 94,
                            "line": 57,
                            "offset": 1957
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "getSubsFromFile()",
                            "svalue_end": {
                                "col": 37,
                                "line": 55,
                                "offset": 1860
                            },
                            "svalue_start": {
                                "col": 20,
                                "line": 55,
                                "offset": 1843
                            }
                        },
                        "start": {
                            "col": 90,
                            "line": 57,
                            "offset": 1953
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/videoHandler.ts",
            "start": {
                "col": 90,
                "line": 57,
                "offset": 1953
            }
        },
        {
            "check_id": "javascript.lang.security.audit.unknown-value-with-script-tag.unknown-value-with-script-tag",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 169,
                "line": 69,
                "offset": 2815
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "219002226a80a8870dbba2ddc136c70ec970c056a7db73a15093f8bc7435eb32db9584976c6b55c8ab0b680fcaf05becd60f1549b7fde8ff9c09aada141d6dba_0",
                "is_ignored": false,
                "lines": "      compiledTemplate = compiledTemplate.replace('<script id=\"subtitle\"></script>', '<script id=\"subtitle\" type=\"text/vtt\" data-label=\"English\" data-lang=\"en\">' + subs + '</script>')",
                "message": "Cannot determine what 'subs' is and it is used with a '<script>' tag. This could be susceptible to cross-site scripting (XSS). Ensure 'subs' is not externally controlled, or sanitize this data.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "LOW",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A07:2017 - Cross-Site Scripting (XSS)",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://www.developsec.com/2017/11/09/xss-in-a-script-tag/",
                        "https://github.com/juice-shop/juice-shop/blob/1ceb8751e986dacd3214a618c37e7411be6bc11a/routes/videoHandler.ts#L68"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9322,
                            "rule_id": "OrU37Y",
                            "rv_id": 834154,
                            "url": "https://semgrep.dev/playground/r/0bTwbdy/javascript.lang.security.audit.unknown-value-with-script-tag.unknown-value-with-script-tag",
                            "version_id": "0bTwbdy"
                        }
                    },
                    "shortlink": "https://sg.run/1Zy1",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.unknown-value-with-script-tag.unknown-value-with-script-tag",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "javascript"
                    ],
                    "vulnerability_class": [
                        "Cross-Site-Scripting (XSS)"
                    ]
                },
                "metavars": {
                    "$ANYFUNC": {
                        "abstract_content": "getSubsFromFile",
                        "end": {
                            "col": 35,
                            "line": 55,
                            "offset": 1858
                        },
                        "start": {
                            "col": 20,
                            "line": 55,
                            "offset": 1843
                        }
                    },
                    "$OTHERFUNC": {
                        "abstract_content": "compiledTemplate.replace",
                        "end": {
                            "col": 50,
                            "line": 69,
                            "offset": 2696
                        },
                        "start": {
                            "col": 26,
                            "line": 69,
                            "offset": 2672
                        }
                    },
                    "$UNK": {
                        "abstract_content": "subs",
                        "end": {
                            "col": 169,
                            "line": 69,
                            "offset": 2815
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "getSubsFromFile()",
                            "svalue_end": {
                                "col": 37,
                                "line": 55,
                                "offset": 1860
                            },
                            "svalue_start": {
                                "col": 20,
                                "line": 55,
                                "offset": 1843
                            }
                        },
                        "start": {
                            "col": 165,
                            "line": 69,
                            "offset": 2811
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/videoHandler.ts",
            "start": {
                "col": 165,
                "line": 69,
                "offset": 2811
            }
        },
        {
            "check_id": "javascript.express.express-fs-filename.express-fs-filename",
            "TP": 0,
            "FP": 1,
            "end": {
                "col": 69,
                "line": 79,
                "offset": 2107
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "key",
                            "location": {
                                "end": {
                                    "col": 12,
                                    "line": 70,
                                    "offset": 1790
                                },
                                "path": "TypeScript/juice-shop/routes/vulnCodeFixes.ts",
                                "start": {
                                    "col": 9,
                                    "line": 70,
                                    "offset": 1787
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 69,
                                    "line": 79,
                                    "offset": 2107
                                },
                                "path": "TypeScript/juice-shop/routes/vulnCodeFixes.ts",
                                "start": {
                                    "col": 23,
                                    "line": 79,
                                    "offset": 2061
                                }
                            },
                            "'./data/static/codefixes/' + key + '.info.yml'"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 23,
                                    "line": 70,
                                    "offset": 1801
                                },
                                "path": "TypeScript/juice-shop/routes/vulnCodeFixes.ts",
                                "start": {
                                    "col": 15,
                                    "line": 70,
                                    "offset": 1793
                                }
                            },
                            "req.body"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "8b053a75f925bcaf9c3b458337b43e1dd2d1a1a442dac31f4332b7d1dc98e27c22bc154f8a96d3486cbbf6819e2a5eb2a862a9ce17bd442356ac1f2b6920d6ee_0",
                "is_ignored": false,
                "lines": "    if (fs.existsSync('./data/static/codefixes/' + key + '.info.yml')) {",
                "message": "The application builds a file path from potentially untrusted data, which can lead to a path traversal vulnerability. An attacker can manipulate the file path which the application uses to access files. If the application does not validate user input and sanitize file paths, sensitive files such as configuration or user data can be accessed, potentially creating or overwriting files. To prevent this vulnerability, validate and sanitize any input that is used to create references to file paths. Also, enforce strict file access controls. For example, choose privileges allowing public-facing applications to access only the required files.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "file::sink::file-access:nodejs.fs"
                    ],
                    "impact": "MEDIUM",
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 28654,
                            "rule_id": "kxUzPO",
                            "rv_id": 850619,
                            "url": "https://semgrep.dev/playground/r/qkTQlv4/javascript.express.express-fs-filename.express-fs-filename",
                            "version_id": "qkTQlv4"
                        }
                    },
                    "shortlink": "https://sg.run/0B9W",
                    "source": "https://semgrep.dev/r/javascript.express.express-fs-filename.express-fs-filename",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "nodejs"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$FILE": {
                        "abstract_content": "'./data/static/codefixes/'+key+'.info.yml'",
                        "end": {
                            "col": 69,
                            "line": 79,
                            "offset": 2107
                        },
                        "start": {
                            "col": 23,
                            "line": 79,
                            "offset": 2061
                        }
                    },
                    "$FS": {
                        "abstract_content": "fs",
                        "end": {
                            "col": 11,
                            "line": 79,
                            "offset": 2049
                        },
                        "start": {
                            "col": 9,
                            "line": 79,
                            "offset": 2047
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 148,
                            "line": 69,
                            "offset": 1757
                        },
                        "start": {
                            "col": 144,
                            "line": 69,
                            "offset": 1753
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 18,
                            "line": 70,
                            "offset": 1796
                        },
                        "start": {
                            "col": 15,
                            "line": 70,
                            "offset": 1793
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 132,
                            "line": 69,
                            "offset": 1741
                        },
                        "start": {
                            "col": 129,
                            "line": 69,
                            "offset": 1738
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/vulnCodeFixes.ts",
            "start": {
                "col": 23,
                "line": 79,
                "offset": 2061
            }
        },
        {
            "check_id": "javascript.express.express-fs-filename.express-fs-filename",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 108,
                "line": 80,
                "offset": 2220
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "key",
                            "location": {
                                "end": {
                                    "col": 12,
                                    "line": 70,
                                    "offset": 1790
                                },
                                "path": "TypeScript/juice-shop/routes/vulnCodeFixes.ts",
                                "start": {
                                    "col": 9,
                                    "line": 70,
                                    "offset": 1787
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 108,
                                    "line": 80,
                                    "offset": 2220
                                },
                                "path": "TypeScript/juice-shop/routes/vulnCodeFixes.ts",
                                "start": {
                                    "col": 62,
                                    "line": 80,
                                    "offset": 2174
                                }
                            },
                            "'./data/static/codefixes/' + key + '.info.yml'"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 23,
                                    "line": 70,
                                    "offset": 1801
                                },
                                "path": "TypeScript/juice-shop/routes/vulnCodeFixes.ts",
                                "start": {
                                    "col": 15,
                                    "line": 70,
                                    "offset": 1793
                                }
                            },
                            "req.body"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "8b053a75f925bcaf9c3b458337b43e1dd2d1a1a442dac31f4332b7d1dc98e27c22bc154f8a96d3486cbbf6819e2a5eb2a862a9ce17bd442356ac1f2b6920d6ee_1",
                "is_ignored": false,
                "lines": "      const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))",
                "message": "The application builds a file path from potentially untrusted data, which can lead to a path traversal vulnerability. An attacker can manipulate the file path which the application uses to access files. If the application does not validate user input and sanitize file paths, sensitive files such as configuration or user data can be accessed, potentially creating or overwriting files. To prevent this vulnerability, validate and sanitize any input that is used to create references to file paths. Also, enforce strict file access controls. For example, choose privileges allowing public-facing applications to access only the required files.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "file::sink::file-access:nodejs.fs"
                    ],
                    "impact": "MEDIUM",
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 28654,
                            "rule_id": "kxUzPO",
                            "rv_id": 850619,
                            "url": "https://semgrep.dev/playground/r/qkTQlv4/javascript.express.express-fs-filename.express-fs-filename",
                            "version_id": "qkTQlv4"
                        }
                    },
                    "shortlink": "https://sg.run/0B9W",
                    "source": "https://semgrep.dev/r/javascript.express.express-fs-filename.express-fs-filename",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "nodejs"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$FILE": {
                        "abstract_content": "'./data/static/codefixes/'+key+'.info.yml'",
                        "end": {
                            "col": 108,
                            "line": 80,
                            "offset": 2220
                        },
                        "start": {
                            "col": 62,
                            "line": 80,
                            "offset": 2174
                        }
                    },
                    "$FS": {
                        "abstract_content": "fs",
                        "end": {
                            "col": 48,
                            "line": 80,
                            "offset": 2160
                        },
                        "start": {
                            "col": 46,
                            "line": 80,
                            "offset": 2158
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 148,
                            "line": 69,
                            "offset": 1757
                        },
                        "start": {
                            "col": 144,
                            "line": 69,
                            "offset": 1753
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 18,
                            "line": 70,
                            "offset": 1796
                        },
                        "start": {
                            "col": 15,
                            "line": 70,
                            "offset": 1793
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 132,
                            "line": 69,
                            "offset": 1741
                        },
                        "start": {
                            "col": 129,
                            "line": 69,
                            "offset": 1738
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/vulnCodeFixes.ts",
            "start": {
                "col": 62,
                "line": 80,
                "offset": 2174
            }
        },
        {
            "check_id": "javascript.express.express-fs-filename.express-fs-filename",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 67,
                "line": 93,
                "offset": 3384
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "key",
                            "location": {
                                "end": {
                                    "col": 12,
                                    "line": 75,
                                    "offset": 2641
                                },
                                "path": "TypeScript/juice-shop/routes/vulnCodeSnippet.ts",
                                "start": {
                                    "col": 9,
                                    "line": 75,
                                    "offset": 2638
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 67,
                                    "line": 93,
                                    "offset": 3384
                                },
                                "path": "TypeScript/juice-shop/routes/vulnCodeSnippet.ts",
                                "start": {
                                    "col": 21,
                                    "line": 93,
                                    "offset": 3338
                                }
                            },
                            "'./data/static/codefixes/' + key + '.info.yml'"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 23,
                                    "line": 75,
                                    "offset": 2652
                                },
                                "path": "TypeScript/juice-shop/routes/vulnCodeSnippet.ts",
                                "start": {
                                    "col": 15,
                                    "line": 75,
                                    "offset": 2644
                                }
                            },
                            "req.body"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "747ff0475b1f6748dd7820f98f3a9cf60fb50468c6dd518c29daba6e0b9cd4c2911d6b8e7332a7a177003f971600b2ab664cba4a6e1e63602b9f9c92dd718790_0",
                "is_ignored": false,
                "lines": "  if (fs.existsSync('./data/static/codefixes/' + key + '.info.yml')) {",
                "message": "The application builds a file path from potentially untrusted data, which can lead to a path traversal vulnerability. An attacker can manipulate the file path which the application uses to access files. If the application does not validate user input and sanitize file paths, sensitive files such as configuration or user data can be accessed, potentially creating or overwriting files. To prevent this vulnerability, validate and sanitize any input that is used to create references to file paths. Also, enforce strict file access controls. For example, choose privileges allowing public-facing applications to access only the required files.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "file::sink::file-access:nodejs.fs"
                    ],
                    "impact": "MEDIUM",
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 28654,
                            "rule_id": "kxUzPO",
                            "rv_id": 850619,
                            "url": "https://semgrep.dev/playground/r/qkTQlv4/javascript.express.express-fs-filename.express-fs-filename",
                            "version_id": "qkTQlv4"
                        }
                    },
                    "shortlink": "https://sg.run/0B9W",
                    "source": "https://semgrep.dev/r/javascript.express.express-fs-filename.express-fs-filename",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "nodejs"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$FILE": {
                        "abstract_content": "'./data/static/codefixes/'+key+'.info.yml'",
                        "end": {
                            "col": 67,
                            "line": 93,
                            "offset": 3384
                        },
                        "start": {
                            "col": 21,
                            "line": 93,
                            "offset": 3338
                        }
                    },
                    "$FS": {
                        "abstract_content": "fs",
                        "end": {
                            "col": 9,
                            "line": 93,
                            "offset": 3326
                        },
                        "start": {
                            "col": 7,
                            "line": 93,
                            "offset": 3324
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 142,
                            "line": 74,
                            "offset": 2608
                        },
                        "start": {
                            "col": 138,
                            "line": 74,
                            "offset": 2604
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 18,
                            "line": 75,
                            "offset": 2647
                        },
                        "start": {
                            "col": 15,
                            "line": 75,
                            "offset": 2644
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 126,
                            "line": 74,
                            "offset": 2592
                        },
                        "start": {
                            "col": 123,
                            "line": 74,
                            "offset": 2589
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/vulnCodeSnippet.ts",
            "start": {
                "col": 21,
                "line": 93,
                "offset": 3338
            }
        },
        {
            "check_id": "javascript.express.express-fs-filename.express-fs-filename",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 106,
                "line": 94,
                "offset": 3495
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [
                        {
                            "content": "key",
                            "location": {
                                "end": {
                                    "col": 12,
                                    "line": 75,
                                    "offset": 2641
                                },
                                "path": "TypeScript/juice-shop/routes/vulnCodeSnippet.ts",
                                "start": {
                                    "col": 9,
                                    "line": 75,
                                    "offset": 2638
                                }
                            }
                        }
                    ],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 106,
                                    "line": 94,
                                    "offset": 3495
                                },
                                "path": "TypeScript/juice-shop/routes/vulnCodeSnippet.ts",
                                "start": {
                                    "col": 60,
                                    "line": 94,
                                    "offset": 3449
                                }
                            },
                            "'./data/static/codefixes/' + key + '.info.yml'"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 23,
                                    "line": 75,
                                    "offset": 2652
                                },
                                "path": "TypeScript/juice-shop/routes/vulnCodeSnippet.ts",
                                "start": {
                                    "col": 15,
                                    "line": 75,
                                    "offset": 2644
                                }
                            },
                            "req.body"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "747ff0475b1f6748dd7820f98f3a9cf60fb50468c6dd518c29daba6e0b9cd4c2911d6b8e7332a7a177003f971600b2ab664cba4a6e1e63602b9f9c92dd718790_1",
                "is_ignored": false,
                "lines": "    const codingChallengeInfos = yaml.load(fs.readFileSync('./data/static/codefixes/' + key + '.info.yml', 'utf8'))",
                "message": "The application builds a file path from potentially untrusted data, which can lead to a path traversal vulnerability. An attacker can manipulate the file path which the application uses to access files. If the application does not validate user input and sanitize file paths, sensitive files such as configuration or user data can be accessed, potentially creating or overwriting files. To prevent this vulnerability, validate and sanitize any input that is used to create references to file paths. Also, enforce strict file access controls. For example, choose privileges allowing public-facing applications to access only the required files.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "functional-categories": [
                        "web::source::cookie::express",
                        "web::source::http-params::express",
                        "web::source::http-body::express",
                        "web::source::header::express",
                        "web::source::url-path-params::express",
                        "file::sink::file-access:nodejs.fs"
                    ],
                    "impact": "MEDIUM",
                    "license": "Copyright 2023 Semgrep, Inc.",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A05:2017 - Broken Access Control",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://owasp.org/www-community/attacks/Path_Traversal"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "pro_rules",
                            "r_id": 28654,
                            "rule_id": "kxUzPO",
                            "rv_id": 850619,
                            "url": "https://semgrep.dev/playground/r/qkTQlv4/javascript.express.express-fs-filename.express-fs-filename",
                            "version_id": "qkTQlv4"
                        }
                    },
                    "shortlink": "https://sg.run/0B9W",
                    "source": "https://semgrep.dev/r/javascript.express.express-fs-filename.express-fs-filename",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express",
                        "nodejs"
                    ],
                    "vulnerability_class": [
                        "Path Traversal"
                    ]
                },
                "metavars": {
                    "$FILE": {
                        "abstract_content": "'./data/static/codefixes/'+key+'.info.yml'",
                        "end": {
                            "col": 106,
                            "line": 94,
                            "offset": 3495
                        },
                        "start": {
                            "col": 60,
                            "line": 94,
                            "offset": 3449
                        }
                    },
                    "$FS": {
                        "abstract_content": "fs",
                        "end": {
                            "col": 46,
                            "line": 94,
                            "offset": 3435
                        },
                        "start": {
                            "col": 44,
                            "line": 94,
                            "offset": 3433
                        }
                    },
                    "$NEXT": {
                        "abstract_content": "next",
                        "end": {
                            "col": 142,
                            "line": 74,
                            "offset": 2608
                        },
                        "start": {
                            "col": 138,
                            "line": 74,
                            "offset": 2604
                        }
                    },
                    "$REQ": {
                        "abstract_content": "req",
                        "end": {
                            "col": 18,
                            "line": 75,
                            "offset": 2647
                        },
                        "start": {
                            "col": 15,
                            "line": 75,
                            "offset": 2644
                        }
                    },
                    "$RES": {
                        "abstract_content": "res",
                        "end": {
                            "col": 126,
                            "line": 74,
                            "offset": 2592
                        },
                        "start": {
                            "col": 123,
                            "line": 74,
                            "offset": 2589
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/routes/vulnCodeSnippet.ts",
            "start": {
                "col": 60,
                "line": 94,
                "offset": 3449
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage",
            "TP": 0,
            "FP": 1,
            "end": {
                "col": 22,
                "line": 105,
                "offset": 4989
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "b60f308f8163ff6fe3f4bd6f45c9d99f898d8e7bb153159d7d4e3e10b5085cc33f43abb11a32381239a2dbbe19b164033b7dd20f585d859e0b83a2b885bb111a_0",
                "is_ignored": false,
                "lines": "const app = express()",
                "message": "A CSRF middleware was not detected in your express application. Ensure you are either using one such as `csurf` or `csrf` (see rule references) and/or you are properly doing CSRF validation in your routes with a token or cookies.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-352: Cross-Site Request Forgery (CSRF)"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "HIGH",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://www.npmjs.com/package/csurf",
                        "https://www.npmjs.com/package/csrf",
                        "https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22551,
                            "rule_id": "wdUKEq",
                            "rv_id": 834059,
                            "url": "https://semgrep.dev/playground/r/5PTyDGX/javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage",
                            "version_id": "5PTyDGX"
                        }
                    },
                    "shortlink": "https://sg.run/BxzR",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-check-csurf-middleware-usage.express-check-csurf-middleware-usage",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "javascript",
                        "typescript",
                        "express"
                    ],
                    "vulnerability_class": [
                        "Cross-Site Request Forgery (CSRF)"
                    ]
                },
                "metavars": {
                    "$APP": {
                        "abstract_content": "app",
                        "end": {
                            "col": 10,
                            "line": 105,
                            "offset": 4977
                        },
                        "start": {
                            "col": 7,
                            "line": 105,
                            "offset": 4974
                        }
                    },
                    "$EXPRESS": {
                        "abstract_content": "express",
                        "end": {
                            "col": 20,
                            "line": 105,
                            "offset": 4987
                        },
                        "start": {
                            "col": 13,
                            "line": 105,
                            "offset": 4980
                        }
                    }
                },
                "severity": "INFO",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/server.ts",
            "start": {
                "col": 7,
                "line": 105,
                "offset": 4974
            }
        },
        {
            "check_id": "javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 63,
                "line": 148,
                "offset": 6922
            },
            "extra": {
                "dataflow_trace": {
                    "intermediate_vars": [],
                    "taint_sink": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 63,
                                    "line": 148,
                                    "offset": 6922
                                },
                                "path": "TypeScript/juice-shop/server.ts",
                                "start": {
                                    "col": 21,
                                    "line": 148,
                                    "offset": 6880
                                }
                            },
                            "'Error in timed startup function: ' + name"
                        ]
                    ],
                    "taint_source": [
                        "CliLoc",
                        [
                            {
                                "end": {
                                    "col": 63,
                                    "line": 148,
                                    "offset": 6922
                                },
                                "path": "TypeScript/juice-shop/server.ts",
                                "start": {
                                    "col": 21,
                                    "line": 148,
                                    "offset": 6880
                                }
                            },
                            "'Error in timed startup function: ' + name"
                        ]
                    ]
                },
                "engine_kind": "OSS",
                "fingerprint": "f6872a1a9ab32b8a77e7c63fd86fb914cb67ccfd639a549dc40aeedeca8c24d8a8f0bdfd6826e5b6a5a1e4c28c15386576992ec5754b69ce296760ce2989ee75_0",
                "is_ignored": false,
                "lines": "      console.error('Error in timed startup function: ' + name, err)",
                "message": "Detected string concatenation with a non-literal variable in a util.format / console.log function. If an attacker injects a format specifier in the string, it will forge the log message. Try to use constant values for the format string.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-134: Use of Externally-Controlled Format String"
                    ],
                    "impact": "LOW",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "MEDIUM",
                    "owasp": [
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://cwe.mitre.org/data/definitions/134.html"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 13582,
                            "rule_id": "ReU3OJ",
                            "rv_id": 834156,
                            "url": "https://semgrep.dev/playground/r/qkTQnZj/javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring",
                            "version_id": "qkTQnZj"
                        }
                    },
                    "shortlink": "https://sg.run/7Y5R",
                    "source": "https://semgrep.dev/r/javascript.lang.security.audit.unsafe-formatstring.unsafe-formatstring",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "javascript"
                    ],
                    "vulnerability_class": [
                        "Improper Validation"
                    ]
                },
                "metavars": {
                    "$LOG": {
                        "abstract_content": "error",
                        "end": {
                            "col": 20,
                            "line": 148,
                            "offset": 6879
                        },
                        "start": {
                            "col": 15,
                            "line": 148,
                            "offset": 6874
                        }
                    },
                    "$PARAM": {
                        "abstract_content": "err",
                        "end": {
                            "col": 68,
                            "line": 148,
                            "offset": 6927
                        },
                        "start": {
                            "col": 65,
                            "line": 148,
                            "offset": 6924
                        }
                    },
                    "$STR": {
                        "abstract_content": "'Error in timed startup function: '+name",
                        "end": {
                            "col": 63,
                            "line": 148,
                            "offset": 6922
                        },
                        "start": {
                            "col": 21,
                            "line": 148,
                            "offset": 6880
                        }
                    },
                    "$X": {
                        "abstract_content": "'Error in timed startup function: '",
                        "end": {
                            "col": 56,
                            "line": 148,
                            "offset": 6915
                        },
                        "start": {
                            "col": 21,
                            "line": 148,
                            "offset": 6880
                        }
                    },
                    "$Y": {
                        "abstract_content": "name",
                        "end": {
                            "col": 63,
                            "line": 148,
                            "offset": 6922
                        },
                        "start": {
                            "col": 59,
                            "line": 148,
                            "offset": 6918
                        }
                    }
                },
                "severity": "INFO",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/server.ts",
            "start": {
                "col": 21,
                "line": 148,
                "offset": 6880
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-check-directory-listing.express-check-directory-listing",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 76,
                "line": 260,
                "offset": 11700
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "490642b29f02daeb90b6ed8822301ba5b09bc7b47176800b80432af17d90b29f26c04aa704a2a3390a36139a58cc135fb2198bf9449cf508d796d71a1cd2dd55_0",
                "is_ignored": false,
                "lines": "  app.use('/ftp', serveIndexMiddleware, serveIndex('ftp', { icons: true })) // vuln-code-snippet vuln-line directoryListingChallenge",
                "message": "Directory listing/indexing is enabled, which may lead to disclosure of sensitive directories and files. It is recommended to disable directory listing unless it is a public resource. If you need directory listing, ensure that sensitive files are inaccessible when querying the resource.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-548: Exposure of Information Through Directory Listing"
                    ],
                    "impact": "MEDIUM",
                    "interfile": true,
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A06:2017 - Security Misconfiguration",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://www.npmjs.com/package/serve-index",
                        "https://www.acunetix.com/blog/articles/directory-listing-information-disclosure/"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22552,
                            "rule_id": "x8UqEb",
                            "rv_id": 834060,
                            "url": "https://semgrep.dev/playground/r/GxTDEXG/javascript.express.security.audit.express-check-directory-listing.express-check-directory-listing",
                            "version_id": "GxTDEXG"
                        }
                    },
                    "shortlink": "https://sg.run/DX2G",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-check-directory-listing.express-check-directory-listing",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "Mishandled Sensitive Information"
                    ]
                },
                "metavars": {
                    "$APP": {
                        "abstract_content": "app",
                        "end": {
                            "col": 6,
                            "line": 260,
                            "offset": 11630
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "express()",
                            "svalue_end": {
                                "col": 22,
                                "line": 105,
                                "offset": 4989
                            },
                            "svalue_start": {
                                "col": 13,
                                "line": 105,
                                "offset": 4980
                            }
                        },
                        "start": {
                            "col": 3,
                            "line": 260,
                            "offset": 11627
                        }
                    },
                    "$SERVEINDEX": {
                        "abstract_content": "serveIndex",
                        "end": {
                            "col": 51,
                            "line": 260,
                            "offset": 11675
                        },
                        "start": {
                            "col": 41,
                            "line": 260,
                            "offset": 11665
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/server.ts",
            "start": {
                "col": 3,
                "line": 260,
                "offset": 11627
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-check-directory-listing.express-check-directory-listing",
            "TP": 0,
            "FP": 1,
            "end": {
                "col": 109,
                "line": 264,
                "offset": 12096
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "490642b29f02daeb90b6ed8822301ba5b09bc7b47176800b80432af17d90b29f26c04aa704a2a3390a36139a58cc135fb2198bf9449cf508d796d71a1cd2dd55_1",
                "is_ignored": false,
                "lines": "  app.use('/.well-known', serveIndexMiddleware, serveIndex('.well-known', { icons: true, view: 'details' }))",
                "message": "Directory listing/indexing is enabled, which may lead to disclosure of sensitive directories and files. It is recommended to disable directory listing unless it is a public resource. If you need directory listing, ensure that sensitive files are inaccessible when querying the resource.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-548: Exposure of Information Through Directory Listing"
                    ],
                    "impact": "MEDIUM",
                    "interfile": true,
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A06:2017 - Security Misconfiguration",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://www.npmjs.com/package/serve-index",
                        "https://www.acunetix.com/blog/articles/directory-listing-information-disclosure/"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22552,
                            "rule_id": "x8UqEb",
                            "rv_id": 834060,
                            "url": "https://semgrep.dev/playground/r/GxTDEXG/javascript.express.security.audit.express-check-directory-listing.express-check-directory-listing",
                            "version_id": "GxTDEXG"
                        }
                    },
                    "shortlink": "https://sg.run/DX2G",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-check-directory-listing.express-check-directory-listing",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "Mishandled Sensitive Information"
                    ]
                },
                "metavars": {
                    "$APP": {
                        "abstract_content": "app",
                        "end": {
                            "col": 6,
                            "line": 264,
                            "offset": 11993
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "express()",
                            "svalue_end": {
                                "col": 22,
                                "line": 105,
                                "offset": 4989
                            },
                            "svalue_start": {
                                "col": 13,
                                "line": 105,
                                "offset": 4980
                            }
                        },
                        "start": {
                            "col": 3,
                            "line": 264,
                            "offset": 11990
                        }
                    },
                    "$SERVEINDEX": {
                        "abstract_content": "serveIndex",
                        "end": {
                            "col": 59,
                            "line": 264,
                            "offset": 12046
                        },
                        "start": {
                            "col": 49,
                            "line": 264,
                            "offset": 12036
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/server.ts",
            "start": {
                "col": 3,
                "line": 264,
                "offset": 11990
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-check-directory-listing.express-check-directory-listing",
            "TP": 0,
            "FP": 1,
            "end": {
                "col": 115,
                "line": 268,
                "offset": 12316
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "490642b29f02daeb90b6ed8822301ba5b09bc7b47176800b80432af17d90b29f26c04aa704a2a3390a36139a58cc135fb2198bf9449cf508d796d71a1cd2dd55_2",
                "is_ignored": false,
                "lines": "  app.use('/encryptionkeys', serveIndexMiddleware, serveIndex('encryptionkeys', { icons: true, view: 'details' }))",
                "message": "Directory listing/indexing is enabled, which may lead to disclosure of sensitive directories and files. It is recommended to disable directory listing unless it is a public resource. If you need directory listing, ensure that sensitive files are inaccessible when querying the resource.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-548: Exposure of Information Through Directory Listing"
                    ],
                    "impact": "MEDIUM",
                    "interfile": true,
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A06:2017 - Security Misconfiguration",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://www.npmjs.com/package/serve-index",
                        "https://www.acunetix.com/blog/articles/directory-listing-information-disclosure/"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22552,
                            "rule_id": "x8UqEb",
                            "rv_id": 834060,
                            "url": "https://semgrep.dev/playground/r/GxTDEXG/javascript.express.security.audit.express-check-directory-listing.express-check-directory-listing",
                            "version_id": "GxTDEXG"
                        }
                    },
                    "shortlink": "https://sg.run/DX2G",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-check-directory-listing.express-check-directory-listing",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "Mishandled Sensitive Information"
                    ]
                },
                "metavars": {
                    "$APP": {
                        "abstract_content": "app",
                        "end": {
                            "col": 6,
                            "line": 268,
                            "offset": 12207
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "express()",
                            "svalue_end": {
                                "col": 22,
                                "line": 105,
                                "offset": 4989
                            },
                            "svalue_start": {
                                "col": 13,
                                "line": 105,
                                "offset": 4980
                            }
                        },
                        "start": {
                            "col": 3,
                            "line": 268,
                            "offset": 12204
                        }
                    },
                    "$SERVEINDEX": {
                        "abstract_content": "serveIndex",
                        "end": {
                            "col": 62,
                            "line": 268,
                            "offset": 12263
                        },
                        "start": {
                            "col": 52,
                            "line": 268,
                            "offset": 12253
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/server.ts",
            "start": {
                "col": 3,
                "line": 268,
                "offset": 12204
            }
        },
        {
            "check_id": "javascript.express.security.audit.express-check-directory-listing.express-check-directory-listing",
            "TP": 1,
            "FP": 0,
            "end": {
                "col": 103,
                "line": 272,
                "offset": 12568
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "490642b29f02daeb90b6ed8822301ba5b09bc7b47176800b80432af17d90b29f26c04aa704a2a3390a36139a58cc135fb2198bf9449cf508d796d71a1cd2dd55_3",
                "is_ignored": false,
                "lines": "  app.use('/support/logs', serveIndexMiddleware, serveIndex('logs', { icons: true, view: 'details' })) // vuln-code-snippet vuln-line accessLogDisclosureChallenge",
                "message": "Directory listing/indexing is enabled, which may lead to disclosure of sensitive directories and files. It is recommended to disable directory listing unless it is a public resource. If you need directory listing, ensure that sensitive files are inaccessible when querying the resource.",
                "metadata": {
                    "category": "security",
                    "confidence": "MEDIUM",
                    "cwe": [
                        "CWE-548: Exposure of Information Through Directory Listing"
                    ],
                    "impact": "MEDIUM",
                    "interfile": true,
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "HIGH",
                    "owasp": [
                        "A06:2017 - Security Misconfiguration",
                        "A01:2021 - Broken Access Control"
                    ],
                    "references": [
                        "https://www.npmjs.com/package/serve-index",
                        "https://www.acunetix.com/blog/articles/directory-listing-information-disclosure/"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 22552,
                            "rule_id": "x8UqEb",
                            "rv_id": 834060,
                            "url": "https://semgrep.dev/playground/r/GxTDEXG/javascript.express.security.audit.express-check-directory-listing.express-check-directory-listing",
                            "version_id": "GxTDEXG"
                        }
                    },
                    "shortlink": "https://sg.run/DX2G",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.express-check-directory-listing.express-check-directory-listing",
                    "subcategory": [
                        "vuln"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "Mishandled Sensitive Information"
                    ]
                },
                "metavars": {
                    "$APP": {
                        "abstract_content": "app",
                        "end": {
                            "col": 6,
                            "line": 272,
                            "offset": 12471
                        },
                        "propagated_value": {
                            "svalue_abstract_content": "express()",
                            "svalue_end": {
                                "col": 22,
                                "line": 105,
                                "offset": 4989
                            },
                            "svalue_start": {
                                "col": 13,
                                "line": 105,
                                "offset": 4980
                            }
                        },
                        "start": {
                            "col": 3,
                            "line": 272,
                            "offset": 12468
                        }
                    },
                    "$SERVEINDEX": {
                        "abstract_content": "serveIndex",
                        "end": {
                            "col": 60,
                            "line": 272,
                            "offset": 12525
                        },
                        "start": {
                            "col": 50,
                            "line": 272,
                            "offset": 12515
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/server.ts",
            "start": {
                "col": 3,
                "line": 272,
                "offset": 12468
            }
        },
        {
            "check_id": "javascript.express.security.audit.xss.pug.explicit-unescape.template-explicit-unescape",
            "TP": 0,
            "FP": 1,
            "end": {
                "col": 41,
                "line": 79,
                "offset": 4048
            },
            "extra": {
                "engine_kind": "OSS",
                "fingerprint": "2970b7712e7d1beda706cd2cef8b8570dd4f419be692306533543f6de87a1734685cca9bd368ed2c48fed22bf1980692e3933c83886c5b73055549df7a4d070a_0",
                "is_ignored": false,
                "lines": "            if (splitted.length != 2) {",
                "message": "Detected an explicit unescape in a Pug template, using either '!=' or '!{...}'. If external data can reach these locations, your application is exposed to a cross-site scripting (XSS) vulnerability. If you must do this, ensure no external data can reach this location.",
                "metadata": {
                    "category": "security",
                    "confidence": "LOW",
                    "cwe": [
                        "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
                    ],
                    "cwe2021-top25": true,
                    "cwe2022-top25": true,
                    "impact": "MEDIUM",
                    "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]",
                    "likelihood": "LOW",
                    "owasp": [
                        "A07:2017 - Cross-Site Scripting (XSS)",
                        "A03:2021 - Injection"
                    ],
                    "references": [
                        "https://pugjs.org/language/code.html#unescaped-buffered-code",
                        "https://pugjs.org/language/attributes.html#unescaped-attributes"
                    ],
                    "semgrep.dev": {
                        "rule": {
                            "origin": "community",
                            "r_id": 9287,
                            "rule_id": "WAUonl",
                            "rv_id": 834091,
                            "url": "https://semgrep.dev/playground/r/ZRTlPA9/javascript.express.security.audit.xss.pug.explicit-unescape.template-explicit-unescape",
                            "version_id": "ZRTlPA9"
                        }
                    },
                    "shortlink": "https://sg.run/3xbe",
                    "source": "https://semgrep.dev/r/javascript.express.security.audit.xss.pug.explicit-unescape.template-explicit-unescape",
                    "subcategory": [
                        "audit"
                    ],
                    "technology": [
                        "express"
                    ],
                    "vulnerability_class": [
                        "Cross-Site-Scripting (XSS)"
                    ]
                },
                "metavars": {
                    "$1": {
                        "abstract_content": "!=",
                        "end": {
                            "col": 35,
                            "line": 79,
                            "offset": 4042
                        },
                        "start": {
                            "col": 33,
                            "line": 79,
                            "offset": 4040
                        }
                    }
                },
                "severity": "WARNING",
                "validation_state": "NO_VALIDATOR"
            },
            "path": "TypeScript/juice-shop/views/promotionVideo.pug",
            "start": {
                "col": 13,
                "line": 79,
                "offset": 4020
            }
        }
    ],
    "skipped_rules": [],
    "version": "1.90.0"
}